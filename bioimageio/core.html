<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 15.0.0"/>
    <title>bioimageio.core API documentation</title>
            <link rel="icon" href="https://bioimage.io/static/img/bioimage-io-icon-small.svg"/>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:.75rem center;margin-bottom:1rem;}.pdoc .alert > em{display:none;}.pdoc .alert > *:last-child{margin-bottom:0;}.pdoc .alert.note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .alert.warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .alert.danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .decorator-deprecated{color:#842029;}.pdoc .decorator-deprecated ~ span{filter:grayscale(1) opacity(0.8);}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../index.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;
                Module Index
            </a>

<a href="https://bioimage.io/">            <img src="https://bioimage.io/static/img/bioimage-io-logo.svg" class="logo" alt="project logo"/>
</a>
            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>

            <h2>Contents</h2>
            <ul>
  <li><a href="#core-bioimage-io-python">core-bioimage-io-python</a>
  <ul>
    <li><a href="#get-started">Get started</a></li>
    <li><a href="#use-the-command-line-interface">💻 Use the Command Line Interface</a></li>
    <li><a href="#use-in-python">🐍 Use in Python</a></li>
    <li><a href="#logging-level">Logging level</a></li>
    <li><a href="#model-specification">Model Specification</a></li>
    <li><a href="#changelog">Changelog</a></li>
  </ul></li>
</ul>


            <h2>Submodules</h2>
            <ul>
                    <li><a href="core/axis.html">axis</a></li>
                    <li><a href="core/block_meta.html">block_meta</a></li>
                    <li><a href="core/cli.html">cli</a></li>
                    <li><a href="core/commands.html">commands</a></li>
                    <li><a href="core/common.html">common</a></li>
                    <li><a href="core/digest_spec.html">digest_spec</a></li>
                    <li><a href="core/io.html">io</a></li>
                    <li><a href="core/model_adapters.html">model_adapters</a></li>
                    <li><a href="core/prediction.html">prediction</a></li>
                    <li><a href="core/proc_ops.html">proc_ops</a></li>
                    <li><a href="core/proc_setup.html">proc_setup</a></li>
                    <li><a href="core/sample.html">sample</a></li>
                    <li><a href="core/stat_calculators.html">stat_calculators</a></li>
                    <li><a href="core/stat_measures.html">stat_measures</a></li>
                    <li><a href="core/tensor.html">tensor</a></li>
            </ul>

            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="variable" href="#__version__">__version__</a>
            </li>
            <li>
                    <a class="class" href="#Axis">Axis</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Axis.__init__">Axis</a>
                        </li>
                        <li>
                                <a class="variable" href="#Axis.id">id</a>
                        </li>
                        <li>
                                <a class="variable" href="#Axis.type">type</a>
                        </li>
                        <li>
                                <a class="function" href="#Axis.create">create</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#AxisId">AxisId</a>
                            <ul class="memberlist">
                        <li>
                                <a class="variable" href="#AxisId.root_model">root_model</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#BlockMeta">BlockMeta</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#BlockMeta.__init__">BlockMeta</a>
                        </li>
                        <li>
                                <a class="variable" href="#BlockMeta.sample_shape">sample_shape</a>
                        </li>
                        <li>
                                <a class="variable" href="#BlockMeta.inner_slice">inner_slice</a>
                        </li>
                        <li>
                                <a class="variable" href="#BlockMeta.halo">halo</a>
                        </li>
                        <li>
                                <a class="variable" href="#BlockMeta.block_index">block_index</a>
                        </li>
                        <li>
                                <a class="variable" href="#BlockMeta.blocks_in_sample">blocks_in_sample</a>
                        </li>
                        <li>
                                <a class="variable" href="#BlockMeta.shape">shape</a>
                        </li>
                        <li>
                                <a class="variable" href="#BlockMeta.padding">padding</a>
                        </li>
                        <li>
                                <a class="variable" href="#BlockMeta.outer_slice">outer_slice</a>
                        </li>
                        <li>
                                <a class="variable" href="#BlockMeta.inner_shape">inner_shape</a>
                        </li>
                        <li>
                                <a class="variable" href="#BlockMeta.local_slice">local_slice</a>
                        </li>
                        <li>
                                <a class="variable" href="#BlockMeta.dims">dims</a>
                        </li>
                        <li>
                                <a class="variable" href="#BlockMeta.tagged_shape">tagged_shape</a>
                        </li>
                        <li>
                                <a class="variable" href="#BlockMeta.inner_slice_wo_overlap">inner_slice_wo_overlap</a>
                        </li>
                        <li>
                                <a class="function" href="#BlockMeta.get_transformed">get_transformed</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="function" href="#build_description">build_description</a>
            </li>
            <li>
                    <a class="function" href="#compute_dataset_measures">compute_dataset_measures</a>
            </li>
            <li>
                    <a class="function" href="#create_prediction_pipeline">create_prediction_pipeline</a>
            </li>
            <li>
                    <a class="function" href="#dump_description">dump_description</a>
            </li>
            <li>
                    <a class="function" href="#enable_determinism">enable_determinism</a>
            </li>
            <li>
                    <a class="function" href="#load_dataset_description">load_dataset_description</a>
            </li>
            <li>
                    <a class="function" href="#load_description_and_test">load_description_and_test</a>
            </li>
            <li>
                    <a class="function" href="#load_description_and_validate_format_only">load_description_and_validate_format_only</a>
            </li>
            <li>
                    <a class="function" href="#load_description">load_description</a>
            </li>
            <li>
                    <a class="function" href="#load_model_description">load_model_description</a>
            </li>
            <li>
                    <a class="function" href="#load_model">load_model</a>
            </li>
            <li>
                    <a class="function" href="#load_resource">load_resource</a>
            </li>
            <li>
                    <a class="variable" href="#MemberId">MemberId</a>
            </li>
            <li>
                    <a class="function" href="#predict_many">predict_many</a>
            </li>
            <li>
                    <a class="function" href="#predict">predict</a>
            </li>
            <li>
                    <a class="class" href="#PredictionPipeline">PredictionPipeline</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#PredictionPipeline.__init__">PredictionPipeline</a>
                        </li>
                        <li>
                                <a class="variable" href="#PredictionPipeline.name">name</a>
                        </li>
                        <li>
                                <a class="variable" href="#PredictionPipeline.model_description">model_description</a>
                        </li>
                        <li>
                                <a class="function" href="#PredictionPipeline.predict_sample_block">predict_sample_block</a>
                        </li>
                        <li>
                                <a class="function" href="#PredictionPipeline.predict_sample_without_blocking">predict_sample_without_blocking</a>
                        </li>
                        <li>
                                <a class="function" href="#PredictionPipeline.get_output_sample_id">get_output_sample_id</a>
                        </li>
                        <li>
                                <a class="function" href="#PredictionPipeline.predict_sample_with_fixed_blocking">predict_sample_with_fixed_blocking</a>
                        </li>
                        <li>
                                <a class="function" href="#PredictionPipeline.predict_sample_with_blocking">predict_sample_with_blocking</a>
                        </li>
                        <li>
                                <a class="function" href="#PredictionPipeline.apply_preprocessing">apply_preprocessing</a>
                        </li>
                        <li>
                                <a class="function" href="#PredictionPipeline.apply_postprocessing">apply_postprocessing</a>
                        </li>
                        <li>
                                <a class="function" href="#PredictionPipeline.load">load</a>
                        </li>
                        <li>
                                <a class="function" href="#PredictionPipeline.unload">unload</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#Sample">Sample</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Sample.__init__">Sample</a>
                        </li>
                        <li>
                                <a class="variable" href="#Sample.members">members</a>
                        </li>
                        <li>
                                <a class="variable" href="#Sample.stat">stat</a>
                        </li>
                        <li>
                                <a class="variable" href="#Sample.id">id</a>
                        </li>
                        <li>
                                <a class="variable" href="#Sample.shape">shape</a>
                        </li>
                        <li>
                                <a class="function" href="#Sample.split_into_blocks">split_into_blocks</a>
                        </li>
                        <li>
                                <a class="function" href="#Sample.as_single_block">as_single_block</a>
                        </li>
                        <li>
                                <a class="function" href="#Sample.from_blocks">from_blocks</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="function" href="#save_bioimageio_package_as_folder">save_bioimageio_package_as_folder</a>
            </li>
            <li>
                    <a class="function" href="#save_bioimageio_package">save_bioimageio_package</a>
            </li>
            <li>
                    <a class="function" href="#save_bioimageio_yaml_only">save_bioimageio_yaml_only</a>
            </li>
            <li>
                    <a class="variable" href="#settings">settings</a>
            </li>
            <li>
                    <a class="variable" href="#Stat">Stat</a>
            </li>
            <li>
                    <a class="class" href="#Tensor">Tensor</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Tensor.__init__">Tensor</a>
                        </li>
                        <li>
                                <a class="function" href="#Tensor.from_xarray">from_xarray</a>
                        </li>
                        <li>
                                <a class="function" href="#Tensor.from_numpy">from_numpy</a>
                        </li>
                        <li>
                                <a class="variable" href="#Tensor.data">data</a>
                        </li>
                        <li>
                                <a class="variable" href="#Tensor.dims">dims</a>
                        </li>
                        <li>
                                <a class="variable" href="#Tensor.tagged_shape">tagged_shape</a>
                        </li>
                        <li>
                                <a class="variable" href="#Tensor.shape_tuple">shape_tuple</a>
                        </li>
                        <li>
                                <a class="variable" href="#Tensor.size">size</a>
                        </li>
                        <li>
                                <a class="function" href="#Tensor.sum">sum</a>
                        </li>
                        <li>
                                <a class="variable" href="#Tensor.ndim">ndim</a>
                        </li>
                        <li>
                                <a class="variable" href="#Tensor.dtype">dtype</a>
                        </li>
                        <li>
                                <a class="variable" href="#Tensor.sizes">sizes</a>
                        </li>
                        <li>
                                <a class="function" href="#Tensor.astype">astype</a>
                        </li>
                        <li>
                                <a class="function" href="#Tensor.clip">clip</a>
                        </li>
                        <li>
                                <a class="function" href="#Tensor.crop_to">crop_to</a>
                        </li>
                        <li>
                                <a class="function" href="#Tensor.expand_dims">expand_dims</a>
                        </li>
                        <li>
                                <a class="function" href="#Tensor.mean">mean</a>
                        </li>
                        <li>
                                <a class="function" href="#Tensor.std">std</a>
                        </li>
                        <li>
                                <a class="function" href="#Tensor.var">var</a>
                        </li>
                        <li>
                                <a class="function" href="#Tensor.pad">pad</a>
                        </li>
                        <li>
                                <a class="function" href="#Tensor.pad_to">pad_to</a>
                        </li>
                        <li>
                                <a class="function" href="#Tensor.quantile">quantile</a>
                        </li>
                        <li>
                                <a class="function" href="#Tensor.resize_to">resize_to</a>
                        </li>
                        <li>
                                <a class="function" href="#Tensor.transpose">transpose</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="function" href="#test_description">test_description</a>
            </li>
            <li>
                    <a class="function" href="#test_model">test_model</a>
            </li>
            <li>
                    <a class="function" href="#test_resource">test_resource</a>
            </li>
            <li>
                    <a class="function" href="#validate_format">validate_format</a>
            </li>
    </ul>


            <footer>bioimageio.core 0.7.0</footer>

        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
bioimageio<wbr>.core    </h1>

                        <div class="docstring"><p><img src="https://img.shields.io/github/license/bioimage-io/core-bioimage-io-python.svg" alt="License" />
<a href="https://pypi.org/project/bioimageio.core/"><img src="https://img.shields.io/pypi/v/bioimageio-core.svg?style=popout" alt="PyPI" /></a>
<a href="https://anaconda.org/conda-forge/bioimageio.core/"><img src="https://anaconda.org/conda-forge/bioimageio.core/badges/version.svg" alt="conda-version" /></a>
<a href="https://pepy.tech/project/bioimageio.core"><img src="https://static.pepy.tech/badge/bioimageio.core" alt="downloads" /></a>
<a href="https://anaconda.org/conda-forge/bioimageio.core/"><img src="https://img.shields.io/conda/dn/conda-forge/bioimageio.core.svg?label=conda-forge" alt="conda-forge downloads" /></a>
<img src="https://img.shields.io/badge/code%20style-black-000000.svg" alt="code style" />
<a href="https://bioimage-io.github.io/core-bioimage-io-python/coverage/index.html"><img src="https://bioimage-io.github.io/core-bioimage-io-python/coverage/coverage-badge.svg" alt="coverage" /></a></p>

<h1 id="core-bioimage-io-python">core-bioimage-io-python</h1>

<p>Python specific core utilities for bioimage.io resources (in particular models).</p>

<h2 id="get-started">Get started</h2>

<p>To get started we recommend installing <a href="">bioimageio.core</a> with conda together with a deep
learning framework, e.g. pytorch, and run a few <code>bioimageio</code> commands to see what
bioimage.core has to offer:</p>

<ol>
<li><p>install with conda (for more details on conda environments, <a href="https://conda.io/projects/conda/en/latest/user-guide/tasks/manage-environments.html">checkout the conda docs</a>)</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="go">conda install -c conda-forge <a href="">bioimageio.core</a> pytorch</span>
</code></pre>
</div></li>

<li><p>test a model</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">$ </span>bioimageio<span class="w"> </span><span class="nb">test</span><span class="w"> </span>powerful-chipmunk
<span class="go">...</span>
</code></pre>
</div>

<p><details>
<summary>(Click to expand output)</summary></p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="go">  ✔️                 bioimageio validation passed</span>
<span class="go">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span>
<span class="go">  source            https://uk1s3.embassy.ebi.ac.uk/public-datasets/bioimage.io/powerful-chipmunk/1/files/rdf.yaml</span>
<span class="go">  format version    model 0.4.10</span>
<span class="go">  <a href="spec.html">bioimageio.spec</a>   0.5.3post4</span>
<span class="go">  <a href="">bioimageio.core</a>   0.6.8</span>



<span class="go">  ❓   location                                     detail</span>
<span class="go">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span>
<span class="go">  ✔️                                                 initialized ModelDescr to describe model 0.4.10</span>

<span class="go">  ✔️                                                 <a href="spec.html">bioimageio.spec</a> format validation model 0.4.10</span>
<span class="go">  🔍   context.perform_io_checks                    True</span>
<span class="go">  🔍   context.root                                 https://uk1s3.embassy.ebi.ac.uk/public-datasets/bioimage.io/powerful-chipmunk/1/files</span>
<span class="go">  🔍   context.known_files.weights.pt               3bd9c518c8473f1e35abb7624f82f3aa92f1015e66fb1f6a9d08444e1f2f5698</span>
<span class="go">  🔍   context.known_files.weights-torchscript.pt   4e568fd81c0ffa06ce13061327c3f673e1bac808891135badd3b0fcdacee086b</span>
<span class="go">  🔍   context.warning_level                        error</span>

<span class="go">  ✔️                                                 Reproduce test outputs from test inputs</span>

<span class="go">  ✔️                                                 Reproduce test outputs from test inputs</span>
</code></pre>
</div>

<p></details></p>

<p>or</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">$ </span>bioimageio<span class="w"> </span><span class="nb">test</span><span class="w"> </span>impartial-shrimp
<span class="go">...</span>
</code></pre>
</div>

<p><details><summary>(Click to expand output)</summary></p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="go">  ✔️                 bioimageio validation passed</span>
<span class="go">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span>
<span class="go">  source            https://uk1s3.embassy.ebi.ac.uk/public-datasets/bioimage.io/impartial-shrimp/1.1/files/rdf.yaml</span>
<span class="go">  format version    model 0.5.3</span>
<span class="go">  <a href="spec.html">bioimageio.spec</a>   0.5.3.2</span>
<span class="go">  <a href="">bioimageio.core</a>   0.6.9</span>


<span class="go">  ❓   location                    detail</span>
<span class="go">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span>
<span class="go">  ✔️                                initialized ModelDescr to describe model 0.5.3</span>


<span class="go">  ✔️                                <a href="spec.html">bioimageio.spec</a> format validation model 0.5.3</span>

<span class="go">  🔍   context.perform_io_checks   False</span>
<span class="go">  🔍   context.warning_level       error</span>

<span class="go">  ✔️                                Reproduce test outputs from test inputs (pytorch_state_dict)</span>


<span class="go">  ✔️                                Run pytorch_state_dict inference for inputs with batch_size: 1 and size parameter n:</span>

<span class="go">                                  0</span>

<span class="go">  ✔️                                Run pytorch_state_dict inference for inputs with batch_size: 2 and size parameter n:</span>

<span class="go">                                  0</span>

<span class="go">  ✔️                                Run pytorch_state_dict inference for inputs with batch_size: 1 and size parameter n:</span>

<span class="go">                                  1</span>

<span class="go">  ✔️                                Run pytorch_state_dict inference for inputs with batch_size: 2 and size parameter n:</span>

<span class="go">                                  1</span>

<span class="go">  ✔️                                Run pytorch_state_dict inference for inputs with batch_size: 1 and size parameter n:</span>

<span class="go">                                  2</span>

<span class="go">  ✔️                                Run pytorch_state_dict inference for inputs with batch_size: 2 and size parameter n:</span>

<span class="go">                                  2</span>

<span class="go">  ✔️                                Reproduce test outputs from test inputs (torchscript)</span>


<span class="go">  ✔️                                Run torchscript inference for inputs with batch_size: 1 and size parameter n: 0</span>


<span class="go">  ✔️                                Run torchscript inference for inputs with batch_size: 2 and size parameter n: 0</span>


<span class="go">  ✔️                                Run torchscript inference for inputs with batch_size: 1 and size parameter n: 1</span>


<span class="go">  ✔️                                Run torchscript inference for inputs with batch_size: 2 and size parameter n: 1</span>


<span class="go">  ✔️                                Run torchscript inference for inputs with batch_size: 1 and size parameter n: 2</span>


<span class="go">  ✔️                                Run torchscript inference for inputs with batch_size: 2 and size parameter n: 2</span>
</code></pre>
</div>

<p></details></p></li>
<li>run prediction on your data</li>
</ol>

<ul>
<li><p>display the <code>bioimageio-predict</code> command help to get an overview:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">$ </span>bioimageio<span class="w"> </span>predict<span class="w"> </span>--help
<span class="go">...</span>
</code></pre>
</div>

<p><details>
<summary>(Click to expand output)</summary></p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="go">usage: bioimageio predict [-h] [--inputs Sequence[Union[str,Annotated[Tuple[str,...],MinLenmin_length=1]]]]</span>
<span class="go">                          [--outputs {str,Tuple[str,...]}] [--overwrite bool] [--blockwise bool] [--stats Path]</span>
<span class="go">                          [--preview bool]</span>
<span class="go">                          [--weight_format {typing.Literal[&#39;keras_hdf5&#39;,&#39;onnx&#39;,&#39;pytorch_state_dict&#39;,&#39;tensorflow_js&#39;,&#39;tensorflow_saved_model_bundle&#39;,&#39;torchscript&#39;],any}]</span>
<span class="go">                          [--example bool]</span>
<span class="go">                          SOURCE</span>

<span class="go">bioimageio-predict - Run inference on your data with a bioimage.io model.</span>

<span class="go">positional arguments:</span>
<span class="go">  SOURCE                Url/path to a bioimageio.yaml/rdf.yaml file</span>
<span class="go">                        or a bioimage.io resource identifier, e.g. &#39;affable-shark&#39;</span>

<span class="go">optional arguments:</span>
<span class="go">  -h, --help            show this help message and exit</span>
<span class="go">  --inputs Sequence[Union[str,Annotated[Tuple[str,...],MinLen(min_length=1)]]]</span>
<span class="go">                        Model input sample paths (for each input tensor)</span>

<span class="go">                        The input paths are expected to have shape...</span>
<span class="go">                        - (n_samples,) or (n_samples,1) for models expecting a single input tensor</span>
<span class="go">                        - (n_samples,) containing the substring &#39;{input_id}&#39;, or</span>
<span class="go">                        - (n_samples, n_model_inputs) to provide each input tensor path explicitly.</span>

<span class="go">                        All substrings that are replaced by metadata from the model description:</span>
<span class="go">                        - &#39;{model_id}&#39;</span>
<span class="go">                        - &#39;{input_id}&#39;</span>

<span class="go">                        Example inputs to process sample &#39;a&#39; and &#39;b&#39;</span>
<span class="go">                        for a model expecting a &#39;raw&#39; and a &#39;mask&#39; input tensor:</span>
<span class="go">                        --inputs=&quot;[[&quot;a_raw.tif&quot;,&quot;a_mask.tif&quot;],[&quot;b_raw.tif&quot;,&quot;b_mask.tif&quot;]]&quot;</span>
<span class="go">                        (Note that JSON double quotes need to be escaped.)</span>

<span class="go">                        Alternatively a `bioimageio-cli.yaml` (or `bioimageio-cli.json`) file</span>
<span class="go">                        may provide the arguments, e.g.:</span>
<span class="go">                        ```yaml</span>
<span class="go">                        inputs:</span>
<span class="go">                        - [a_raw.tif, a_mask.tif]</span>
<span class="go">                        - [b_raw.tif, b_mask.tif]</span>
<span class="go">                   </span>
</code></pre>
</div>

<pre><code>                    `.npy` and any file extension supported by imageio are supported.
                    Aavailable formats are listed at
                    https://imageio.readthedocs.io/en/stable/formats/index.html#all-formats.
                    Some formats have additional dependencies.

                      (default: ('{input_id}/001.tif',))
</code></pre>

<p>--outputs {str,Tuple[str,...]}
                        Model output path pattern (per output tensor)</p>

<pre><code>                    All substrings that are replaced:
                    - '{model_id}' (from model description)
                    - '{output_id}' (from model description)
                    - '{sample_id}' (extracted from input paths)

                      (default: outputs_{model_id}/{output_id}/{sample_id}.tif)
</code></pre>

<p>--overwrite bool      allow overwriting existing output files (default: False)
  --blockwise bool      process inputs blockwise (default: False)
  --stats Path          path to dataset statistics
                        (will be written if it does not exist,
                        but the model requires statistical dataset measures)
                          (default: dataset_statistics.json)
  --preview bool        preview which files would be processed
                        and what outputs would be generated. (default: False)
  --weight_format {typing.Literal['keras_hdf5','onnx','pytorch_state_dict','tensorflow_js','tensorflow_saved_model_bundle','torchscript'],any}
                        The weight format to use. (default: any)
  --example bool        generate and run an example</p>

<pre><code>                    1. downloads example model inputs
                    2. creates a `{model_id}_example` folder
                    3. writes input arguments to `{model_id}_example/bioimageio-cli.yaml`
                    4. executes a preview dry-run
                    5. executes prediction with example input

                      (default: False)
</code></pre></li>
</ul>

<pre><code>
    &lt;/details&gt;

- create an example and run prediction locally!

    ```console
    $ bioimageio predict impartial-shrimp --example=True
    ...
</code></pre>

<pre><code>&lt;details&gt;
&lt;summary&gt;(Click to expand output)&lt;/summary&gt;

```console
🛈 bioimageio prediction preview structure:
{'{sample_id}': {'inputs': {'{input_id}': '&lt;input path&gt;'},
                'outputs': {'{output_id}': '&lt;output path&gt;'}}}
🔎 bioimageio prediction preview output:
{'1': {'inputs': {'input0': 'impartial-shrimp_example/input0/001.tif'},
      'outputs': {'output0': 'impartial-shrimp_example/outputs/output0/1.tif'}}}
predict with impartial-shrimp: 100%|███████████████████████████████████████████████████| 1/1 [00:21&lt;00:00, 21.76s/sample]
🎉 Sucessfully ran example prediction!
To predict the example input using the CLI example config file impartial-shrimp_example\bioimageio-cli.yaml, execute `bioimageio predict` from impartial-shrimp_example:
$ cd impartial-shrimp_example
$ bioimageio predict "impartial-shrimp"

Alternatively run the following command in the current workind directory, not the example folder:
$ bioimageio predict --preview=False --overwrite=True --stats="impartial-shrimp_example/dataset_statistics.json" --inputs="[[\"impartial-shrimp_example/input0/001.tif\"]]" --outputs="impartial-shrimp_example/outputs/{output_id}/{sample_id}.tif" "impartial-shrimp"
(note that a local 'bioimageio-cli.json' or 'bioimageio-cli.yaml' may interfere with this)
</code></pre>

<pre><code>
  &lt;/details&gt;

## Installation

### Via Mamba/Conda

The `<a href="">bioimageio.core</a>` package can be installed from conda-forge via

```console
mamba install -c conda-forge <a href="">bioimageio.core</a>
```

If you do not install any additional deep learning libraries, you will only be able to use general convenience
functionality, but not any functionality for model prediction.
To install additional deep learning libraries use:

- Pytorch/Torchscript:

  CPU installation (if you don't have an nvidia graphics card):

  ```console
  mamba install -c pytorch -c conda-forge <a href="">bioimageio.core</a> pytorch torchvision cpuonly
</code></pre>

<p>GPU installation (for cuda 11.6, please choose the appropriate cuda version for your system):</p>

<p><div class="pdoc-code codehilite">
<pre><span></span><code><span class="go">mamba install -c pytorch -c nvidia -c conda-forge <a href="">bioimageio.core</a> pytorch torchvision pytorch-cuda=11.8</span>
</code></pre>
</div></p>

<p>Note that the pytorch installation instructions may change in the future. For the latest instructions please refer to <a href="https://pytorch.org/">pytorch.org</a>.</p>

<ul>
<li><p>Tensorflow</p>

<p>Currently only CPU version supported</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="go">mamba install -c conda-forge <a href="">bioimageio.core</a> tensorflow</span>
</code></pre>
</div></li>

<li><p>ONNXRuntime</p>

<p>Currently only cpu version supported</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="go">mamba install -c conda-forge <a href="">bioimageio.core</a> onnxruntime</span>
</code></pre>
</div></li>
</ul>

<h3 id="via-pip">Via pip</h3>

<p>The package is also available via pip
(e.g. with recommended extras <code>onnx</code> and <code>pytorch</code>):</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="go">pip install &quot;<a href="">bioimageio.core</a>[onnx,pytorch]&quot;</span>
</code></pre>
</div>

<h3 id="set-up-development-environment">Set up Development Environment</h3>

<p>To set up a development conda environment run the following commands:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="go">mamba env create -f dev/env.yaml</span>
<span class="go">mamba activate core</span>
<span class="go">pip install -e . --no-deps</span>
</code></pre>
</div>

<p>There are different environment files available that only install tensorflow or pytorch as dependencies.</p>

<h2 id="use-the-command-line-interface">💻 Use the Command Line Interface</h2>

<p><code><a href="">bioimageio.core</a></code> installs a command line interface (CLI) for testing models and other functionality.
You can list all the available commands via:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="go">bioimageio</span>
</code></pre>
</div>

<h3 id="cli-inputs-from-file">CLI inputs from file</h3>

<p>For convenience the command line options (not arguments) may be given in a <code>bioimageio-cli.json</code>
or <code>bioimageio-cli.yaml</code> file, e.g.:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="c1"># bioimageio-cli.yaml</span>
<span class="nt">inputs</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">inputs/*_{tensor_id}.h5</span>
<span class="nt">outputs</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">outputs_{model_id}/{sample_id}_{tensor_id}.h5</span>
<span class="nt">overwrite</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="nt">blockwise</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="nt">stats</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">inputs/dataset_statistics.json</span>
</code></pre>
</div>

<h2 id="use-in-python">🐍 Use in Python</h2>

<p><code><a href="">bioimageio.core</a></code> is a python package that implements prediction with bioimageio models
including standardized pre- and postprocessing operations.
These models are described by---and can be loaded with---the <a href="spec.html">bioimageio.spec</a> package.</p>

<p>In addition <a href="">bioimageio.core</a> provides functionality to convert model weight formats.</p>

<p>To get an overview of this functionality, check out these example notebooks:</p>

<ul>
<li><a href="https://github.com/bioimage-io/spec-bioimage-io/blob/main/example/load_model_and_create_your_own.ipynb">model creation/loading with bioimageio.spec</a></li>
</ul>

<p>and the <a href="https://bioimage-io.github.io/core-bioimage-io-python/bioimageio/core.html">developer documentation</a>.</p>

<h2 id="logging-level">Logging level</h2>

<p><code><a href="spec.html">bioimageio.spec</a></code> and <code><a href="">bioimageio.core</a></code> use <a href="https://github.com/Delgan/loguru">loguru</a> for logging, hence the logging level
may be controlled with the <code>LOGURU_LEVEL</code> environment variable.</p>

<h2 id="model-specification">Model Specification</h2>

<p>The model specification and its validation tools can be found at <a href="https://github.com/bioimage-io/spec-bioimage-io">https://github.com/bioimage-io/spec-bioimage-io</a>.</p>

<h2 id="changelog">Changelog</h2>

<h3 id="070">0.7.0</h3>

<ul>
<li>breaking:
<ul>
<li>bioimageio CLI now has implicit boolean flags</li>
</ul></li>
<li>non-breaking:
<ul>
<li>use new <code>ValidationDetail.recommended_env</code> in <code>ValidationSummary</code></li>
<li>improve <code>get_io_sample_block_metas()</code>
<ul>
<li>now works for sufficiently large, but not exactly shaped inputs</li>
</ul></li>
<li>update to support <code>zipfile.ZipFile</code> object with <a href="spec.html">bioimageio.spec</a>==0.5.3.5</li>
<li>add io helpers <code>resolve</code> and <code>resolve_and_extract</code></li>
<li>added <code><a href="#enable_determinism">enable_determinism</a></code> function and <strong>determinism</strong> input argument for testing with seeded
random generators and optionally (determinsim=="full") instructing DL frameworks to use
deterministic algorithms.</li>
</ul></li>
</ul>

<h3 id="0610">0.6.10</h3>

<ul>
<li>fix #423</li>
</ul>

<h3 id="069">0.6.9</h3>

<ul>
<li>improve bioimageio command line interface (details in #157)
<ul>
<li>add <code><a href="#predict">predict</a></code> command</li>
<li>package command input <code>path</code> is now required</li>
</ul></li>
</ul>

<h3 id="068">0.6.8</h3>

<ul>
<li>testing model inference will now check all weight formats
(previously only the first one for which model adapter creation succeeded had been checked)</li>
<li>fix predict with blocking (Thanks @thodkatz)</li>
</ul>

<h3 id="067">0.6.7</h3>

<ul>
<li><code><a href="#predict">predict()</a></code> argument <code>inputs</code> may be sample</li>
</ul>

<h3 id="066">0.6.6</h3>

<ul>
<li>add aliases to match previous API more closely</li>
</ul>

<h3 id="065">0.6.5</h3>

<ul>
<li>improve adapter error messages</li>
</ul>

<h3 id="064">0.6.4</h3>

<ul>
<li>add <code>bioimageio validate-format</code> command</li>
<li>improve error messages and display of command results</li>
</ul>

<h3 id="063">0.6.3</h3>

<ul>
<li>Fix <a href="https://github.com/bioimage-io/core-bioimage-io-python/issues/386">#386</a></li>
<li>(in model inference testing) stop assuming model inputs are tileable</li>
</ul>

<h3 id="062">0.6.2</h3>

<ul>
<li>Fix <a href="https://github.com/bioimage-io/core-bioimage-io-python/issues/384">#384</a></li>
</ul>

<h3 id="061">0.6.1</h3>

<ul>
<li>Fix <a href="https://github.com/bioimage-io/core-bioimage-io-python/pull/378">#378</a> (with <a href="https://github.com/bioimage-io/core-bioimage-io-python/pull/379">#379</a>)*</li>
</ul>

<h3 id="060">0.6.0</h3>

<ul>
<li>add compatibility with new <a href="spec.html">bioimageio.spec</a> 0.5 (0.5.2post1)</li>
<li>improve interfaces</li>
</ul>

<h3 id="0510">0.5.10</h3>

<ul>
<li><a href="https://github.com/bioimage-io/core-bioimage-io-python/pull/359">Fix critical bug in predict with tiling</a></li>
</ul>
</div>

                        <input id="mod-core-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-core-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">  1</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">  2</span></a><span class="sd">.. include:: ../../README.md</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos">  3</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos">  4</span></a>
</span><span id="L-5"><a href="#L-5"><span class="linenos">  5</span></a><span class="kn">from</span> <span class="nn">bioimageio.spec</span> <span class="kn">import</span> <span class="p">(</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos">  6</span></a>    <span class="n">build_description</span><span class="p">,</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos">  7</span></a>    <span class="n">dump_description</span><span class="p">,</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos">  8</span></a>    <span class="n">load_dataset_description</span><span class="p">,</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos">  9</span></a>    <span class="n">load_description</span><span class="p">,</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos"> 10</span></a>    <span class="n">load_description_and_validate_format_only</span><span class="p">,</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos"> 11</span></a>    <span class="n">load_model_description</span><span class="p">,</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos"> 12</span></a>    <span class="n">save_bioimageio_package</span><span class="p">,</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos"> 13</span></a>    <span class="n">save_bioimageio_package_as_folder</span><span class="p">,</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos"> 14</span></a>    <span class="n">save_bioimageio_yaml_only</span><span class="p">,</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos"> 15</span></a>    <span class="n">validate_format</span><span class="p">,</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos"> 16</span></a><span class="p">)</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos"> 17</span></a>
</span><span id="L-18"><a href="#L-18"><span class="linenos"> 18</span></a><span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="p">(</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos"> 19</span></a>    <span class="n">axis</span><span class="p">,</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos"> 20</span></a>    <span class="n">block_meta</span><span class="p">,</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos"> 21</span></a>    <span class="n">cli</span><span class="p">,</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos"> 22</span></a>    <span class="n">commands</span><span class="p">,</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos"> 23</span></a>    <span class="n">common</span><span class="p">,</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos"> 24</span></a>    <span class="n">digest_spec</span><span class="p">,</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos"> 25</span></a>    <span class="n">io</span><span class="p">,</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos"> 26</span></a>    <span class="n">model_adapters</span><span class="p">,</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos"> 27</span></a>    <span class="n">prediction</span><span class="p">,</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos"> 28</span></a>    <span class="n">proc_ops</span><span class="p">,</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos"> 29</span></a>    <span class="n">proc_setup</span><span class="p">,</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos"> 30</span></a>    <span class="n">sample</span><span class="p">,</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos"> 31</span></a>    <span class="n">stat_calculators</span><span class="p">,</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos"> 32</span></a>    <span class="n">stat_measures</span><span class="p">,</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos"> 33</span></a>    <span class="n">tensor</span><span class="p">,</span>
</span><span id="L-34"><a href="#L-34"><span class="linenos"> 34</span></a><span class="p">)</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos"> 35</span></a><span class="kn">from</span> <span class="nn">._prediction_pipeline</span> <span class="kn">import</span> <span class="n">PredictionPipeline</span><span class="p">,</span> <span class="n">create_prediction_pipeline</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos"> 36</span></a><span class="kn">from</span> <span class="nn">._resource_tests</span> <span class="kn">import</span> <span class="p">(</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos"> 37</span></a>    <span class="n">enable_determinism</span><span class="p">,</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos"> 38</span></a>    <span class="n">load_description_and_test</span><span class="p">,</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos"> 39</span></a>    <span class="n">test_description</span><span class="p">,</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos"> 40</span></a>    <span class="n">test_model</span><span class="p">,</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos"> 41</span></a><span class="p">)</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos"> 42</span></a><span class="kn">from</span> <span class="nn">._settings</span> <span class="kn">import</span> <span class="n">settings</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos"> 43</span></a><span class="kn">from</span> <span class="nn">.axis</span> <span class="kn">import</span> <span class="n">Axis</span><span class="p">,</span> <span class="n">AxisId</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos"> 44</span></a><span class="kn">from</span> <span class="nn">.block_meta</span> <span class="kn">import</span> <span class="n">BlockMeta</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos"> 45</span></a><span class="kn">from</span> <span class="nn">.common</span> <span class="kn">import</span> <span class="n">MemberId</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos"> 46</span></a><span class="kn">from</span> <span class="nn">.prediction</span> <span class="kn">import</span> <span class="n">predict</span><span class="p">,</span> <span class="n">predict_many</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos"> 47</span></a><span class="kn">from</span> <span class="nn">.sample</span> <span class="kn">import</span> <span class="n">Sample</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos"> 48</span></a><span class="kn">from</span> <span class="nn">.stat_calculators</span> <span class="kn">import</span> <span class="n">compute_dataset_measures</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos"> 49</span></a><span class="kn">from</span> <span class="nn">.stat_measures</span> <span class="kn">import</span> <span class="n">Stat</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos"> 50</span></a><span class="kn">from</span> <span class="nn">.tensor</span> <span class="kn">import</span> <span class="n">Tensor</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos"> 51</span></a><span class="kn">from</span> <span class="nn">.utils</span> <span class="kn">import</span> <span class="n">VERSION</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos"> 52</span></a>
</span><span id="L-53"><a href="#L-53"><span class="linenos"> 53</span></a><span class="n">__version__</span> <span class="o">=</span> <span class="n">VERSION</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos"> 54</span></a>
</span><span id="L-55"><a href="#L-55"><span class="linenos"> 55</span></a>
</span><span id="L-56"><a href="#L-56"><span class="linenos"> 56</span></a><span class="c1"># aliases</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos"> 57</span></a><span class="n">test_resource</span> <span class="o">=</span> <span class="n">test_description</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos"> 58</span></a><span class="sd">&quot;&quot;&quot;alias of `test_description`&quot;&quot;&quot;</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos"> 59</span></a><span class="n">load_resource</span> <span class="o">=</span> <span class="n">load_description</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos"> 60</span></a><span class="sd">&quot;&quot;&quot;alias of `load_description`&quot;&quot;&quot;</span>
</span><span id="L-61"><a href="#L-61"><span class="linenos"> 61</span></a><span class="n">load_model</span> <span class="o">=</span> <span class="n">load_model_description</span>
</span><span id="L-62"><a href="#L-62"><span class="linenos"> 62</span></a><span class="sd">&quot;&quot;&quot;alias of `load_model_description`&quot;&quot;&quot;</span>
</span><span id="L-63"><a href="#L-63"><span class="linenos"> 63</span></a>
</span><span id="L-64"><a href="#L-64"><span class="linenos"> 64</span></a><span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos"> 65</span></a>    <span class="s2">&quot;__version__&quot;</span><span class="p">,</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos"> 66</span></a>    <span class="s2">&quot;axis&quot;</span><span class="p">,</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos"> 67</span></a>    <span class="s2">&quot;Axis&quot;</span><span class="p">,</span>
</span><span id="L-68"><a href="#L-68"><span class="linenos"> 68</span></a>    <span class="s2">&quot;AxisId&quot;</span><span class="p">,</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos"> 69</span></a>    <span class="s2">&quot;block_meta&quot;</span><span class="p">,</span>
</span><span id="L-70"><a href="#L-70"><span class="linenos"> 70</span></a>    <span class="s2">&quot;BlockMeta&quot;</span><span class="p">,</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos"> 71</span></a>    <span class="s2">&quot;build_description&quot;</span><span class="p">,</span>
</span><span id="L-72"><a href="#L-72"><span class="linenos"> 72</span></a>    <span class="s2">&quot;cli&quot;</span><span class="p">,</span>
</span><span id="L-73"><a href="#L-73"><span class="linenos"> 73</span></a>    <span class="s2">&quot;commands&quot;</span><span class="p">,</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos"> 74</span></a>    <span class="s2">&quot;common&quot;</span><span class="p">,</span>
</span><span id="L-75"><a href="#L-75"><span class="linenos"> 75</span></a>    <span class="s2">&quot;compute_dataset_measures&quot;</span><span class="p">,</span>
</span><span id="L-76"><a href="#L-76"><span class="linenos"> 76</span></a>    <span class="s2">&quot;create_prediction_pipeline&quot;</span><span class="p">,</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos"> 77</span></a>    <span class="s2">&quot;digest_spec&quot;</span><span class="p">,</span>
</span><span id="L-78"><a href="#L-78"><span class="linenos"> 78</span></a>    <span class="s2">&quot;dump_description&quot;</span><span class="p">,</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos"> 79</span></a>    <span class="s2">&quot;enable_determinism&quot;</span><span class="p">,</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos"> 80</span></a>    <span class="s2">&quot;io&quot;</span><span class="p">,</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos"> 81</span></a>    <span class="s2">&quot;load_dataset_description&quot;</span><span class="p">,</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos"> 82</span></a>    <span class="s2">&quot;load_description_and_test&quot;</span><span class="p">,</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos"> 83</span></a>    <span class="s2">&quot;load_description_and_validate_format_only&quot;</span><span class="p">,</span>
</span><span id="L-84"><a href="#L-84"><span class="linenos"> 84</span></a>    <span class="s2">&quot;load_description&quot;</span><span class="p">,</span>
</span><span id="L-85"><a href="#L-85"><span class="linenos"> 85</span></a>    <span class="s2">&quot;load_model_description&quot;</span><span class="p">,</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos"> 86</span></a>    <span class="s2">&quot;load_model&quot;</span><span class="p">,</span>
</span><span id="L-87"><a href="#L-87"><span class="linenos"> 87</span></a>    <span class="s2">&quot;load_resource&quot;</span><span class="p">,</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos"> 88</span></a>    <span class="s2">&quot;MemberId&quot;</span><span class="p">,</span>
</span><span id="L-89"><a href="#L-89"><span class="linenos"> 89</span></a>    <span class="s2">&quot;model_adapters&quot;</span><span class="p">,</span>
</span><span id="L-90"><a href="#L-90"><span class="linenos"> 90</span></a>    <span class="s2">&quot;predict_many&quot;</span><span class="p">,</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos"> 91</span></a>    <span class="s2">&quot;predict&quot;</span><span class="p">,</span>
</span><span id="L-92"><a href="#L-92"><span class="linenos"> 92</span></a>    <span class="s2">&quot;prediction&quot;</span><span class="p">,</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos"> 93</span></a>    <span class="s2">&quot;PredictionPipeline&quot;</span><span class="p">,</span>
</span><span id="L-94"><a href="#L-94"><span class="linenos"> 94</span></a>    <span class="s2">&quot;proc_ops&quot;</span><span class="p">,</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos"> 95</span></a>    <span class="s2">&quot;proc_setup&quot;</span><span class="p">,</span>
</span><span id="L-96"><a href="#L-96"><span class="linenos"> 96</span></a>    <span class="s2">&quot;sample&quot;</span><span class="p">,</span>
</span><span id="L-97"><a href="#L-97"><span class="linenos"> 97</span></a>    <span class="s2">&quot;Sample&quot;</span><span class="p">,</span>
</span><span id="L-98"><a href="#L-98"><span class="linenos"> 98</span></a>    <span class="s2">&quot;save_bioimageio_package_as_folder&quot;</span><span class="p">,</span>
</span><span id="L-99"><a href="#L-99"><span class="linenos"> 99</span></a>    <span class="s2">&quot;save_bioimageio_package&quot;</span><span class="p">,</span>
</span><span id="L-100"><a href="#L-100"><span class="linenos">100</span></a>    <span class="s2">&quot;save_bioimageio_yaml_only&quot;</span><span class="p">,</span>
</span><span id="L-101"><a href="#L-101"><span class="linenos">101</span></a>    <span class="s2">&quot;settings&quot;</span><span class="p">,</span>
</span><span id="L-102"><a href="#L-102"><span class="linenos">102</span></a>    <span class="s2">&quot;stat_calculators&quot;</span><span class="p">,</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos">103</span></a>    <span class="s2">&quot;stat_measures&quot;</span><span class="p">,</span>
</span><span id="L-104"><a href="#L-104"><span class="linenos">104</span></a>    <span class="s2">&quot;Stat&quot;</span><span class="p">,</span>
</span><span id="L-105"><a href="#L-105"><span class="linenos">105</span></a>    <span class="s2">&quot;tensor&quot;</span><span class="p">,</span>
</span><span id="L-106"><a href="#L-106"><span class="linenos">106</span></a>    <span class="s2">&quot;Tensor&quot;</span><span class="p">,</span>
</span><span id="L-107"><a href="#L-107"><span class="linenos">107</span></a>    <span class="s2">&quot;test_description&quot;</span><span class="p">,</span>
</span><span id="L-108"><a href="#L-108"><span class="linenos">108</span></a>    <span class="s2">&quot;test_model&quot;</span><span class="p">,</span>
</span><span id="L-109"><a href="#L-109"><span class="linenos">109</span></a>    <span class="s2">&quot;test_resource&quot;</span><span class="p">,</span>
</span><span id="L-110"><a href="#L-110"><span class="linenos">110</span></a>    <span class="s2">&quot;validate_format&quot;</span><span class="p">,</span>
</span><span id="L-111"><a href="#L-111"><span class="linenos">111</span></a><span class="p">]</span>
</span></pre></div>


            </section>
                <section id="__version__">
                    <div class="attr variable">
            <span class="name">__version__</span>        =
<span class="default_value">&#39;0.7.0&#39;</span>

        
    </div>
    <a class="headerlink" href="#__version__"></a>
    
    

                </section>
                <section id="Axis">
                            <input id="Axis-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator decorator-dataclass">@dataclass</div>

    <span class="def">class</span>
    <span class="name">Axis</span>:

                <label class="view-source-button" for="Axis-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Axis"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Axis-41"><a href="#Axis-41"><span class="linenos">41</span></a><span class="nd">@dataclass</span>
</span><span id="Axis-42"><a href="#Axis-42"><span class="linenos">42</span></a><span class="k">class</span> <span class="nc">Axis</span><span class="p">:</span>
</span><span id="Axis-43"><a href="#Axis-43"><span class="linenos">43</span></a>    <span class="nb">id</span><span class="p">:</span> <span class="n">AxisId</span>
</span><span id="Axis-44"><a href="#Axis-44"><span class="linenos">44</span></a>    <span class="nb">type</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;batch&quot;</span><span class="p">,</span> <span class="s2">&quot;channel&quot;</span><span class="p">,</span> <span class="s2">&quot;index&quot;</span><span class="p">,</span> <span class="s2">&quot;space&quot;</span><span class="p">,</span> <span class="s2">&quot;time&quot;</span><span class="p">]</span>
</span><span id="Axis-45"><a href="#Axis-45"><span class="linenos">45</span></a>
</span><span id="Axis-46"><a href="#Axis-46"><span class="linenos">46</span></a>    <span class="nd">@classmethod</span>
</span><span id="Axis-47"><a href="#Axis-47"><span class="linenos">47</span></a>    <span class="k">def</span> <span class="nf">create</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">axis</span><span class="p">:</span> <span class="n">AxisLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Axis</span><span class="p">:</span>
</span><span id="Axis-48"><a href="#Axis-48"><span class="linenos">48</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="bp">cls</span><span class="p">):</span>
</span><span id="Axis-49"><a href="#Axis-49"><span class="linenos">49</span></a>            <span class="k">return</span> <span class="n">axis</span>
</span><span id="Axis-50"><a href="#Axis-50"><span class="linenos">50</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">Axis</span><span class="p">):</span>
</span><span id="Axis-51"><a href="#Axis-51"><span class="linenos">51</span></a>            <span class="k">return</span> <span class="n">Axis</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">axis</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="n">axis</span><span class="o">.</span><span class="n">type</span><span class="p">)</span>
</span><span id="Axis-52"><a href="#Axis-52"><span class="linenos">52</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="Axis-53"><a href="#Axis-53"><span class="linenos">53</span></a>            <span class="k">return</span> <span class="n">Axis</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">AxisId</span><span class="p">(</span><span class="n">axis</span><span class="p">),</span> <span class="nb">type</span><span class="o">=</span><span class="n">_get_axis_type</span><span class="p">(</span><span class="n">axis</span><span class="p">))</span>
</span><span id="Axis-54"><a href="#Axis-54"><span class="linenos">54</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">v0_5</span><span class="o">.</span><span class="n">AxisBase</span><span class="p">):</span>
</span><span id="Axis-55"><a href="#Axis-55"><span class="linenos">55</span></a>            <span class="k">return</span> <span class="n">Axis</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">AxisId</span><span class="p">(</span><span class="n">axis</span><span class="o">.</span><span class="n">id</span><span class="p">),</span> <span class="nb">type</span><span class="o">=</span><span class="n">axis</span><span class="o">.</span><span class="n">type</span><span class="p">)</span>
</span><span id="Axis-56"><a href="#Axis-56"><span class="linenos">56</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Axis-57"><a href="#Axis-57"><span class="linenos">57</span></a>            <span class="n">assert_never</span><span class="p">(</span><span class="n">axis</span><span class="p">)</span>
</span></pre></div>


    

                            <div id="Axis.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">Axis</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="nb">id</span><span class="p">:</span> <span class="n"><a href="#AxisId">AxisId</a></span>,</span><span class="param">	<span class="nb">type</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;batch&#39;</span><span class="p">,</span> <span class="s1">&#39;channel&#39;</span><span class="p">,</span> <span class="s1">&#39;index&#39;</span><span class="p">,</span> <span class="s1">&#39;space&#39;</span><span class="p">,</span> <span class="s1">&#39;time&#39;</span><span class="p">]</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#Axis.__init__"></a>
    
    

                            </div>
                            <div id="Axis.id" class="classattr">
                                <div class="attr variable">
            <span class="name">id</span><span class="annotation">: <a href="#AxisId">AxisId</a></span>

        
    </div>
    <a class="headerlink" href="#Axis.id"></a>
    
    

                            </div>
                            <div id="Axis.type" class="classattr">
                                <div class="attr variable">
            <span class="name">type</span><span class="annotation">: Literal[&#39;batch&#39;, &#39;channel&#39;, &#39;index&#39;, &#39;space&#39;, &#39;time&#39;]</span>

        
    </div>
    <a class="headerlink" href="#Axis.type"></a>
    
    

                            </div>
                            <div id="Axis.create" class="classattr">
                                        <input id="Axis.create-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-classmethod">@classmethod</div>

        <span class="def">def</span>
        <span class="name">create</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">cls</span>,</span><span class="param">	<span class="n">axis</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n"><a href="#AxisId">AxisId</a></span><span class="p">,</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">],</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n"><a href="spec/model/v0_5.html#BatchAxis">bioimageio.spec.model.v0_5.BatchAxis</a></span><span class="p">,</span> <span class="n"><a href="spec/model/v0_5.html#ChannelAxis">bioimageio.spec.model.v0_5.ChannelAxis</a></span><span class="p">,</span> <span class="n"><a href="spec/model/v0_5.html#IndexInputAxis">bioimageio.spec.model.v0_5.IndexInputAxis</a></span><span class="p">,</span> <span class="n"><a href="spec/model/v0_5.html#TimeInputAxis">bioimageio.spec.model.v0_5.TimeInputAxis</a></span><span class="p">,</span> <span class="n"><a href="spec/model/v0_5.html#SpaceInputAxis">bioimageio.spec.model.v0_5.SpaceInputAxis</a></span><span class="p">],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=</span><span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)],</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n"><a href="spec/model/v0_5.html#BatchAxis">bioimageio.spec.model.v0_5.BatchAxis</a></span><span class="p">,</span> <span class="n"><a href="spec/model/v0_5.html#ChannelAxis">bioimageio.spec.model.v0_5.ChannelAxis</a></span><span class="p">,</span> <span class="n"><a href="spec/model/v0_5.html#IndexOutputAxis">bioimageio.spec.model.v0_5.IndexOutputAxis</a></span><span class="p">,</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Annotated</span><span class="p">[</span><span class="n"><a href="spec/model/v0_5.html#TimeOutputAxis">bioimageio.spec.model.v0_5.TimeOutputAxis</a></span><span class="p">,</span> <span class="n">Tag</span><span class="p">(</span><span class="n">tag</span><span class="o">=</span><span class="s1">&#39;wo_halo&#39;</span><span class="p">)],</span> <span class="n">Annotated</span><span class="p">[</span><span class="n"><a href="spec/model/v0_5.html#TimeOutputAxisWithHalo">bioimageio.spec.model.v0_5.TimeOutputAxisWithHalo</a></span><span class="p">,</span> <span class="n">Tag</span><span class="p">(</span><span class="n">tag</span><span class="o">=</span><span class="s1">&#39;with_halo&#39;</span><span class="p">)]],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=&lt;</span><span class="n">function</span> <span class="n">_get_halo_axis_discriminator_value</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)],</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Annotated</span><span class="p">[</span><span class="n"><a href="spec/model/v0_5.html#SpaceOutputAxis">bioimageio.spec.model.v0_5.SpaceOutputAxis</a></span><span class="p">,</span> <span class="n">Tag</span><span class="p">(</span><span class="n">tag</span><span class="o">=</span><span class="s1">&#39;wo_halo&#39;</span><span class="p">)],</span> <span class="n">Annotated</span><span class="p">[</span><span class="n"><a href="spec/model/v0_5.html#SpaceOutputAxisWithHalo">bioimageio.spec.model.v0_5.SpaceOutputAxisWithHalo</a></span><span class="p">,</span> <span class="n">Tag</span><span class="p">(</span><span class="n">tag</span><span class="o">=</span><span class="s1">&#39;with_halo&#39;</span><span class="p">)]],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=&lt;</span><span class="n">function</span> <span class="n">_get_halo_axis_discriminator_value</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)]],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=</span><span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)],</span> <span class="n"><a href="#Axis">Axis</a></span><span class="p">]</span></span><span class="return-annotation">) -> <span class="n"><a href="#Axis">Axis</a></span>:</span></span>

                <label class="view-source-button" for="Axis.create-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Axis.create"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Axis.create-46"><a href="#Axis.create-46"><span class="linenos">46</span></a>    <span class="nd">@classmethod</span>
</span><span id="Axis.create-47"><a href="#Axis.create-47"><span class="linenos">47</span></a>    <span class="k">def</span> <span class="nf">create</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">axis</span><span class="p">:</span> <span class="n">AxisLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Axis</span><span class="p">:</span>
</span><span id="Axis.create-48"><a href="#Axis.create-48"><span class="linenos">48</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="bp">cls</span><span class="p">):</span>
</span><span id="Axis.create-49"><a href="#Axis.create-49"><span class="linenos">49</span></a>            <span class="k">return</span> <span class="n">axis</span>
</span><span id="Axis.create-50"><a href="#Axis.create-50"><span class="linenos">50</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">Axis</span><span class="p">):</span>
</span><span id="Axis.create-51"><a href="#Axis.create-51"><span class="linenos">51</span></a>            <span class="k">return</span> <span class="n">Axis</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">axis</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="n">axis</span><span class="o">.</span><span class="n">type</span><span class="p">)</span>
</span><span id="Axis.create-52"><a href="#Axis.create-52"><span class="linenos">52</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="Axis.create-53"><a href="#Axis.create-53"><span class="linenos">53</span></a>            <span class="k">return</span> <span class="n">Axis</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">AxisId</span><span class="p">(</span><span class="n">axis</span><span class="p">),</span> <span class="nb">type</span><span class="o">=</span><span class="n">_get_axis_type</span><span class="p">(</span><span class="n">axis</span><span class="p">))</span>
</span><span id="Axis.create-54"><a href="#Axis.create-54"><span class="linenos">54</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">v0_5</span><span class="o">.</span><span class="n">AxisBase</span><span class="p">):</span>
</span><span id="Axis.create-55"><a href="#Axis.create-55"><span class="linenos">55</span></a>            <span class="k">return</span> <span class="n">Axis</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">AxisId</span><span class="p">(</span><span class="n">axis</span><span class="o">.</span><span class="n">id</span><span class="p">),</span> <span class="nb">type</span><span class="o">=</span><span class="n">axis</span><span class="o">.</span><span class="n">type</span><span class="p">)</span>
</span><span id="Axis.create-56"><a href="#Axis.create-56"><span class="linenos">56</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Axis.create-57"><a href="#Axis.create-57"><span class="linenos">57</span></a>            <span class="n">assert_never</span><span class="p">(</span><span class="n">axis</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                </section>
                <section id="AxisId">
                            <input id="AxisId-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">AxisId</span><wbr>(<span class="base">bioimageio.spec._internal.types.LowerCaseIdentifier</span>):

                <label class="view-source-button" for="AxisId-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AxisId"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AxisId-199"><a href="#AxisId-199"><span class="linenos">199</span></a><span class="k">class</span> <span class="nc">AxisId</span><span class="p">(</span><span class="n">LowerCaseIdentifier</span><span class="p">):</span>
</span><span id="AxisId-200"><a href="#AxisId-200"><span class="linenos">200</span></a>    <span class="n">root_model</span><span class="p">:</span> <span class="n">ClassVar</span><span class="p">[</span><span class="n">Type</span><span class="p">[</span><span class="n">RootModel</span><span class="p">[</span><span class="n">Any</span><span class="p">]]]</span> <span class="o">=</span> <span class="n">RootModel</span><span class="p">[</span>
</span><span id="AxisId-201"><a href="#AxisId-201"><span class="linenos">201</span></a>        <span class="n">Annotated</span><span class="p">[</span><span class="n">LowerCaseIdentifierAnno</span><span class="p">,</span> <span class="n">MaxLen</span><span class="p">(</span><span class="mi">16</span><span class="p">)]</span>
</span><span id="AxisId-202"><a href="#AxisId-202"><span class="linenos">202</span></a>    <span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>str(object='') -> str
str(bytes_or_buffer[, encoding[, errors]]) -> str</p>

<p>Create a new string object from the given object. If encoding or
errors is specified, then the object must expose a data buffer
that will be decoded using the given encoding and error handler.
Otherwise, returns the result of object.__str__() (if defined)
or repr(object).
encoding defaults to sys.getdefaultencoding().
errors defaults to 'strict'.</p>
</div>


                            <div id="AxisId.root_model" class="classattr">
                                <div class="attr variable">
            <span class="name">root_model</span><span class="annotation">: ClassVar[Type[pydantic.root_model.RootModel[Any]]]</span>        =
<input id="AxisId.root_model-view-value" class="view-value-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
            <label class="view-value-button pdoc-button" for="AxisId.root_model-view-value"></label><span class="default_value">&lt;class &#39;pydantic.root_model.RootModel[Annotated[str, MinLen, AfterValidator, AfterValidator, Annotated[TypeVar, Predicate], MaxLen]]&#39;&gt;</span>

        
    </div>
    <a class="headerlink" href="#AxisId.root_model"></a>
    
            <div class="docstring"><p>the pydantic root model to validate the string</p>
</div>


                            </div>
                </section>
                <section id="BlockMeta">
                            <input id="BlockMeta-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator decorator-dataclass">@dataclass(frozen=True)</div>

    <span class="def">class</span>
    <span class="name">BlockMeta</span>:

                <label class="view-source-button" for="BlockMeta-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#BlockMeta"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BlockMeta-46"><a href="#BlockMeta-46"><span class="linenos"> 46</span></a><span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="BlockMeta-47"><a href="#BlockMeta-47"><span class="linenos"> 47</span></a><span class="k">class</span> <span class="nc">BlockMeta</span><span class="p">:</span>
</span><span id="BlockMeta-48"><a href="#BlockMeta-48"><span class="linenos"> 48</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Block meta data of a sample member (a tensor in a sample)</span>
</span><span id="BlockMeta-49"><a href="#BlockMeta-49"><span class="linenos"> 49</span></a>
</span><span id="BlockMeta-50"><a href="#BlockMeta-50"><span class="linenos"> 50</span></a><span class="sd">    Figure for illustration:</span>
</span><span id="BlockMeta-51"><a href="#BlockMeta-51"><span class="linenos"> 51</span></a><span class="sd">    The first 2d block (dashed) of a sample member (**bold**).</span>
</span><span id="BlockMeta-52"><a href="#BlockMeta-52"><span class="linenos"> 52</span></a><span class="sd">    The inner slice (thin) is expanded by a halo in both dimensions on both sides.</span>
</span><span id="BlockMeta-53"><a href="#BlockMeta-53"><span class="linenos"> 53</span></a><span class="sd">    The outer slice reaches from the sample member origin (0, 0) to the right halo point.</span>
</span><span id="BlockMeta-54"><a href="#BlockMeta-54"><span class="linenos"> 54</span></a>
</span><span id="BlockMeta-55"><a href="#BlockMeta-55"><span class="linenos"> 55</span></a><span class="sd">    ```terminal</span>
</span><span id="BlockMeta-56"><a href="#BlockMeta-56"><span class="linenos"> 56</span></a><span class="sd">    ┌ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─  ─ ─ ─ ─ ─ ─ ─ ┐</span>
</span><span id="BlockMeta-57"><a href="#BlockMeta-57"><span class="linenos"> 57</span></a><span class="sd">    ╷ halo(left)                         ╷</span>
</span><span id="BlockMeta-58"><a href="#BlockMeta-58"><span class="linenos"> 58</span></a><span class="sd">    ╷                                    ╷</span>
</span><span id="BlockMeta-59"><a href="#BlockMeta-59"><span class="linenos"> 59</span></a><span class="sd">    ╷  (0, 0)┏━━━━━━━━━━━━━━━━━┯━━━━━━━━━┯━━━➔</span>
</span><span id="BlockMeta-60"><a href="#BlockMeta-60"><span class="linenos"> 60</span></a><span class="sd">    ╷        ┃                 │         ╷  sample member</span>
</span><span id="BlockMeta-61"><a href="#BlockMeta-61"><span class="linenos"> 61</span></a><span class="sd">    ╷        ┃      inner      │         ╷</span>
</span><span id="BlockMeta-62"><a href="#BlockMeta-62"><span class="linenos"> 62</span></a><span class="sd">    ╷        ┃   (and outer)   │  outer  ╷</span>
</span><span id="BlockMeta-63"><a href="#BlockMeta-63"><span class="linenos"> 63</span></a><span class="sd">    ╷        ┃      slice      │  slice  ╷</span>
</span><span id="BlockMeta-64"><a href="#BlockMeta-64"><span class="linenos"> 64</span></a><span class="sd">    ╷        ┃                 │         ╷</span>
</span><span id="BlockMeta-65"><a href="#BlockMeta-65"><span class="linenos"> 65</span></a><span class="sd">    ╷        ┣─────────────────┘         ╷</span>
</span><span id="BlockMeta-66"><a href="#BlockMeta-66"><span class="linenos"> 66</span></a><span class="sd">    ╷        ┃   outer slice             ╷</span>
</span><span id="BlockMeta-67"><a href="#BlockMeta-67"><span class="linenos"> 67</span></a><span class="sd">    ╷        ┃               halo(right) ╷</span>
</span><span id="BlockMeta-68"><a href="#BlockMeta-68"><span class="linenos"> 68</span></a><span class="sd">    └ ─ ─ ─ ─┃─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─┘</span>
</span><span id="BlockMeta-69"><a href="#BlockMeta-69"><span class="linenos"> 69</span></a><span class="sd">             ⬇</span>
</span><span id="BlockMeta-70"><a href="#BlockMeta-70"><span class="linenos"> 70</span></a><span class="sd">    ```</span>
</span><span id="BlockMeta-71"><a href="#BlockMeta-71"><span class="linenos"> 71</span></a>
</span><span id="BlockMeta-72"><a href="#BlockMeta-72"><span class="linenos"> 72</span></a><span class="sd">    note:</span>
</span><span id="BlockMeta-73"><a href="#BlockMeta-73"><span class="linenos"> 73</span></a><span class="sd">    - Inner and outer slices are specified in sample member coordinates.</span>
</span><span id="BlockMeta-74"><a href="#BlockMeta-74"><span class="linenos"> 74</span></a><span class="sd">    - The outer_slice of a block at the sample edge may overlap by more than the</span>
</span><span id="BlockMeta-75"><a href="#BlockMeta-75"><span class="linenos"> 75</span></a><span class="sd">        halo with the neighboring block (the inner slices will not overlap though).</span>
</span><span id="BlockMeta-76"><a href="#BlockMeta-76"><span class="linenos"> 76</span></a>
</span><span id="BlockMeta-77"><a href="#BlockMeta-77"><span class="linenos"> 77</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="BlockMeta-78"><a href="#BlockMeta-78"><span class="linenos"> 78</span></a>
</span><span id="BlockMeta-79"><a href="#BlockMeta-79"><span class="linenos"> 79</span></a>    <span class="n">sample_shape</span><span class="p">:</span> <span class="n">PerAxis</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>
</span><span id="BlockMeta-80"><a href="#BlockMeta-80"><span class="linenos"> 80</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;the axis sizes of the whole (unblocked) sample&quot;&quot;&quot;</span>
</span><span id="BlockMeta-81"><a href="#BlockMeta-81"><span class="linenos"> 81</span></a>
</span><span id="BlockMeta-82"><a href="#BlockMeta-82"><span class="linenos"> 82</span></a>    <span class="n">inner_slice</span><span class="p">:</span> <span class="n">PerAxis</span><span class="p">[</span><span class="n">SliceInfo</span><span class="p">]</span>
</span><span id="BlockMeta-83"><a href="#BlockMeta-83"><span class="linenos"> 83</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;inner region (without halo) wrt the sample&quot;&quot;&quot;</span>
</span><span id="BlockMeta-84"><a href="#BlockMeta-84"><span class="linenos"> 84</span></a>
</span><span id="BlockMeta-85"><a href="#BlockMeta-85"><span class="linenos"> 85</span></a>    <span class="n">halo</span><span class="p">:</span> <span class="n">PerAxis</span><span class="p">[</span><span class="n">Halo</span><span class="p">]</span>
</span><span id="BlockMeta-86"><a href="#BlockMeta-86"><span class="linenos"> 86</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;halo enlarging the inner region to the block&#39;s sizes&quot;&quot;&quot;</span>
</span><span id="BlockMeta-87"><a href="#BlockMeta-87"><span class="linenos"> 87</span></a>
</span><span id="BlockMeta-88"><a href="#BlockMeta-88"><span class="linenos"> 88</span></a>    <span class="n">block_index</span><span class="p">:</span> <span class="n">BlockIndex</span>
</span><span id="BlockMeta-89"><a href="#BlockMeta-89"><span class="linenos"> 89</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;the i-th block of the sample&quot;&quot;&quot;</span>
</span><span id="BlockMeta-90"><a href="#BlockMeta-90"><span class="linenos"> 90</span></a>
</span><span id="BlockMeta-91"><a href="#BlockMeta-91"><span class="linenos"> 91</span></a>    <span class="n">blocks_in_sample</span><span class="p">:</span> <span class="n">TotalNumberOfBlocks</span>
</span><span id="BlockMeta-92"><a href="#BlockMeta-92"><span class="linenos"> 92</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;total number of blocks in the sample&quot;&quot;&quot;</span>
</span><span id="BlockMeta-93"><a href="#BlockMeta-93"><span class="linenos"> 93</span></a>
</span><span id="BlockMeta-94"><a href="#BlockMeta-94"><span class="linenos"> 94</span></a>    <span class="nd">@cached_property</span>
</span><span id="BlockMeta-95"><a href="#BlockMeta-95"><span class="linenos"> 95</span></a>    <span class="k">def</span> <span class="nf">shape</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PerAxis</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span><span id="BlockMeta-96"><a href="#BlockMeta-96"><span class="linenos"> 96</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;axis lengths of the block&quot;&quot;&quot;</span>
</span><span id="BlockMeta-97"><a href="#BlockMeta-97"><span class="linenos"> 97</span></a>        <span class="k">return</span> <span class="n">Frozen</span><span class="p">(</span>
</span><span id="BlockMeta-98"><a href="#BlockMeta-98"><span class="linenos"> 98</span></a>            <span class="p">{</span>
</span><span id="BlockMeta-99"><a href="#BlockMeta-99"><span class="linenos"> 99</span></a>                <span class="n">a</span><span class="p">:</span> <span class="n">s</span><span class="o">.</span><span class="n">stop</span> <span class="o">-</span> <span class="n">s</span><span class="o">.</span><span class="n">start</span> <span class="o">+</span> <span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">halo</span><span class="p">[</span><span class="n">a</span><span class="p">])</span> <span class="k">if</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">halo</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="BlockMeta-100"><a href="#BlockMeta-100"><span class="linenos">100</span></a>                <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">inner_slice</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
</span><span id="BlockMeta-101"><a href="#BlockMeta-101"><span class="linenos">101</span></a>            <span class="p">}</span>
</span><span id="BlockMeta-102"><a href="#BlockMeta-102"><span class="linenos">102</span></a>        <span class="p">)</span>
</span><span id="BlockMeta-103"><a href="#BlockMeta-103"><span class="linenos">103</span></a>
</span><span id="BlockMeta-104"><a href="#BlockMeta-104"><span class="linenos">104</span></a>    <span class="nd">@cached_property</span>
</span><span id="BlockMeta-105"><a href="#BlockMeta-105"><span class="linenos">105</span></a>    <span class="k">def</span> <span class="nf">padding</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PerAxis</span><span class="p">[</span><span class="n">PadWidth</span><span class="p">]:</span>
</span><span id="BlockMeta-106"><a href="#BlockMeta-106"><span class="linenos">106</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;padding to realize the halo at the sample edge</span>
</span><span id="BlockMeta-107"><a href="#BlockMeta-107"><span class="linenos">107</span></a><span class="sd">        where we cannot simply enlarge the inner slice&quot;&quot;&quot;</span>
</span><span id="BlockMeta-108"><a href="#BlockMeta-108"><span class="linenos">108</span></a>        <span class="k">return</span> <span class="n">Frozen</span><span class="p">(</span>
</span><span id="BlockMeta-109"><a href="#BlockMeta-109"><span class="linenos">109</span></a>            <span class="p">{</span>
</span><span id="BlockMeta-110"><a href="#BlockMeta-110"><span class="linenos">110</span></a>                <span class="n">a</span><span class="p">:</span> <span class="n">PadWidth</span><span class="p">(</span>
</span><span id="BlockMeta-111"><a href="#BlockMeta-111"><span class="linenos">111</span></a>                    <span class="p">(</span>
</span><span id="BlockMeta-112"><a href="#BlockMeta-112"><span class="linenos">112</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">halo</span><span class="p">[</span><span class="n">a</span><span class="p">]</span><span class="o">.</span><span class="n">left</span>
</span><span id="BlockMeta-113"><a href="#BlockMeta-113"><span class="linenos">113</span></a>                        <span class="o">-</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inner_slice</span><span class="p">[</span><span class="n">a</span><span class="p">]</span><span class="o">.</span><span class="n">start</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">outer_slice</span><span class="p">[</span><span class="n">a</span><span class="p">]</span><span class="o">.</span><span class="n">start</span><span class="p">)</span>
</span><span id="BlockMeta-114"><a href="#BlockMeta-114"><span class="linenos">114</span></a>                        <span class="k">if</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">halo</span>
</span><span id="BlockMeta-115"><a href="#BlockMeta-115"><span class="linenos">115</span></a>                        <span class="k">else</span> <span class="mi">0</span>
</span><span id="BlockMeta-116"><a href="#BlockMeta-116"><span class="linenos">116</span></a>                    <span class="p">),</span>
</span><span id="BlockMeta-117"><a href="#BlockMeta-117"><span class="linenos">117</span></a>                    <span class="p">(</span>
</span><span id="BlockMeta-118"><a href="#BlockMeta-118"><span class="linenos">118</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">halo</span><span class="p">[</span><span class="n">a</span><span class="p">]</span><span class="o">.</span><span class="n">right</span>
</span><span id="BlockMeta-119"><a href="#BlockMeta-119"><span class="linenos">119</span></a>                        <span class="o">-</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outer_slice</span><span class="p">[</span><span class="n">a</span><span class="p">]</span><span class="o">.</span><span class="n">stop</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">inner_slice</span><span class="p">[</span><span class="n">a</span><span class="p">]</span><span class="o">.</span><span class="n">stop</span><span class="p">)</span>
</span><span id="BlockMeta-120"><a href="#BlockMeta-120"><span class="linenos">120</span></a>                        <span class="k">if</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">halo</span>
</span><span id="BlockMeta-121"><a href="#BlockMeta-121"><span class="linenos">121</span></a>                        <span class="k">else</span> <span class="mi">0</span>
</span><span id="BlockMeta-122"><a href="#BlockMeta-122"><span class="linenos">122</span></a>                    <span class="p">),</span>
</span><span id="BlockMeta-123"><a href="#BlockMeta-123"><span class="linenos">123</span></a>                <span class="p">)</span>
</span><span id="BlockMeta-124"><a href="#BlockMeta-124"><span class="linenos">124</span></a>                <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">inner_slice</span>
</span><span id="BlockMeta-125"><a href="#BlockMeta-125"><span class="linenos">125</span></a>            <span class="p">}</span>
</span><span id="BlockMeta-126"><a href="#BlockMeta-126"><span class="linenos">126</span></a>        <span class="p">)</span>
</span><span id="BlockMeta-127"><a href="#BlockMeta-127"><span class="linenos">127</span></a>
</span><span id="BlockMeta-128"><a href="#BlockMeta-128"><span class="linenos">128</span></a>    <span class="nd">@cached_property</span>
</span><span id="BlockMeta-129"><a href="#BlockMeta-129"><span class="linenos">129</span></a>    <span class="k">def</span> <span class="nf">outer_slice</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PerAxis</span><span class="p">[</span><span class="n">SliceInfo</span><span class="p">]:</span>
</span><span id="BlockMeta-130"><a href="#BlockMeta-130"><span class="linenos">130</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;slice of the outer block (without padding) wrt the sample&quot;&quot;&quot;</span>
</span><span id="BlockMeta-131"><a href="#BlockMeta-131"><span class="linenos">131</span></a>        <span class="k">return</span> <span class="n">Frozen</span><span class="p">(</span>
</span><span id="BlockMeta-132"><a href="#BlockMeta-132"><span class="linenos">132</span></a>            <span class="p">{</span>
</span><span id="BlockMeta-133"><a href="#BlockMeta-133"><span class="linenos">133</span></a>                <span class="n">a</span><span class="p">:</span> <span class="n">SliceInfo</span><span class="p">(</span>
</span><span id="BlockMeta-134"><a href="#BlockMeta-134"><span class="linenos">134</span></a>                    <span class="nb">max</span><span class="p">(</span>
</span><span id="BlockMeta-135"><a href="#BlockMeta-135"><span class="linenos">135</span></a>                        <span class="mi">0</span><span class="p">,</span>
</span><span id="BlockMeta-136"><a href="#BlockMeta-136"><span class="linenos">136</span></a>                        <span class="nb">min</span><span class="p">(</span>
</span><span id="BlockMeta-137"><a href="#BlockMeta-137"><span class="linenos">137</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">inner_slice</span><span class="p">[</span><span class="n">a</span><span class="p">]</span><span class="o">.</span><span class="n">start</span>
</span><span id="BlockMeta-138"><a href="#BlockMeta-138"><span class="linenos">138</span></a>                            <span class="o">-</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">halo</span><span class="p">[</span><span class="n">a</span><span class="p">]</span><span class="o">.</span><span class="n">left</span> <span class="k">if</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">halo</span> <span class="k">else</span> <span class="mi">0</span><span class="p">),</span>
</span><span id="BlockMeta-139"><a href="#BlockMeta-139"><span class="linenos">139</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">sample_shape</span><span class="p">[</span><span class="n">a</span><span class="p">]</span>
</span><span id="BlockMeta-140"><a href="#BlockMeta-140"><span class="linenos">140</span></a>                            <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">inner_shape</span><span class="p">[</span><span class="n">a</span><span class="p">]</span>
</span><span id="BlockMeta-141"><a href="#BlockMeta-141"><span class="linenos">141</span></a>                            <span class="o">-</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">halo</span><span class="p">[</span><span class="n">a</span><span class="p">]</span><span class="o">.</span><span class="n">left</span> <span class="k">if</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">halo</span> <span class="k">else</span> <span class="mi">0</span><span class="p">),</span>
</span><span id="BlockMeta-142"><a href="#BlockMeta-142"><span class="linenos">142</span></a>                        <span class="p">),</span>
</span><span id="BlockMeta-143"><a href="#BlockMeta-143"><span class="linenos">143</span></a>                    <span class="p">),</span>
</span><span id="BlockMeta-144"><a href="#BlockMeta-144"><span class="linenos">144</span></a>                    <span class="nb">min</span><span class="p">(</span>
</span><span id="BlockMeta-145"><a href="#BlockMeta-145"><span class="linenos">145</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">sample_shape</span><span class="p">[</span><span class="n">a</span><span class="p">],</span>
</span><span id="BlockMeta-146"><a href="#BlockMeta-146"><span class="linenos">146</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">inner_slice</span><span class="p">[</span><span class="n">a</span><span class="p">]</span><span class="o">.</span><span class="n">stop</span>
</span><span id="BlockMeta-147"><a href="#BlockMeta-147"><span class="linenos">147</span></a>                        <span class="o">+</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">halo</span><span class="p">[</span><span class="n">a</span><span class="p">]</span><span class="o">.</span><span class="n">right</span> <span class="k">if</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">halo</span> <span class="k">else</span> <span class="mi">0</span><span class="p">),</span>
</span><span id="BlockMeta-148"><a href="#BlockMeta-148"><span class="linenos">148</span></a>                    <span class="p">),</span>
</span><span id="BlockMeta-149"><a href="#BlockMeta-149"><span class="linenos">149</span></a>                <span class="p">)</span>
</span><span id="BlockMeta-150"><a href="#BlockMeta-150"><span class="linenos">150</span></a>                <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">inner_slice</span>
</span><span id="BlockMeta-151"><a href="#BlockMeta-151"><span class="linenos">151</span></a>            <span class="p">}</span>
</span><span id="BlockMeta-152"><a href="#BlockMeta-152"><span class="linenos">152</span></a>        <span class="p">)</span>
</span><span id="BlockMeta-153"><a href="#BlockMeta-153"><span class="linenos">153</span></a>
</span><span id="BlockMeta-154"><a href="#BlockMeta-154"><span class="linenos">154</span></a>    <span class="nd">@cached_property</span>
</span><span id="BlockMeta-155"><a href="#BlockMeta-155"><span class="linenos">155</span></a>    <span class="k">def</span> <span class="nf">inner_shape</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PerAxis</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span><span id="BlockMeta-156"><a href="#BlockMeta-156"><span class="linenos">156</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;axis lengths of the inner region (without halo)&quot;&quot;&quot;</span>
</span><span id="BlockMeta-157"><a href="#BlockMeta-157"><span class="linenos">157</span></a>        <span class="k">return</span> <span class="n">Frozen</span><span class="p">({</span><span class="n">a</span><span class="p">:</span> <span class="n">s</span><span class="o">.</span><span class="n">stop</span> <span class="o">-</span> <span class="n">s</span><span class="o">.</span><span class="n">start</span> <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">inner_slice</span><span class="o">.</span><span class="n">items</span><span class="p">()})</span>
</span><span id="BlockMeta-158"><a href="#BlockMeta-158"><span class="linenos">158</span></a>
</span><span id="BlockMeta-159"><a href="#BlockMeta-159"><span class="linenos">159</span></a>    <span class="nd">@cached_property</span>
</span><span id="BlockMeta-160"><a href="#BlockMeta-160"><span class="linenos">160</span></a>    <span class="k">def</span> <span class="nf">local_slice</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PerAxis</span><span class="p">[</span><span class="n">SliceInfo</span><span class="p">]:</span>
</span><span id="BlockMeta-161"><a href="#BlockMeta-161"><span class="linenos">161</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;inner slice wrt the block, **not** the sample&quot;&quot;&quot;</span>
</span><span id="BlockMeta-162"><a href="#BlockMeta-162"><span class="linenos">162</span></a>        <span class="k">return</span> <span class="n">Frozen</span><span class="p">(</span>
</span><span id="BlockMeta-163"><a href="#BlockMeta-163"><span class="linenos">163</span></a>            <span class="p">{</span>
</span><span id="BlockMeta-164"><a href="#BlockMeta-164"><span class="linenos">164</span></a>                <span class="n">a</span><span class="p">:</span> <span class="n">SliceInfo</span><span class="p">(</span>
</span><span id="BlockMeta-165"><a href="#BlockMeta-165"><span class="linenos">165</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">halo</span><span class="p">[</span><span class="n">a</span><span class="p">]</span><span class="o">.</span><span class="n">left</span><span class="p">,</span>
</span><span id="BlockMeta-166"><a href="#BlockMeta-166"><span class="linenos">166</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">halo</span><span class="p">[</span><span class="n">a</span><span class="p">]</span><span class="o">.</span><span class="n">left</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">inner_shape</span><span class="p">[</span><span class="n">a</span><span class="p">],</span>
</span><span id="BlockMeta-167"><a href="#BlockMeta-167"><span class="linenos">167</span></a>                <span class="p">)</span>
</span><span id="BlockMeta-168"><a href="#BlockMeta-168"><span class="linenos">168</span></a>                <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">inner_slice</span>
</span><span id="BlockMeta-169"><a href="#BlockMeta-169"><span class="linenos">169</span></a>            <span class="p">}</span>
</span><span id="BlockMeta-170"><a href="#BlockMeta-170"><span class="linenos">170</span></a>        <span class="p">)</span>
</span><span id="BlockMeta-171"><a href="#BlockMeta-171"><span class="linenos">171</span></a>
</span><span id="BlockMeta-172"><a href="#BlockMeta-172"><span class="linenos">172</span></a>    <span class="nd">@property</span>
</span><span id="BlockMeta-173"><a href="#BlockMeta-173"><span class="linenos">173</span></a>    <span class="k">def</span> <span class="nf">dims</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Collection</span><span class="p">[</span><span class="n">AxisId</span><span class="p">]:</span>
</span><span id="BlockMeta-174"><a href="#BlockMeta-174"><span class="linenos">174</span></a>        <span class="k">return</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inner_shape</span><span class="p">)</span>
</span><span id="BlockMeta-175"><a href="#BlockMeta-175"><span class="linenos">175</span></a>
</span><span id="BlockMeta-176"><a href="#BlockMeta-176"><span class="linenos">176</span></a>    <span class="nd">@property</span>
</span><span id="BlockMeta-177"><a href="#BlockMeta-177"><span class="linenos">177</span></a>    <span class="k">def</span> <span class="nf">tagged_shape</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PerAxis</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span><span id="BlockMeta-178"><a href="#BlockMeta-178"><span class="linenos">178</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;alias for shape&quot;&quot;&quot;</span>
</span><span id="BlockMeta-179"><a href="#BlockMeta-179"><span class="linenos">179</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span>
</span><span id="BlockMeta-180"><a href="#BlockMeta-180"><span class="linenos">180</span></a>
</span><span id="BlockMeta-181"><a href="#BlockMeta-181"><span class="linenos">181</span></a>    <span class="nd">@property</span>
</span><span id="BlockMeta-182"><a href="#BlockMeta-182"><span class="linenos">182</span></a>    <span class="k">def</span> <span class="nf">inner_slice_wo_overlap</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BlockMeta-183"><a href="#BlockMeta-183"><span class="linenos">183</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;subslice of the inner slice, such that all `inner_slice_wo_overlap` can be</span>
</span><span id="BlockMeta-184"><a href="#BlockMeta-184"><span class="linenos">184</span></a><span class="sd">        stiched together trivially to form the original sample.</span>
</span><span id="BlockMeta-185"><a href="#BlockMeta-185"><span class="linenos">185</span></a>
</span><span id="BlockMeta-186"><a href="#BlockMeta-186"><span class="linenos">186</span></a><span class="sd">        This can also be used to calculate statistics</span>
</span><span id="BlockMeta-187"><a href="#BlockMeta-187"><span class="linenos">187</span></a><span class="sd">        without overrepresenting block edge regions.&quot;&quot;&quot;</span>
</span><span id="BlockMeta-188"><a href="#BlockMeta-188"><span class="linenos">188</span></a>        <span class="c1"># TODO: update inner_slice_wo_overlap when adding block overlap</span>
</span><span id="BlockMeta-189"><a href="#BlockMeta-189"><span class="linenos">189</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">inner_slice</span>
</span><span id="BlockMeta-190"><a href="#BlockMeta-190"><span class="linenos">190</span></a>
</span><span id="BlockMeta-191"><a href="#BlockMeta-191"><span class="linenos">191</span></a>    <span class="k">def</span> <span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BlockMeta-192"><a href="#BlockMeta-192"><span class="linenos">192</span></a>        <span class="c1"># freeze mutable inputs</span>
</span><span id="BlockMeta-193"><a href="#BlockMeta-193"><span class="linenos">193</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sample_shape</span><span class="p">,</span> <span class="n">Frozen</span><span class="p">):</span>
</span><span id="BlockMeta-194"><a href="#BlockMeta-194"><span class="linenos">194</span></a>            <span class="nb">object</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;sample_shape&quot;</span><span class="p">,</span> <span class="n">Frozen</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sample_shape</span><span class="p">))</span>
</span><span id="BlockMeta-195"><a href="#BlockMeta-195"><span class="linenos">195</span></a>
</span><span id="BlockMeta-196"><a href="#BlockMeta-196"><span class="linenos">196</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inner_slice</span><span class="p">,</span> <span class="n">Frozen</span><span class="p">):</span>
</span><span id="BlockMeta-197"><a href="#BlockMeta-197"><span class="linenos">197</span></a>            <span class="nb">object</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;inner_slice&quot;</span><span class="p">,</span> <span class="n">Frozen</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inner_slice</span><span class="p">))</span>
</span><span id="BlockMeta-198"><a href="#BlockMeta-198"><span class="linenos">198</span></a>
</span><span id="BlockMeta-199"><a href="#BlockMeta-199"><span class="linenos">199</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">halo</span><span class="p">,</span> <span class="n">Frozen</span><span class="p">):</span>
</span><span id="BlockMeta-200"><a href="#BlockMeta-200"><span class="linenos">200</span></a>            <span class="nb">object</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;halo&quot;</span><span class="p">,</span> <span class="n">Frozen</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">halo</span><span class="p">))</span>
</span><span id="BlockMeta-201"><a href="#BlockMeta-201"><span class="linenos">201</span></a>
</span><span id="BlockMeta-202"><a href="#BlockMeta-202"><span class="linenos">202</span></a>        <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span>
</span><span id="BlockMeta-203"><a href="#BlockMeta-203"><span class="linenos">203</span></a>            <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sample_shape</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">inner_slice</span>
</span><span id="BlockMeta-204"><a href="#BlockMeta-204"><span class="linenos">204</span></a>        <span class="p">),</span> <span class="s2">&quot;block has axes not present in sample&quot;</span>
</span><span id="BlockMeta-205"><a href="#BlockMeta-205"><span class="linenos">205</span></a>
</span><span id="BlockMeta-206"><a href="#BlockMeta-206"><span class="linenos">206</span></a>        <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span>
</span><span id="BlockMeta-207"><a href="#BlockMeta-207"><span class="linenos">207</span></a>            <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">inner_slice</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">halo</span>
</span><span id="BlockMeta-208"><a href="#BlockMeta-208"><span class="linenos">208</span></a>        <span class="p">),</span> <span class="s2">&quot;halo has axes not present in block&quot;</span>
</span><span id="BlockMeta-209"><a href="#BlockMeta-209"><span class="linenos">209</span></a>
</span><span id="BlockMeta-210"><a href="#BlockMeta-210"><span class="linenos">210</span></a>        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">s</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">sample_shape</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
</span><span id="BlockMeta-211"><a href="#BlockMeta-211"><span class="linenos">211</span></a>            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
</span><span id="BlockMeta-212"><a href="#BlockMeta-212"><span class="linenos">212</span></a>                <span class="s2">&quot;block </span><span class="si">{}</span><span class="s2"> larger than sample </span><span class="si">{}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sample_shape</span>
</span><span id="BlockMeta-213"><a href="#BlockMeta-213"><span class="linenos">213</span></a>            <span class="p">)</span>
</span><span id="BlockMeta-214"><a href="#BlockMeta-214"><span class="linenos">214</span></a>
</span><span id="BlockMeta-215"><a href="#BlockMeta-215"><span class="linenos">215</span></a>    <span class="k">def</span> <span class="nf">get_transformed</span><span class="p">(</span>
</span><span id="BlockMeta-216"><a href="#BlockMeta-216"><span class="linenos">216</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">new_axes</span><span class="p">:</span> <span class="n">PerAxis</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">LinearAxisTransform</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span>
</span><span id="BlockMeta-217"><a href="#BlockMeta-217"><span class="linenos">217</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
</span><span id="BlockMeta-218"><a href="#BlockMeta-218"><span class="linenos">218</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
</span><span id="BlockMeta-219"><a href="#BlockMeta-219"><span class="linenos">219</span></a>            <span class="n">sample_shape</span><span class="o">=</span><span class="p">{</span>
</span><span id="BlockMeta-220"><a href="#BlockMeta-220"><span class="linenos">220</span></a>                <span class="n">a</span><span class="p">:</span> <span class="p">(</span>
</span><span id="BlockMeta-221"><a href="#BlockMeta-221"><span class="linenos">221</span></a>                    <span class="n">trf</span>
</span><span id="BlockMeta-222"><a href="#BlockMeta-222"><span class="linenos">222</span></a>                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">trf</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
</span><span id="BlockMeta-223"><a href="#BlockMeta-223"><span class="linenos">223</span></a>                    <span class="k">else</span> <span class="n">trf</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sample_shape</span><span class="p">[</span><span class="n">trf</span><span class="o">.</span><span class="n">axis</span><span class="p">])</span>
</span><span id="BlockMeta-224"><a href="#BlockMeta-224"><span class="linenos">224</span></a>                <span class="p">)</span>
</span><span id="BlockMeta-225"><a href="#BlockMeta-225"><span class="linenos">225</span></a>                <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">trf</span> <span class="ow">in</span> <span class="n">new_axes</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
</span><span id="BlockMeta-226"><a href="#BlockMeta-226"><span class="linenos">226</span></a>            <span class="p">},</span>
</span><span id="BlockMeta-227"><a href="#BlockMeta-227"><span class="linenos">227</span></a>            <span class="n">inner_slice</span><span class="o">=</span><span class="p">{</span>
</span><span id="BlockMeta-228"><a href="#BlockMeta-228"><span class="linenos">228</span></a>                <span class="n">a</span><span class="p">:</span> <span class="p">(</span>
</span><span id="BlockMeta-229"><a href="#BlockMeta-229"><span class="linenos">229</span></a>                    <span class="n">SliceInfo</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">trf</span><span class="p">)</span>
</span><span id="BlockMeta-230"><a href="#BlockMeta-230"><span class="linenos">230</span></a>                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">trf</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
</span><span id="BlockMeta-231"><a href="#BlockMeta-231"><span class="linenos">231</span></a>                    <span class="k">else</span> <span class="n">SliceInfo</span><span class="p">(</span>
</span><span id="BlockMeta-232"><a href="#BlockMeta-232"><span class="linenos">232</span></a>                        <span class="n">trf</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inner_slice</span><span class="p">[</span><span class="n">trf</span><span class="o">.</span><span class="n">axis</span><span class="p">]</span><span class="o">.</span><span class="n">start</span><span class="p">),</span>
</span><span id="BlockMeta-233"><a href="#BlockMeta-233"><span class="linenos">233</span></a>                        <span class="n">trf</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inner_slice</span><span class="p">[</span><span class="n">trf</span><span class="o">.</span><span class="n">axis</span><span class="p">]</span><span class="o">.</span><span class="n">stop</span><span class="p">),</span>
</span><span id="BlockMeta-234"><a href="#BlockMeta-234"><span class="linenos">234</span></a>                    <span class="p">)</span>
</span><span id="BlockMeta-235"><a href="#BlockMeta-235"><span class="linenos">235</span></a>                <span class="p">)</span>
</span><span id="BlockMeta-236"><a href="#BlockMeta-236"><span class="linenos">236</span></a>                <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">trf</span> <span class="ow">in</span> <span class="n">new_axes</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
</span><span id="BlockMeta-237"><a href="#BlockMeta-237"><span class="linenos">237</span></a>            <span class="p">},</span>
</span><span id="BlockMeta-238"><a href="#BlockMeta-238"><span class="linenos">238</span></a>            <span class="n">halo</span><span class="o">=</span><span class="p">{</span>
</span><span id="BlockMeta-239"><a href="#BlockMeta-239"><span class="linenos">239</span></a>                <span class="n">a</span><span class="p">:</span> <span class="p">(</span>
</span><span id="BlockMeta-240"><a href="#BlockMeta-240"><span class="linenos">240</span></a>                    <span class="n">Halo</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="BlockMeta-241"><a href="#BlockMeta-241"><span class="linenos">241</span></a>                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">trf</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
</span><span id="BlockMeta-242"><a href="#BlockMeta-242"><span class="linenos">242</span></a>                    <span class="k">else</span> <span class="n">Halo</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">halo</span><span class="p">[</span><span class="n">trf</span><span class="o">.</span><span class="n">axis</span><span class="p">]</span><span class="o">.</span><span class="n">left</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">halo</span><span class="p">[</span><span class="n">trf</span><span class="o">.</span><span class="n">axis</span><span class="p">]</span><span class="o">.</span><span class="n">right</span><span class="p">)</span>
</span><span id="BlockMeta-243"><a href="#BlockMeta-243"><span class="linenos">243</span></a>                <span class="p">)</span>
</span><span id="BlockMeta-244"><a href="#BlockMeta-244"><span class="linenos">244</span></a>                <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">trf</span> <span class="ow">in</span> <span class="n">new_axes</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
</span><span id="BlockMeta-245"><a href="#BlockMeta-245"><span class="linenos">245</span></a>            <span class="p">},</span>
</span><span id="BlockMeta-246"><a href="#BlockMeta-246"><span class="linenos">246</span></a>            <span class="n">block_index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">block_index</span><span class="p">,</span>
</span><span id="BlockMeta-247"><a href="#BlockMeta-247"><span class="linenos">247</span></a>            <span class="n">blocks_in_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">blocks_in_sample</span><span class="p">,</span>
</span><span id="BlockMeta-248"><a href="#BlockMeta-248"><span class="linenos">248</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Block meta data of a sample member (a tensor in a sample)</p>

<p>Figure for illustration:
The first 2d block (dashed) of a sample member (<strong>bold</strong>).
The inner slice (thin) is expanded by a halo in both dimensions on both sides.
The outer slice reaches from the sample member origin (0, 0) to the right halo point.</p>

<pre><code>┌ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─  ─ ─ ─ ─ ─ ─ ─ ┐
╷ halo(left)                         ╷
╷                                    ╷
╷  (0, 0)┏━━━━━━━━━━━━━━━━━┯━━━━━━━━━┯━━━➔
╷        ┃                 │         ╷  sample member
╷        ┃      inner      │         ╷
╷        ┃   (and outer)   │  outer  ╷
╷        ┃      slice      │  slice  ╷
╷        ┃                 │         ╷
╷        ┣─────────────────┘         ╷
╷        ┃   outer slice             ╷
╷        ┃               halo(right) ╷
└ ─ ─ ─ ─┃─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─┘
         ⬇
</code></pre>

<p>note:</p>

<ul>
<li>Inner and outer slices are specified in sample member coordinates.</li>
<li>The outer_slice of a block at the sample edge may overlap by more than the
halo with the neighboring block (the inner slices will not overlap though).</li>
</ul>
</div>


                            <div id="BlockMeta.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">BlockMeta</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">sample_shape</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="n"><a href="#AxisId">AxisId</a></span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span>,</span><span class="param">	<span class="n">inner_slice</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="n"><a href="#AxisId">AxisId</a></span><span class="p">,</span> <span class="n"><a href="core/common.html#SliceInfo">bioimageio.core.common.SliceInfo</a></span><span class="p">]</span>,</span><span class="param">	<span class="n">halo</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="n"><a href="#AxisId">AxisId</a></span><span class="p">,</span> <span class="n"><a href="core/common.html#Halo">bioimageio.core.common.Halo</a></span><span class="p">]</span>,</span><span class="param">	<span class="n">block_index</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">blocks_in_sample</span><span class="p">:</span> <span class="nb">int</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#BlockMeta.__init__"></a>
    
    

                            </div>
                            <div id="BlockMeta.sample_shape" class="classattr">
                                <div class="attr variable">
            <span class="name">sample_shape</span><span class="annotation">: Mapping[<a href="#AxisId">AxisId</a>, int]</span>

        
    </div>
    <a class="headerlink" href="#BlockMeta.sample_shape"></a>
    
            <div class="docstring"><p>the axis sizes of the whole (unblocked) sample</p>
</div>


                            </div>
                            <div id="BlockMeta.inner_slice" class="classattr">
                                <div class="attr variable">
            <span class="name">inner_slice</span><span class="annotation">: Mapping[<a href="#AxisId">AxisId</a>, <a href="core/common.html#SliceInfo">bioimageio.core.common.SliceInfo</a>]</span>

        
    </div>
    <a class="headerlink" href="#BlockMeta.inner_slice"></a>
    
            <div class="docstring"><p>inner region (without halo) wrt the sample</p>
</div>


                            </div>
                            <div id="BlockMeta.halo" class="classattr">
                                <div class="attr variable">
            <span class="name">halo</span><span class="annotation">: Mapping[<a href="#AxisId">AxisId</a>, <a href="core/common.html#Halo">bioimageio.core.common.Halo</a>]</span>

        
    </div>
    <a class="headerlink" href="#BlockMeta.halo"></a>
    
            <div class="docstring"><p>halo enlarging the inner region to the block's sizes</p>
</div>


                            </div>
                            <div id="BlockMeta.block_index" class="classattr">
                                <div class="attr variable">
            <span class="name">block_index</span><span class="annotation">: int</span>

        
    </div>
    <a class="headerlink" href="#BlockMeta.block_index"></a>
    
            <div class="docstring"><p>the i-th block of the sample</p>
</div>


                            </div>
                            <div id="BlockMeta.blocks_in_sample" class="classattr">
                                <div class="attr variable">
            <span class="name">blocks_in_sample</span><span class="annotation">: int</span>

        
    </div>
    <a class="headerlink" href="#BlockMeta.blocks_in_sample"></a>
    
            <div class="docstring"><p>total number of blocks in the sample</p>
</div>


                            </div>
                            <div id="BlockMeta.shape" class="classattr">
                                        <input id="BlockMeta.shape-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">shape</span><span class="annotation">: Mapping[<a href="#AxisId">AxisId</a>, int]</span>

                <label class="view-source-button" for="BlockMeta.shape-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#BlockMeta.shape"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BlockMeta.shape-94"><a href="#BlockMeta.shape-94"><span class="linenos"> 94</span></a>    <span class="nd">@cached_property</span>
</span><span id="BlockMeta.shape-95"><a href="#BlockMeta.shape-95"><span class="linenos"> 95</span></a>    <span class="k">def</span> <span class="nf">shape</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PerAxis</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span><span id="BlockMeta.shape-96"><a href="#BlockMeta.shape-96"><span class="linenos"> 96</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;axis lengths of the block&quot;&quot;&quot;</span>
</span><span id="BlockMeta.shape-97"><a href="#BlockMeta.shape-97"><span class="linenos"> 97</span></a>        <span class="k">return</span> <span class="n">Frozen</span><span class="p">(</span>
</span><span id="BlockMeta.shape-98"><a href="#BlockMeta.shape-98"><span class="linenos"> 98</span></a>            <span class="p">{</span>
</span><span id="BlockMeta.shape-99"><a href="#BlockMeta.shape-99"><span class="linenos"> 99</span></a>                <span class="n">a</span><span class="p">:</span> <span class="n">s</span><span class="o">.</span><span class="n">stop</span> <span class="o">-</span> <span class="n">s</span><span class="o">.</span><span class="n">start</span> <span class="o">+</span> <span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">halo</span><span class="p">[</span><span class="n">a</span><span class="p">])</span> <span class="k">if</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">halo</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="BlockMeta.shape-100"><a href="#BlockMeta.shape-100"><span class="linenos">100</span></a>                <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">inner_slice</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
</span><span id="BlockMeta.shape-101"><a href="#BlockMeta.shape-101"><span class="linenos">101</span></a>            <span class="p">}</span>
</span><span id="BlockMeta.shape-102"><a href="#BlockMeta.shape-102"><span class="linenos">102</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>axis lengths of the block</p>
</div>


                            </div>
                            <div id="BlockMeta.padding" class="classattr">
                                        <input id="BlockMeta.padding-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">padding</span><span class="annotation">: Mapping[<a href="#AxisId">AxisId</a>, <a href="core/common.html#PadWidth">bioimageio.core.common.PadWidth</a>]</span>

                <label class="view-source-button" for="BlockMeta.padding-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#BlockMeta.padding"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BlockMeta.padding-104"><a href="#BlockMeta.padding-104"><span class="linenos">104</span></a>    <span class="nd">@cached_property</span>
</span><span id="BlockMeta.padding-105"><a href="#BlockMeta.padding-105"><span class="linenos">105</span></a>    <span class="k">def</span> <span class="nf">padding</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PerAxis</span><span class="p">[</span><span class="n">PadWidth</span><span class="p">]:</span>
</span><span id="BlockMeta.padding-106"><a href="#BlockMeta.padding-106"><span class="linenos">106</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;padding to realize the halo at the sample edge</span>
</span><span id="BlockMeta.padding-107"><a href="#BlockMeta.padding-107"><span class="linenos">107</span></a><span class="sd">        where we cannot simply enlarge the inner slice&quot;&quot;&quot;</span>
</span><span id="BlockMeta.padding-108"><a href="#BlockMeta.padding-108"><span class="linenos">108</span></a>        <span class="k">return</span> <span class="n">Frozen</span><span class="p">(</span>
</span><span id="BlockMeta.padding-109"><a href="#BlockMeta.padding-109"><span class="linenos">109</span></a>            <span class="p">{</span>
</span><span id="BlockMeta.padding-110"><a href="#BlockMeta.padding-110"><span class="linenos">110</span></a>                <span class="n">a</span><span class="p">:</span> <span class="n">PadWidth</span><span class="p">(</span>
</span><span id="BlockMeta.padding-111"><a href="#BlockMeta.padding-111"><span class="linenos">111</span></a>                    <span class="p">(</span>
</span><span id="BlockMeta.padding-112"><a href="#BlockMeta.padding-112"><span class="linenos">112</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">halo</span><span class="p">[</span><span class="n">a</span><span class="p">]</span><span class="o">.</span><span class="n">left</span>
</span><span id="BlockMeta.padding-113"><a href="#BlockMeta.padding-113"><span class="linenos">113</span></a>                        <span class="o">-</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inner_slice</span><span class="p">[</span><span class="n">a</span><span class="p">]</span><span class="o">.</span><span class="n">start</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">outer_slice</span><span class="p">[</span><span class="n">a</span><span class="p">]</span><span class="o">.</span><span class="n">start</span><span class="p">)</span>
</span><span id="BlockMeta.padding-114"><a href="#BlockMeta.padding-114"><span class="linenos">114</span></a>                        <span class="k">if</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">halo</span>
</span><span id="BlockMeta.padding-115"><a href="#BlockMeta.padding-115"><span class="linenos">115</span></a>                        <span class="k">else</span> <span class="mi">0</span>
</span><span id="BlockMeta.padding-116"><a href="#BlockMeta.padding-116"><span class="linenos">116</span></a>                    <span class="p">),</span>
</span><span id="BlockMeta.padding-117"><a href="#BlockMeta.padding-117"><span class="linenos">117</span></a>                    <span class="p">(</span>
</span><span id="BlockMeta.padding-118"><a href="#BlockMeta.padding-118"><span class="linenos">118</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">halo</span><span class="p">[</span><span class="n">a</span><span class="p">]</span><span class="o">.</span><span class="n">right</span>
</span><span id="BlockMeta.padding-119"><a href="#BlockMeta.padding-119"><span class="linenos">119</span></a>                        <span class="o">-</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outer_slice</span><span class="p">[</span><span class="n">a</span><span class="p">]</span><span class="o">.</span><span class="n">stop</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">inner_slice</span><span class="p">[</span><span class="n">a</span><span class="p">]</span><span class="o">.</span><span class="n">stop</span><span class="p">)</span>
</span><span id="BlockMeta.padding-120"><a href="#BlockMeta.padding-120"><span class="linenos">120</span></a>                        <span class="k">if</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">halo</span>
</span><span id="BlockMeta.padding-121"><a href="#BlockMeta.padding-121"><span class="linenos">121</span></a>                        <span class="k">else</span> <span class="mi">0</span>
</span><span id="BlockMeta.padding-122"><a href="#BlockMeta.padding-122"><span class="linenos">122</span></a>                    <span class="p">),</span>
</span><span id="BlockMeta.padding-123"><a href="#BlockMeta.padding-123"><span class="linenos">123</span></a>                <span class="p">)</span>
</span><span id="BlockMeta.padding-124"><a href="#BlockMeta.padding-124"><span class="linenos">124</span></a>                <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">inner_slice</span>
</span><span id="BlockMeta.padding-125"><a href="#BlockMeta.padding-125"><span class="linenos">125</span></a>            <span class="p">}</span>
</span><span id="BlockMeta.padding-126"><a href="#BlockMeta.padding-126"><span class="linenos">126</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>padding to realize the halo at the sample edge
where we cannot simply enlarge the inner slice</p>
</div>


                            </div>
                            <div id="BlockMeta.outer_slice" class="classattr">
                                        <input id="BlockMeta.outer_slice-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">outer_slice</span><span class="annotation">: Mapping[<a href="#AxisId">AxisId</a>, <a href="core/common.html#SliceInfo">bioimageio.core.common.SliceInfo</a>]</span>

                <label class="view-source-button" for="BlockMeta.outer_slice-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#BlockMeta.outer_slice"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BlockMeta.outer_slice-128"><a href="#BlockMeta.outer_slice-128"><span class="linenos">128</span></a>    <span class="nd">@cached_property</span>
</span><span id="BlockMeta.outer_slice-129"><a href="#BlockMeta.outer_slice-129"><span class="linenos">129</span></a>    <span class="k">def</span> <span class="nf">outer_slice</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PerAxis</span><span class="p">[</span><span class="n">SliceInfo</span><span class="p">]:</span>
</span><span id="BlockMeta.outer_slice-130"><a href="#BlockMeta.outer_slice-130"><span class="linenos">130</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;slice of the outer block (without padding) wrt the sample&quot;&quot;&quot;</span>
</span><span id="BlockMeta.outer_slice-131"><a href="#BlockMeta.outer_slice-131"><span class="linenos">131</span></a>        <span class="k">return</span> <span class="n">Frozen</span><span class="p">(</span>
</span><span id="BlockMeta.outer_slice-132"><a href="#BlockMeta.outer_slice-132"><span class="linenos">132</span></a>            <span class="p">{</span>
</span><span id="BlockMeta.outer_slice-133"><a href="#BlockMeta.outer_slice-133"><span class="linenos">133</span></a>                <span class="n">a</span><span class="p">:</span> <span class="n">SliceInfo</span><span class="p">(</span>
</span><span id="BlockMeta.outer_slice-134"><a href="#BlockMeta.outer_slice-134"><span class="linenos">134</span></a>                    <span class="nb">max</span><span class="p">(</span>
</span><span id="BlockMeta.outer_slice-135"><a href="#BlockMeta.outer_slice-135"><span class="linenos">135</span></a>                        <span class="mi">0</span><span class="p">,</span>
</span><span id="BlockMeta.outer_slice-136"><a href="#BlockMeta.outer_slice-136"><span class="linenos">136</span></a>                        <span class="nb">min</span><span class="p">(</span>
</span><span id="BlockMeta.outer_slice-137"><a href="#BlockMeta.outer_slice-137"><span class="linenos">137</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">inner_slice</span><span class="p">[</span><span class="n">a</span><span class="p">]</span><span class="o">.</span><span class="n">start</span>
</span><span id="BlockMeta.outer_slice-138"><a href="#BlockMeta.outer_slice-138"><span class="linenos">138</span></a>                            <span class="o">-</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">halo</span><span class="p">[</span><span class="n">a</span><span class="p">]</span><span class="o">.</span><span class="n">left</span> <span class="k">if</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">halo</span> <span class="k">else</span> <span class="mi">0</span><span class="p">),</span>
</span><span id="BlockMeta.outer_slice-139"><a href="#BlockMeta.outer_slice-139"><span class="linenos">139</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">sample_shape</span><span class="p">[</span><span class="n">a</span><span class="p">]</span>
</span><span id="BlockMeta.outer_slice-140"><a href="#BlockMeta.outer_slice-140"><span class="linenos">140</span></a>                            <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">inner_shape</span><span class="p">[</span><span class="n">a</span><span class="p">]</span>
</span><span id="BlockMeta.outer_slice-141"><a href="#BlockMeta.outer_slice-141"><span class="linenos">141</span></a>                            <span class="o">-</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">halo</span><span class="p">[</span><span class="n">a</span><span class="p">]</span><span class="o">.</span><span class="n">left</span> <span class="k">if</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">halo</span> <span class="k">else</span> <span class="mi">0</span><span class="p">),</span>
</span><span id="BlockMeta.outer_slice-142"><a href="#BlockMeta.outer_slice-142"><span class="linenos">142</span></a>                        <span class="p">),</span>
</span><span id="BlockMeta.outer_slice-143"><a href="#BlockMeta.outer_slice-143"><span class="linenos">143</span></a>                    <span class="p">),</span>
</span><span id="BlockMeta.outer_slice-144"><a href="#BlockMeta.outer_slice-144"><span class="linenos">144</span></a>                    <span class="nb">min</span><span class="p">(</span>
</span><span id="BlockMeta.outer_slice-145"><a href="#BlockMeta.outer_slice-145"><span class="linenos">145</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">sample_shape</span><span class="p">[</span><span class="n">a</span><span class="p">],</span>
</span><span id="BlockMeta.outer_slice-146"><a href="#BlockMeta.outer_slice-146"><span class="linenos">146</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">inner_slice</span><span class="p">[</span><span class="n">a</span><span class="p">]</span><span class="o">.</span><span class="n">stop</span>
</span><span id="BlockMeta.outer_slice-147"><a href="#BlockMeta.outer_slice-147"><span class="linenos">147</span></a>                        <span class="o">+</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">halo</span><span class="p">[</span><span class="n">a</span><span class="p">]</span><span class="o">.</span><span class="n">right</span> <span class="k">if</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">halo</span> <span class="k">else</span> <span class="mi">0</span><span class="p">),</span>
</span><span id="BlockMeta.outer_slice-148"><a href="#BlockMeta.outer_slice-148"><span class="linenos">148</span></a>                    <span class="p">),</span>
</span><span id="BlockMeta.outer_slice-149"><a href="#BlockMeta.outer_slice-149"><span class="linenos">149</span></a>                <span class="p">)</span>
</span><span id="BlockMeta.outer_slice-150"><a href="#BlockMeta.outer_slice-150"><span class="linenos">150</span></a>                <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">inner_slice</span>
</span><span id="BlockMeta.outer_slice-151"><a href="#BlockMeta.outer_slice-151"><span class="linenos">151</span></a>            <span class="p">}</span>
</span><span id="BlockMeta.outer_slice-152"><a href="#BlockMeta.outer_slice-152"><span class="linenos">152</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>slice of the outer block (without padding) wrt the sample</p>
</div>


                            </div>
                            <div id="BlockMeta.inner_shape" class="classattr">
                                        <input id="BlockMeta.inner_shape-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">inner_shape</span><span class="annotation">: Mapping[<a href="#AxisId">AxisId</a>, int]</span>

                <label class="view-source-button" for="BlockMeta.inner_shape-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#BlockMeta.inner_shape"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BlockMeta.inner_shape-154"><a href="#BlockMeta.inner_shape-154"><span class="linenos">154</span></a>    <span class="nd">@cached_property</span>
</span><span id="BlockMeta.inner_shape-155"><a href="#BlockMeta.inner_shape-155"><span class="linenos">155</span></a>    <span class="k">def</span> <span class="nf">inner_shape</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PerAxis</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span><span id="BlockMeta.inner_shape-156"><a href="#BlockMeta.inner_shape-156"><span class="linenos">156</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;axis lengths of the inner region (without halo)&quot;&quot;&quot;</span>
</span><span id="BlockMeta.inner_shape-157"><a href="#BlockMeta.inner_shape-157"><span class="linenos">157</span></a>        <span class="k">return</span> <span class="n">Frozen</span><span class="p">({</span><span class="n">a</span><span class="p">:</span> <span class="n">s</span><span class="o">.</span><span class="n">stop</span> <span class="o">-</span> <span class="n">s</span><span class="o">.</span><span class="n">start</span> <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">inner_slice</span><span class="o">.</span><span class="n">items</span><span class="p">()})</span>
</span></pre></div>


            <div class="docstring"><p>axis lengths of the inner region (without halo)</p>
</div>


                            </div>
                            <div id="BlockMeta.local_slice" class="classattr">
                                        <input id="BlockMeta.local_slice-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">local_slice</span><span class="annotation">: Mapping[<a href="#AxisId">AxisId</a>, <a href="core/common.html#SliceInfo">bioimageio.core.common.SliceInfo</a>]</span>

                <label class="view-source-button" for="BlockMeta.local_slice-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#BlockMeta.local_slice"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BlockMeta.local_slice-159"><a href="#BlockMeta.local_slice-159"><span class="linenos">159</span></a>    <span class="nd">@cached_property</span>
</span><span id="BlockMeta.local_slice-160"><a href="#BlockMeta.local_slice-160"><span class="linenos">160</span></a>    <span class="k">def</span> <span class="nf">local_slice</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PerAxis</span><span class="p">[</span><span class="n">SliceInfo</span><span class="p">]:</span>
</span><span id="BlockMeta.local_slice-161"><a href="#BlockMeta.local_slice-161"><span class="linenos">161</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;inner slice wrt the block, **not** the sample&quot;&quot;&quot;</span>
</span><span id="BlockMeta.local_slice-162"><a href="#BlockMeta.local_slice-162"><span class="linenos">162</span></a>        <span class="k">return</span> <span class="n">Frozen</span><span class="p">(</span>
</span><span id="BlockMeta.local_slice-163"><a href="#BlockMeta.local_slice-163"><span class="linenos">163</span></a>            <span class="p">{</span>
</span><span id="BlockMeta.local_slice-164"><a href="#BlockMeta.local_slice-164"><span class="linenos">164</span></a>                <span class="n">a</span><span class="p">:</span> <span class="n">SliceInfo</span><span class="p">(</span>
</span><span id="BlockMeta.local_slice-165"><a href="#BlockMeta.local_slice-165"><span class="linenos">165</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">halo</span><span class="p">[</span><span class="n">a</span><span class="p">]</span><span class="o">.</span><span class="n">left</span><span class="p">,</span>
</span><span id="BlockMeta.local_slice-166"><a href="#BlockMeta.local_slice-166"><span class="linenos">166</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">halo</span><span class="p">[</span><span class="n">a</span><span class="p">]</span><span class="o">.</span><span class="n">left</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">inner_shape</span><span class="p">[</span><span class="n">a</span><span class="p">],</span>
</span><span id="BlockMeta.local_slice-167"><a href="#BlockMeta.local_slice-167"><span class="linenos">167</span></a>                <span class="p">)</span>
</span><span id="BlockMeta.local_slice-168"><a href="#BlockMeta.local_slice-168"><span class="linenos">168</span></a>                <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">inner_slice</span>
</span><span id="BlockMeta.local_slice-169"><a href="#BlockMeta.local_slice-169"><span class="linenos">169</span></a>            <span class="p">}</span>
</span><span id="BlockMeta.local_slice-170"><a href="#BlockMeta.local_slice-170"><span class="linenos">170</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>inner slice wrt the block, <strong>not</strong> the sample</p>
</div>


                            </div>
                            <div id="BlockMeta.dims" class="classattr">
                                        <input id="BlockMeta.dims-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">dims</span><span class="annotation">: Collection[<a href="#AxisId">AxisId</a>]</span>

                <label class="view-source-button" for="BlockMeta.dims-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#BlockMeta.dims"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BlockMeta.dims-172"><a href="#BlockMeta.dims-172"><span class="linenos">172</span></a>    <span class="nd">@property</span>
</span><span id="BlockMeta.dims-173"><a href="#BlockMeta.dims-173"><span class="linenos">173</span></a>    <span class="k">def</span> <span class="nf">dims</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Collection</span><span class="p">[</span><span class="n">AxisId</span><span class="p">]:</span>
</span><span id="BlockMeta.dims-174"><a href="#BlockMeta.dims-174"><span class="linenos">174</span></a>        <span class="k">return</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inner_shape</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="BlockMeta.tagged_shape" class="classattr">
                                        <input id="BlockMeta.tagged_shape-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">tagged_shape</span><span class="annotation">: Mapping[<a href="#AxisId">AxisId</a>, int]</span>

                <label class="view-source-button" for="BlockMeta.tagged_shape-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#BlockMeta.tagged_shape"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BlockMeta.tagged_shape-176"><a href="#BlockMeta.tagged_shape-176"><span class="linenos">176</span></a>    <span class="nd">@property</span>
</span><span id="BlockMeta.tagged_shape-177"><a href="#BlockMeta.tagged_shape-177"><span class="linenos">177</span></a>    <span class="k">def</span> <span class="nf">tagged_shape</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PerAxis</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span><span id="BlockMeta.tagged_shape-178"><a href="#BlockMeta.tagged_shape-178"><span class="linenos">178</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;alias for shape&quot;&quot;&quot;</span>
</span><span id="BlockMeta.tagged_shape-179"><a href="#BlockMeta.tagged_shape-179"><span class="linenos">179</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span>
</span></pre></div>


            <div class="docstring"><p>alias for shape</p>
</div>


                            </div>
                            <div id="BlockMeta.inner_slice_wo_overlap" class="classattr">
                                        <input id="BlockMeta.inner_slice_wo_overlap-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">inner_slice_wo_overlap</span>

                <label class="view-source-button" for="BlockMeta.inner_slice_wo_overlap-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#BlockMeta.inner_slice_wo_overlap"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BlockMeta.inner_slice_wo_overlap-181"><a href="#BlockMeta.inner_slice_wo_overlap-181"><span class="linenos">181</span></a>    <span class="nd">@property</span>
</span><span id="BlockMeta.inner_slice_wo_overlap-182"><a href="#BlockMeta.inner_slice_wo_overlap-182"><span class="linenos">182</span></a>    <span class="k">def</span> <span class="nf">inner_slice_wo_overlap</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BlockMeta.inner_slice_wo_overlap-183"><a href="#BlockMeta.inner_slice_wo_overlap-183"><span class="linenos">183</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;subslice of the inner slice, such that all `inner_slice_wo_overlap` can be</span>
</span><span id="BlockMeta.inner_slice_wo_overlap-184"><a href="#BlockMeta.inner_slice_wo_overlap-184"><span class="linenos">184</span></a><span class="sd">        stiched together trivially to form the original sample.</span>
</span><span id="BlockMeta.inner_slice_wo_overlap-185"><a href="#BlockMeta.inner_slice_wo_overlap-185"><span class="linenos">185</span></a>
</span><span id="BlockMeta.inner_slice_wo_overlap-186"><a href="#BlockMeta.inner_slice_wo_overlap-186"><span class="linenos">186</span></a><span class="sd">        This can also be used to calculate statistics</span>
</span><span id="BlockMeta.inner_slice_wo_overlap-187"><a href="#BlockMeta.inner_slice_wo_overlap-187"><span class="linenos">187</span></a><span class="sd">        without overrepresenting block edge regions.&quot;&quot;&quot;</span>
</span><span id="BlockMeta.inner_slice_wo_overlap-188"><a href="#BlockMeta.inner_slice_wo_overlap-188"><span class="linenos">188</span></a>        <span class="c1"># TODO: update inner_slice_wo_overlap when adding block overlap</span>
</span><span id="BlockMeta.inner_slice_wo_overlap-189"><a href="#BlockMeta.inner_slice_wo_overlap-189"><span class="linenos">189</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">inner_slice</span>
</span></pre></div>


            <div class="docstring"><p>subslice of the inner slice, such that all <code><a href="#BlockMeta.inner_slice_wo_overlap">inner_slice_wo_overlap</a></code> can be
stiched together trivially to form the original sample.</p>

<p>This can also be used to calculate statistics
without overrepresenting block edge regions.</p>
</div>


                            </div>
                            <div id="BlockMeta.get_transformed" class="classattr">
                                        <input id="BlockMeta.get_transformed-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_transformed</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">new_axes</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="n"><a href="#AxisId">AxisId</a></span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="n"><a href="core/block_meta.html#LinearAxisTransform">bioimageio.core.block_meta.LinearAxisTransform</a></span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span></span><span class="return-annotation">) -> <span class="n">Self</span>:</span></span>

                <label class="view-source-button" for="BlockMeta.get_transformed-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#BlockMeta.get_transformed"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BlockMeta.get_transformed-215"><a href="#BlockMeta.get_transformed-215"><span class="linenos">215</span></a>    <span class="k">def</span> <span class="nf">get_transformed</span><span class="p">(</span>
</span><span id="BlockMeta.get_transformed-216"><a href="#BlockMeta.get_transformed-216"><span class="linenos">216</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">new_axes</span><span class="p">:</span> <span class="n">PerAxis</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">LinearAxisTransform</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span>
</span><span id="BlockMeta.get_transformed-217"><a href="#BlockMeta.get_transformed-217"><span class="linenos">217</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
</span><span id="BlockMeta.get_transformed-218"><a href="#BlockMeta.get_transformed-218"><span class="linenos">218</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
</span><span id="BlockMeta.get_transformed-219"><a href="#BlockMeta.get_transformed-219"><span class="linenos">219</span></a>            <span class="n">sample_shape</span><span class="o">=</span><span class="p">{</span>
</span><span id="BlockMeta.get_transformed-220"><a href="#BlockMeta.get_transformed-220"><span class="linenos">220</span></a>                <span class="n">a</span><span class="p">:</span> <span class="p">(</span>
</span><span id="BlockMeta.get_transformed-221"><a href="#BlockMeta.get_transformed-221"><span class="linenos">221</span></a>                    <span class="n">trf</span>
</span><span id="BlockMeta.get_transformed-222"><a href="#BlockMeta.get_transformed-222"><span class="linenos">222</span></a>                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">trf</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
</span><span id="BlockMeta.get_transformed-223"><a href="#BlockMeta.get_transformed-223"><span class="linenos">223</span></a>                    <span class="k">else</span> <span class="n">trf</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sample_shape</span><span class="p">[</span><span class="n">trf</span><span class="o">.</span><span class="n">axis</span><span class="p">])</span>
</span><span id="BlockMeta.get_transformed-224"><a href="#BlockMeta.get_transformed-224"><span class="linenos">224</span></a>                <span class="p">)</span>
</span><span id="BlockMeta.get_transformed-225"><a href="#BlockMeta.get_transformed-225"><span class="linenos">225</span></a>                <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">trf</span> <span class="ow">in</span> <span class="n">new_axes</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
</span><span id="BlockMeta.get_transformed-226"><a href="#BlockMeta.get_transformed-226"><span class="linenos">226</span></a>            <span class="p">},</span>
</span><span id="BlockMeta.get_transformed-227"><a href="#BlockMeta.get_transformed-227"><span class="linenos">227</span></a>            <span class="n">inner_slice</span><span class="o">=</span><span class="p">{</span>
</span><span id="BlockMeta.get_transformed-228"><a href="#BlockMeta.get_transformed-228"><span class="linenos">228</span></a>                <span class="n">a</span><span class="p">:</span> <span class="p">(</span>
</span><span id="BlockMeta.get_transformed-229"><a href="#BlockMeta.get_transformed-229"><span class="linenos">229</span></a>                    <span class="n">SliceInfo</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">trf</span><span class="p">)</span>
</span><span id="BlockMeta.get_transformed-230"><a href="#BlockMeta.get_transformed-230"><span class="linenos">230</span></a>                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">trf</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
</span><span id="BlockMeta.get_transformed-231"><a href="#BlockMeta.get_transformed-231"><span class="linenos">231</span></a>                    <span class="k">else</span> <span class="n">SliceInfo</span><span class="p">(</span>
</span><span id="BlockMeta.get_transformed-232"><a href="#BlockMeta.get_transformed-232"><span class="linenos">232</span></a>                        <span class="n">trf</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inner_slice</span><span class="p">[</span><span class="n">trf</span><span class="o">.</span><span class="n">axis</span><span class="p">]</span><span class="o">.</span><span class="n">start</span><span class="p">),</span>
</span><span id="BlockMeta.get_transformed-233"><a href="#BlockMeta.get_transformed-233"><span class="linenos">233</span></a>                        <span class="n">trf</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inner_slice</span><span class="p">[</span><span class="n">trf</span><span class="o">.</span><span class="n">axis</span><span class="p">]</span><span class="o">.</span><span class="n">stop</span><span class="p">),</span>
</span><span id="BlockMeta.get_transformed-234"><a href="#BlockMeta.get_transformed-234"><span class="linenos">234</span></a>                    <span class="p">)</span>
</span><span id="BlockMeta.get_transformed-235"><a href="#BlockMeta.get_transformed-235"><span class="linenos">235</span></a>                <span class="p">)</span>
</span><span id="BlockMeta.get_transformed-236"><a href="#BlockMeta.get_transformed-236"><span class="linenos">236</span></a>                <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">trf</span> <span class="ow">in</span> <span class="n">new_axes</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
</span><span id="BlockMeta.get_transformed-237"><a href="#BlockMeta.get_transformed-237"><span class="linenos">237</span></a>            <span class="p">},</span>
</span><span id="BlockMeta.get_transformed-238"><a href="#BlockMeta.get_transformed-238"><span class="linenos">238</span></a>            <span class="n">halo</span><span class="o">=</span><span class="p">{</span>
</span><span id="BlockMeta.get_transformed-239"><a href="#BlockMeta.get_transformed-239"><span class="linenos">239</span></a>                <span class="n">a</span><span class="p">:</span> <span class="p">(</span>
</span><span id="BlockMeta.get_transformed-240"><a href="#BlockMeta.get_transformed-240"><span class="linenos">240</span></a>                    <span class="n">Halo</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="BlockMeta.get_transformed-241"><a href="#BlockMeta.get_transformed-241"><span class="linenos">241</span></a>                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">trf</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
</span><span id="BlockMeta.get_transformed-242"><a href="#BlockMeta.get_transformed-242"><span class="linenos">242</span></a>                    <span class="k">else</span> <span class="n">Halo</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">halo</span><span class="p">[</span><span class="n">trf</span><span class="o">.</span><span class="n">axis</span><span class="p">]</span><span class="o">.</span><span class="n">left</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">halo</span><span class="p">[</span><span class="n">trf</span><span class="o">.</span><span class="n">axis</span><span class="p">]</span><span class="o">.</span><span class="n">right</span><span class="p">)</span>
</span><span id="BlockMeta.get_transformed-243"><a href="#BlockMeta.get_transformed-243"><span class="linenos">243</span></a>                <span class="p">)</span>
</span><span id="BlockMeta.get_transformed-244"><a href="#BlockMeta.get_transformed-244"><span class="linenos">244</span></a>                <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">trf</span> <span class="ow">in</span> <span class="n">new_axes</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
</span><span id="BlockMeta.get_transformed-245"><a href="#BlockMeta.get_transformed-245"><span class="linenos">245</span></a>            <span class="p">},</span>
</span><span id="BlockMeta.get_transformed-246"><a href="#BlockMeta.get_transformed-246"><span class="linenos">246</span></a>            <span class="n">block_index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">block_index</span><span class="p">,</span>
</span><span id="BlockMeta.get_transformed-247"><a href="#BlockMeta.get_transformed-247"><span class="linenos">247</span></a>            <span class="n">blocks_in_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">blocks_in_sample</span><span class="p">,</span>
</span><span id="BlockMeta.get_transformed-248"><a href="#BlockMeta.get_transformed-248"><span class="linenos">248</span></a>        <span class="p">)</span>
</span></pre></div>


    

                            </div>
                </section>
                <section id="build_description">
                            <input id="build_description-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">build_description</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">content</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">YamlValue</span><span class="p">]</span>,</span><span class="param">	<span class="o">/</span>,</span><span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">context</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n"><a href="spec.html#ValidationContext">bioimageio.spec.ValidationContext</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">format_version</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;latest&#39;</span><span class="p">,</span> <span class="s1">&#39;discover&#39;</span><span class="p">],</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;discover&#39;</span></span><span class="return-annotation">) -> <span class="n">Union</span><span class="p">[</span><span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n"><a href="spec/application/v0_2.html#ApplicationDescr">bioimageio.spec.application.v0_2.ApplicationDescr</a></span><span class="p">,</span> <span class="n"><a href="spec.html#ApplicationDescr">bioimageio.spec.ApplicationDescr</a></span><span class="p">],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=</span><span class="s1">&#39;format_version&#39;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)],</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n"><a href="spec/dataset/v0_2.html#DatasetDescr">bioimageio.spec.dataset.v0_2.DatasetDescr</a></span><span class="p">,</span> <span class="n"><a href="spec.html#DatasetDescr">bioimageio.spec.DatasetDescr</a></span><span class="p">],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=</span><span class="s1">&#39;format_version&#39;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)],</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n"><a href="spec/model/v0_4.html#ModelDescr">bioimageio.spec.model.v0_4.ModelDescr</a></span><span class="p">,</span> <span class="n"><a href="spec.html#ModelDescr">bioimageio.spec.ModelDescr</a></span><span class="p">],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=</span><span class="s1">&#39;format_version&#39;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)],</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n"><a href="spec.html#NotebookDescr">bioimageio.spec.NotebookDescr</a></span><span class="p">,</span> <span class="n"><a href="spec.html#NotebookDescr">bioimageio.spec.NotebookDescr</a></span><span class="p">],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=</span><span class="s1">&#39;format_version&#39;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)]],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=</span><span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)],</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n"><a href="spec/generic/v0_2.html#GenericDescr">bioimageio.spec.generic.v0_2.GenericDescr</a></span><span class="p">,</span> <span class="n"><a href="spec.html#GenericDescr">bioimageio.spec.GenericDescr</a></span><span class="p">],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=</span><span class="s1">&#39;format_version&#39;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)],</span> <span class="n"><a href="spec.html#InvalidDescr">bioimageio.spec.InvalidDescr</a></span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="build_description-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#build_description"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="build_description-130"><a href="#build_description-130"><span class="linenos">130</span></a><span class="k">def</span> <span class="nf">build_description</span><span class="p">(</span>
</span><span id="build_description-131"><a href="#build_description-131"><span class="linenos">131</span></a>    <span class="n">content</span><span class="p">:</span> <span class="n">BioimageioYamlContent</span><span class="p">,</span>
</span><span id="build_description-132"><a href="#build_description-132"><span class="linenos">132</span></a>    <span class="o">/</span><span class="p">,</span>
</span><span id="build_description-133"><a href="#build_description-133"><span class="linenos">133</span></a>    <span class="o">*</span><span class="p">,</span>
</span><span id="build_description-134"><a href="#build_description-134"><span class="linenos">134</span></a>    <span class="n">context</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ValidationContext</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="build_description-135"><a href="#build_description-135"><span class="linenos">135</span></a>    <span class="n">format_version</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">FormatVersionPlaceholder</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">DISCOVER</span><span class="p">,</span>
</span><span id="build_description-136"><a href="#build_description-136"><span class="linenos">136</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">ResourceDescr</span><span class="p">,</span> <span class="n">InvalidDescr</span><span class="p">]:</span>
</span><span id="build_description-137"><a href="#build_description-137"><span class="linenos">137</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;build a bioimage.io resource description from an RDF&#39;s content.</span>
</span><span id="build_description-138"><a href="#build_description-138"><span class="linenos">138</span></a>
</span><span id="build_description-139"><a href="#build_description-139"><span class="linenos">139</span></a><span class="sd">    Use `load_description` if you want to build a resource description from an rdf.yaml</span>
</span><span id="build_description-140"><a href="#build_description-140"><span class="linenos">140</span></a><span class="sd">    or bioimage.io zip-package.</span>
</span><span id="build_description-141"><a href="#build_description-141"><span class="linenos">141</span></a>
</span><span id="build_description-142"><a href="#build_description-142"><span class="linenos">142</span></a><span class="sd">    Args:</span>
</span><span id="build_description-143"><a href="#build_description-143"><span class="linenos">143</span></a><span class="sd">        content: loaded rdf.yaml file (loaded with YAML, not bioimageio.spec)</span>
</span><span id="build_description-144"><a href="#build_description-144"><span class="linenos">144</span></a><span class="sd">        context: validation context to use during validation</span>
</span><span id="build_description-145"><a href="#build_description-145"><span class="linenos">145</span></a><span class="sd">        format_version: (optional) use this argument to load the resource and</span>
</span><span id="build_description-146"><a href="#build_description-146"><span class="linenos">146</span></a><span class="sd">                        convert its metadata to a higher format_version</span>
</span><span id="build_description-147"><a href="#build_description-147"><span class="linenos">147</span></a>
</span><span id="build_description-148"><a href="#build_description-148"><span class="linenos">148</span></a><span class="sd">    Returns:</span>
</span><span id="build_description-149"><a href="#build_description-149"><span class="linenos">149</span></a><span class="sd">        An object holding all metadata of the bioimage.io resource</span>
</span><span id="build_description-150"><a href="#build_description-150"><span class="linenos">150</span></a>
</span><span id="build_description-151"><a href="#build_description-151"><span class="linenos">151</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="build_description-152"><a href="#build_description-152"><span class="linenos">152</span></a>
</span><span id="build_description-153"><a href="#build_description-153"><span class="linenos">153</span></a>    <span class="k">return</span> <span class="n">build_description_impl</span><span class="p">(</span>
</span><span id="build_description-154"><a href="#build_description-154"><span class="linenos">154</span></a>        <span class="n">content</span><span class="p">,</span>
</span><span id="build_description-155"><a href="#build_description-155"><span class="linenos">155</span></a>        <span class="n">context</span><span class="o">=</span><span class="n">context</span><span class="p">,</span>
</span><span id="build_description-156"><a href="#build_description-156"><span class="linenos">156</span></a>        <span class="n">format_version</span><span class="o">=</span><span class="n">format_version</span><span class="p">,</span>
</span><span id="build_description-157"><a href="#build_description-157"><span class="linenos">157</span></a>        <span class="n">get_rd_class</span><span class="o">=</span><span class="n">_get_rd_class</span><span class="p">,</span>
</span><span id="build_description-158"><a href="#build_description-158"><span class="linenos">158</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>build a bioimage.io resource description from an RDF's content.</p>

<p>Use <code><a href="#load_description">load_description</a></code> if you want to build a resource description from an rdf.yaml
or bioimage.io zip-package.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>content:</strong>  loaded rdf.yaml file (loaded with YAML, not <a href="spec.html">bioimageio.spec</a>)</li>
<li><strong>context:</strong>  validation context to use during validation</li>
<li><strong>format_version:</strong>  (optional) use this argument to load the resource and
convert its metadata to a higher format_version</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>An object holding all metadata of the bioimage.io resource</p>
</blockquote>
</div>


                </section>
                <section id="compute_dataset_measures">
                            <input id="compute_dataset_measures-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">compute_dataset_measures</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">measures</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n"><a href="core/stat_measures.html#DatasetMean">bioimageio.core.stat_measures.DatasetMean</a></span><span class="p">,</span> <span class="n"><a href="core/stat_measures.html#DatasetStd">bioimageio.core.stat_measures.DatasetStd</a></span><span class="p">,</span> <span class="n"><a href="core/stat_measures.html#DatasetVar">bioimageio.core.stat_measures.DatasetVar</a></span><span class="p">,</span> <span class="n"><a href="core/stat_measures.html#DatasetPercentile">bioimageio.core.stat_measures.DatasetPercentile</a></span><span class="p">],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)]]</span>,</span><span class="param">	<span class="n">dataset</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n"><a href="#Sample">Sample</a></span><span class="p">]</span></span><span class="return-annotation">) -> <span class="n">Dict</span><span class="p">[</span><span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n"><a href="core/stat_measures.html#DatasetMean">bioimageio.core.stat_measures.DatasetMean</a></span><span class="p">,</span> <span class="n"><a href="core/stat_measures.html#DatasetStd">bioimageio.core.stat_measures.DatasetStd</a></span><span class="p">,</span> <span class="n"><a href="core/stat_measures.html#DatasetVar">bioimageio.core.stat_measures.DatasetVar</a></span><span class="p">,</span> <span class="n"><a href="core/stat_measures.html#DatasetPercentile">bioimageio.core.stat_measures.DatasetPercentile</a></span><span class="p">],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)],</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">Annotated</span><span class="p">[</span><span class="n"><a href="#Tensor">Tensor</a></span><span class="p">,</span> <span class="n">BeforeValidator</span><span class="p">(</span><span class="n">func</span><span class="o">=&lt;</span><span class="n">function</span> <span class="n">tensor_custom_before_validator</span> <span class="n">at</span> <span class="mh">0x7f7587fee840</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">json_schema_input_type</span><span class="o">=</span><span class="n">PydanticUndefined</span><span class="p">),</span> <span class="n">PlainSerializer</span><span class="p">(</span><span class="n">func</span><span class="o">=&lt;</span><span class="n">function</span> <span class="n">tensor_custom_serializer</span> <span class="n">at</span> <span class="mh">0x7f7587feea20</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">return_type</span><span class="o">=</span><span class="n">PydanticUndefined</span><span class="p">,</span> <span class="n">when_used</span><span class="o">=</span><span class="s1">&#39;always&#39;</span><span class="p">)]]]</span>:</span></span>

                <label class="view-source-button" for="compute_dataset_measures-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#compute_dataset_measures"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="compute_dataset_measures-560"><a href="#compute_dataset_measures-560"><span class="linenos">560</span></a><span class="k">def</span> <span class="nf">compute_dataset_measures</span><span class="p">(</span>
</span><span id="compute_dataset_measures-561"><a href="#compute_dataset_measures-561"><span class="linenos">561</span></a>    <span class="n">measures</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">DatasetMeasure</span><span class="p">],</span> <span class="n">dataset</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Sample</span><span class="p">]</span>
</span><span id="compute_dataset_measures-562"><a href="#compute_dataset_measures-562"><span class="linenos">562</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="n">DatasetMeasure</span><span class="p">,</span> <span class="n">MeasureValue</span><span class="p">]:</span>
</span><span id="compute_dataset_measures-563"><a href="#compute_dataset_measures-563"><span class="linenos">563</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;compute all dataset `measures` for the given `dataset`&quot;&quot;&quot;</span>
</span><span id="compute_dataset_measures-564"><a href="#compute_dataset_measures-564"><span class="linenos">564</span></a>    <span class="n">sample_calculators</span><span class="p">,</span> <span class="n">calculators</span> <span class="o">=</span> <span class="n">get_measure_calculators</span><span class="p">(</span><span class="n">measures</span><span class="p">)</span>
</span><span id="compute_dataset_measures-565"><a href="#compute_dataset_measures-565"><span class="linenos">565</span></a>    <span class="k">assert</span> <span class="ow">not</span> <span class="n">sample_calculators</span>
</span><span id="compute_dataset_measures-566"><a href="#compute_dataset_measures-566"><span class="linenos">566</span></a>
</span><span id="compute_dataset_measures-567"><a href="#compute_dataset_measures-567"><span class="linenos">567</span></a>    <span class="n">ret</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="n">DatasetMeasure</span><span class="p">,</span> <span class="n">MeasureValue</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="compute_dataset_measures-568"><a href="#compute_dataset_measures-568"><span class="linenos">568</span></a>
</span><span id="compute_dataset_measures-569"><a href="#compute_dataset_measures-569"><span class="linenos">569</span></a>    <span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="n">dataset</span><span class="p">:</span>
</span><span id="compute_dataset_measures-570"><a href="#compute_dataset_measures-570"><span class="linenos">570</span></a>        <span class="k">for</span> <span class="n">calc</span> <span class="ow">in</span> <span class="n">calculators</span><span class="p">:</span>
</span><span id="compute_dataset_measures-571"><a href="#compute_dataset_measures-571"><span class="linenos">571</span></a>            <span class="n">calc</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
</span><span id="compute_dataset_measures-572"><a href="#compute_dataset_measures-572"><span class="linenos">572</span></a>
</span><span id="compute_dataset_measures-573"><a href="#compute_dataset_measures-573"><span class="linenos">573</span></a>    <span class="k">for</span> <span class="n">calc</span> <span class="ow">in</span> <span class="n">calculators</span><span class="p">:</span>
</span><span id="compute_dataset_measures-574"><a href="#compute_dataset_measures-574"><span class="linenos">574</span></a>        <span class="n">ret</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">calc</span><span class="o">.</span><span class="n">finalize</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
</span><span id="compute_dataset_measures-575"><a href="#compute_dataset_measures-575"><span class="linenos">575</span></a>
</span><span id="compute_dataset_measures-576"><a href="#compute_dataset_measures-576"><span class="linenos">576</span></a>    <span class="k">return</span> <span class="n">ret</span>
</span></pre></div>


            <div class="docstring"><p>compute all dataset <code>measures</code> for the given <code>dataset</code></p>
</div>


                </section>
                <section id="create_prediction_pipeline">
                            <input id="create_prediction_pipeline-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_prediction_pipeline</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">bioimageio_model</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n"><a href="spec/model/v0_4.html#ModelDescr">bioimageio.spec.model.v0_4.ModelDescr</a></span><span class="p">,</span> <span class="n"><a href="spec.html#ModelDescr">bioimageio.spec.ModelDescr</a></span><span class="p">],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=</span><span class="s1">&#39;format_version&#39;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)]</span>,</span><span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">devices</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">weight_format</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;keras_hdf5&#39;</span><span class="p">,</span> <span class="s1">&#39;onnx&#39;</span><span class="p">,</span> <span class="s1">&#39;pytorch_state_dict&#39;</span><span class="p">,</span> <span class="s1">&#39;tensorflow_js&#39;</span><span class="p">,</span> <span class="s1">&#39;tensorflow_saved_model_bundle&#39;</span><span class="p">,</span> <span class="s1">&#39;torchscript&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">weights_format</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;keras_hdf5&#39;</span><span class="p">,</span> <span class="s1">&#39;onnx&#39;</span><span class="p">,</span> <span class="s1">&#39;pytorch_state_dict&#39;</span><span class="p">,</span> <span class="s1">&#39;tensorflow_js&#39;</span><span class="p">,</span> <span class="s1">&#39;tensorflow_saved_model_bundle&#39;</span><span class="p">,</span> <span class="s1">&#39;torchscript&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">dataset_for_initial_statistics</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n"><a href="#Sample">Sample</a></span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="n"><a href="#Tensor">Tensor</a></span><span class="p">]]]</span> <span class="o">=</span> <span class="p">()</span>,</span><span class="param">	<span class="n">keep_updating_initial_dataset_statistics</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">fixed_dataset_statistics</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n"><a href="core/stat_measures.html#DatasetMean">bioimageio.core.stat_measures.DatasetMean</a></span><span class="p">,</span> <span class="n"><a href="core/stat_measures.html#DatasetStd">bioimageio.core.stat_measures.DatasetStd</a></span><span class="p">,</span> <span class="n"><a href="core/stat_measures.html#DatasetVar">bioimageio.core.stat_measures.DatasetVar</a></span><span class="p">,</span> <span class="n"><a href="core/stat_measures.html#DatasetPercentile">bioimageio.core.stat_measures.DatasetPercentile</a></span><span class="p">],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)],</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">Annotated</span><span class="p">[</span><span class="n"><a href="#Tensor">Tensor</a></span><span class="p">,</span> <span class="n">BeforeValidator</span><span class="p">(</span><span class="n">func</span><span class="o">=&lt;</span><span class="n">function</span> <span class="n">tensor_custom_before_validator</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">json_schema_input_type</span><span class="o">=</span><span class="n">PydanticUndefined</span><span class="p">),</span> <span class="n">PlainSerializer</span><span class="p">(</span><span class="n">func</span><span class="o">=&lt;</span><span class="n">function</span> <span class="n">tensor_custom_serializer</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">return_type</span><span class="o">=</span><span class="n">PydanticUndefined</span><span class="p">,</span> <span class="n">when_used</span><span class="o">=</span><span class="s1">&#39;always&#39;</span><span class="p">)]]]</span> <span class="o">=</span> <span class="n">mappingproxy</span><span class="p">({})</span>,</span><span class="param">	<span class="n">model_adapter</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n"><a href="core/model_adapters.html#ModelAdapter">bioimageio.core.model_adapters.ModelAdapter</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">ns</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Mapping</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n"><a href="spec/model/v0_5.html#TensorId">bioimageio.spec.model.v0_5.TensorId</a></span><span class="p">,</span> <span class="n"><a href="#AxisId">AxisId</a></span><span class="p">],</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">10</span>,</span><span class="param">	<span class="o">**</span><span class="n">deprecated_kwargs</span><span class="p">:</span> <span class="n">Any</span></span><span class="return-annotation">) -> <span class="n"><a href="#PredictionPipeline">PredictionPipeline</a></span>:</span></span>

                <label class="view-source-button" for="create_prediction_pipeline-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#create_prediction_pipeline"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="create_prediction_pipeline-319"><a href="#create_prediction_pipeline-319"><span class="linenos">319</span></a><span class="k">def</span> <span class="nf">create_prediction_pipeline</span><span class="p">(</span>
</span><span id="create_prediction_pipeline-320"><a href="#create_prediction_pipeline-320"><span class="linenos">320</span></a>    <span class="n">bioimageio_model</span><span class="p">:</span> <span class="n">AnyModelDescr</span><span class="p">,</span>
</span><span id="create_prediction_pipeline-321"><a href="#create_prediction_pipeline-321"><span class="linenos">321</span></a>    <span class="o">*</span><span class="p">,</span>
</span><span id="create_prediction_pipeline-322"><a href="#create_prediction_pipeline-322"><span class="linenos">322</span></a>    <span class="n">devices</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="create_prediction_pipeline-323"><a href="#create_prediction_pipeline-323"><span class="linenos">323</span></a>    <span class="n">weight_format</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">WeightsFormat</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="create_prediction_pipeline-324"><a href="#create_prediction_pipeline-324"><span class="linenos">324</span></a>    <span class="n">weights_format</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">WeightsFormat</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="create_prediction_pipeline-325"><a href="#create_prediction_pipeline-325"><span class="linenos">325</span></a>    <span class="n">dataset_for_initial_statistics</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Sample</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Tensor</span><span class="p">]]]</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(),</span>
</span><span id="create_prediction_pipeline-326"><a href="#create_prediction_pipeline-326"><span class="linenos">326</span></a>    <span class="n">keep_updating_initial_dataset_statistics</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="create_prediction_pipeline-327"><a href="#create_prediction_pipeline-327"><span class="linenos">327</span></a>    <span class="n">fixed_dataset_statistics</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="n">DatasetMeasure</span><span class="p">,</span> <span class="n">MeasureValue</span><span class="p">]</span> <span class="o">=</span> <span class="n">MappingProxyType</span><span class="p">(</span>
</span><span id="create_prediction_pipeline-328"><a href="#create_prediction_pipeline-328"><span class="linenos">328</span></a>        <span class="p">{}</span>
</span><span id="create_prediction_pipeline-329"><a href="#create_prediction_pipeline-329"><span class="linenos">329</span></a>    <span class="p">),</span>
</span><span id="create_prediction_pipeline-330"><a href="#create_prediction_pipeline-330"><span class="linenos">330</span></a>    <span class="n">model_adapter</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ModelAdapter</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="create_prediction_pipeline-331"><a href="#create_prediction_pipeline-331"><span class="linenos">331</span></a>    <span class="n">ns</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span>
</span><span id="create_prediction_pipeline-332"><a href="#create_prediction_pipeline-332"><span class="linenos">332</span></a>        <span class="n">v0_5</span><span class="o">.</span><span class="n">ParameterizedSize_N</span><span class="p">,</span>
</span><span id="create_prediction_pipeline-333"><a href="#create_prediction_pipeline-333"><span class="linenos">333</span></a>        <span class="n">Mapping</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">MemberId</span><span class="p">,</span> <span class="n">AxisId</span><span class="p">],</span> <span class="n">v0_5</span><span class="o">.</span><span class="n">ParameterizedSize_N</span><span class="p">],</span>
</span><span id="create_prediction_pipeline-334"><a href="#create_prediction_pipeline-334"><span class="linenos">334</span></a>    <span class="p">]</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
</span><span id="create_prediction_pipeline-335"><a href="#create_prediction_pipeline-335"><span class="linenos">335</span></a>    <span class="o">**</span><span class="n">deprecated_kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
</span><span id="create_prediction_pipeline-336"><a href="#create_prediction_pipeline-336"><span class="linenos">336</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PredictionPipeline</span><span class="p">:</span>
</span><span id="create_prediction_pipeline-337"><a href="#create_prediction_pipeline-337"><span class="linenos">337</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="create_prediction_pipeline-338"><a href="#create_prediction_pipeline-338"><span class="linenos">338</span></a><span class="sd">    Creates prediction pipeline which includes:</span>
</span><span id="create_prediction_pipeline-339"><a href="#create_prediction_pipeline-339"><span class="linenos">339</span></a><span class="sd">    * computation of input statistics</span>
</span><span id="create_prediction_pipeline-340"><a href="#create_prediction_pipeline-340"><span class="linenos">340</span></a><span class="sd">    * preprocessing</span>
</span><span id="create_prediction_pipeline-341"><a href="#create_prediction_pipeline-341"><span class="linenos">341</span></a><span class="sd">    * model prediction</span>
</span><span id="create_prediction_pipeline-342"><a href="#create_prediction_pipeline-342"><span class="linenos">342</span></a><span class="sd">    * computation of output statistics</span>
</span><span id="create_prediction_pipeline-343"><a href="#create_prediction_pipeline-343"><span class="linenos">343</span></a><span class="sd">    * postprocessing</span>
</span><span id="create_prediction_pipeline-344"><a href="#create_prediction_pipeline-344"><span class="linenos">344</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="create_prediction_pipeline-345"><a href="#create_prediction_pipeline-345"><span class="linenos">345</span></a>    <span class="n">weights_format</span> <span class="o">=</span> <span class="n">weight_format</span> <span class="ow">or</span> <span class="n">weights_format</span>
</span><span id="create_prediction_pipeline-346"><a href="#create_prediction_pipeline-346"><span class="linenos">346</span></a>    <span class="k">del</span> <span class="n">weight_format</span>
</span><span id="create_prediction_pipeline-347"><a href="#create_prediction_pipeline-347"><span class="linenos">347</span></a>    <span class="k">if</span> <span class="n">deprecated_kwargs</span><span class="p">:</span>
</span><span id="create_prediction_pipeline-348"><a href="#create_prediction_pipeline-348"><span class="linenos">348</span></a>        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
</span><span id="create_prediction_pipeline-349"><a href="#create_prediction_pipeline-349"><span class="linenos">349</span></a>            <span class="sa">f</span><span class="s2">&quot;deprecated create_prediction_pipeline kwargs: </span><span class="si">{</span><span class="nb">set</span><span class="p">(</span><span class="n">deprecated_kwargs</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="create_prediction_pipeline-350"><a href="#create_prediction_pipeline-350"><span class="linenos">350</span></a>        <span class="p">)</span>
</span><span id="create_prediction_pipeline-351"><a href="#create_prediction_pipeline-351"><span class="linenos">351</span></a>
</span><span id="create_prediction_pipeline-352"><a href="#create_prediction_pipeline-352"><span class="linenos">352</span></a>    <span class="n">model_adapter</span> <span class="o">=</span> <span class="n">model_adapter</span> <span class="ow">or</span> <span class="n">create_model_adapter</span><span class="p">(</span>
</span><span id="create_prediction_pipeline-353"><a href="#create_prediction_pipeline-353"><span class="linenos">353</span></a>        <span class="n">model_description</span><span class="o">=</span><span class="n">bioimageio_model</span><span class="p">,</span>
</span><span id="create_prediction_pipeline-354"><a href="#create_prediction_pipeline-354"><span class="linenos">354</span></a>        <span class="n">devices</span><span class="o">=</span><span class="n">devices</span><span class="p">,</span>
</span><span id="create_prediction_pipeline-355"><a href="#create_prediction_pipeline-355"><span class="linenos">355</span></a>        <span class="n">weight_format_priority_order</span><span class="o">=</span><span class="n">weights_format</span> <span class="ow">and</span> <span class="p">(</span><span class="n">weights_format</span><span class="p">,),</span>
</span><span id="create_prediction_pipeline-356"><a href="#create_prediction_pipeline-356"><span class="linenos">356</span></a>    <span class="p">)</span>
</span><span id="create_prediction_pipeline-357"><a href="#create_prediction_pipeline-357"><span class="linenos">357</span></a>
</span><span id="create_prediction_pipeline-358"><a href="#create_prediction_pipeline-358"><span class="linenos">358</span></a>    <span class="n">input_ids</span> <span class="o">=</span> <span class="n">get_member_ids</span><span class="p">(</span><span class="n">bioimageio_model</span><span class="o">.</span><span class="n">inputs</span><span class="p">)</span>
</span><span id="create_prediction_pipeline-359"><a href="#create_prediction_pipeline-359"><span class="linenos">359</span></a>
</span><span id="create_prediction_pipeline-360"><a href="#create_prediction_pipeline-360"><span class="linenos">360</span></a>    <span class="k">def</span> <span class="nf">dataset</span><span class="p">():</span>
</span><span id="create_prediction_pipeline-361"><a href="#create_prediction_pipeline-361"><span class="linenos">361</span></a>        <span class="n">common_stat</span><span class="p">:</span> <span class="n">Stat</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="create_prediction_pipeline-362"><a href="#create_prediction_pipeline-362"><span class="linenos">362</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">dataset_for_initial_statistics</span><span class="p">):</span>
</span><span id="create_prediction_pipeline-363"><a href="#create_prediction_pipeline-363"><span class="linenos">363</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Sample</span><span class="p">):</span>
</span><span id="create_prediction_pipeline-364"><a href="#create_prediction_pipeline-364"><span class="linenos">364</span></a>                <span class="k">yield</span> <span class="n">x</span>
</span><span id="create_prediction_pipeline-365"><a href="#create_prediction_pipeline-365"><span class="linenos">365</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="create_prediction_pipeline-366"><a href="#create_prediction_pipeline-366"><span class="linenos">366</span></a>                <span class="k">yield</span> <span class="n">Sample</span><span class="p">(</span><span class="n">members</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">input_ids</span><span class="p">,</span> <span class="n">x</span><span class="p">)),</span> <span class="n">stat</span><span class="o">=</span><span class="n">common_stat</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
</span><span id="create_prediction_pipeline-367"><a href="#create_prediction_pipeline-367"><span class="linenos">367</span></a>
</span><span id="create_prediction_pipeline-368"><a href="#create_prediction_pipeline-368"><span class="linenos">368</span></a>    <span class="n">preprocessing</span><span class="p">,</span> <span class="n">postprocessing</span> <span class="o">=</span> <span class="n">setup_pre_and_postprocessing</span><span class="p">(</span>
</span><span id="create_prediction_pipeline-369"><a href="#create_prediction_pipeline-369"><span class="linenos">369</span></a>        <span class="n">bioimageio_model</span><span class="p">,</span>
</span><span id="create_prediction_pipeline-370"><a href="#create_prediction_pipeline-370"><span class="linenos">370</span></a>        <span class="n">dataset</span><span class="p">(),</span>
</span><span id="create_prediction_pipeline-371"><a href="#create_prediction_pipeline-371"><span class="linenos">371</span></a>        <span class="n">keep_updating_initial_dataset_stats</span><span class="o">=</span><span class="n">keep_updating_initial_dataset_statistics</span><span class="p">,</span>
</span><span id="create_prediction_pipeline-372"><a href="#create_prediction_pipeline-372"><span class="linenos">372</span></a>        <span class="n">fixed_dataset_stats</span><span class="o">=</span><span class="n">fixed_dataset_statistics</span><span class="p">,</span>
</span><span id="create_prediction_pipeline-373"><a href="#create_prediction_pipeline-373"><span class="linenos">373</span></a>    <span class="p">)</span>
</span><span id="create_prediction_pipeline-374"><a href="#create_prediction_pipeline-374"><span class="linenos">374</span></a>
</span><span id="create_prediction_pipeline-375"><a href="#create_prediction_pipeline-375"><span class="linenos">375</span></a>    <span class="k">return</span> <span class="n">PredictionPipeline</span><span class="p">(</span>
</span><span id="create_prediction_pipeline-376"><a href="#create_prediction_pipeline-376"><span class="linenos">376</span></a>        <span class="n">name</span><span class="o">=</span><span class="n">bioimageio_model</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="create_prediction_pipeline-377"><a href="#create_prediction_pipeline-377"><span class="linenos">377</span></a>        <span class="n">model_description</span><span class="o">=</span><span class="n">bioimageio_model</span><span class="p">,</span>
</span><span id="create_prediction_pipeline-378"><a href="#create_prediction_pipeline-378"><span class="linenos">378</span></a>        <span class="n">model_adapter</span><span class="o">=</span><span class="n">model_adapter</span><span class="p">,</span>
</span><span id="create_prediction_pipeline-379"><a href="#create_prediction_pipeline-379"><span class="linenos">379</span></a>        <span class="n">preprocessing</span><span class="o">=</span><span class="n">preprocessing</span><span class="p">,</span>
</span><span id="create_prediction_pipeline-380"><a href="#create_prediction_pipeline-380"><span class="linenos">380</span></a>        <span class="n">postprocessing</span><span class="o">=</span><span class="n">postprocessing</span><span class="p">,</span>
</span><span id="create_prediction_pipeline-381"><a href="#create_prediction_pipeline-381"><span class="linenos">381</span></a>        <span class="n">default_ns</span><span class="o">=</span><span class="n">ns</span><span class="p">,</span>
</span><span id="create_prediction_pipeline-382"><a href="#create_prediction_pipeline-382"><span class="linenos">382</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Creates prediction pipeline which includes:</p>

<ul>
<li>computation of input statistics</li>
<li>preprocessing</li>
<li>model prediction</li>
<li>computation of output statistics</li>
<li>postprocessing</li>
</ul>
</div>


                </section>
                <section id="dump_description">
                            <input id="dump_description-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">dump_description</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">rd</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n"><a href="spec/application/v0_2.html#ApplicationDescr">bioimageio.spec.application.v0_2.ApplicationDescr</a></span><span class="p">,</span> <span class="n"><a href="spec.html#ApplicationDescr">bioimageio.spec.ApplicationDescr</a></span><span class="p">],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=</span><span class="s1">&#39;format_version&#39;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)],</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n"><a href="spec/dataset/v0_2.html#DatasetDescr">bioimageio.spec.dataset.v0_2.DatasetDescr</a></span><span class="p">,</span> <span class="n"><a href="spec.html#DatasetDescr">bioimageio.spec.DatasetDescr</a></span><span class="p">],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=</span><span class="s1">&#39;format_version&#39;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)],</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n"><a href="spec/model/v0_4.html#ModelDescr">bioimageio.spec.model.v0_4.ModelDescr</a></span><span class="p">,</span> <span class="n"><a href="spec.html#ModelDescr">bioimageio.spec.ModelDescr</a></span><span class="p">],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=</span><span class="s1">&#39;format_version&#39;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)],</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n"><a href="spec.html#NotebookDescr">bioimageio.spec.NotebookDescr</a></span><span class="p">,</span> <span class="n"><a href="spec.html#NotebookDescr">bioimageio.spec.NotebookDescr</a></span><span class="p">],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=</span><span class="s1">&#39;format_version&#39;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)]],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=</span><span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)],</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n"><a href="spec/generic/v0_2.html#GenericDescr">bioimageio.spec.generic.v0_2.GenericDescr</a></span><span class="p">,</span> <span class="n"><a href="spec.html#GenericDescr">bioimageio.spec.GenericDescr</a></span><span class="p">],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=</span><span class="s1">&#39;format_version&#39;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)],</span> <span class="n"><a href="spec.html#InvalidDescr">bioimageio.spec.InvalidDescr</a></span><span class="p">]</span>,</span><span class="param">	<span class="n">exclude_unset</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span></span><span class="return-annotation">) -> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">YamlValue</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="dump_description-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#dump_description"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="dump_description-65"><a href="#dump_description-65"><span class="linenos">65</span></a><span class="k">def</span> <span class="nf">dump_description</span><span class="p">(</span>
</span><span id="dump_description-66"><a href="#dump_description-66"><span class="linenos">66</span></a>    <span class="n">rd</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ResourceDescr</span><span class="p">,</span> <span class="n">InvalidDescr</span><span class="p">],</span> <span class="n">exclude_unset</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="dump_description-67"><a href="#dump_description-67"><span class="linenos">67</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BioimageioYamlContent</span><span class="p">:</span>
</span><span id="dump_description-68"><a href="#dump_description-68"><span class="linenos">68</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Converts a resource to a dictionary containing only simple types that can directly be serialzed to YAML.&quot;&quot;&quot;</span>
</span><span id="dump_description-69"><a href="#dump_description-69"><span class="linenos">69</span></a>    <span class="k">return</span> <span class="n">rd</span><span class="o">.</span><span class="n">model_dump</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s2">&quot;json&quot;</span><span class="p">,</span> <span class="n">exclude_unset</span><span class="o">=</span><span class="n">exclude_unset</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Converts a resource to a dictionary containing only simple types that can directly be serialzed to YAML.</p>
</div>


                </section>
                <section id="enable_determinism">
                            <input id="enable_determinism-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">enable_determinism</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">mode</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;seed_only&#39;</span><span class="p">,</span> <span class="s1">&#39;full&#39;</span><span class="p">]</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="enable_determinism-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#enable_determinism"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="enable_determinism-36"><a href="#enable_determinism-36"><span class="linenos">36</span></a><span class="k">def</span> <span class="nf">enable_determinism</span><span class="p">(</span><span class="n">mode</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;seed_only&quot;</span><span class="p">,</span> <span class="s2">&quot;full&quot;</span><span class="p">]):</span>
</span><span id="enable_determinism-37"><a href="#enable_determinism-37"><span class="linenos">37</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Seed and configure ML frameworks for maximum reproducibility.</span>
</span><span id="enable_determinism-38"><a href="#enable_determinism-38"><span class="linenos">38</span></a><span class="sd">    May degrade performance. Only recommended for testing reproducibility!</span>
</span><span id="enable_determinism-39"><a href="#enable_determinism-39"><span class="linenos">39</span></a>
</span><span id="enable_determinism-40"><a href="#enable_determinism-40"><span class="linenos">40</span></a><span class="sd">    Seed any random generators and (if **mode**==&quot;full&quot;) request ML frameworks to use</span>
</span><span id="enable_determinism-41"><a href="#enable_determinism-41"><span class="linenos">41</span></a><span class="sd">    deterministic algorithms.</span>
</span><span id="enable_determinism-42"><a href="#enable_determinism-42"><span class="linenos">42</span></a><span class="sd">    Notes:</span>
</span><span id="enable_determinism-43"><a href="#enable_determinism-43"><span class="linenos">43</span></a><span class="sd">        - **mode** == &quot;full&quot;  might degrade performance and throw exceptions.</span>
</span><span id="enable_determinism-44"><a href="#enable_determinism-44"><span class="linenos">44</span></a><span class="sd">        - Subsequent inference calls might still differ. Call before each function</span>
</span><span id="enable_determinism-45"><a href="#enable_determinism-45"><span class="linenos">45</span></a><span class="sd">          (sequence) that is expected to be reproducible.</span>
</span><span id="enable_determinism-46"><a href="#enable_determinism-46"><span class="linenos">46</span></a><span class="sd">        - Degraded performance: Use for testing reproducibility only!</span>
</span><span id="enable_determinism-47"><a href="#enable_determinism-47"><span class="linenos">47</span></a><span class="sd">        - Recipes:</span>
</span><span id="enable_determinism-48"><a href="#enable_determinism-48"><span class="linenos">48</span></a><span class="sd">            - [PyTorch](https://pytorch.org/docs/stable/notes/randomness.html)</span>
</span><span id="enable_determinism-49"><a href="#enable_determinism-49"><span class="linenos">49</span></a><span class="sd">            - [Keras](https://keras.io/examples/keras_recipes/reproducibility_recipes/)</span>
</span><span id="enable_determinism-50"><a href="#enable_determinism-50"><span class="linenos">50</span></a><span class="sd">            - [NumPy](https://numpy.org/doc/2.0/reference/random/generated/numpy.random.seed.html)</span>
</span><span id="enable_determinism-51"><a href="#enable_determinism-51"><span class="linenos">51</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="enable_determinism-52"><a href="#enable_determinism-52"><span class="linenos">52</span></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="enable_determinism-53"><a href="#enable_determinism-53"><span class="linenos">53</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="enable_determinism-54"><a href="#enable_determinism-54"><span class="linenos">54</span></a>            <span class="kn">import</span> <span class="nn">numpy.random</span>
</span><span id="enable_determinism-55"><a href="#enable_determinism-55"><span class="linenos">55</span></a>        <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
</span><span id="enable_determinism-56"><a href="#enable_determinism-56"><span class="linenos">56</span></a>            <span class="k">pass</span>
</span><span id="enable_determinism-57"><a href="#enable_determinism-57"><span class="linenos">57</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="enable_determinism-58"><a href="#enable_determinism-58"><span class="linenos">58</span></a>            <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="enable_determinism-59"><a href="#enable_determinism-59"><span class="linenos">59</span></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="enable_determinism-60"><a href="#enable_determinism-60"><span class="linenos">60</span></a>        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</span><span id="enable_determinism-61"><a href="#enable_determinism-61"><span class="linenos">61</span></a>
</span><span id="enable_determinism-62"><a href="#enable_determinism-62"><span class="linenos">62</span></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="enable_determinism-63"><a href="#enable_determinism-63"><span class="linenos">63</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="enable_determinism-64"><a href="#enable_determinism-64"><span class="linenos">64</span></a>            <span class="kn">import</span> <span class="nn">torch</span>
</span><span id="enable_determinism-65"><a href="#enable_determinism-65"><span class="linenos">65</span></a>        <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
</span><span id="enable_determinism-66"><a href="#enable_determinism-66"><span class="linenos">66</span></a>            <span class="k">pass</span>
</span><span id="enable_determinism-67"><a href="#enable_determinism-67"><span class="linenos">67</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="enable_determinism-68"><a href="#enable_determinism-68"><span class="linenos">68</span></a>            <span class="n">_</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">manual_seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="enable_determinism-69"><a href="#enable_determinism-69"><span class="linenos">69</span></a>            <span class="n">torch</span><span class="o">.</span><span class="n">use_deterministic_algorithms</span><span class="p">(</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;full&quot;</span><span class="p">)</span>
</span><span id="enable_determinism-70"><a href="#enable_determinism-70"><span class="linenos">70</span></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="enable_determinism-71"><a href="#enable_determinism-71"><span class="linenos">71</span></a>        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</span><span id="enable_determinism-72"><a href="#enable_determinism-72"><span class="linenos">72</span></a>
</span><span id="enable_determinism-73"><a href="#enable_determinism-73"><span class="linenos">73</span></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="enable_determinism-74"><a href="#enable_determinism-74"><span class="linenos">74</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="enable_determinism-75"><a href="#enable_determinism-75"><span class="linenos">75</span></a>            <span class="kn">import</span> <span class="nn">keras</span>
</span><span id="enable_determinism-76"><a href="#enable_determinism-76"><span class="linenos">76</span></a>        <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
</span><span id="enable_determinism-77"><a href="#enable_determinism-77"><span class="linenos">77</span></a>            <span class="k">pass</span>
</span><span id="enable_determinism-78"><a href="#enable_determinism-78"><span class="linenos">78</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="enable_determinism-79"><a href="#enable_determinism-79"><span class="linenos">79</span></a>            <span class="n">keras</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">set_random_seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="enable_determinism-80"><a href="#enable_determinism-80"><span class="linenos">80</span></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="enable_determinism-81"><a href="#enable_determinism-81"><span class="linenos">81</span></a>        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</span><span id="enable_determinism-82"><a href="#enable_determinism-82"><span class="linenos">82</span></a>
</span><span id="enable_determinism-83"><a href="#enable_determinism-83"><span class="linenos">83</span></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="enable_determinism-84"><a href="#enable_determinism-84"><span class="linenos">84</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="enable_determinism-85"><a href="#enable_determinism-85"><span class="linenos">85</span></a>            <span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>  <span class="c1"># pyright: ignore[reportMissingImports]</span>
</span><span id="enable_determinism-86"><a href="#enable_determinism-86"><span class="linenos">86</span></a>        <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
</span><span id="enable_determinism-87"><a href="#enable_determinism-87"><span class="linenos">87</span></a>            <span class="k">pass</span>
</span><span id="enable_determinism-88"><a href="#enable_determinism-88"><span class="linenos">88</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="enable_determinism-89"><a href="#enable_determinism-89"><span class="linenos">89</span></a>            <span class="n">tf</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="enable_determinism-90"><a href="#enable_determinism-90"><span class="linenos">90</span></a>            <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;full&quot;</span><span class="p">:</span>
</span><span id="enable_determinism-91"><a href="#enable_determinism-91"><span class="linenos">91</span></a>                <span class="n">tf</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">experimental</span><span class="o">.</span><span class="n">enable_op_determinism</span><span class="p">()</span>
</span><span id="enable_determinism-92"><a href="#enable_determinism-92"><span class="linenos">92</span></a>            <span class="c1"># TODO: find possibility to switch it off again??</span>
</span><span id="enable_determinism-93"><a href="#enable_determinism-93"><span class="linenos">93</span></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="enable_determinism-94"><a href="#enable_determinism-94"><span class="linenos">94</span></a>        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>Seed and configure ML frameworks for maximum reproducibility.
May degrade performance. Only recommended for testing reproducibility!</p>

<p>Seed any random generators and (if <strong>mode</strong>=="full") request ML frameworks to use
deterministic algorithms.</p>

<h6 id="notes">Notes:</h6>

<blockquote>
  <ul>
  <li><strong>mode</strong> == "full"  might degrade performance and throw exceptions.</li>
  <li>Subsequent inference calls might still differ. Call before each function
  (sequence) that is expected to be reproducible.</li>
  <li>Degraded performance: Use for testing reproducibility only!</li>
  <li>Recipes:
  <ul>
  <li><a href="https://pytorch.org/docs/stable/notes/randomness.html">PyTorch</a></li>
  <li><a href="https://keras.io/examples/keras_recipes/reproducibility_recipes/">Keras</a></li>
  <li><a href="https://numpy.org/doc/2.0/reference/random/generated/numpy.random.seed.html">NumPy</a></li>
  </ul></li>
  </ul>
</blockquote>
</div>


                </section>
                <section id="load_dataset_description">
                            <input id="load_dataset_description-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">load_dataset_description</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">source</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">bioimageio</span><span class="o">.</span><span class="n">spec</span><span class="o">.</span><span class="n">_internal</span><span class="o">.</span><span class="n">url</span><span class="o">.</span><span class="n">HttpUrl</span><span class="p">,</span> <span class="n">bioimageio</span><span class="o">.</span><span class="n">spec</span><span class="o">.</span><span class="n">_internal</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">RelativeFilePath</span><span class="p">,</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span> <span class="n">PathType</span><span class="p">(</span><span class="n">path_type</span><span class="o">=</span><span class="s1">&#39;file&#39;</span><span class="p">)]],</span> <span class="n">FieldInfo</span><span class="p">(</span><span class="n">annotation</span><span class="o">=</span><span class="n">NoneType</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="p">[</span><span class="n">_PydanticGeneralMetadata</span><span class="p">(</span><span class="n">union_mode</span><span class="o">=</span><span class="s1">&#39;left_to_right&#39;</span><span class="p">)])],</span> <span class="nb">str</span><span class="p">,</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">pydantic_core</span><span class="o">.</span><span class="n">_pydantic_core</span><span class="o">.</span><span class="n">Url</span><span class="p">,</span> <span class="n">UrlConstraints</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">2083</span><span class="p">,</span> <span class="n">allowed_schemes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;http&#39;</span><span class="p">,</span> <span class="s1">&#39;https&#39;</span><span class="p">],</span> <span class="n">host_required</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">default_host</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">default_port</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">default_path</span><span class="o">=</span><span class="kc">None</span><span class="p">)],</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">]</span>,</span><span class="param">	<span class="o">/</span>,</span><span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">format_version</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;discover&#39;</span><span class="p">],</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;latest&#39;</span><span class="p">],</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;discover&#39;</span>,</span><span class="param">	<span class="n">perform_io_checks</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">known_files</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">bioimageio</span><span class="o">.</span><span class="n">spec</span><span class="o">.</span><span class="n">_internal</span><span class="o">.</span><span class="n">io_basics</span><span class="o">.</span><span class="n">Sha256</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n"><a href="spec/dataset/v0_2.html#DatasetDescr">bioimageio.spec.dataset.v0_2.DatasetDescr</a></span><span class="p">,</span> <span class="n"><a href="spec.html#DatasetDescr">bioimageio.spec.DatasetDescr</a></span><span class="p">],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=</span><span class="s1">&#39;format_version&#39;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)]</span>:</span></span>

                <label class="view-source-button" for="load_dataset_description-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#load_dataset_description"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="load_dataset_description-98"><a href="#load_dataset_description-98"><span class="linenos"> 98</span></a><span class="k">def</span> <span class="nf">load_dataset_description</span><span class="p">(</span>
</span><span id="load_dataset_description-99"><a href="#load_dataset_description-99"><span class="linenos"> 99</span></a>    <span class="n">source</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">PermissiveFileSource</span><span class="p">,</span> <span class="n">ZipFile</span><span class="p">],</span>
</span><span id="load_dataset_description-100"><a href="#load_dataset_description-100"><span class="linenos">100</span></a>    <span class="o">/</span><span class="p">,</span>
</span><span id="load_dataset_description-101"><a href="#load_dataset_description-101"><span class="linenos">101</span></a>    <span class="o">*</span><span class="p">,</span>
</span><span id="load_dataset_description-102"><a href="#load_dataset_description-102"><span class="linenos">102</span></a>    <span class="n">format_version</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;discover&quot;</span><span class="p">],</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;latest&quot;</span><span class="p">],</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">DISCOVER</span><span class="p">,</span>
</span><span id="load_dataset_description-103"><a href="#load_dataset_description-103"><span class="linenos">103</span></a>    <span class="n">perform_io_checks</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">settings</span><span class="o">.</span><span class="n">perform_io_checks</span><span class="p">,</span>
</span><span id="load_dataset_description-104"><a href="#load_dataset_description-104"><span class="linenos">104</span></a>    <span class="n">known_files</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sha256</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="load_dataset_description-105"><a href="#load_dataset_description-105"><span class="linenos">105</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AnyDatasetDescr</span><span class="p">:</span>
</span><span id="load_dataset_description-106"><a href="#load_dataset_description-106"><span class="linenos">106</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;same as `load_description`, but addtionally ensures that the loaded</span>
</span><span id="load_dataset_description-107"><a href="#load_dataset_description-107"><span class="linenos">107</span></a><span class="sd">    description is valid and of type &#39;dataset&#39;.</span>
</span><span id="load_dataset_description-108"><a href="#load_dataset_description-108"><span class="linenos">108</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="load_dataset_description-109"><a href="#load_dataset_description-109"><span class="linenos">109</span></a>    <span class="n">rd</span> <span class="o">=</span> <span class="n">load_description</span><span class="p">(</span>
</span><span id="load_dataset_description-110"><a href="#load_dataset_description-110"><span class="linenos">110</span></a>        <span class="n">source</span><span class="p">,</span>
</span><span id="load_dataset_description-111"><a href="#load_dataset_description-111"><span class="linenos">111</span></a>        <span class="n">format_version</span><span class="o">=</span><span class="n">format_version</span><span class="p">,</span>
</span><span id="load_dataset_description-112"><a href="#load_dataset_description-112"><span class="linenos">112</span></a>        <span class="n">perform_io_checks</span><span class="o">=</span><span class="n">perform_io_checks</span><span class="p">,</span>
</span><span id="load_dataset_description-113"><a href="#load_dataset_description-113"><span class="linenos">113</span></a>        <span class="n">known_files</span><span class="o">=</span><span class="n">known_files</span><span class="p">,</span>
</span><span id="load_dataset_description-114"><a href="#load_dataset_description-114"><span class="linenos">114</span></a>    <span class="p">)</span>
</span><span id="load_dataset_description-115"><a href="#load_dataset_description-115"><span class="linenos">115</span></a>    <span class="k">return</span> <span class="n">ensure_description_is_dataset</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>same as <code><a href="#load_description">load_description</a></code>, but addtionally ensures that the loaded
description is valid and of type 'dataset'.</p>
</div>


                </section>
                <section id="load_description_and_test">
                            <input id="load_description_and_test-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">load_description_and_test</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">source</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n"><a href="spec/application/v0_2.html#ApplicationDescr">bioimageio.spec.application.v0_2.ApplicationDescr</a></span><span class="p">,</span> <span class="n"><a href="spec.html#ApplicationDescr">bioimageio.spec.ApplicationDescr</a></span><span class="p">],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=</span><span class="s1">&#39;format_version&#39;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)],</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n"><a href="spec/dataset/v0_2.html#DatasetDescr">bioimageio.spec.dataset.v0_2.DatasetDescr</a></span><span class="p">,</span> <span class="n"><a href="spec.html#DatasetDescr">bioimageio.spec.DatasetDescr</a></span><span class="p">],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=</span><span class="s1">&#39;format_version&#39;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)],</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n"><a href="spec/model/v0_4.html#ModelDescr">bioimageio.spec.model.v0_4.ModelDescr</a></span><span class="p">,</span> <span class="n"><a href="spec.html#ModelDescr">bioimageio.spec.ModelDescr</a></span><span class="p">],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=</span><span class="s1">&#39;format_version&#39;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)],</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n"><a href="spec.html#NotebookDescr">bioimageio.spec.NotebookDescr</a></span><span class="p">,</span> <span class="n"><a href="spec.html#NotebookDescr">bioimageio.spec.NotebookDescr</a></span><span class="p">],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=</span><span class="s1">&#39;format_version&#39;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)]],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=</span><span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)],</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n"><a href="spec/generic/v0_2.html#GenericDescr">bioimageio.spec.generic.v0_2.GenericDescr</a></span><span class="p">,</span> <span class="n"><a href="spec.html#GenericDescr">bioimageio.spec.GenericDescr</a></span><span class="p">],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=</span><span class="s1">&#39;format_version&#39;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)],</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">bioimageio</span><span class="o">.</span><span class="n">spec</span><span class="o">.</span><span class="n">_internal</span><span class="o">.</span><span class="n">url</span><span class="o">.</span><span class="n">HttpUrl</span><span class="p">,</span> <span class="n">bioimageio</span><span class="o">.</span><span class="n">spec</span><span class="o">.</span><span class="n">_internal</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">RelativeFilePath</span><span class="p">,</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span> <span class="n">PathType</span><span class="p">(</span><span class="n">path_type</span><span class="o">=</span><span class="s1">&#39;file&#39;</span><span class="p">)]],</span> <span class="n">FieldInfo</span><span class="p">(</span><span class="n">annotation</span><span class="o">=</span><span class="n">NoneType</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="p">[</span><span class="n">_PydanticGeneralMetadata</span><span class="p">(</span><span class="n">union_mode</span><span class="o">=</span><span class="s1">&#39;left_to_right&#39;</span><span class="p">)])],</span> <span class="nb">str</span><span class="p">,</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">pydantic_core</span><span class="o">.</span><span class="n">_pydantic_core</span><span class="o">.</span><span class="n">Url</span><span class="p">,</span> <span class="n">UrlConstraints</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">2083</span><span class="p">,</span> <span class="n">allowed_schemes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;http&#39;</span><span class="p">,</span> <span class="s1">&#39;https&#39;</span><span class="p">],</span> <span class="n">host_required</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">default_host</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">default_port</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">default_path</span><span class="o">=</span><span class="kc">None</span><span class="p">)],</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">YamlValue</span><span class="p">]]</span>,</span><span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">format_version</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;discover&#39;</span><span class="p">,</span> <span class="s1">&#39;latest&#39;</span><span class="p">],</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;discover&#39;</span>,</span><span class="param">	<span class="n">weight_format</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;keras_hdf5&#39;</span><span class="p">,</span> <span class="s1">&#39;onnx&#39;</span><span class="p">,</span> <span class="s1">&#39;pytorch_state_dict&#39;</span><span class="p">,</span> <span class="s1">&#39;tensorflow_js&#39;</span><span class="p">,</span> <span class="s1">&#39;tensorflow_saved_model_bundle&#39;</span><span class="p">,</span> <span class="s1">&#39;torchscript&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">devices</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">absolute_tolerance</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.00015</span>,</span><span class="param">	<span class="n">relative_tolerance</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0001</span>,</span><span class="param">	<span class="n">decimal</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">determinism</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;seed_only&#39;</span><span class="p">,</span> <span class="s1">&#39;full&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;seed_only&#39;</span>,</span><span class="param">	<span class="n">expected_type</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n">Union</span><span class="p">[</span><span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n"><a href="spec/application/v0_2.html#ApplicationDescr">bioimageio.spec.application.v0_2.ApplicationDescr</a></span><span class="p">,</span> <span class="n"><a href="spec.html#ApplicationDescr">bioimageio.spec.ApplicationDescr</a></span><span class="p">],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=</span><span class="s1">&#39;format_version&#39;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)],</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n"><a href="spec/dataset/v0_2.html#DatasetDescr">bioimageio.spec.dataset.v0_2.DatasetDescr</a></span><span class="p">,</span> <span class="n"><a href="spec.html#DatasetDescr">bioimageio.spec.DatasetDescr</a></span><span class="p">],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=</span><span class="s1">&#39;format_version&#39;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)],</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n"><a href="spec/model/v0_4.html#ModelDescr">bioimageio.spec.model.v0_4.ModelDescr</a></span><span class="p">,</span> <span class="n"><a href="spec.html#ModelDescr">bioimageio.spec.ModelDescr</a></span><span class="p">],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=</span><span class="s1">&#39;format_version&#39;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)],</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n"><a href="spec.html#NotebookDescr">bioimageio.spec.NotebookDescr</a></span><span class="p">,</span> <span class="n"><a href="spec.html#NotebookDescr">bioimageio.spec.NotebookDescr</a></span><span class="p">],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=</span><span class="s1">&#39;format_version&#39;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)]],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=</span><span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)],</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n"><a href="spec/generic/v0_2.html#GenericDescr">bioimageio.spec.generic.v0_2.GenericDescr</a></span><span class="p">,</span> <span class="n"><a href="spec.html#GenericDescr">bioimageio.spec.GenericDescr</a></span><span class="p">],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=</span><span class="s1">&#39;format_version&#39;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)],</span> <span class="n"><a href="spec.html#InvalidDescr">bioimageio.spec.InvalidDescr</a></span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="load_description_and_test-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#load_description_and_test"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="load_description_and_test-147"><a href="#load_description_and_test-147"><span class="linenos">147</span></a><span class="k">def</span> <span class="nf">load_description_and_test</span><span class="p">(</span>
</span><span id="load_description_and_test-148"><a href="#load_description_and_test-148"><span class="linenos">148</span></a>    <span class="n">source</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ResourceDescr</span><span class="p">,</span> <span class="n">PermissiveFileSource</span><span class="p">,</span> <span class="n">BioimageioYamlContent</span><span class="p">],</span>
</span><span id="load_description_and_test-149"><a href="#load_description_and_test-149"><span class="linenos">149</span></a>    <span class="o">*</span><span class="p">,</span>
</span><span id="load_description_and_test-150"><a href="#load_description_and_test-150"><span class="linenos">150</span></a>    <span class="n">format_version</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;discover&quot;</span><span class="p">,</span> <span class="s2">&quot;latest&quot;</span><span class="p">],</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;discover&quot;</span><span class="p">,</span>
</span><span id="load_description_and_test-151"><a href="#load_description_and_test-151"><span class="linenos">151</span></a>    <span class="n">weight_format</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">WeightsFormat</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="load_description_and_test-152"><a href="#load_description_and_test-152"><span class="linenos">152</span></a>    <span class="n">devices</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="load_description_and_test-153"><a href="#load_description_and_test-153"><span class="linenos">153</span></a>    <span class="n">absolute_tolerance</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.5e-4</span><span class="p">,</span>
</span><span id="load_description_and_test-154"><a href="#load_description_and_test-154"><span class="linenos">154</span></a>    <span class="n">relative_tolerance</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-4</span><span class="p">,</span>
</span><span id="load_description_and_test-155"><a href="#load_description_and_test-155"><span class="linenos">155</span></a>    <span class="n">decimal</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="load_description_and_test-156"><a href="#load_description_and_test-156"><span class="linenos">156</span></a>    <span class="n">determinism</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;seed_only&quot;</span><span class="p">,</span> <span class="s2">&quot;full&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;seed_only&quot;</span><span class="p">,</span>
</span><span id="load_description_and_test-157"><a href="#load_description_and_test-157"><span class="linenos">157</span></a>    <span class="n">expected_type</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="load_description_and_test-158"><a href="#load_description_and_test-158"><span class="linenos">158</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">ResourceDescr</span><span class="p">,</span> <span class="n">InvalidDescr</span><span class="p">]:</span>
</span><span id="load_description_and_test-159"><a href="#load_description_and_test-159"><span class="linenos">159</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Test RDF dynamically, e.g. model inference of test inputs&quot;&quot;&quot;</span>
</span><span id="load_description_and_test-160"><a href="#load_description_and_test-160"><span class="linenos">160</span></a>    <span class="k">if</span> <span class="p">(</span>
</span><span id="load_description_and_test-161"><a href="#load_description_and_test-161"><span class="linenos">161</span></a>        <span class="nb">isinstance</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">ResourceDescrBase</span><span class="p">)</span>
</span><span id="load_description_and_test-162"><a href="#load_description_and_test-162"><span class="linenos">162</span></a>        <span class="ow">and</span> <span class="n">format_version</span> <span class="o">!=</span> <span class="s2">&quot;discover&quot;</span>
</span><span id="load_description_and_test-163"><a href="#load_description_and_test-163"><span class="linenos">163</span></a>        <span class="ow">and</span> <span class="n">source</span><span class="o">.</span><span class="n">format_version</span> <span class="o">!=</span> <span class="n">format_version</span>
</span><span id="load_description_and_test-164"><a href="#load_description_and_test-164"><span class="linenos">164</span></a>    <span class="p">):</span>
</span><span id="load_description_and_test-165"><a href="#load_description_and_test-165"><span class="linenos">165</span></a>        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
</span><span id="load_description_and_test-166"><a href="#load_description_and_test-166"><span class="linenos">166</span></a>            <span class="sa">f</span><span class="s2">&quot;deserializing source to ensure we validate and test using format </span><span class="si">{</span><span class="n">format_version</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="load_description_and_test-167"><a href="#load_description_and_test-167"><span class="linenos">167</span></a>        <span class="p">)</span>
</span><span id="load_description_and_test-168"><a href="#load_description_and_test-168"><span class="linenos">168</span></a>        <span class="n">source</span> <span class="o">=</span> <span class="n">dump_description</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
</span><span id="load_description_and_test-169"><a href="#load_description_and_test-169"><span class="linenos">169</span></a>
</span><span id="load_description_and_test-170"><a href="#load_description_and_test-170"><span class="linenos">170</span></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">ResourceDescrBase</span><span class="p">):</span>
</span><span id="load_description_and_test-171"><a href="#load_description_and_test-171"><span class="linenos">171</span></a>        <span class="n">rd</span> <span class="o">=</span> <span class="n">source</span>
</span><span id="load_description_and_test-172"><a href="#load_description_and_test-172"><span class="linenos">172</span></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="load_description_and_test-173"><a href="#load_description_and_test-173"><span class="linenos">173</span></a>        <span class="n">rd</span> <span class="o">=</span> <span class="n">build_description</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">format_version</span><span class="o">=</span><span class="n">format_version</span><span class="p">)</span>
</span><span id="load_description_and_test-174"><a href="#load_description_and_test-174"><span class="linenos">174</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="load_description_and_test-175"><a href="#load_description_and_test-175"><span class="linenos">175</span></a>        <span class="n">rd</span> <span class="o">=</span> <span class="n">load_description</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">format_version</span><span class="o">=</span><span class="n">format_version</span><span class="p">)</span>
</span><span id="load_description_and_test-176"><a href="#load_description_and_test-176"><span class="linenos">176</span></a>
</span><span id="load_description_and_test-177"><a href="#load_description_and_test-177"><span class="linenos">177</span></a>    <span class="n">rd</span><span class="o">.</span><span class="n">validation_summary</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">add</span><span class="p">(</span>
</span><span id="load_description_and_test-178"><a href="#load_description_and_test-178"><span class="linenos">178</span></a>        <span class="n">InstalledPackage</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;bioimageio.core&quot;</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="n">VERSION</span><span class="p">)</span>
</span><span id="load_description_and_test-179"><a href="#load_description_and_test-179"><span class="linenos">179</span></a>    <span class="p">)</span>
</span><span id="load_description_and_test-180"><a href="#load_description_and_test-180"><span class="linenos">180</span></a>
</span><span id="load_description_and_test-181"><a href="#load_description_and_test-181"><span class="linenos">181</span></a>    <span class="k">if</span> <span class="n">expected_type</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="load_description_and_test-182"><a href="#load_description_and_test-182"><span class="linenos">182</span></a>        <span class="n">_test_expected_resource_type</span><span class="p">(</span><span class="n">rd</span><span class="p">,</span> <span class="n">expected_type</span><span class="p">)</span>
</span><span id="load_description_and_test-183"><a href="#load_description_and_test-183"><span class="linenos">183</span></a>
</span><span id="load_description_and_test-184"><a href="#load_description_and_test-184"><span class="linenos">184</span></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rd</span><span class="p">,</span> <span class="p">(</span><span class="n">v0_4</span><span class="o">.</span><span class="n">ModelDescr</span><span class="p">,</span> <span class="n">v0_5</span><span class="o">.</span><span class="n">ModelDescr</span><span class="p">)):</span>
</span><span id="load_description_and_test-185"><a href="#load_description_and_test-185"><span class="linenos">185</span></a>        <span class="k">if</span> <span class="n">weight_format</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="load_description_and_test-186"><a href="#load_description_and_test-186"><span class="linenos">186</span></a>            <span class="n">weight_formats</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">WeightsFormat</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="load_description_and_test-187"><a href="#load_description_and_test-187"><span class="linenos">187</span></a>                <span class="n">w</span> <span class="k">for</span> <span class="n">w</span><span class="p">,</span> <span class="n">we</span> <span class="ow">in</span> <span class="n">rd</span><span class="o">.</span><span class="n">weights</span> <span class="k">if</span> <span class="n">we</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="load_description_and_test-188"><a href="#load_description_and_test-188"><span class="linenos">188</span></a>            <span class="p">]</span>  <span class="c1"># pyright: ignore[reportAssignmentType]</span>
</span><span id="load_description_and_test-189"><a href="#load_description_and_test-189"><span class="linenos">189</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="load_description_and_test-190"><a href="#load_description_and_test-190"><span class="linenos">190</span></a>            <span class="n">weight_formats</span> <span class="o">=</span> <span class="p">[</span><span class="n">weight_format</span><span class="p">]</span>
</span><span id="load_description_and_test-191"><a href="#load_description_and_test-191"><span class="linenos">191</span></a>
</span><span id="load_description_and_test-192"><a href="#load_description_and_test-192"><span class="linenos">192</span></a>        <span class="k">if</span> <span class="n">decimal</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="load_description_and_test-193"><a href="#load_description_and_test-193"><span class="linenos">193</span></a>            <span class="n">atol</span> <span class="o">=</span> <span class="n">absolute_tolerance</span>
</span><span id="load_description_and_test-194"><a href="#load_description_and_test-194"><span class="linenos">194</span></a>            <span class="n">rtol</span> <span class="o">=</span> <span class="n">relative_tolerance</span>
</span><span id="load_description_and_test-195"><a href="#load_description_and_test-195"><span class="linenos">195</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="load_description_and_test-196"><a href="#load_description_and_test-196"><span class="linenos">196</span></a>            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
</span><span id="load_description_and_test-197"><a href="#load_description_and_test-197"><span class="linenos">197</span></a>                <span class="s2">&quot;The argument `decimal` has been deprecated in favour of&quot;</span>
</span><span id="load_description_and_test-198"><a href="#load_description_and_test-198"><span class="linenos">198</span></a>                <span class="o">+</span> <span class="s2">&quot; `relative_tolerance` and `absolute_tolerance`, with different&quot;</span>
</span><span id="load_description_and_test-199"><a href="#load_description_and_test-199"><span class="linenos">199</span></a>                <span class="o">+</span> <span class="s2">&quot; validation logic, using `numpy.testing.assert_allclose, see&quot;</span>
</span><span id="load_description_and_test-200"><a href="#load_description_and_test-200"><span class="linenos">200</span></a>                <span class="o">+</span> <span class="s2">&quot; &#39;https://numpy.org/doc/stable/reference/generated/&quot;</span>
</span><span id="load_description_and_test-201"><a href="#load_description_and_test-201"><span class="linenos">201</span></a>                <span class="o">+</span> <span class="s2">&quot; numpy.testing.assert_allclose.html&#39;. Passing a value for `decimal`&quot;</span>
</span><span id="load_description_and_test-202"><a href="#load_description_and_test-202"><span class="linenos">202</span></a>                <span class="o">+</span> <span class="s2">&quot; will cause validation to revert to the old behaviour.&quot;</span>
</span><span id="load_description_and_test-203"><a href="#load_description_and_test-203"><span class="linenos">203</span></a>            <span class="p">)</span>
</span><span id="load_description_and_test-204"><a href="#load_description_and_test-204"><span class="linenos">204</span></a>            <span class="n">atol</span> <span class="o">=</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="n">decimal</span><span class="p">)</span>
</span><span id="load_description_and_test-205"><a href="#load_description_and_test-205"><span class="linenos">205</span></a>            <span class="n">rtol</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="load_description_and_test-206"><a href="#load_description_and_test-206"><span class="linenos">206</span></a>
</span><span id="load_description_and_test-207"><a href="#load_description_and_test-207"><span class="linenos">207</span></a>        <span class="n">enable_determinism</span><span class="p">(</span><span class="n">determinism</span><span class="p">)</span>
</span><span id="load_description_and_test-208"><a href="#load_description_and_test-208"><span class="linenos">208</span></a>        <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">weight_formats</span><span class="p">:</span>
</span><span id="load_description_and_test-209"><a href="#load_description_and_test-209"><span class="linenos">209</span></a>            <span class="n">_test_model_inference</span><span class="p">(</span><span class="n">rd</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">devices</span><span class="p">,</span> <span class="n">atol</span><span class="p">,</span> <span class="n">rtol</span><span class="p">)</span>
</span><span id="load_description_and_test-210"><a href="#load_description_and_test-210"><span class="linenos">210</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rd</span><span class="p">,</span> <span class="n">v0_4</span><span class="o">.</span><span class="n">ModelDescr</span><span class="p">):</span>
</span><span id="load_description_and_test-211"><a href="#load_description_and_test-211"><span class="linenos">211</span></a>                <span class="n">_test_model_inference_parametrized</span><span class="p">(</span><span class="n">rd</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">devices</span><span class="p">)</span>
</span><span id="load_description_and_test-212"><a href="#load_description_and_test-212"><span class="linenos">212</span></a>
</span><span id="load_description_and_test-213"><a href="#load_description_and_test-213"><span class="linenos">213</span></a>    <span class="c1"># TODO: add execution of jupyter notebooks</span>
</span><span id="load_description_and_test-214"><a href="#load_description_and_test-214"><span class="linenos">214</span></a>    <span class="c1"># TODO: add more tests</span>
</span><span id="load_description_and_test-215"><a href="#load_description_and_test-215"><span class="linenos">215</span></a>
</span><span id="load_description_and_test-216"><a href="#load_description_and_test-216"><span class="linenos">216</span></a>    <span class="k">return</span> <span class="n">rd</span>
</span></pre></div>


            <div class="docstring"><p>Test RDF dynamically, e.g. model inference of test inputs</p>
</div>


                </section>
                <section id="load_description_and_validate_format_only">
                            <input id="load_description_and_validate_format_only-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">load_description_and_validate_format_only</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">source</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">bioimageio</span><span class="o">.</span><span class="n">spec</span><span class="o">.</span><span class="n">_internal</span><span class="o">.</span><span class="n">url</span><span class="o">.</span><span class="n">HttpUrl</span><span class="p">,</span> <span class="n">bioimageio</span><span class="o">.</span><span class="n">spec</span><span class="o">.</span><span class="n">_internal</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">RelativeFilePath</span><span class="p">,</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span> <span class="n">PathType</span><span class="p">(</span><span class="n">path_type</span><span class="o">=</span><span class="s1">&#39;file&#39;</span><span class="p">)]],</span> <span class="n">FieldInfo</span><span class="p">(</span><span class="n">annotation</span><span class="o">=</span><span class="n">NoneType</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="p">[</span><span class="n">_PydanticGeneralMetadata</span><span class="p">(</span><span class="n">union_mode</span><span class="o">=</span><span class="s1">&#39;left_to_right&#39;</span><span class="p">)])],</span> <span class="nb">str</span><span class="p">,</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">pydantic_core</span><span class="o">.</span><span class="n">_pydantic_core</span><span class="o">.</span><span class="n">Url</span><span class="p">,</span> <span class="n">UrlConstraints</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">2083</span><span class="p">,</span> <span class="n">allowed_schemes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;http&#39;</span><span class="p">,</span> <span class="s1">&#39;https&#39;</span><span class="p">],</span> <span class="n">host_required</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">default_host</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">default_port</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">default_path</span><span class="o">=</span><span class="kc">None</span><span class="p">)],</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">]</span>,</span><span class="param">	<span class="o">/</span>,</span><span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">format_version</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;discover&#39;</span><span class="p">],</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;latest&#39;</span><span class="p">],</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;discover&#39;</span>,</span><span class="param">	<span class="n">perform_io_checks</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">known_files</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">bioimageio</span><span class="o">.</span><span class="n">spec</span><span class="o">.</span><span class="n">_internal</span><span class="o">.</span><span class="n">io_basics</span><span class="o">.</span><span class="n">Sha256</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n"><a href="spec.html#ValidationSummary">bioimageio.spec.ValidationSummary</a></span>:</span></span>

                <label class="view-source-button" for="load_description_and_validate_format_only-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#load_description_and_validate_format_only"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="load_description_and_validate_format_only-137"><a href="#load_description_and_validate_format_only-137"><span class="linenos">137</span></a><span class="k">def</span> <span class="nf">load_description_and_validate_format_only</span><span class="p">(</span>
</span><span id="load_description_and_validate_format_only-138"><a href="#load_description_and_validate_format_only-138"><span class="linenos">138</span></a>    <span class="n">source</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">PermissiveFileSource</span><span class="p">,</span> <span class="n">ZipFile</span><span class="p">],</span>
</span><span id="load_description_and_validate_format_only-139"><a href="#load_description_and_validate_format_only-139"><span class="linenos">139</span></a>    <span class="o">/</span><span class="p">,</span>
</span><span id="load_description_and_validate_format_only-140"><a href="#load_description_and_validate_format_only-140"><span class="linenos">140</span></a>    <span class="o">*</span><span class="p">,</span>
</span><span id="load_description_and_validate_format_only-141"><a href="#load_description_and_validate_format_only-141"><span class="linenos">141</span></a>    <span class="n">format_version</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;discover&quot;</span><span class="p">],</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;latest&quot;</span><span class="p">],</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">DISCOVER</span><span class="p">,</span>
</span><span id="load_description_and_validate_format_only-142"><a href="#load_description_and_validate_format_only-142"><span class="linenos">142</span></a>    <span class="n">perform_io_checks</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">settings</span><span class="o">.</span><span class="n">perform_io_checks</span><span class="p">,</span>
</span><span id="load_description_and_validate_format_only-143"><a href="#load_description_and_validate_format_only-143"><span class="linenos">143</span></a>    <span class="n">known_files</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sha256</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="load_description_and_validate_format_only-144"><a href="#load_description_and_validate_format_only-144"><span class="linenos">144</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ValidationSummary</span><span class="p">:</span>
</span><span id="load_description_and_validate_format_only-145"><a href="#load_description_and_validate_format_only-145"><span class="linenos">145</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;load a bioimage.io resource description</span>
</span><span id="load_description_and_validate_format_only-146"><a href="#load_description_and_validate_format_only-146"><span class="linenos">146</span></a>
</span><span id="load_description_and_validate_format_only-147"><a href="#load_description_and_validate_format_only-147"><span class="linenos">147</span></a><span class="sd">    Args:</span>
</span><span id="load_description_and_validate_format_only-148"><a href="#load_description_and_validate_format_only-148"><span class="linenos">148</span></a><span class="sd">        source: Path or URL to an rdf.yaml or a bioimage.io package</span>
</span><span id="load_description_and_validate_format_only-149"><a href="#load_description_and_validate_format_only-149"><span class="linenos">149</span></a><span class="sd">                (zip-file with rdf.yaml in it).</span>
</span><span id="load_description_and_validate_format_only-150"><a href="#load_description_and_validate_format_only-150"><span class="linenos">150</span></a><span class="sd">        format_version: (optional) Use this argument to load the resource and</span>
</span><span id="load_description_and_validate_format_only-151"><a href="#load_description_and_validate_format_only-151"><span class="linenos">151</span></a><span class="sd">                        convert its metadata to a higher format_version.</span>
</span><span id="load_description_and_validate_format_only-152"><a href="#load_description_and_validate_format_only-152"><span class="linenos">152</span></a><span class="sd">        perform_io_checks: Wether or not to perform validation that requires file io,</span>
</span><span id="load_description_and_validate_format_only-153"><a href="#load_description_and_validate_format_only-153"><span class="linenos">153</span></a><span class="sd">                           e.g. downloading a remote files. The existence of local</span>
</span><span id="load_description_and_validate_format_only-154"><a href="#load_description_and_validate_format_only-154"><span class="linenos">154</span></a><span class="sd">                           absolute file paths is still being checked.</span>
</span><span id="load_description_and_validate_format_only-155"><a href="#load_description_and_validate_format_only-155"><span class="linenos">155</span></a><span class="sd">        known_files: Allows to bypass download and hashing of referenced files</span>
</span><span id="load_description_and_validate_format_only-156"><a href="#load_description_and_validate_format_only-156"><span class="linenos">156</span></a><span class="sd">                     (even if perform_io_checks is True).</span>
</span><span id="load_description_and_validate_format_only-157"><a href="#load_description_and_validate_format_only-157"><span class="linenos">157</span></a>
</span><span id="load_description_and_validate_format_only-158"><a href="#load_description_and_validate_format_only-158"><span class="linenos">158</span></a><span class="sd">    Returns:</span>
</span><span id="load_description_and_validate_format_only-159"><a href="#load_description_and_validate_format_only-159"><span class="linenos">159</span></a><span class="sd">        Validation summary of the bioimage.io resource found at `source`.</span>
</span><span id="load_description_and_validate_format_only-160"><a href="#load_description_and_validate_format_only-160"><span class="linenos">160</span></a>
</span><span id="load_description_and_validate_format_only-161"><a href="#load_description_and_validate_format_only-161"><span class="linenos">161</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="load_description_and_validate_format_only-162"><a href="#load_description_and_validate_format_only-162"><span class="linenos">162</span></a>    <span class="n">rd</span> <span class="o">=</span> <span class="n">load_description</span><span class="p">(</span>
</span><span id="load_description_and_validate_format_only-163"><a href="#load_description_and_validate_format_only-163"><span class="linenos">163</span></a>        <span class="n">source</span><span class="p">,</span>
</span><span id="load_description_and_validate_format_only-164"><a href="#load_description_and_validate_format_only-164"><span class="linenos">164</span></a>        <span class="n">format_version</span><span class="o">=</span><span class="n">format_version</span><span class="p">,</span>
</span><span id="load_description_and_validate_format_only-165"><a href="#load_description_and_validate_format_only-165"><span class="linenos">165</span></a>        <span class="n">perform_io_checks</span><span class="o">=</span><span class="n">perform_io_checks</span><span class="p">,</span>
</span><span id="load_description_and_validate_format_only-166"><a href="#load_description_and_validate_format_only-166"><span class="linenos">166</span></a>        <span class="n">known_files</span><span class="o">=</span><span class="n">known_files</span><span class="p">,</span>
</span><span id="load_description_and_validate_format_only-167"><a href="#load_description_and_validate_format_only-167"><span class="linenos">167</span></a>    <span class="p">)</span>
</span><span id="load_description_and_validate_format_only-168"><a href="#load_description_and_validate_format_only-168"><span class="linenos">168</span></a>    <span class="k">assert</span> <span class="n">rd</span><span class="o">.</span><span class="n">validation_summary</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="load_description_and_validate_format_only-169"><a href="#load_description_and_validate_format_only-169"><span class="linenos">169</span></a>    <span class="k">return</span> <span class="n">rd</span><span class="o">.</span><span class="n">validation_summary</span>
</span></pre></div>


            <div class="docstring"><p>load a bioimage.io resource description</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>source:</strong>  Path or URL to an rdf.yaml or a bioimage.io package
(zip-file with rdf.yaml in it).</li>
<li><strong>format_version:</strong>  (optional) Use this argument to load the resource and
convert its metadata to a higher format_version.</li>
<li><strong>perform_io_checks:</strong>  Wether or not to perform validation that requires file io,
e.g. downloading a remote files. The existence of local
absolute file paths is still being checked.</li>
<li><strong>known_files:</strong>  Allows to bypass download and hashing of referenced files
(even if perform_io_checks is True).</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>Validation summary of the bioimage.io resource found at <code>source</code>.</p>
</blockquote>
</div>


                </section>
                <section id="load_description">
                            <input id="load_description-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">load_description</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">source</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">bioimageio</span><span class="o">.</span><span class="n">spec</span><span class="o">.</span><span class="n">_internal</span><span class="o">.</span><span class="n">url</span><span class="o">.</span><span class="n">HttpUrl</span><span class="p">,</span> <span class="n">bioimageio</span><span class="o">.</span><span class="n">spec</span><span class="o">.</span><span class="n">_internal</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">RelativeFilePath</span><span class="p">,</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span> <span class="n">PathType</span><span class="p">(</span><span class="n">path_type</span><span class="o">=</span><span class="s1">&#39;file&#39;</span><span class="p">)]],</span> <span class="n">FieldInfo</span><span class="p">(</span><span class="n">annotation</span><span class="o">=</span><span class="n">NoneType</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="p">[</span><span class="n">_PydanticGeneralMetadata</span><span class="p">(</span><span class="n">union_mode</span><span class="o">=</span><span class="s1">&#39;left_to_right&#39;</span><span class="p">)])],</span> <span class="nb">str</span><span class="p">,</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">pydantic_core</span><span class="o">.</span><span class="n">_pydantic_core</span><span class="o">.</span><span class="n">Url</span><span class="p">,</span> <span class="n">UrlConstraints</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">2083</span><span class="p">,</span> <span class="n">allowed_schemes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;http&#39;</span><span class="p">,</span> <span class="s1">&#39;https&#39;</span><span class="p">],</span> <span class="n">host_required</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">default_host</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">default_port</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">default_path</span><span class="o">=</span><span class="kc">None</span><span class="p">)],</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">]</span>,</span><span class="param">	<span class="o">/</span>,</span><span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">format_version</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;discover&#39;</span><span class="p">],</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;latest&#39;</span><span class="p">],</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;discover&#39;</span>,</span><span class="param">	<span class="n">perform_io_checks</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">known_files</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">bioimageio</span><span class="o">.</span><span class="n">spec</span><span class="o">.</span><span class="n">_internal</span><span class="o">.</span><span class="n">io_basics</span><span class="o">.</span><span class="n">Sha256</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n">Union</span><span class="p">[</span><span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n"><a href="spec/application/v0_2.html#ApplicationDescr">bioimageio.spec.application.v0_2.ApplicationDescr</a></span><span class="p">,</span> <span class="n"><a href="spec.html#ApplicationDescr">bioimageio.spec.ApplicationDescr</a></span><span class="p">],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=</span><span class="s1">&#39;format_version&#39;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)],</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n"><a href="spec/dataset/v0_2.html#DatasetDescr">bioimageio.spec.dataset.v0_2.DatasetDescr</a></span><span class="p">,</span> <span class="n"><a href="spec.html#DatasetDescr">bioimageio.spec.DatasetDescr</a></span><span class="p">],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=</span><span class="s1">&#39;format_version&#39;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)],</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n"><a href="spec/model/v0_4.html#ModelDescr">bioimageio.spec.model.v0_4.ModelDescr</a></span><span class="p">,</span> <span class="n"><a href="spec.html#ModelDescr">bioimageio.spec.ModelDescr</a></span><span class="p">],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=</span><span class="s1">&#39;format_version&#39;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)],</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n"><a href="spec.html#NotebookDescr">bioimageio.spec.NotebookDescr</a></span><span class="p">,</span> <span class="n"><a href="spec.html#NotebookDescr">bioimageio.spec.NotebookDescr</a></span><span class="p">],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=</span><span class="s1">&#39;format_version&#39;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)]],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=</span><span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)],</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n"><a href="spec/generic/v0_2.html#GenericDescr">bioimageio.spec.generic.v0_2.GenericDescr</a></span><span class="p">,</span> <span class="n"><a href="spec.html#GenericDescr">bioimageio.spec.GenericDescr</a></span><span class="p">],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=</span><span class="s1">&#39;format_version&#39;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)],</span> <span class="n"><a href="spec.html#InvalidDescr">bioimageio.spec.InvalidDescr</a></span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="load_description-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#load_description"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="load_description-29"><a href="#load_description-29"><span class="linenos">29</span></a><span class="k">def</span> <span class="nf">load_description</span><span class="p">(</span>
</span><span id="load_description-30"><a href="#load_description-30"><span class="linenos">30</span></a>    <span class="n">source</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">PermissiveFileSource</span><span class="p">,</span> <span class="n">ZipFile</span><span class="p">],</span>
</span><span id="load_description-31"><a href="#load_description-31"><span class="linenos">31</span></a>    <span class="o">/</span><span class="p">,</span>
</span><span id="load_description-32"><a href="#load_description-32"><span class="linenos">32</span></a>    <span class="o">*</span><span class="p">,</span>
</span><span id="load_description-33"><a href="#load_description-33"><span class="linenos">33</span></a>    <span class="n">format_version</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;discover&quot;</span><span class="p">],</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;latest&quot;</span><span class="p">],</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">DISCOVER</span><span class="p">,</span>
</span><span id="load_description-34"><a href="#load_description-34"><span class="linenos">34</span></a>    <span class="n">perform_io_checks</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">settings</span><span class="o">.</span><span class="n">perform_io_checks</span><span class="p">,</span>
</span><span id="load_description-35"><a href="#load_description-35"><span class="linenos">35</span></a>    <span class="n">known_files</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sha256</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="load_description-36"><a href="#load_description-36"><span class="linenos">36</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">ResourceDescr</span><span class="p">,</span> <span class="n">InvalidDescr</span><span class="p">]:</span>
</span><span id="load_description-37"><a href="#load_description-37"><span class="linenos">37</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;load a bioimage.io resource description</span>
</span><span id="load_description-38"><a href="#load_description-38"><span class="linenos">38</span></a>
</span><span id="load_description-39"><a href="#load_description-39"><span class="linenos">39</span></a><span class="sd">    Args:</span>
</span><span id="load_description-40"><a href="#load_description-40"><span class="linenos">40</span></a><span class="sd">        source: Path or URL to an rdf.yaml or a bioimage.io package</span>
</span><span id="load_description-41"><a href="#load_description-41"><span class="linenos">41</span></a><span class="sd">                (zip-file with rdf.yaml in it).</span>
</span><span id="load_description-42"><a href="#load_description-42"><span class="linenos">42</span></a><span class="sd">        format_version: (optional) Use this argument to load the resource and</span>
</span><span id="load_description-43"><a href="#load_description-43"><span class="linenos">43</span></a><span class="sd">                        convert its metadata to a higher format_version.</span>
</span><span id="load_description-44"><a href="#load_description-44"><span class="linenos">44</span></a><span class="sd">        perform_io_checks: Wether or not to perform validation that requires file io,</span>
</span><span id="load_description-45"><a href="#load_description-45"><span class="linenos">45</span></a><span class="sd">                           e.g. downloading a remote files. The existence of local</span>
</span><span id="load_description-46"><a href="#load_description-46"><span class="linenos">46</span></a><span class="sd">                           absolute file paths is still being checked.</span>
</span><span id="load_description-47"><a href="#load_description-47"><span class="linenos">47</span></a><span class="sd">        known_files: Allows to bypass download and hashing of referenced files</span>
</span><span id="load_description-48"><a href="#load_description-48"><span class="linenos">48</span></a><span class="sd">                     (even if perform_io_checks is True).</span>
</span><span id="load_description-49"><a href="#load_description-49"><span class="linenos">49</span></a>
</span><span id="load_description-50"><a href="#load_description-50"><span class="linenos">50</span></a><span class="sd">    Returns:</span>
</span><span id="load_description-51"><a href="#load_description-51"><span class="linenos">51</span></a><span class="sd">        An object holding all metadata of the bioimage.io resource</span>
</span><span id="load_description-52"><a href="#load_description-52"><span class="linenos">52</span></a>
</span><span id="load_description-53"><a href="#load_description-53"><span class="linenos">53</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="load_description-54"><a href="#load_description-54"><span class="linenos">54</span></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">ResourceDescrBase</span><span class="p">):</span>
</span><span id="load_description-55"><a href="#load_description-55"><span class="linenos">55</span></a>        <span class="n">name</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">source</span><span class="p">)[:</span><span class="mi">10</span><span class="p">]</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>
</span><span id="load_description-56"><a href="#load_description-56"><span class="linenos">56</span></a>        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;returning already loaded description &#39;</span><span class="si">{}</span><span class="s2">&#39; as is&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
</span><span id="load_description-57"><a href="#load_description-57"><span class="linenos">57</span></a>        <span class="k">return</span> <span class="n">source</span>  <span class="c1"># pyright: ignore[reportReturnType]</span>
</span><span id="load_description-58"><a href="#load_description-58"><span class="linenos">58</span></a>
</span><span id="load_description-59"><a href="#load_description-59"><span class="linenos">59</span></a>    <span class="n">opened</span> <span class="o">=</span> <span class="n">open_bioimageio_yaml</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
</span><span id="load_description-60"><a href="#load_description-60"><span class="linenos">60</span></a>
</span><span id="load_description-61"><a href="#load_description-61"><span class="linenos">61</span></a>    <span class="n">context</span> <span class="o">=</span> <span class="n">validation_context_var</span><span class="o">.</span><span class="n">get</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
</span><span id="load_description-62"><a href="#load_description-62"><span class="linenos">62</span></a>        <span class="n">root</span><span class="o">=</span><span class="n">opened</span><span class="o">.</span><span class="n">original_root</span><span class="p">,</span>
</span><span id="load_description-63"><a href="#load_description-63"><span class="linenos">63</span></a>        <span class="n">file_name</span><span class="o">=</span><span class="n">opened</span><span class="o">.</span><span class="n">original_file_name</span><span class="p">,</span>
</span><span id="load_description-64"><a href="#load_description-64"><span class="linenos">64</span></a>        <span class="n">perform_io_checks</span><span class="o">=</span><span class="n">perform_io_checks</span><span class="p">,</span>
</span><span id="load_description-65"><a href="#load_description-65"><span class="linenos">65</span></a>        <span class="n">known_files</span><span class="o">=</span><span class="n">known_files</span><span class="p">,</span>
</span><span id="load_description-66"><a href="#load_description-66"><span class="linenos">66</span></a>    <span class="p">)</span>
</span><span id="load_description-67"><a href="#load_description-67"><span class="linenos">67</span></a>
</span><span id="load_description-68"><a href="#load_description-68"><span class="linenos">68</span></a>    <span class="k">return</span> <span class="n">build_description</span><span class="p">(</span>
</span><span id="load_description-69"><a href="#load_description-69"><span class="linenos">69</span></a>        <span class="n">opened</span><span class="o">.</span><span class="n">content</span><span class="p">,</span>
</span><span id="load_description-70"><a href="#load_description-70"><span class="linenos">70</span></a>        <span class="n">context</span><span class="o">=</span><span class="n">context</span><span class="p">,</span>
</span><span id="load_description-71"><a href="#load_description-71"><span class="linenos">71</span></a>        <span class="n">format_version</span><span class="o">=</span><span class="n">format_version</span><span class="p">,</span>
</span><span id="load_description-72"><a href="#load_description-72"><span class="linenos">72</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>load a bioimage.io resource description</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>source:</strong>  Path or URL to an rdf.yaml or a bioimage.io package
(zip-file with rdf.yaml in it).</li>
<li><strong>format_version:</strong>  (optional) Use this argument to load the resource and
convert its metadata to a higher format_version.</li>
<li><strong>perform_io_checks:</strong>  Wether or not to perform validation that requires file io,
e.g. downloading a remote files. The existence of local
absolute file paths is still being checked.</li>
<li><strong>known_files:</strong>  Allows to bypass download and hashing of referenced files
(even if perform_io_checks is True).</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>An object holding all metadata of the bioimage.io resource</p>
</blockquote>
</div>


                </section>
                <section id="load_model_description">
                            <input id="load_model_description-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">load_model_description</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">source</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">bioimageio</span><span class="o">.</span><span class="n">spec</span><span class="o">.</span><span class="n">_internal</span><span class="o">.</span><span class="n">url</span><span class="o">.</span><span class="n">HttpUrl</span><span class="p">,</span> <span class="n">bioimageio</span><span class="o">.</span><span class="n">spec</span><span class="o">.</span><span class="n">_internal</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">RelativeFilePath</span><span class="p">,</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span> <span class="n">PathType</span><span class="p">(</span><span class="n">path_type</span><span class="o">=</span><span class="s1">&#39;file&#39;</span><span class="p">)]],</span> <span class="n">FieldInfo</span><span class="p">(</span><span class="n">annotation</span><span class="o">=</span><span class="n">NoneType</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="p">[</span><span class="n">_PydanticGeneralMetadata</span><span class="p">(</span><span class="n">union_mode</span><span class="o">=</span><span class="s1">&#39;left_to_right&#39;</span><span class="p">)])],</span> <span class="nb">str</span><span class="p">,</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">pydantic_core</span><span class="o">.</span><span class="n">_pydantic_core</span><span class="o">.</span><span class="n">Url</span><span class="p">,</span> <span class="n">UrlConstraints</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">2083</span><span class="p">,</span> <span class="n">allowed_schemes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;http&#39;</span><span class="p">,</span> <span class="s1">&#39;https&#39;</span><span class="p">],</span> <span class="n">host_required</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">default_host</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">default_port</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">default_path</span><span class="o">=</span><span class="kc">None</span><span class="p">)],</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">]</span>,</span><span class="param">	<span class="o">/</span>,</span><span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">format_version</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;discover&#39;</span><span class="p">],</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;latest&#39;</span><span class="p">],</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;discover&#39;</span>,</span><span class="param">	<span class="n">perform_io_checks</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">known_files</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">bioimageio</span><span class="o">.</span><span class="n">spec</span><span class="o">.</span><span class="n">_internal</span><span class="o">.</span><span class="n">io_basics</span><span class="o">.</span><span class="n">Sha256</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n"><a href="spec/model/v0_4.html#ModelDescr">bioimageio.spec.model.v0_4.ModelDescr</a></span><span class="p">,</span> <span class="n"><a href="spec.html#ModelDescr">bioimageio.spec.ModelDescr</a></span><span class="p">],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=</span><span class="s1">&#39;format_version&#39;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)]</span>:</span></span>

                <label class="view-source-button" for="load_model_description-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#load_model_description"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="load_model_description-75"><a href="#load_model_description-75"><span class="linenos">75</span></a><span class="k">def</span> <span class="nf">load_model_description</span><span class="p">(</span>
</span><span id="load_model_description-76"><a href="#load_model_description-76"><span class="linenos">76</span></a>    <span class="n">source</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">PermissiveFileSource</span><span class="p">,</span> <span class="n">ZipFile</span><span class="p">],</span>
</span><span id="load_model_description-77"><a href="#load_model_description-77"><span class="linenos">77</span></a>    <span class="o">/</span><span class="p">,</span>
</span><span id="load_model_description-78"><a href="#load_model_description-78"><span class="linenos">78</span></a>    <span class="o">*</span><span class="p">,</span>
</span><span id="load_model_description-79"><a href="#load_model_description-79"><span class="linenos">79</span></a>    <span class="n">format_version</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;discover&quot;</span><span class="p">],</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;latest&quot;</span><span class="p">],</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">DISCOVER</span><span class="p">,</span>
</span><span id="load_model_description-80"><a href="#load_model_description-80"><span class="linenos">80</span></a>    <span class="n">perform_io_checks</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">settings</span><span class="o">.</span><span class="n">perform_io_checks</span><span class="p">,</span>
</span><span id="load_model_description-81"><a href="#load_model_description-81"><span class="linenos">81</span></a>    <span class="n">known_files</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sha256</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="load_model_description-82"><a href="#load_model_description-82"><span class="linenos">82</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AnyModelDescr</span><span class="p">:</span>
</span><span id="load_model_description-83"><a href="#load_model_description-83"><span class="linenos">83</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;same as `load_description`, but addtionally ensures that the loaded</span>
</span><span id="load_model_description-84"><a href="#load_model_description-84"><span class="linenos">84</span></a><span class="sd">    description is valid and of type &#39;model&#39;.</span>
</span><span id="load_model_description-85"><a href="#load_model_description-85"><span class="linenos">85</span></a>
</span><span id="load_model_description-86"><a href="#load_model_description-86"><span class="linenos">86</span></a><span class="sd">    Raises:</span>
</span><span id="load_model_description-87"><a href="#load_model_description-87"><span class="linenos">87</span></a><span class="sd">        ValueError: for invalid or non-model resources</span>
</span><span id="load_model_description-88"><a href="#load_model_description-88"><span class="linenos">88</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="load_model_description-89"><a href="#load_model_description-89"><span class="linenos">89</span></a>    <span class="n">rd</span> <span class="o">=</span> <span class="n">load_description</span><span class="p">(</span>
</span><span id="load_model_description-90"><a href="#load_model_description-90"><span class="linenos">90</span></a>        <span class="n">source</span><span class="p">,</span>
</span><span id="load_model_description-91"><a href="#load_model_description-91"><span class="linenos">91</span></a>        <span class="n">format_version</span><span class="o">=</span><span class="n">format_version</span><span class="p">,</span>
</span><span id="load_model_description-92"><a href="#load_model_description-92"><span class="linenos">92</span></a>        <span class="n">perform_io_checks</span><span class="o">=</span><span class="n">perform_io_checks</span><span class="p">,</span>
</span><span id="load_model_description-93"><a href="#load_model_description-93"><span class="linenos">93</span></a>        <span class="n">known_files</span><span class="o">=</span><span class="n">known_files</span><span class="p">,</span>
</span><span id="load_model_description-94"><a href="#load_model_description-94"><span class="linenos">94</span></a>    <span class="p">)</span>
</span><span id="load_model_description-95"><a href="#load_model_description-95"><span class="linenos">95</span></a>    <span class="k">return</span> <span class="n">ensure_description_is_model</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>same as <code><a href="#load_description">load_description</a></code>, but addtionally ensures that the loaded
description is valid and of type 'model'.</p>

<h6 id="raises">Raises:</h6>

<ul>
<li><strong>ValueError:</strong>  for invalid or non-model resources</li>
</ul>
</div>


                </section>
                <section id="load_model">
                            <input id="load_model-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">load_model</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">source</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">bioimageio</span><span class="o">.</span><span class="n">spec</span><span class="o">.</span><span class="n">_internal</span><span class="o">.</span><span class="n">url</span><span class="o">.</span><span class="n">HttpUrl</span><span class="p">,</span> <span class="n">bioimageio</span><span class="o">.</span><span class="n">spec</span><span class="o">.</span><span class="n">_internal</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">RelativeFilePath</span><span class="p">,</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span> <span class="n">PathType</span><span class="p">(</span><span class="n">path_type</span><span class="o">=</span><span class="s1">&#39;file&#39;</span><span class="p">)]],</span> <span class="n">FieldInfo</span><span class="p">(</span><span class="n">annotation</span><span class="o">=</span><span class="n">NoneType</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="p">[</span><span class="n">_PydanticGeneralMetadata</span><span class="p">(</span><span class="n">union_mode</span><span class="o">=</span><span class="s1">&#39;left_to_right&#39;</span><span class="p">)])],</span> <span class="nb">str</span><span class="p">,</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">pydantic_core</span><span class="o">.</span><span class="n">_pydantic_core</span><span class="o">.</span><span class="n">Url</span><span class="p">,</span> <span class="n">UrlConstraints</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">2083</span><span class="p">,</span> <span class="n">allowed_schemes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;http&#39;</span><span class="p">,</span> <span class="s1">&#39;https&#39;</span><span class="p">],</span> <span class="n">host_required</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">default_host</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">default_port</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">default_path</span><span class="o">=</span><span class="kc">None</span><span class="p">)],</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">]</span>,</span><span class="param">	<span class="o">/</span>,</span><span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">format_version</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;discover&#39;</span><span class="p">],</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;latest&#39;</span><span class="p">],</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;discover&#39;</span>,</span><span class="param">	<span class="n">perform_io_checks</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">known_files</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">bioimageio</span><span class="o">.</span><span class="n">spec</span><span class="o">.</span><span class="n">_internal</span><span class="o">.</span><span class="n">io_basics</span><span class="o">.</span><span class="n">Sha256</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n"><a href="spec/model/v0_4.html#ModelDescr">bioimageio.spec.model.v0_4.ModelDescr</a></span><span class="p">,</span> <span class="n"><a href="spec.html#ModelDescr">bioimageio.spec.ModelDescr</a></span><span class="p">],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=</span><span class="s1">&#39;format_version&#39;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)]</span>:</span></span>

                <label class="view-source-button" for="load_model-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#load_model"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="load_model-75"><a href="#load_model-75"><span class="linenos">75</span></a><span class="k">def</span> <span class="nf">load_model_description</span><span class="p">(</span>
</span><span id="load_model-76"><a href="#load_model-76"><span class="linenos">76</span></a>    <span class="n">source</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">PermissiveFileSource</span><span class="p">,</span> <span class="n">ZipFile</span><span class="p">],</span>
</span><span id="load_model-77"><a href="#load_model-77"><span class="linenos">77</span></a>    <span class="o">/</span><span class="p">,</span>
</span><span id="load_model-78"><a href="#load_model-78"><span class="linenos">78</span></a>    <span class="o">*</span><span class="p">,</span>
</span><span id="load_model-79"><a href="#load_model-79"><span class="linenos">79</span></a>    <span class="n">format_version</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;discover&quot;</span><span class="p">],</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;latest&quot;</span><span class="p">],</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">DISCOVER</span><span class="p">,</span>
</span><span id="load_model-80"><a href="#load_model-80"><span class="linenos">80</span></a>    <span class="n">perform_io_checks</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">settings</span><span class="o">.</span><span class="n">perform_io_checks</span><span class="p">,</span>
</span><span id="load_model-81"><a href="#load_model-81"><span class="linenos">81</span></a>    <span class="n">known_files</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sha256</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="load_model-82"><a href="#load_model-82"><span class="linenos">82</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AnyModelDescr</span><span class="p">:</span>
</span><span id="load_model-83"><a href="#load_model-83"><span class="linenos">83</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;same as `load_description`, but addtionally ensures that the loaded</span>
</span><span id="load_model-84"><a href="#load_model-84"><span class="linenos">84</span></a><span class="sd">    description is valid and of type &#39;model&#39;.</span>
</span><span id="load_model-85"><a href="#load_model-85"><span class="linenos">85</span></a>
</span><span id="load_model-86"><a href="#load_model-86"><span class="linenos">86</span></a><span class="sd">    Raises:</span>
</span><span id="load_model-87"><a href="#load_model-87"><span class="linenos">87</span></a><span class="sd">        ValueError: for invalid or non-model resources</span>
</span><span id="load_model-88"><a href="#load_model-88"><span class="linenos">88</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="load_model-89"><a href="#load_model-89"><span class="linenos">89</span></a>    <span class="n">rd</span> <span class="o">=</span> <span class="n">load_description</span><span class="p">(</span>
</span><span id="load_model-90"><a href="#load_model-90"><span class="linenos">90</span></a>        <span class="n">source</span><span class="p">,</span>
</span><span id="load_model-91"><a href="#load_model-91"><span class="linenos">91</span></a>        <span class="n">format_version</span><span class="o">=</span><span class="n">format_version</span><span class="p">,</span>
</span><span id="load_model-92"><a href="#load_model-92"><span class="linenos">92</span></a>        <span class="n">perform_io_checks</span><span class="o">=</span><span class="n">perform_io_checks</span><span class="p">,</span>
</span><span id="load_model-93"><a href="#load_model-93"><span class="linenos">93</span></a>        <span class="n">known_files</span><span class="o">=</span><span class="n">known_files</span><span class="p">,</span>
</span><span id="load_model-94"><a href="#load_model-94"><span class="linenos">94</span></a>    <span class="p">)</span>
</span><span id="load_model-95"><a href="#load_model-95"><span class="linenos">95</span></a>    <span class="k">return</span> <span class="n">ensure_description_is_model</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>alias of <code><a href="#load_model_description">load_model_description</a></code></p>
</div>


                </section>
                <section id="load_resource">
                            <input id="load_resource-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">load_resource</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">source</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">bioimageio</span><span class="o">.</span><span class="n">spec</span><span class="o">.</span><span class="n">_internal</span><span class="o">.</span><span class="n">url</span><span class="o">.</span><span class="n">HttpUrl</span><span class="p">,</span> <span class="n">bioimageio</span><span class="o">.</span><span class="n">spec</span><span class="o">.</span><span class="n">_internal</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">RelativeFilePath</span><span class="p">,</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span> <span class="n">PathType</span><span class="p">(</span><span class="n">path_type</span><span class="o">=</span><span class="s1">&#39;file&#39;</span><span class="p">)]],</span> <span class="n">FieldInfo</span><span class="p">(</span><span class="n">annotation</span><span class="o">=</span><span class="n">NoneType</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="p">[</span><span class="n">_PydanticGeneralMetadata</span><span class="p">(</span><span class="n">union_mode</span><span class="o">=</span><span class="s1">&#39;left_to_right&#39;</span><span class="p">)])],</span> <span class="nb">str</span><span class="p">,</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">pydantic_core</span><span class="o">.</span><span class="n">_pydantic_core</span><span class="o">.</span><span class="n">Url</span><span class="p">,</span> <span class="n">UrlConstraints</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">2083</span><span class="p">,</span> <span class="n">allowed_schemes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;http&#39;</span><span class="p">,</span> <span class="s1">&#39;https&#39;</span><span class="p">],</span> <span class="n">host_required</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">default_host</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">default_port</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">default_path</span><span class="o">=</span><span class="kc">None</span><span class="p">)],</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">]</span>,</span><span class="param">	<span class="o">/</span>,</span><span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">format_version</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;discover&#39;</span><span class="p">],</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;latest&#39;</span><span class="p">],</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;discover&#39;</span>,</span><span class="param">	<span class="n">perform_io_checks</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">known_files</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">bioimageio</span><span class="o">.</span><span class="n">spec</span><span class="o">.</span><span class="n">_internal</span><span class="o">.</span><span class="n">io_basics</span><span class="o">.</span><span class="n">Sha256</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n">Union</span><span class="p">[</span><span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n"><a href="spec/application/v0_2.html#ApplicationDescr">bioimageio.spec.application.v0_2.ApplicationDescr</a></span><span class="p">,</span> <span class="n"><a href="spec.html#ApplicationDescr">bioimageio.spec.ApplicationDescr</a></span><span class="p">],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=</span><span class="s1">&#39;format_version&#39;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)],</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n"><a href="spec/dataset/v0_2.html#DatasetDescr">bioimageio.spec.dataset.v0_2.DatasetDescr</a></span><span class="p">,</span> <span class="n"><a href="spec.html#DatasetDescr">bioimageio.spec.DatasetDescr</a></span><span class="p">],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=</span><span class="s1">&#39;format_version&#39;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)],</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n"><a href="spec/model/v0_4.html#ModelDescr">bioimageio.spec.model.v0_4.ModelDescr</a></span><span class="p">,</span> <span class="n"><a href="spec.html#ModelDescr">bioimageio.spec.ModelDescr</a></span><span class="p">],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=</span><span class="s1">&#39;format_version&#39;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)],</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n"><a href="spec.html#NotebookDescr">bioimageio.spec.NotebookDescr</a></span><span class="p">,</span> <span class="n"><a href="spec.html#NotebookDescr">bioimageio.spec.NotebookDescr</a></span><span class="p">],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=</span><span class="s1">&#39;format_version&#39;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)]],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=</span><span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)],</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n"><a href="spec/generic/v0_2.html#GenericDescr">bioimageio.spec.generic.v0_2.GenericDescr</a></span><span class="p">,</span> <span class="n"><a href="spec.html#GenericDescr">bioimageio.spec.GenericDescr</a></span><span class="p">],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=</span><span class="s1">&#39;format_version&#39;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)],</span> <span class="n"><a href="spec.html#InvalidDescr">bioimageio.spec.InvalidDescr</a></span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="load_resource-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#load_resource"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="load_resource-29"><a href="#load_resource-29"><span class="linenos">29</span></a><span class="k">def</span> <span class="nf">load_description</span><span class="p">(</span>
</span><span id="load_resource-30"><a href="#load_resource-30"><span class="linenos">30</span></a>    <span class="n">source</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">PermissiveFileSource</span><span class="p">,</span> <span class="n">ZipFile</span><span class="p">],</span>
</span><span id="load_resource-31"><a href="#load_resource-31"><span class="linenos">31</span></a>    <span class="o">/</span><span class="p">,</span>
</span><span id="load_resource-32"><a href="#load_resource-32"><span class="linenos">32</span></a>    <span class="o">*</span><span class="p">,</span>
</span><span id="load_resource-33"><a href="#load_resource-33"><span class="linenos">33</span></a>    <span class="n">format_version</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;discover&quot;</span><span class="p">],</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;latest&quot;</span><span class="p">],</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">DISCOVER</span><span class="p">,</span>
</span><span id="load_resource-34"><a href="#load_resource-34"><span class="linenos">34</span></a>    <span class="n">perform_io_checks</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">settings</span><span class="o">.</span><span class="n">perform_io_checks</span><span class="p">,</span>
</span><span id="load_resource-35"><a href="#load_resource-35"><span class="linenos">35</span></a>    <span class="n">known_files</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sha256</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="load_resource-36"><a href="#load_resource-36"><span class="linenos">36</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">ResourceDescr</span><span class="p">,</span> <span class="n">InvalidDescr</span><span class="p">]:</span>
</span><span id="load_resource-37"><a href="#load_resource-37"><span class="linenos">37</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;load a bioimage.io resource description</span>
</span><span id="load_resource-38"><a href="#load_resource-38"><span class="linenos">38</span></a>
</span><span id="load_resource-39"><a href="#load_resource-39"><span class="linenos">39</span></a><span class="sd">    Args:</span>
</span><span id="load_resource-40"><a href="#load_resource-40"><span class="linenos">40</span></a><span class="sd">        source: Path or URL to an rdf.yaml or a bioimage.io package</span>
</span><span id="load_resource-41"><a href="#load_resource-41"><span class="linenos">41</span></a><span class="sd">                (zip-file with rdf.yaml in it).</span>
</span><span id="load_resource-42"><a href="#load_resource-42"><span class="linenos">42</span></a><span class="sd">        format_version: (optional) Use this argument to load the resource and</span>
</span><span id="load_resource-43"><a href="#load_resource-43"><span class="linenos">43</span></a><span class="sd">                        convert its metadata to a higher format_version.</span>
</span><span id="load_resource-44"><a href="#load_resource-44"><span class="linenos">44</span></a><span class="sd">        perform_io_checks: Wether or not to perform validation that requires file io,</span>
</span><span id="load_resource-45"><a href="#load_resource-45"><span class="linenos">45</span></a><span class="sd">                           e.g. downloading a remote files. The existence of local</span>
</span><span id="load_resource-46"><a href="#load_resource-46"><span class="linenos">46</span></a><span class="sd">                           absolute file paths is still being checked.</span>
</span><span id="load_resource-47"><a href="#load_resource-47"><span class="linenos">47</span></a><span class="sd">        known_files: Allows to bypass download and hashing of referenced files</span>
</span><span id="load_resource-48"><a href="#load_resource-48"><span class="linenos">48</span></a><span class="sd">                     (even if perform_io_checks is True).</span>
</span><span id="load_resource-49"><a href="#load_resource-49"><span class="linenos">49</span></a>
</span><span id="load_resource-50"><a href="#load_resource-50"><span class="linenos">50</span></a><span class="sd">    Returns:</span>
</span><span id="load_resource-51"><a href="#load_resource-51"><span class="linenos">51</span></a><span class="sd">        An object holding all metadata of the bioimage.io resource</span>
</span><span id="load_resource-52"><a href="#load_resource-52"><span class="linenos">52</span></a>
</span><span id="load_resource-53"><a href="#load_resource-53"><span class="linenos">53</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="load_resource-54"><a href="#load_resource-54"><span class="linenos">54</span></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">ResourceDescrBase</span><span class="p">):</span>
</span><span id="load_resource-55"><a href="#load_resource-55"><span class="linenos">55</span></a>        <span class="n">name</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">source</span><span class="p">)[:</span><span class="mi">10</span><span class="p">]</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>
</span><span id="load_resource-56"><a href="#load_resource-56"><span class="linenos">56</span></a>        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;returning already loaded description &#39;</span><span class="si">{}</span><span class="s2">&#39; as is&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
</span><span id="load_resource-57"><a href="#load_resource-57"><span class="linenos">57</span></a>        <span class="k">return</span> <span class="n">source</span>  <span class="c1"># pyright: ignore[reportReturnType]</span>
</span><span id="load_resource-58"><a href="#load_resource-58"><span class="linenos">58</span></a>
</span><span id="load_resource-59"><a href="#load_resource-59"><span class="linenos">59</span></a>    <span class="n">opened</span> <span class="o">=</span> <span class="n">open_bioimageio_yaml</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
</span><span id="load_resource-60"><a href="#load_resource-60"><span class="linenos">60</span></a>
</span><span id="load_resource-61"><a href="#load_resource-61"><span class="linenos">61</span></a>    <span class="n">context</span> <span class="o">=</span> <span class="n">validation_context_var</span><span class="o">.</span><span class="n">get</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
</span><span id="load_resource-62"><a href="#load_resource-62"><span class="linenos">62</span></a>        <span class="n">root</span><span class="o">=</span><span class="n">opened</span><span class="o">.</span><span class="n">original_root</span><span class="p">,</span>
</span><span id="load_resource-63"><a href="#load_resource-63"><span class="linenos">63</span></a>        <span class="n">file_name</span><span class="o">=</span><span class="n">opened</span><span class="o">.</span><span class="n">original_file_name</span><span class="p">,</span>
</span><span id="load_resource-64"><a href="#load_resource-64"><span class="linenos">64</span></a>        <span class="n">perform_io_checks</span><span class="o">=</span><span class="n">perform_io_checks</span><span class="p">,</span>
</span><span id="load_resource-65"><a href="#load_resource-65"><span class="linenos">65</span></a>        <span class="n">known_files</span><span class="o">=</span><span class="n">known_files</span><span class="p">,</span>
</span><span id="load_resource-66"><a href="#load_resource-66"><span class="linenos">66</span></a>    <span class="p">)</span>
</span><span id="load_resource-67"><a href="#load_resource-67"><span class="linenos">67</span></a>
</span><span id="load_resource-68"><a href="#load_resource-68"><span class="linenos">68</span></a>    <span class="k">return</span> <span class="n">build_description</span><span class="p">(</span>
</span><span id="load_resource-69"><a href="#load_resource-69"><span class="linenos">69</span></a>        <span class="n">opened</span><span class="o">.</span><span class="n">content</span><span class="p">,</span>
</span><span id="load_resource-70"><a href="#load_resource-70"><span class="linenos">70</span></a>        <span class="n">context</span><span class="o">=</span><span class="n">context</span><span class="p">,</span>
</span><span id="load_resource-71"><a href="#load_resource-71"><span class="linenos">71</span></a>        <span class="n">format_version</span><span class="o">=</span><span class="n">format_version</span><span class="p">,</span>
</span><span id="load_resource-72"><a href="#load_resource-72"><span class="linenos">72</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>alias of <code><a href="#load_description">load_description</a></code></p>
</div>


                </section>
                <section id="MemberId">
                    <div class="attr variable">
            <span class="name">MemberId</span>        =
<span class="default_value">&lt;class &#39;<a href="spec/model/v0_5.html#TensorId">bioimageio.spec.model.v0_5.TensorId</a>&#39;&gt;</span>

        
    </div>
    <a class="headerlink" href="#MemberId"></a>
    
    

                </section>
                <section id="predict_many">
                            <input id="predict_many-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">predict_many</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">model</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">bioimageio</span><span class="o">.</span><span class="n">spec</span><span class="o">.</span><span class="n">_internal</span><span class="o">.</span><span class="n">url</span><span class="o">.</span><span class="n">HttpUrl</span><span class="p">,</span> <span class="n">bioimageio</span><span class="o">.</span><span class="n">spec</span><span class="o">.</span><span class="n">_internal</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">RelativeFilePath</span><span class="p">,</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span> <span class="n">PathType</span><span class="p">(</span><span class="n">path_type</span><span class="o">=</span><span class="s1">&#39;file&#39;</span><span class="p">)]],</span> <span class="n">FieldInfo</span><span class="p">(</span><span class="n">annotation</span><span class="o">=</span><span class="n">NoneType</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="p">[</span><span class="n">_PydanticGeneralMetadata</span><span class="p">(</span><span class="n">union_mode</span><span class="o">=</span><span class="s1">&#39;left_to_right&#39;</span><span class="p">)])],</span> <span class="nb">str</span><span class="p">,</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">pydantic_core</span><span class="o">.</span><span class="n">_pydantic_core</span><span class="o">.</span><span class="n">Url</span><span class="p">,</span> <span class="n">UrlConstraints</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">2083</span><span class="p">,</span> <span class="n">allowed_schemes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;http&#39;</span><span class="p">,</span> <span class="s1">&#39;https&#39;</span><span class="p">],</span> <span class="n">host_required</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">default_host</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">default_port</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">default_path</span><span class="o">=</span><span class="kc">None</span><span class="p">)],</span> <span class="n"><a href="spec/model/v0_4.html#ModelDescr">bioimageio.spec.model.v0_4.ModelDescr</a></span><span class="p">,</span> <span class="n"><a href="spec.html#ModelDescr">bioimageio.spec.ModelDescr</a></span><span class="p">,</span> <span class="n"><a href="#PredictionPipeline">PredictionPipeline</a></span><span class="p">]</span>,</span><span class="param">	<span class="n">inputs</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Mapping</span><span class="p">[</span><span class="n"><a href="spec/model/v0_5.html#TensorId">bioimageio.spec.model.v0_5.TensorId</a></span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="n"><a href="#Tensor">Tensor</a></span><span class="p">,</span> <span class="n">xarray</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">dataarray</span><span class="o">.</span><span class="n">DataArray</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">Any</span><span class="p">]],</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">]]]</span>,</span><span class="param">	<span class="n">sample_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;sample</span><span class="si">{i:03}</span><span class="s1">&#39;</span>,</span><span class="param">	<span class="n">blocksize_parameter</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Mapping</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n"><a href="spec/model/v0_5.html#TensorId">bioimageio.spec.model.v0_5.TensorId</a></span><span class="p">,</span> <span class="n"><a href="#AxisId">AxisId</a></span><span class="p">],</span> <span class="nb">int</span><span class="p">],</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">skip_preprocessing</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">skip_postprocessing</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">save_output_path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n">Iterator</span><span class="p">[</span><span class="n"><a href="#Sample">Sample</a></span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="predict_many-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#predict_many"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="predict_many-126"><a href="#predict_many-126"><span class="linenos">126</span></a><span class="k">def</span> <span class="nf">predict_many</span><span class="p">(</span>
</span><span id="predict_many-127"><a href="#predict_many-127"><span class="linenos">127</span></a>    <span class="o">*</span><span class="p">,</span>
</span><span id="predict_many-128"><a href="#predict_many-128"><span class="linenos">128</span></a>    <span class="n">model</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span>
</span><span id="predict_many-129"><a href="#predict_many-129"><span class="linenos">129</span></a>        <span class="n">PermissiveFileSource</span><span class="p">,</span> <span class="n">v0_4</span><span class="o">.</span><span class="n">ModelDescr</span><span class="p">,</span> <span class="n">v0_5</span><span class="o">.</span><span class="n">ModelDescr</span><span class="p">,</span> <span class="n">PredictionPipeline</span>
</span><span id="predict_many-130"><a href="#predict_many-130"><span class="linenos">130</span></a>    <span class="p">],</span>
</span><span id="predict_many-131"><a href="#predict_many-131"><span class="linenos">131</span></a>    <span class="n">inputs</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">PerMember</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">,</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">Any</span><span class="p">],</span> <span class="n">Path</span><span class="p">]]],</span>
</span><span id="predict_many-132"><a href="#predict_many-132"><span class="linenos">132</span></a>    <span class="n">sample_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;sample</span><span class="si">{i:03}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="predict_many-133"><a href="#predict_many-133"><span class="linenos">133</span></a>    <span class="n">blocksize_parameter</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span>
</span><span id="predict_many-134"><a href="#predict_many-134"><span class="linenos">134</span></a>        <span class="n">Union</span><span class="p">[</span>
</span><span id="predict_many-135"><a href="#predict_many-135"><span class="linenos">135</span></a>            <span class="n">v0_5</span><span class="o">.</span><span class="n">ParameterizedSize_N</span><span class="p">,</span>
</span><span id="predict_many-136"><a href="#predict_many-136"><span class="linenos">136</span></a>            <span class="n">Mapping</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">MemberId</span><span class="p">,</span> <span class="n">AxisId</span><span class="p">],</span> <span class="n">v0_5</span><span class="o">.</span><span class="n">ParameterizedSize_N</span><span class="p">],</span>
</span><span id="predict_many-137"><a href="#predict_many-137"><span class="linenos">137</span></a>        <span class="p">]</span>
</span><span id="predict_many-138"><a href="#predict_many-138"><span class="linenos">138</span></a>    <span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="predict_many-139"><a href="#predict_many-139"><span class="linenos">139</span></a>    <span class="n">skip_preprocessing</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="predict_many-140"><a href="#predict_many-140"><span class="linenos">140</span></a>    <span class="n">skip_postprocessing</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="predict_many-141"><a href="#predict_many-141"><span class="linenos">141</span></a>    <span class="n">save_output_path</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Path</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="predict_many-142"><a href="#predict_many-142"><span class="linenos">142</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Sample</span><span class="p">]:</span>
</span><span id="predict_many-143"><a href="#predict_many-143"><span class="linenos">143</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Run prediction for a multiple sets of inputs with a bioimage.io model</span>
</span><span id="predict_many-144"><a href="#predict_many-144"><span class="linenos">144</span></a>
</span><span id="predict_many-145"><a href="#predict_many-145"><span class="linenos">145</span></a><span class="sd">    Args:</span>
</span><span id="predict_many-146"><a href="#predict_many-146"><span class="linenos">146</span></a><span class="sd">        model: model to predict with.</span>
</span><span id="predict_many-147"><a href="#predict_many-147"><span class="linenos">147</span></a><span class="sd">            May be given as RDF source, model description or prediction pipeline.</span>
</span><span id="predict_many-148"><a href="#predict_many-148"><span class="linenos">148</span></a><span class="sd">        inputs: An iterable of the named input(s) for this model as a dictionary.</span>
</span><span id="predict_many-149"><a href="#predict_many-149"><span class="linenos">149</span></a><span class="sd">        sample_id: the sample id.</span>
</span><span id="predict_many-150"><a href="#predict_many-150"><span class="linenos">150</span></a><span class="sd">            note: `{i}` will be formatted as the i-th sample.</span>
</span><span id="predict_many-151"><a href="#predict_many-151"><span class="linenos">151</span></a><span class="sd">            If `{i}` (or `{i:`) is not present and `inputs` is an iterable `{i:03}` is appended.</span>
</span><span id="predict_many-152"><a href="#predict_many-152"><span class="linenos">152</span></a><span class="sd">        blocksize_parameter: (optional) tile the input into blocks parametrized by</span>
</span><span id="predict_many-153"><a href="#predict_many-153"><span class="linenos">153</span></a><span class="sd">            blocksize according to any parametrized axis sizes defined in the model RDF</span>
</span><span id="predict_many-154"><a href="#predict_many-154"><span class="linenos">154</span></a><span class="sd">        skip_preprocessing: flag to skip the model&#39;s preprocessing</span>
</span><span id="predict_many-155"><a href="#predict_many-155"><span class="linenos">155</span></a><span class="sd">        skip_postprocessing: flag to skip the model&#39;s postprocessing</span>
</span><span id="predict_many-156"><a href="#predict_many-156"><span class="linenos">156</span></a><span class="sd">        save_output_path: A path with `{member_id}` `{sample_id}` in it</span>
</span><span id="predict_many-157"><a href="#predict_many-157"><span class="linenos">157</span></a><span class="sd">            to save the output to.</span>
</span><span id="predict_many-158"><a href="#predict_many-158"><span class="linenos">158</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="predict_many-159"><a href="#predict_many-159"><span class="linenos">159</span></a>    <span class="k">if</span> <span class="n">save_output_path</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="predict_many-160"><a href="#predict_many-160"><span class="linenos">160</span></a>        <span class="k">if</span> <span class="s2">&quot;</span><span class="si">{member_id}</span><span class="s2">&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">save_output_path</span><span class="p">):</span>
</span><span id="predict_many-161"><a href="#predict_many-161"><span class="linenos">161</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="predict_many-162"><a href="#predict_many-162"><span class="linenos">162</span></a>                <span class="sa">f</span><span class="s2">&quot;Missing `</span><span class="se">{{</span><span class="s2">member_id</span><span class="se">}}</span><span class="s2">` in save_output_path=</span><span class="si">{</span><span class="n">save_output_path</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="predict_many-163"><a href="#predict_many-163"><span class="linenos">163</span></a>            <span class="p">)</span>
</span><span id="predict_many-164"><a href="#predict_many-164"><span class="linenos">164</span></a>
</span><span id="predict_many-165"><a href="#predict_many-165"><span class="linenos">165</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">collections</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">Mapping</span><span class="p">)</span> <span class="ow">and</span> <span class="s2">&quot;</span><span class="si">{sample_id}</span><span class="s2">&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span>
</span><span id="predict_many-166"><a href="#predict_many-166"><span class="linenos">166</span></a>            <span class="n">save_output_path</span>
</span><span id="predict_many-167"><a href="#predict_many-167"><span class="linenos">167</span></a>        <span class="p">):</span>
</span><span id="predict_many-168"><a href="#predict_many-168"><span class="linenos">168</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="predict_many-169"><a href="#predict_many-169"><span class="linenos">169</span></a>                <span class="sa">f</span><span class="s2">&quot;Missing `</span><span class="se">{{</span><span class="s2">sample_id</span><span class="se">}}</span><span class="s2">` in save_output_path=</span><span class="si">{</span><span class="n">save_output_path</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="predict_many-170"><a href="#predict_many-170"><span class="linenos">170</span></a>            <span class="p">)</span>
</span><span id="predict_many-171"><a href="#predict_many-171"><span class="linenos">171</span></a>
</span><span id="predict_many-172"><a href="#predict_many-172"><span class="linenos">172</span></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">PredictionPipeline</span><span class="p">):</span>
</span><span id="predict_many-173"><a href="#predict_many-173"><span class="linenos">173</span></a>        <span class="n">pp</span> <span class="o">=</span> <span class="n">model</span>
</span><span id="predict_many-174"><a href="#predict_many-174"><span class="linenos">174</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="predict_many-175"><a href="#predict_many-175"><span class="linenos">175</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="p">(</span><span class="n">v0_4</span><span class="o">.</span><span class="n">ModelDescr</span><span class="p">,</span> <span class="n">v0_5</span><span class="o">.</span><span class="n">ModelDescr</span><span class="p">)):</span>
</span><span id="predict_many-176"><a href="#predict_many-176"><span class="linenos">176</span></a>            <span class="n">loaded</span> <span class="o">=</span> <span class="n">load_description</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</span><span id="predict_many-177"><a href="#predict_many-177"><span class="linenos">177</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">loaded</span><span class="p">,</span> <span class="p">(</span><span class="n">v0_4</span><span class="o">.</span><span class="n">ModelDescr</span><span class="p">,</span> <span class="n">v0_5</span><span class="o">.</span><span class="n">ModelDescr</span><span class="p">)):</span>
</span><span id="predict_many-178"><a href="#predict_many-178"><span class="linenos">178</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;expected model description, but got </span><span class="si">{</span><span class="n">loaded</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="predict_many-179"><a href="#predict_many-179"><span class="linenos">179</span></a>            <span class="n">model</span> <span class="o">=</span> <span class="n">loaded</span>
</span><span id="predict_many-180"><a href="#predict_many-180"><span class="linenos">180</span></a>
</span><span id="predict_many-181"><a href="#predict_many-181"><span class="linenos">181</span></a>        <span class="n">pp</span> <span class="o">=</span> <span class="n">create_prediction_pipeline</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</span><span id="predict_many-182"><a href="#predict_many-182"><span class="linenos">182</span></a>
</span><span id="predict_many-183"><a href="#predict_many-183"><span class="linenos">183</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">collections</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">Mapping</span><span class="p">):</span>
</span><span id="predict_many-184"><a href="#predict_many-184"><span class="linenos">184</span></a>        <span class="n">sample_id</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">sample_id</span><span class="p">)</span>
</span><span id="predict_many-185"><a href="#predict_many-185"><span class="linenos">185</span></a>        <span class="k">if</span> <span class="s2">&quot;</span><span class="si">{i}</span><span class="s2">&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sample_id</span> <span class="ow">and</span> <span class="s2">&quot;{i:&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sample_id</span><span class="p">:</span>
</span><span id="predict_many-186"><a href="#predict_many-186"><span class="linenos">186</span></a>            <span class="n">sample_id</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="si">{i:03}</span><span class="s2">&quot;</span>
</span><span id="predict_many-187"><a href="#predict_many-187"><span class="linenos">187</span></a>
</span><span id="predict_many-188"><a href="#predict_many-188"><span class="linenos">188</span></a>        <span class="n">total</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">collections</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">Sized</span><span class="p">)</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="predict_many-189"><a href="#predict_many-189"><span class="linenos">189</span></a>
</span><span id="predict_many-190"><a href="#predict_many-190"><span class="linenos">190</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ipts</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">enumerate</span><span class="p">(</span><span class="n">inputs</span><span class="p">),</span> <span class="n">total</span><span class="o">=</span><span class="n">total</span><span class="p">):</span>
</span><span id="predict_many-191"><a href="#predict_many-191"><span class="linenos">191</span></a>            <span class="k">yield</span> <span class="n">predict</span><span class="p">(</span>
</span><span id="predict_many-192"><a href="#predict_many-192"><span class="linenos">192</span></a>                <span class="n">model</span><span class="o">=</span><span class="n">pp</span><span class="p">,</span>
</span><span id="predict_many-193"><a href="#predict_many-193"><span class="linenos">193</span></a>                <span class="n">inputs</span><span class="o">=</span><span class="n">ipts</span><span class="p">,</span>
</span><span id="predict_many-194"><a href="#predict_many-194"><span class="linenos">194</span></a>                <span class="n">sample_id</span><span class="o">=</span><span class="n">sample_id</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="n">i</span><span class="p">),</span>
</span><span id="predict_many-195"><a href="#predict_many-195"><span class="linenos">195</span></a>                <span class="n">blocksize_parameter</span><span class="o">=</span><span class="n">blocksize_parameter</span><span class="p">,</span>
</span><span id="predict_many-196"><a href="#predict_many-196"><span class="linenos">196</span></a>                <span class="n">skip_preprocessing</span><span class="o">=</span><span class="n">skip_preprocessing</span><span class="p">,</span>
</span><span id="predict_many-197"><a href="#predict_many-197"><span class="linenos">197</span></a>                <span class="n">skip_postprocessing</span><span class="o">=</span><span class="n">skip_postprocessing</span><span class="p">,</span>
</span><span id="predict_many-198"><a href="#predict_many-198"><span class="linenos">198</span></a>                <span class="n">save_output_path</span><span class="o">=</span><span class="n">save_output_path</span><span class="p">,</span>
</span><span id="predict_many-199"><a href="#predict_many-199"><span class="linenos">199</span></a>            <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Run prediction for a multiple sets of inputs with a bioimage.io model</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>model:</strong>  model to predict with.
May be given as RDF source, model description or prediction pipeline.</li>
<li><strong>inputs:</strong>  An iterable of the named input(s) for this model as a dictionary.</li>
<li><strong>sample_id:</strong>  the sample id.
note: <code>{i}</code> will be formatted as the i-th sample.
If <code>{i}</code> (or <code>{i:</code>) is not present and <code>inputs</code> is an iterable <code>{i:03}</code> is appended.</li>
<li><strong>blocksize_parameter:</strong>  (optional) tile the input into blocks parametrized by
blocksize according to any parametrized axis sizes defined in the model RDF</li>
<li><strong>skip_preprocessing:</strong>  flag to skip the model's preprocessing</li>
<li><strong>skip_postprocessing:</strong>  flag to skip the model's postprocessing</li>
<li><strong>save_output_path:</strong>  A path with <code>{member_id}</code> <code>{sample_id}</code> in it
to save the output to.</li>
</ul>
</div>


                </section>
                <section id="predict">
                            <input id="predict-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">predict</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">model</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">bioimageio</span><span class="o">.</span><span class="n">spec</span><span class="o">.</span><span class="n">_internal</span><span class="o">.</span><span class="n">url</span><span class="o">.</span><span class="n">HttpUrl</span><span class="p">,</span> <span class="n">bioimageio</span><span class="o">.</span><span class="n">spec</span><span class="o">.</span><span class="n">_internal</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">RelativeFilePath</span><span class="p">,</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span> <span class="n">PathType</span><span class="p">(</span><span class="n">path_type</span><span class="o">=</span><span class="s1">&#39;file&#39;</span><span class="p">)]],</span> <span class="n">FieldInfo</span><span class="p">(</span><span class="n">annotation</span><span class="o">=</span><span class="n">NoneType</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="p">[</span><span class="n">_PydanticGeneralMetadata</span><span class="p">(</span><span class="n">union_mode</span><span class="o">=</span><span class="s1">&#39;left_to_right&#39;</span><span class="p">)])],</span> <span class="nb">str</span><span class="p">,</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">pydantic_core</span><span class="o">.</span><span class="n">_pydantic_core</span><span class="o">.</span><span class="n">Url</span><span class="p">,</span> <span class="n">UrlConstraints</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">2083</span><span class="p">,</span> <span class="n">allowed_schemes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;http&#39;</span><span class="p">,</span> <span class="s1">&#39;https&#39;</span><span class="p">],</span> <span class="n">host_required</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">default_host</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">default_port</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">default_path</span><span class="o">=</span><span class="kc">None</span><span class="p">)],</span> <span class="n"><a href="spec/model/v0_4.html#ModelDescr">bioimageio.spec.model.v0_4.ModelDescr</a></span><span class="p">,</span> <span class="n"><a href="spec.html#ModelDescr">bioimageio.spec.ModelDescr</a></span><span class="p">,</span> <span class="n"><a href="#PredictionPipeline">PredictionPipeline</a></span><span class="p">]</span>,</span><span class="param">	<span class="n">inputs</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n"><a href="#Sample">Sample</a></span><span class="p">,</span> <span class="n">Mapping</span><span class="p">[</span><span class="n"><a href="spec/model/v0_5.html#TensorId">bioimageio.spec.model.v0_5.TensorId</a></span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="n"><a href="#Tensor">Tensor</a></span><span class="p">,</span> <span class="n">xarray</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">dataarray</span><span class="o">.</span><span class="n">DataArray</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">Any</span><span class="p">]],</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">]]]</span>,</span><span class="param">	<span class="n">sample_id</span><span class="p">:</span> <span class="n">Hashable</span> <span class="o">=</span> <span class="s1">&#39;sample&#39;</span>,</span><span class="param">	<span class="n">blocksize_parameter</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Mapping</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n"><a href="spec/model/v0_5.html#TensorId">bioimageio.spec.model.v0_5.TensorId</a></span><span class="p">,</span> <span class="n"><a href="#AxisId">AxisId</a></span><span class="p">],</span> <span class="nb">int</span><span class="p">],</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">input_block_shape</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Mapping</span><span class="p">[</span><span class="n"><a href="spec/model/v0_5.html#TensorId">bioimageio.spec.model.v0_5.TensorId</a></span><span class="p">,</span> <span class="n">Mapping</span><span class="p">[</span><span class="n"><a href="#AxisId">AxisId</a></span><span class="p">,</span> <span class="nb">int</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">skip_preprocessing</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">skip_postprocessing</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">save_output_path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n"><a href="#Sample">Sample</a></span>:</span></span>

                <label class="view-source-button" for="predict-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#predict"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="predict-33"><a href="#predict-33"><span class="linenos"> 33</span></a><span class="k">def</span> <span class="nf">predict</span><span class="p">(</span>
</span><span id="predict-34"><a href="#predict-34"><span class="linenos"> 34</span></a>    <span class="o">*</span><span class="p">,</span>
</span><span id="predict-35"><a href="#predict-35"><span class="linenos"> 35</span></a>    <span class="n">model</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span>
</span><span id="predict-36"><a href="#predict-36"><span class="linenos"> 36</span></a>        <span class="n">PermissiveFileSource</span><span class="p">,</span> <span class="n">v0_4</span><span class="o">.</span><span class="n">ModelDescr</span><span class="p">,</span> <span class="n">v0_5</span><span class="o">.</span><span class="n">ModelDescr</span><span class="p">,</span> <span class="n">PredictionPipeline</span>
</span><span id="predict-37"><a href="#predict-37"><span class="linenos"> 37</span></a>    <span class="p">],</span>
</span><span id="predict-38"><a href="#predict-38"><span class="linenos"> 38</span></a>    <span class="n">inputs</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Sample</span><span class="p">,</span> <span class="n">PerMember</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">,</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">Any</span><span class="p">],</span> <span class="n">Path</span><span class="p">]]],</span>
</span><span id="predict-39"><a href="#predict-39"><span class="linenos"> 39</span></a>    <span class="n">sample_id</span><span class="p">:</span> <span class="n">Hashable</span> <span class="o">=</span> <span class="s2">&quot;sample&quot;</span><span class="p">,</span>
</span><span id="predict-40"><a href="#predict-40"><span class="linenos"> 40</span></a>    <span class="n">blocksize_parameter</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span>
</span><span id="predict-41"><a href="#predict-41"><span class="linenos"> 41</span></a>        <span class="n">Union</span><span class="p">[</span>
</span><span id="predict-42"><a href="#predict-42"><span class="linenos"> 42</span></a>            <span class="n">v0_5</span><span class="o">.</span><span class="n">ParameterizedSize_N</span><span class="p">,</span>
</span><span id="predict-43"><a href="#predict-43"><span class="linenos"> 43</span></a>            <span class="n">Mapping</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">MemberId</span><span class="p">,</span> <span class="n">AxisId</span><span class="p">],</span> <span class="n">v0_5</span><span class="o">.</span><span class="n">ParameterizedSize_N</span><span class="p">],</span>
</span><span id="predict-44"><a href="#predict-44"><span class="linenos"> 44</span></a>        <span class="p">]</span>
</span><span id="predict-45"><a href="#predict-45"><span class="linenos"> 45</span></a>    <span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="predict-46"><a href="#predict-46"><span class="linenos"> 46</span></a>    <span class="n">input_block_shape</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Mapping</span><span class="p">[</span><span class="n">MemberId</span><span class="p">,</span> <span class="n">Mapping</span><span class="p">[</span><span class="n">AxisId</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="predict-47"><a href="#predict-47"><span class="linenos"> 47</span></a>    <span class="n">skip_preprocessing</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="predict-48"><a href="#predict-48"><span class="linenos"> 48</span></a>    <span class="n">skip_postprocessing</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="predict-49"><a href="#predict-49"><span class="linenos"> 49</span></a>    <span class="n">save_output_path</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Path</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="predict-50"><a href="#predict-50"><span class="linenos"> 50</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sample</span><span class="p">:</span>
</span><span id="predict-51"><a href="#predict-51"><span class="linenos"> 51</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Run prediction for a single set of input(s) with a bioimage.io model</span>
</span><span id="predict-52"><a href="#predict-52"><span class="linenos"> 52</span></a>
</span><span id="predict-53"><a href="#predict-53"><span class="linenos"> 53</span></a><span class="sd">    Args:</span>
</span><span id="predict-54"><a href="#predict-54"><span class="linenos"> 54</span></a><span class="sd">        model: model to predict with.</span>
</span><span id="predict-55"><a href="#predict-55"><span class="linenos"> 55</span></a><span class="sd">            May be given as RDF source, model description or prediction pipeline.</span>
</span><span id="predict-56"><a href="#predict-56"><span class="linenos"> 56</span></a><span class="sd">        inputs: the input sample or the named input(s) for this model as a dictionary</span>
</span><span id="predict-57"><a href="#predict-57"><span class="linenos"> 57</span></a><span class="sd">        sample_id: the sample id.</span>
</span><span id="predict-58"><a href="#predict-58"><span class="linenos"> 58</span></a><span class="sd">        blocksize_parameter: (optional) tile the input into blocks parametrized by</span>
</span><span id="predict-59"><a href="#predict-59"><span class="linenos"> 59</span></a><span class="sd">            blocksize according to any parametrized axis sizes defined in the model RDF.</span>
</span><span id="predict-60"><a href="#predict-60"><span class="linenos"> 60</span></a><span class="sd">            Note: For a predetermined, fixed block shape use `input_block_shape`</span>
</span><span id="predict-61"><a href="#predict-61"><span class="linenos"> 61</span></a><span class="sd">        input_block_shape: (optional) tile the input sample tensors into blocks.</span>
</span><span id="predict-62"><a href="#predict-62"><span class="linenos"> 62</span></a><span class="sd">            Note: For a parameterized block shape, not dealing with the exact block shape,</span>
</span><span id="predict-63"><a href="#predict-63"><span class="linenos"> 63</span></a><span class="sd">            use `blocksize_parameter`.</span>
</span><span id="predict-64"><a href="#predict-64"><span class="linenos"> 64</span></a><span class="sd">        skip_preprocessing: flag to skip the model&#39;s preprocessing</span>
</span><span id="predict-65"><a href="#predict-65"><span class="linenos"> 65</span></a><span class="sd">        skip_postprocessing: flag to skip the model&#39;s postprocessing</span>
</span><span id="predict-66"><a href="#predict-66"><span class="linenos"> 66</span></a><span class="sd">        save_output_path: A path with `{member_id}` `{sample_id}` in it</span>
</span><span id="predict-67"><a href="#predict-67"><span class="linenos"> 67</span></a><span class="sd">            to save the output to.</span>
</span><span id="predict-68"><a href="#predict-68"><span class="linenos"> 68</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="predict-69"><a href="#predict-69"><span class="linenos"> 69</span></a>    <span class="k">if</span> <span class="n">save_output_path</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="predict-70"><a href="#predict-70"><span class="linenos"> 70</span></a>        <span class="k">if</span> <span class="s2">&quot;</span><span class="si">{member_id}</span><span class="s2">&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">save_output_path</span><span class="p">):</span>
</span><span id="predict-71"><a href="#predict-71"><span class="linenos"> 71</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="predict-72"><a href="#predict-72"><span class="linenos"> 72</span></a>                <span class="sa">f</span><span class="s2">&quot;Missing `</span><span class="se">{{</span><span class="s2">member_id</span><span class="se">}}</span><span class="s2">` in save_output_path=</span><span class="si">{</span><span class="n">save_output_path</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="predict-73"><a href="#predict-73"><span class="linenos"> 73</span></a>            <span class="p">)</span>
</span><span id="predict-74"><a href="#predict-74"><span class="linenos"> 74</span></a>
</span><span id="predict-75"><a href="#predict-75"><span class="linenos"> 75</span></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">PredictionPipeline</span><span class="p">):</span>
</span><span id="predict-76"><a href="#predict-76"><span class="linenos"> 76</span></a>        <span class="n">pp</span> <span class="o">=</span> <span class="n">model</span>
</span><span id="predict-77"><a href="#predict-77"><span class="linenos"> 77</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="predict-78"><a href="#predict-78"><span class="linenos"> 78</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="p">(</span><span class="n">v0_4</span><span class="o">.</span><span class="n">ModelDescr</span><span class="p">,</span> <span class="n">v0_5</span><span class="o">.</span><span class="n">ModelDescr</span><span class="p">)):</span>
</span><span id="predict-79"><a href="#predict-79"><span class="linenos"> 79</span></a>            <span class="n">loaded</span> <span class="o">=</span> <span class="n">load_description</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</span><span id="predict-80"><a href="#predict-80"><span class="linenos"> 80</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">loaded</span><span class="p">,</span> <span class="p">(</span><span class="n">v0_4</span><span class="o">.</span><span class="n">ModelDescr</span><span class="p">,</span> <span class="n">v0_5</span><span class="o">.</span><span class="n">ModelDescr</span><span class="p">)):</span>
</span><span id="predict-81"><a href="#predict-81"><span class="linenos"> 81</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;expected model description, but got </span><span class="si">{</span><span class="n">loaded</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="predict-82"><a href="#predict-82"><span class="linenos"> 82</span></a>            <span class="n">model</span> <span class="o">=</span> <span class="n">loaded</span>
</span><span id="predict-83"><a href="#predict-83"><span class="linenos"> 83</span></a>
</span><span id="predict-84"><a href="#predict-84"><span class="linenos"> 84</span></a>        <span class="n">pp</span> <span class="o">=</span> <span class="n">create_prediction_pipeline</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</span><span id="predict-85"><a href="#predict-85"><span class="linenos"> 85</span></a>
</span><span id="predict-86"><a href="#predict-86"><span class="linenos"> 86</span></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">Sample</span><span class="p">):</span>
</span><span id="predict-87"><a href="#predict-87"><span class="linenos"> 87</span></a>        <span class="n">sample</span> <span class="o">=</span> <span class="n">inputs</span>
</span><span id="predict-88"><a href="#predict-88"><span class="linenos"> 88</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="predict-89"><a href="#predict-89"><span class="linenos"> 89</span></a>        <span class="n">sample</span> <span class="o">=</span> <span class="n">create_sample_for_model</span><span class="p">(</span>
</span><span id="predict-90"><a href="#predict-90"><span class="linenos"> 90</span></a>            <span class="n">pp</span><span class="o">.</span><span class="n">model_description</span><span class="p">,</span> <span class="n">inputs</span><span class="o">=</span><span class="n">inputs</span><span class="p">,</span> <span class="n">sample_id</span><span class="o">=</span><span class="n">sample_id</span>
</span><span id="predict-91"><a href="#predict-91"><span class="linenos"> 91</span></a>        <span class="p">)</span>
</span><span id="predict-92"><a href="#predict-92"><span class="linenos"> 92</span></a>
</span><span id="predict-93"><a href="#predict-93"><span class="linenos"> 93</span></a>    <span class="k">if</span> <span class="n">input_block_shape</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="predict-94"><a href="#predict-94"><span class="linenos"> 94</span></a>        <span class="k">if</span> <span class="n">blocksize_parameter</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="predict-95"><a href="#predict-95"><span class="linenos"> 95</span></a>            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
</span><span id="predict-96"><a href="#predict-96"><span class="linenos"> 96</span></a>                <span class="s2">&quot;ignoring blocksize_parameter=</span><span class="si">{}</span><span class="s2"> in favor of input_block_shape=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="predict-97"><a href="#predict-97"><span class="linenos"> 97</span></a>                <span class="n">blocksize_parameter</span><span class="p">,</span>
</span><span id="predict-98"><a href="#predict-98"><span class="linenos"> 98</span></a>                <span class="n">input_block_shape</span><span class="p">,</span>
</span><span id="predict-99"><a href="#predict-99"><span class="linenos"> 99</span></a>            <span class="p">)</span>
</span><span id="predict-100"><a href="#predict-100"><span class="linenos">100</span></a>
</span><span id="predict-101"><a href="#predict-101"><span class="linenos">101</span></a>        <span class="n">output</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">predict_sample_with_fixed_blocking</span><span class="p">(</span>
</span><span id="predict-102"><a href="#predict-102"><span class="linenos">102</span></a>            <span class="n">sample</span><span class="p">,</span>
</span><span id="predict-103"><a href="#predict-103"><span class="linenos">103</span></a>            <span class="n">input_block_shape</span><span class="o">=</span><span class="n">input_block_shape</span><span class="p">,</span>
</span><span id="predict-104"><a href="#predict-104"><span class="linenos">104</span></a>            <span class="n">skip_preprocessing</span><span class="o">=</span><span class="n">skip_preprocessing</span><span class="p">,</span>
</span><span id="predict-105"><a href="#predict-105"><span class="linenos">105</span></a>            <span class="n">skip_postprocessing</span><span class="o">=</span><span class="n">skip_postprocessing</span><span class="p">,</span>
</span><span id="predict-106"><a href="#predict-106"><span class="linenos">106</span></a>        <span class="p">)</span>
</span><span id="predict-107"><a href="#predict-107"><span class="linenos">107</span></a>    <span class="k">elif</span> <span class="n">blocksize_parameter</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="predict-108"><a href="#predict-108"><span class="linenos">108</span></a>        <span class="n">output</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">predict_sample_with_blocking</span><span class="p">(</span>
</span><span id="predict-109"><a href="#predict-109"><span class="linenos">109</span></a>            <span class="n">sample</span><span class="p">,</span>
</span><span id="predict-110"><a href="#predict-110"><span class="linenos">110</span></a>            <span class="n">skip_preprocessing</span><span class="o">=</span><span class="n">skip_preprocessing</span><span class="p">,</span>
</span><span id="predict-111"><a href="#predict-111"><span class="linenos">111</span></a>            <span class="n">skip_postprocessing</span><span class="o">=</span><span class="n">skip_postprocessing</span><span class="p">,</span>
</span><span id="predict-112"><a href="#predict-112"><span class="linenos">112</span></a>            <span class="n">ns</span><span class="o">=</span><span class="n">blocksize_parameter</span><span class="p">,</span>
</span><span id="predict-113"><a href="#predict-113"><span class="linenos">113</span></a>        <span class="p">)</span>
</span><span id="predict-114"><a href="#predict-114"><span class="linenos">114</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="predict-115"><a href="#predict-115"><span class="linenos">115</span></a>        <span class="n">output</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">predict_sample_without_blocking</span><span class="p">(</span>
</span><span id="predict-116"><a href="#predict-116"><span class="linenos">116</span></a>            <span class="n">sample</span><span class="p">,</span>
</span><span id="predict-117"><a href="#predict-117"><span class="linenos">117</span></a>            <span class="n">skip_preprocessing</span><span class="o">=</span><span class="n">skip_preprocessing</span><span class="p">,</span>
</span><span id="predict-118"><a href="#predict-118"><span class="linenos">118</span></a>            <span class="n">skip_postprocessing</span><span class="o">=</span><span class="n">skip_postprocessing</span><span class="p">,</span>
</span><span id="predict-119"><a href="#predict-119"><span class="linenos">119</span></a>        <span class="p">)</span>
</span><span id="predict-120"><a href="#predict-120"><span class="linenos">120</span></a>    <span class="k">if</span> <span class="n">save_output_path</span><span class="p">:</span>
</span><span id="predict-121"><a href="#predict-121"><span class="linenos">121</span></a>        <span class="n">save_sample</span><span class="p">(</span><span class="n">save_output_path</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span>
</span><span id="predict-122"><a href="#predict-122"><span class="linenos">122</span></a>
</span><span id="predict-123"><a href="#predict-123"><span class="linenos">123</span></a>    <span class="k">return</span> <span class="n">output</span>
</span></pre></div>


            <div class="docstring"><p>Run prediction for a single set of input(s) with a bioimage.io model</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>model:</strong>  model to predict with.
May be given as RDF source, model description or prediction pipeline.</li>
<li><strong>inputs:</strong>  the input sample or the named input(s) for this model as a dictionary</li>
<li><strong>sample_id:</strong>  the sample id.</li>
<li><strong>blocksize_parameter:</strong>  (optional) tile the input into blocks parametrized by
blocksize according to any parametrized axis sizes defined in the model RDF.
Note: For a predetermined, fixed block shape use <code>input_block_shape</code></li>
<li><strong>input_block_shape:</strong>  (optional) tile the input sample tensors into blocks.
Note: For a parameterized block shape, not dealing with the exact block shape,
use <code>blocksize_parameter</code>.</li>
<li><strong>skip_preprocessing:</strong>  flag to skip the model's preprocessing</li>
<li><strong>skip_postprocessing:</strong>  flag to skip the model's postprocessing</li>
<li><strong>save_output_path:</strong>  A path with <code>{member_id}</code> <code>{sample_id}</code> in it
to save the output to.</li>
</ul>
</div>


                </section>
                <section id="PredictionPipeline">
                            <input id="PredictionPipeline-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">PredictionPipeline</span>:

                <label class="view-source-button" for="PredictionPipeline-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PredictionPipeline"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PredictionPipeline-44"><a href="#PredictionPipeline-44"><span class="linenos"> 44</span></a><span class="k">class</span> <span class="nc">PredictionPipeline</span><span class="p">:</span>
</span><span id="PredictionPipeline-45"><a href="#PredictionPipeline-45"><span class="linenos"> 45</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PredictionPipeline-46"><a href="#PredictionPipeline-46"><span class="linenos"> 46</span></a><span class="sd">    Represents model computation including preprocessing and postprocessing</span>
</span><span id="PredictionPipeline-47"><a href="#PredictionPipeline-47"><span class="linenos"> 47</span></a><span class="sd">    Note: Ideally use the PredictionPipeline as a context manager</span>
</span><span id="PredictionPipeline-48"><a href="#PredictionPipeline-48"><span class="linenos"> 48</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="PredictionPipeline-49"><a href="#PredictionPipeline-49"><span class="linenos"> 49</span></a>
</span><span id="PredictionPipeline-50"><a href="#PredictionPipeline-50"><span class="linenos"> 50</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="PredictionPipeline-51"><a href="#PredictionPipeline-51"><span class="linenos"> 51</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="PredictionPipeline-52"><a href="#PredictionPipeline-52"><span class="linenos"> 52</span></a>        <span class="o">*</span><span class="p">,</span>
</span><span id="PredictionPipeline-53"><a href="#PredictionPipeline-53"><span class="linenos"> 53</span></a>        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="PredictionPipeline-54"><a href="#PredictionPipeline-54"><span class="linenos"> 54</span></a>        <span class="n">model_description</span><span class="p">:</span> <span class="n">AnyModelDescr</span><span class="p">,</span>
</span><span id="PredictionPipeline-55"><a href="#PredictionPipeline-55"><span class="linenos"> 55</span></a>        <span class="n">preprocessing</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Processing</span><span class="p">],</span>
</span><span id="PredictionPipeline-56"><a href="#PredictionPipeline-56"><span class="linenos"> 56</span></a>        <span class="n">postprocessing</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Processing</span><span class="p">],</span>
</span><span id="PredictionPipeline-57"><a href="#PredictionPipeline-57"><span class="linenos"> 57</span></a>        <span class="n">model_adapter</span><span class="p">:</span> <span class="n">ModelAdapter</span><span class="p">,</span>
</span><span id="PredictionPipeline-58"><a href="#PredictionPipeline-58"><span class="linenos"> 58</span></a>        <span class="n">default_ns</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span>
</span><span id="PredictionPipeline-59"><a href="#PredictionPipeline-59"><span class="linenos"> 59</span></a>            <span class="n">v0_5</span><span class="o">.</span><span class="n">ParameterizedSize_N</span><span class="p">,</span>
</span><span id="PredictionPipeline-60"><a href="#PredictionPipeline-60"><span class="linenos"> 60</span></a>            <span class="n">Mapping</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">MemberId</span><span class="p">,</span> <span class="n">AxisId</span><span class="p">],</span> <span class="n">v0_5</span><span class="o">.</span><span class="n">ParameterizedSize_N</span><span class="p">],</span>
</span><span id="PredictionPipeline-61"><a href="#PredictionPipeline-61"><span class="linenos"> 61</span></a>        <span class="p">]</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
</span><span id="PredictionPipeline-62"><a href="#PredictionPipeline-62"><span class="linenos"> 62</span></a>        <span class="n">default_batch_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="PredictionPipeline-63"><a href="#PredictionPipeline-63"><span class="linenos"> 63</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PredictionPipeline-64"><a href="#PredictionPipeline-64"><span class="linenos"> 64</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
</span><span id="PredictionPipeline-65"><a href="#PredictionPipeline-65"><span class="linenos"> 65</span></a>        <span class="k">if</span> <span class="n">model_description</span><span class="o">.</span><span class="n">run_mode</span><span class="p">:</span>
</span><span id="PredictionPipeline-66"><a href="#PredictionPipeline-66"><span class="linenos"> 66</span></a>            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
</span><span id="PredictionPipeline-67"><a href="#PredictionPipeline-67"><span class="linenos"> 67</span></a>                <span class="sa">f</span><span class="s2">&quot;Not yet implemented inference for run mode &#39;</span><span class="si">{</span><span class="n">model_description</span><span class="o">.</span><span class="n">run_mode</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
</span><span id="PredictionPipeline-68"><a href="#PredictionPipeline-68"><span class="linenos"> 68</span></a>            <span class="p">)</span>
</span><span id="PredictionPipeline-69"><a href="#PredictionPipeline-69"><span class="linenos"> 69</span></a>
</span><span id="PredictionPipeline-70"><a href="#PredictionPipeline-70"><span class="linenos"> 70</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
</span><span id="PredictionPipeline-71"><a href="#PredictionPipeline-71"><span class="linenos"> 71</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_preprocessing</span> <span class="o">=</span> <span class="n">preprocessing</span>
</span><span id="PredictionPipeline-72"><a href="#PredictionPipeline-72"><span class="linenos"> 72</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_postprocessing</span> <span class="o">=</span> <span class="n">postprocessing</span>
</span><span id="PredictionPipeline-73"><a href="#PredictionPipeline-73"><span class="linenos"> 73</span></a>
</span><span id="PredictionPipeline-74"><a href="#PredictionPipeline-74"><span class="linenos"> 74</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model_description</span> <span class="o">=</span> <span class="n">model_description</span>
</span><span id="PredictionPipeline-75"><a href="#PredictionPipeline-75"><span class="linenos"> 75</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">model_description</span><span class="p">,</span> <span class="n">v0_4</span><span class="o">.</span><span class="n">ModelDescr</span><span class="p">):</span>
</span><span id="PredictionPipeline-76"><a href="#PredictionPipeline-76"><span class="linenos"> 76</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_default_input_halo</span><span class="p">:</span> <span class="n">PerMember</span><span class="p">[</span><span class="n">PerAxis</span><span class="p">[</span><span class="n">Halo</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="PredictionPipeline-77"><a href="#PredictionPipeline-77"><span class="linenos"> 77</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_block_transform</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="PredictionPipeline-78"><a href="#PredictionPipeline-78"><span class="linenos"> 78</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="PredictionPipeline-79"><a href="#PredictionPipeline-79"><span class="linenos"> 79</span></a>            <span class="n">default_output_halo</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="PredictionPipeline-80"><a href="#PredictionPipeline-80"><span class="linenos"> 80</span></a>                <span class="n">t</span><span class="o">.</span><span class="n">id</span><span class="p">:</span> <span class="p">{</span>
</span><span id="PredictionPipeline-81"><a href="#PredictionPipeline-81"><span class="linenos"> 81</span></a>                    <span class="n">a</span><span class="o">.</span><span class="n">id</span><span class="p">:</span> <span class="n">Halo</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">halo</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">halo</span><span class="p">)</span>
</span><span id="PredictionPipeline-82"><a href="#PredictionPipeline-82"><span class="linenos"> 82</span></a>                    <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">t</span><span class="o">.</span><span class="n">axes</span>
</span><span id="PredictionPipeline-83"><a href="#PredictionPipeline-83"><span class="linenos"> 83</span></a>                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">v0_5</span><span class="o">.</span><span class="n">WithHalo</span><span class="p">)</span>
</span><span id="PredictionPipeline-84"><a href="#PredictionPipeline-84"><span class="linenos"> 84</span></a>                <span class="p">}</span>
</span><span id="PredictionPipeline-85"><a href="#PredictionPipeline-85"><span class="linenos"> 85</span></a>                <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">model_description</span><span class="o">.</span><span class="n">outputs</span>
</span><span id="PredictionPipeline-86"><a href="#PredictionPipeline-86"><span class="linenos"> 86</span></a>            <span class="p">}</span>
</span><span id="PredictionPipeline-87"><a href="#PredictionPipeline-87"><span class="linenos"> 87</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_default_input_halo</span> <span class="o">=</span> <span class="n">get_input_halo</span><span class="p">(</span>
</span><span id="PredictionPipeline-88"><a href="#PredictionPipeline-88"><span class="linenos"> 88</span></a>                <span class="n">model_description</span><span class="p">,</span> <span class="n">default_output_halo</span>
</span><span id="PredictionPipeline-89"><a href="#PredictionPipeline-89"><span class="linenos"> 89</span></a>            <span class="p">)</span>
</span><span id="PredictionPipeline-90"><a href="#PredictionPipeline-90"><span class="linenos"> 90</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_block_transform</span> <span class="o">=</span> <span class="n">get_block_transform</span><span class="p">(</span><span class="n">model_description</span><span class="p">)</span>
</span><span id="PredictionPipeline-91"><a href="#PredictionPipeline-91"><span class="linenos"> 91</span></a>
</span><span id="PredictionPipeline-92"><a href="#PredictionPipeline-92"><span class="linenos"> 92</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_default_ns</span> <span class="o">=</span> <span class="n">default_ns</span>
</span><span id="PredictionPipeline-93"><a href="#PredictionPipeline-93"><span class="linenos"> 93</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_default_batch_size</span> <span class="o">=</span> <span class="n">default_batch_size</span>
</span><span id="PredictionPipeline-94"><a href="#PredictionPipeline-94"><span class="linenos"> 94</span></a>
</span><span id="PredictionPipeline-95"><a href="#PredictionPipeline-95"><span class="linenos"> 95</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_input_ids</span> <span class="o">=</span> <span class="n">get_member_ids</span><span class="p">(</span><span class="n">model_description</span><span class="o">.</span><span class="n">inputs</span><span class="p">)</span>
</span><span id="PredictionPipeline-96"><a href="#PredictionPipeline-96"><span class="linenos"> 96</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_output_ids</span> <span class="o">=</span> <span class="n">get_member_ids</span><span class="p">(</span><span class="n">model_description</span><span class="o">.</span><span class="n">outputs</span><span class="p">)</span>
</span><span id="PredictionPipeline-97"><a href="#PredictionPipeline-97"><span class="linenos"> 97</span></a>
</span><span id="PredictionPipeline-98"><a href="#PredictionPipeline-98"><span class="linenos"> 98</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_adapter</span><span class="p">:</span> <span class="n">ModelAdapter</span> <span class="o">=</span> <span class="n">model_adapter</span>
</span><span id="PredictionPipeline-99"><a href="#PredictionPipeline-99"><span class="linenos"> 99</span></a>
</span><span id="PredictionPipeline-100"><a href="#PredictionPipeline-100"><span class="linenos">100</span></a>    <span class="k">def</span> <span class="fm">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="PredictionPipeline-101"><a href="#PredictionPipeline-101"><span class="linenos">101</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
</span><span id="PredictionPipeline-102"><a href="#PredictionPipeline-102"><span class="linenos">102</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="PredictionPipeline-103"><a href="#PredictionPipeline-103"><span class="linenos">103</span></a>
</span><span id="PredictionPipeline-104"><a href="#PredictionPipeline-104"><span class="linenos">104</span></a>    <span class="k">def</span> <span class="fm">__exit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exc_type</span><span class="p">,</span> <span class="n">exc_val</span><span class="p">,</span> <span class="n">exc_tb</span><span class="p">):</span>  <span class="c1"># type: ignore</span>
</span><span id="PredictionPipeline-105"><a href="#PredictionPipeline-105"><span class="linenos">105</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unload</span><span class="p">()</span>
</span><span id="PredictionPipeline-106"><a href="#PredictionPipeline-106"><span class="linenos">106</span></a>        <span class="k">return</span> <span class="kc">False</span>
</span><span id="PredictionPipeline-107"><a href="#PredictionPipeline-107"><span class="linenos">107</span></a>
</span><span id="PredictionPipeline-108"><a href="#PredictionPipeline-108"><span class="linenos">108</span></a>    <span class="k">def</span> <span class="nf">predict_sample_block</span><span class="p">(</span>
</span><span id="PredictionPipeline-109"><a href="#PredictionPipeline-109"><span class="linenos">109</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="PredictionPipeline-110"><a href="#PredictionPipeline-110"><span class="linenos">110</span></a>        <span class="n">sample_block</span><span class="p">:</span> <span class="n">SampleBlockWithOrigin</span><span class="p">,</span>
</span><span id="PredictionPipeline-111"><a href="#PredictionPipeline-111"><span class="linenos">111</span></a>        <span class="n">skip_preprocessing</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="PredictionPipeline-112"><a href="#PredictionPipeline-112"><span class="linenos">112</span></a>        <span class="n">skip_postprocessing</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="PredictionPipeline-113"><a href="#PredictionPipeline-113"><span class="linenos">113</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SampleBlock</span><span class="p">:</span>
</span><span id="PredictionPipeline-114"><a href="#PredictionPipeline-114"><span class="linenos">114</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model_description</span><span class="p">,</span> <span class="n">v0_4</span><span class="o">.</span><span class="n">ModelDescr</span><span class="p">):</span>
</span><span id="PredictionPipeline-115"><a href="#PredictionPipeline-115"><span class="linenos">115</span></a>            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
</span><span id="PredictionPipeline-116"><a href="#PredictionPipeline-116"><span class="linenos">116</span></a>                <span class="sa">f</span><span class="s2">&quot;predict_sample_block not implemented for model </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">model_description</span><span class="o">.</span><span class="n">format_version</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="PredictionPipeline-117"><a href="#PredictionPipeline-117"><span class="linenos">117</span></a>            <span class="p">)</span>
</span><span id="PredictionPipeline-118"><a href="#PredictionPipeline-118"><span class="linenos">118</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="PredictionPipeline-119"><a href="#PredictionPipeline-119"><span class="linenos">119</span></a>            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">_block_transform</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="PredictionPipeline-120"><a href="#PredictionPipeline-120"><span class="linenos">120</span></a>
</span><span id="PredictionPipeline-121"><a href="#PredictionPipeline-121"><span class="linenos">121</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">skip_preprocessing</span><span class="p">:</span>
</span><span id="PredictionPipeline-122"><a href="#PredictionPipeline-122"><span class="linenos">122</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">apply_preprocessing</span><span class="p">(</span><span class="n">sample_block</span><span class="p">)</span>
</span><span id="PredictionPipeline-123"><a href="#PredictionPipeline-123"><span class="linenos">123</span></a>
</span><span id="PredictionPipeline-124"><a href="#PredictionPipeline-124"><span class="linenos">124</span></a>        <span class="n">output_meta</span> <span class="o">=</span> <span class="n">sample_block</span><span class="o">.</span><span class="n">get_transformed_meta</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_block_transform</span><span class="p">)</span>
</span><span id="PredictionPipeline-125"><a href="#PredictionPipeline-125"><span class="linenos">125</span></a>        <span class="n">output</span> <span class="o">=</span> <span class="n">output_meta</span><span class="o">.</span><span class="n">with_data</span><span class="p">(</span>
</span><span id="PredictionPipeline-126"><a href="#PredictionPipeline-126"><span class="linenos">126</span></a>            <span class="p">{</span>
</span><span id="PredictionPipeline-127"><a href="#PredictionPipeline-127"><span class="linenos">127</span></a>                <span class="n">tid</span><span class="p">:</span> <span class="n">out</span>
</span><span id="PredictionPipeline-128"><a href="#PredictionPipeline-128"><span class="linenos">128</span></a>                <span class="k">for</span> <span class="n">tid</span><span class="p">,</span> <span class="n">out</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
</span><span id="PredictionPipeline-129"><a href="#PredictionPipeline-129"><span class="linenos">129</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_output_ids</span><span class="p">,</span>
</span><span id="PredictionPipeline-130"><a href="#PredictionPipeline-130"><span class="linenos">130</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_adapter</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span>
</span><span id="PredictionPipeline-131"><a href="#PredictionPipeline-131"><span class="linenos">131</span></a>                        <span class="o">*</span><span class="p">(</span><span class="n">sample_block</span><span class="o">.</span><span class="n">members</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_input_ids</span><span class="p">)</span>
</span><span id="PredictionPipeline-132"><a href="#PredictionPipeline-132"><span class="linenos">132</span></a>                    <span class="p">),</span>
</span><span id="PredictionPipeline-133"><a href="#PredictionPipeline-133"><span class="linenos">133</span></a>                <span class="p">)</span>
</span><span id="PredictionPipeline-134"><a href="#PredictionPipeline-134"><span class="linenos">134</span></a>                <span class="k">if</span> <span class="n">out</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="PredictionPipeline-135"><a href="#PredictionPipeline-135"><span class="linenos">135</span></a>            <span class="p">},</span>
</span><span id="PredictionPipeline-136"><a href="#PredictionPipeline-136"><span class="linenos">136</span></a>            <span class="n">stat</span><span class="o">=</span><span class="n">sample_block</span><span class="o">.</span><span class="n">stat</span><span class="p">,</span>
</span><span id="PredictionPipeline-137"><a href="#PredictionPipeline-137"><span class="linenos">137</span></a>        <span class="p">)</span>
</span><span id="PredictionPipeline-138"><a href="#PredictionPipeline-138"><span class="linenos">138</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">skip_postprocessing</span><span class="p">:</span>
</span><span id="PredictionPipeline-139"><a href="#PredictionPipeline-139"><span class="linenos">139</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">apply_postprocessing</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
</span><span id="PredictionPipeline-140"><a href="#PredictionPipeline-140"><span class="linenos">140</span></a>
</span><span id="PredictionPipeline-141"><a href="#PredictionPipeline-141"><span class="linenos">141</span></a>        <span class="k">return</span> <span class="n">output</span>
</span><span id="PredictionPipeline-142"><a href="#PredictionPipeline-142"><span class="linenos">142</span></a>
</span><span id="PredictionPipeline-143"><a href="#PredictionPipeline-143"><span class="linenos">143</span></a>    <span class="k">def</span> <span class="nf">predict_sample_without_blocking</span><span class="p">(</span>
</span><span id="PredictionPipeline-144"><a href="#PredictionPipeline-144"><span class="linenos">144</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="PredictionPipeline-145"><a href="#PredictionPipeline-145"><span class="linenos">145</span></a>        <span class="n">sample</span><span class="p">:</span> <span class="n">Sample</span><span class="p">,</span>
</span><span id="PredictionPipeline-146"><a href="#PredictionPipeline-146"><span class="linenos">146</span></a>        <span class="n">skip_preprocessing</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="PredictionPipeline-147"><a href="#PredictionPipeline-147"><span class="linenos">147</span></a>        <span class="n">skip_postprocessing</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="PredictionPipeline-148"><a href="#PredictionPipeline-148"><span class="linenos">148</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sample</span><span class="p">:</span>
</span><span id="PredictionPipeline-149"><a href="#PredictionPipeline-149"><span class="linenos">149</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;predict a sample.</span>
</span><span id="PredictionPipeline-150"><a href="#PredictionPipeline-150"><span class="linenos">150</span></a><span class="sd">        The sample&#39;s tensor shapes have to match the model&#39;s input tensor description.</span>
</span><span id="PredictionPipeline-151"><a href="#PredictionPipeline-151"><span class="linenos">151</span></a><span class="sd">        If that is not the case, consider `predict_sample_with_blocking`&quot;&quot;&quot;</span>
</span><span id="PredictionPipeline-152"><a href="#PredictionPipeline-152"><span class="linenos">152</span></a>
</span><span id="PredictionPipeline-153"><a href="#PredictionPipeline-153"><span class="linenos">153</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">skip_preprocessing</span><span class="p">:</span>
</span><span id="PredictionPipeline-154"><a href="#PredictionPipeline-154"><span class="linenos">154</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">apply_preprocessing</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
</span><span id="PredictionPipeline-155"><a href="#PredictionPipeline-155"><span class="linenos">155</span></a>
</span><span id="PredictionPipeline-156"><a href="#PredictionPipeline-156"><span class="linenos">156</span></a>        <span class="n">output</span> <span class="o">=</span> <span class="n">Sample</span><span class="p">(</span>
</span><span id="PredictionPipeline-157"><a href="#PredictionPipeline-157"><span class="linenos">157</span></a>            <span class="n">members</span><span class="o">=</span><span class="p">{</span>
</span><span id="PredictionPipeline-158"><a href="#PredictionPipeline-158"><span class="linenos">158</span></a>                <span class="n">out_id</span><span class="p">:</span> <span class="n">out</span>
</span><span id="PredictionPipeline-159"><a href="#PredictionPipeline-159"><span class="linenos">159</span></a>                <span class="k">for</span> <span class="n">out_id</span><span class="p">,</span> <span class="n">out</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
</span><span id="PredictionPipeline-160"><a href="#PredictionPipeline-160"><span class="linenos">160</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_output_ids</span><span class="p">,</span>
</span><span id="PredictionPipeline-161"><a href="#PredictionPipeline-161"><span class="linenos">161</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_adapter</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span>
</span><span id="PredictionPipeline-162"><a href="#PredictionPipeline-162"><span class="linenos">162</span></a>                        <span class="o">*</span><span class="p">(</span><span class="n">sample</span><span class="o">.</span><span class="n">members</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">in_id</span><span class="p">)</span> <span class="k">for</span> <span class="n">in_id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_input_ids</span><span class="p">)</span>
</span><span id="PredictionPipeline-163"><a href="#PredictionPipeline-163"><span class="linenos">163</span></a>                    <span class="p">),</span>
</span><span id="PredictionPipeline-164"><a href="#PredictionPipeline-164"><span class="linenos">164</span></a>                <span class="p">)</span>
</span><span id="PredictionPipeline-165"><a href="#PredictionPipeline-165"><span class="linenos">165</span></a>                <span class="k">if</span> <span class="n">out</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="PredictionPipeline-166"><a href="#PredictionPipeline-166"><span class="linenos">166</span></a>            <span class="p">},</span>
</span><span id="PredictionPipeline-167"><a href="#PredictionPipeline-167"><span class="linenos">167</span></a>            <span class="n">stat</span><span class="o">=</span><span class="n">sample</span><span class="o">.</span><span class="n">stat</span><span class="p">,</span>
</span><span id="PredictionPipeline-168"><a href="#PredictionPipeline-168"><span class="linenos">168</span></a>            <span class="nb">id</span><span class="o">=</span><span class="n">sample</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
</span><span id="PredictionPipeline-169"><a href="#PredictionPipeline-169"><span class="linenos">169</span></a>        <span class="p">)</span>
</span><span id="PredictionPipeline-170"><a href="#PredictionPipeline-170"><span class="linenos">170</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">skip_postprocessing</span><span class="p">:</span>
</span><span id="PredictionPipeline-171"><a href="#PredictionPipeline-171"><span class="linenos">171</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">apply_postprocessing</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
</span><span id="PredictionPipeline-172"><a href="#PredictionPipeline-172"><span class="linenos">172</span></a>
</span><span id="PredictionPipeline-173"><a href="#PredictionPipeline-173"><span class="linenos">173</span></a>        <span class="k">return</span> <span class="n">output</span>
</span><span id="PredictionPipeline-174"><a href="#PredictionPipeline-174"><span class="linenos">174</span></a>
</span><span id="PredictionPipeline-175"><a href="#PredictionPipeline-175"><span class="linenos">175</span></a>    <span class="k">def</span> <span class="nf">get_output_sample_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_sample_id</span><span class="p">:</span> <span class="n">SampleId</span><span class="p">):</span>
</span><span id="PredictionPipeline-176"><a href="#PredictionPipeline-176"><span class="linenos">176</span></a>        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
</span><span id="PredictionPipeline-177"><a href="#PredictionPipeline-177"><span class="linenos">177</span></a>            <span class="s2">&quot;`PredictionPipeline.get_output_sample_id()` is deprecated and will be&quot;</span>
</span><span id="PredictionPipeline-178"><a href="#PredictionPipeline-178"><span class="linenos">178</span></a>            <span class="o">+</span> <span class="s2">&quot; removed soon. Output sample id is equal to input sample id, hence this&quot;</span>
</span><span id="PredictionPipeline-179"><a href="#PredictionPipeline-179"><span class="linenos">179</span></a>            <span class="o">+</span> <span class="s2">&quot; function is not needed.&quot;</span>
</span><span id="PredictionPipeline-180"><a href="#PredictionPipeline-180"><span class="linenos">180</span></a>        <span class="p">)</span>
</span><span id="PredictionPipeline-181"><a href="#PredictionPipeline-181"><span class="linenos">181</span></a>        <span class="k">return</span> <span class="n">input_sample_id</span>
</span><span id="PredictionPipeline-182"><a href="#PredictionPipeline-182"><span class="linenos">182</span></a>
</span><span id="PredictionPipeline-183"><a href="#PredictionPipeline-183"><span class="linenos">183</span></a>    <span class="k">def</span> <span class="nf">predict_sample_with_fixed_blocking</span><span class="p">(</span>
</span><span id="PredictionPipeline-184"><a href="#PredictionPipeline-184"><span class="linenos">184</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="PredictionPipeline-185"><a href="#PredictionPipeline-185"><span class="linenos">185</span></a>        <span class="n">sample</span><span class="p">:</span> <span class="n">Sample</span><span class="p">,</span>
</span><span id="PredictionPipeline-186"><a href="#PredictionPipeline-186"><span class="linenos">186</span></a>        <span class="n">input_block_shape</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="n">MemberId</span><span class="p">,</span> <span class="n">Mapping</span><span class="p">[</span><span class="n">AxisId</span><span class="p">,</span> <span class="nb">int</span><span class="p">]],</span>
</span><span id="PredictionPipeline-187"><a href="#PredictionPipeline-187"><span class="linenos">187</span></a>        <span class="o">*</span><span class="p">,</span>
</span><span id="PredictionPipeline-188"><a href="#PredictionPipeline-188"><span class="linenos">188</span></a>        <span class="n">skip_preprocessing</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="PredictionPipeline-189"><a href="#PredictionPipeline-189"><span class="linenos">189</span></a>        <span class="n">skip_postprocessing</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="PredictionPipeline-190"><a href="#PredictionPipeline-190"><span class="linenos">190</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sample</span><span class="p">:</span>
</span><span id="PredictionPipeline-191"><a href="#PredictionPipeline-191"><span class="linenos">191</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">skip_preprocessing</span><span class="p">:</span>
</span><span id="PredictionPipeline-192"><a href="#PredictionPipeline-192"><span class="linenos">192</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">apply_preprocessing</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
</span><span id="PredictionPipeline-193"><a href="#PredictionPipeline-193"><span class="linenos">193</span></a>
</span><span id="PredictionPipeline-194"><a href="#PredictionPipeline-194"><span class="linenos">194</span></a>        <span class="n">n_blocks</span><span class="p">,</span> <span class="n">input_blocks</span> <span class="o">=</span> <span class="n">sample</span><span class="o">.</span><span class="n">split_into_blocks</span><span class="p">(</span>
</span><span id="PredictionPipeline-195"><a href="#PredictionPipeline-195"><span class="linenos">195</span></a>            <span class="n">input_block_shape</span><span class="p">,</span>
</span><span id="PredictionPipeline-196"><a href="#PredictionPipeline-196"><span class="linenos">196</span></a>            <span class="n">halo</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_default_input_halo</span><span class="p">,</span>
</span><span id="PredictionPipeline-197"><a href="#PredictionPipeline-197"><span class="linenos">197</span></a>            <span class="n">pad_mode</span><span class="o">=</span><span class="s2">&quot;reflect&quot;</span><span class="p">,</span>
</span><span id="PredictionPipeline-198"><a href="#PredictionPipeline-198"><span class="linenos">198</span></a>        <span class="p">)</span>
</span><span id="PredictionPipeline-199"><a href="#PredictionPipeline-199"><span class="linenos">199</span></a>        <span class="n">input_blocks</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">input_blocks</span><span class="p">)</span>
</span><span id="PredictionPipeline-200"><a href="#PredictionPipeline-200"><span class="linenos">200</span></a>        <span class="n">predicted_blocks</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">SampleBlock</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="PredictionPipeline-201"><a href="#PredictionPipeline-201"><span class="linenos">201</span></a>        <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span>
</span><span id="PredictionPipeline-202"><a href="#PredictionPipeline-202"><span class="linenos">202</span></a>            <span class="n">input_blocks</span><span class="p">,</span>
</span><span id="PredictionPipeline-203"><a href="#PredictionPipeline-203"><span class="linenos">203</span></a>            <span class="n">desc</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;predict sample </span><span class="si">{</span><span class="n">sample</span><span class="o">.</span><span class="n">id</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}</span><span class="s2"> with </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">model_description</span><span class="o">.</span><span class="n">id</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">model_description</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="PredictionPipeline-204"><a href="#PredictionPipeline-204"><span class="linenos">204</span></a>            <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;block&quot;</span><span class="p">,</span>
</span><span id="PredictionPipeline-205"><a href="#PredictionPipeline-205"><span class="linenos">205</span></a>            <span class="n">unit_divisor</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="PredictionPipeline-206"><a href="#PredictionPipeline-206"><span class="linenos">206</span></a>            <span class="n">total</span><span class="o">=</span><span class="n">n_blocks</span><span class="p">,</span>
</span><span id="PredictionPipeline-207"><a href="#PredictionPipeline-207"><span class="linenos">207</span></a>        <span class="p">):</span>
</span><span id="PredictionPipeline-208"><a href="#PredictionPipeline-208"><span class="linenos">208</span></a>            <span class="n">predicted_blocks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="PredictionPipeline-209"><a href="#PredictionPipeline-209"><span class="linenos">209</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">predict_sample_block</span><span class="p">(</span>
</span><span id="PredictionPipeline-210"><a href="#PredictionPipeline-210"><span class="linenos">210</span></a>                    <span class="n">b</span><span class="p">,</span> <span class="n">skip_preprocessing</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">skip_postprocessing</span><span class="o">=</span><span class="kc">True</span>
</span><span id="PredictionPipeline-211"><a href="#PredictionPipeline-211"><span class="linenos">211</span></a>                <span class="p">)</span>
</span><span id="PredictionPipeline-212"><a href="#PredictionPipeline-212"><span class="linenos">212</span></a>            <span class="p">)</span>
</span><span id="PredictionPipeline-213"><a href="#PredictionPipeline-213"><span class="linenos">213</span></a>
</span><span id="PredictionPipeline-214"><a href="#PredictionPipeline-214"><span class="linenos">214</span></a>        <span class="n">predicted_sample</span> <span class="o">=</span> <span class="n">Sample</span><span class="o">.</span><span class="n">from_blocks</span><span class="p">(</span><span class="n">predicted_blocks</span><span class="p">)</span>
</span><span id="PredictionPipeline-215"><a href="#PredictionPipeline-215"><span class="linenos">215</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">skip_postprocessing</span><span class="p">:</span>
</span><span id="PredictionPipeline-216"><a href="#PredictionPipeline-216"><span class="linenos">216</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">apply_postprocessing</span><span class="p">(</span><span class="n">predicted_sample</span><span class="p">)</span>
</span><span id="PredictionPipeline-217"><a href="#PredictionPipeline-217"><span class="linenos">217</span></a>
</span><span id="PredictionPipeline-218"><a href="#PredictionPipeline-218"><span class="linenos">218</span></a>        <span class="k">return</span> <span class="n">predicted_sample</span>
</span><span id="PredictionPipeline-219"><a href="#PredictionPipeline-219"><span class="linenos">219</span></a>
</span><span id="PredictionPipeline-220"><a href="#PredictionPipeline-220"><span class="linenos">220</span></a>    <span class="k">def</span> <span class="nf">predict_sample_with_blocking</span><span class="p">(</span>
</span><span id="PredictionPipeline-221"><a href="#PredictionPipeline-221"><span class="linenos">221</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="PredictionPipeline-222"><a href="#PredictionPipeline-222"><span class="linenos">222</span></a>        <span class="n">sample</span><span class="p">:</span> <span class="n">Sample</span><span class="p">,</span>
</span><span id="PredictionPipeline-223"><a href="#PredictionPipeline-223"><span class="linenos">223</span></a>        <span class="n">skip_preprocessing</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="PredictionPipeline-224"><a href="#PredictionPipeline-224"><span class="linenos">224</span></a>        <span class="n">skip_postprocessing</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="PredictionPipeline-225"><a href="#PredictionPipeline-225"><span class="linenos">225</span></a>        <span class="n">ns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span>
</span><span id="PredictionPipeline-226"><a href="#PredictionPipeline-226"><span class="linenos">226</span></a>            <span class="n">Union</span><span class="p">[</span>
</span><span id="PredictionPipeline-227"><a href="#PredictionPipeline-227"><span class="linenos">227</span></a>                <span class="n">v0_5</span><span class="o">.</span><span class="n">ParameterizedSize_N</span><span class="p">,</span>
</span><span id="PredictionPipeline-228"><a href="#PredictionPipeline-228"><span class="linenos">228</span></a>                <span class="n">Mapping</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">MemberId</span><span class="p">,</span> <span class="n">AxisId</span><span class="p">],</span> <span class="n">v0_5</span><span class="o">.</span><span class="n">ParameterizedSize_N</span><span class="p">],</span>
</span><span id="PredictionPipeline-229"><a href="#PredictionPipeline-229"><span class="linenos">229</span></a>            <span class="p">]</span>
</span><span id="PredictionPipeline-230"><a href="#PredictionPipeline-230"><span class="linenos">230</span></a>        <span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PredictionPipeline-231"><a href="#PredictionPipeline-231"><span class="linenos">231</span></a>        <span class="n">batch_size</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PredictionPipeline-232"><a href="#PredictionPipeline-232"><span class="linenos">232</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sample</span><span class="p">:</span>
</span><span id="PredictionPipeline-233"><a href="#PredictionPipeline-233"><span class="linenos">233</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;predict a sample by splitting it into blocks according to the model and the `ns` parameter&quot;&quot;&quot;</span>
</span><span id="PredictionPipeline-234"><a href="#PredictionPipeline-234"><span class="linenos">234</span></a>
</span><span id="PredictionPipeline-235"><a href="#PredictionPipeline-235"><span class="linenos">235</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model_description</span><span class="p">,</span> <span class="n">v0_4</span><span class="o">.</span><span class="n">ModelDescr</span><span class="p">):</span>
</span><span id="PredictionPipeline-236"><a href="#PredictionPipeline-236"><span class="linenos">236</span></a>            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
</span><span id="PredictionPipeline-237"><a href="#PredictionPipeline-237"><span class="linenos">237</span></a>                <span class="s2">&quot;`predict_sample_with_blocking` not implemented for v0_4.ModelDescr&quot;</span>
</span><span id="PredictionPipeline-238"><a href="#PredictionPipeline-238"><span class="linenos">238</span></a>                <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">model_description</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">.&quot;</span>
</span><span id="PredictionPipeline-239"><a href="#PredictionPipeline-239"><span class="linenos">239</span></a>                <span class="o">+</span> <span class="s2">&quot; Consider using `predict_sample_with_fixed_blocking`&quot;</span>
</span><span id="PredictionPipeline-240"><a href="#PredictionPipeline-240"><span class="linenos">240</span></a>            <span class="p">)</span>
</span><span id="PredictionPipeline-241"><a href="#PredictionPipeline-241"><span class="linenos">241</span></a>
</span><span id="PredictionPipeline-242"><a href="#PredictionPipeline-242"><span class="linenos">242</span></a>        <span class="n">ns</span> <span class="o">=</span> <span class="n">ns</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_default_ns</span>
</span><span id="PredictionPipeline-243"><a href="#PredictionPipeline-243"><span class="linenos">243</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ns</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
</span><span id="PredictionPipeline-244"><a href="#PredictionPipeline-244"><span class="linenos">244</span></a>            <span class="n">ns</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="PredictionPipeline-245"><a href="#PredictionPipeline-245"><span class="linenos">245</span></a>                <span class="p">(</span><span class="n">ipt</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">id</span><span class="p">):</span> <span class="n">ns</span>
</span><span id="PredictionPipeline-246"><a href="#PredictionPipeline-246"><span class="linenos">246</span></a>                <span class="k">for</span> <span class="n">ipt</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_description</span><span class="o">.</span><span class="n">inputs</span>
</span><span id="PredictionPipeline-247"><a href="#PredictionPipeline-247"><span class="linenos">247</span></a>                <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">ipt</span><span class="o">.</span><span class="n">axes</span>
</span><span id="PredictionPipeline-248"><a href="#PredictionPipeline-248"><span class="linenos">248</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">v0_5</span><span class="o">.</span><span class="n">ParameterizedSize</span><span class="p">)</span>
</span><span id="PredictionPipeline-249"><a href="#PredictionPipeline-249"><span class="linenos">249</span></a>            <span class="p">}</span>
</span><span id="PredictionPipeline-250"><a href="#PredictionPipeline-250"><span class="linenos">250</span></a>        <span class="n">input_block_shape</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_description</span><span class="o">.</span><span class="n">get_tensor_sizes</span><span class="p">(</span>
</span><span id="PredictionPipeline-251"><a href="#PredictionPipeline-251"><span class="linenos">251</span></a>            <span class="n">ns</span><span class="p">,</span> <span class="n">batch_size</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_default_batch_size</span>
</span><span id="PredictionPipeline-252"><a href="#PredictionPipeline-252"><span class="linenos">252</span></a>        <span class="p">)</span><span class="o">.</span><span class="n">inputs</span>
</span><span id="PredictionPipeline-253"><a href="#PredictionPipeline-253"><span class="linenos">253</span></a>
</span><span id="PredictionPipeline-254"><a href="#PredictionPipeline-254"><span class="linenos">254</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict_sample_with_fixed_blocking</span><span class="p">(</span>
</span><span id="PredictionPipeline-255"><a href="#PredictionPipeline-255"><span class="linenos">255</span></a>            <span class="n">sample</span><span class="p">,</span>
</span><span id="PredictionPipeline-256"><a href="#PredictionPipeline-256"><span class="linenos">256</span></a>            <span class="n">input_block_shape</span><span class="o">=</span><span class="n">input_block_shape</span><span class="p">,</span>
</span><span id="PredictionPipeline-257"><a href="#PredictionPipeline-257"><span class="linenos">257</span></a>            <span class="n">skip_preprocessing</span><span class="o">=</span><span class="n">skip_preprocessing</span><span class="p">,</span>
</span><span id="PredictionPipeline-258"><a href="#PredictionPipeline-258"><span class="linenos">258</span></a>            <span class="n">skip_postprocessing</span><span class="o">=</span><span class="n">skip_postprocessing</span><span class="p">,</span>
</span><span id="PredictionPipeline-259"><a href="#PredictionPipeline-259"><span class="linenos">259</span></a>        <span class="p">)</span>
</span><span id="PredictionPipeline-260"><a href="#PredictionPipeline-260"><span class="linenos">260</span></a>
</span><span id="PredictionPipeline-261"><a href="#PredictionPipeline-261"><span class="linenos">261</span></a>    <span class="c1"># def predict(</span>
</span><span id="PredictionPipeline-262"><a href="#PredictionPipeline-262"><span class="linenos">262</span></a>    <span class="c1">#     self,</span>
</span><span id="PredictionPipeline-263"><a href="#PredictionPipeline-263"><span class="linenos">263</span></a>    <span class="c1">#     inputs: Predict_IO,</span>
</span><span id="PredictionPipeline-264"><a href="#PredictionPipeline-264"><span class="linenos">264</span></a>    <span class="c1">#     skip_preprocessing: bool = False,</span>
</span><span id="PredictionPipeline-265"><a href="#PredictionPipeline-265"><span class="linenos">265</span></a>    <span class="c1">#     skip_postprocessing: bool = False,</span>
</span><span id="PredictionPipeline-266"><a href="#PredictionPipeline-266"><span class="linenos">266</span></a>    <span class="c1"># ) -&gt; Predict_IO:</span>
</span><span id="PredictionPipeline-267"><a href="#PredictionPipeline-267"><span class="linenos">267</span></a>    <span class="c1">#     &quot;&quot;&quot;Run model prediction **including** pre/postprocessing.&quot;&quot;&quot;</span>
</span><span id="PredictionPipeline-268"><a href="#PredictionPipeline-268"><span class="linenos">268</span></a>
</span><span id="PredictionPipeline-269"><a href="#PredictionPipeline-269"><span class="linenos">269</span></a>    <span class="c1">#     if isinstance(inputs, Sample):</span>
</span><span id="PredictionPipeline-270"><a href="#PredictionPipeline-270"><span class="linenos">270</span></a>    <span class="c1">#         return self.predict_sample_with_blocking(</span>
</span><span id="PredictionPipeline-271"><a href="#PredictionPipeline-271"><span class="linenos">271</span></a>    <span class="c1">#             inputs,</span>
</span><span id="PredictionPipeline-272"><a href="#PredictionPipeline-272"><span class="linenos">272</span></a>    <span class="c1">#             skip_preprocessing=skip_preprocessing,</span>
</span><span id="PredictionPipeline-273"><a href="#PredictionPipeline-273"><span class="linenos">273</span></a>    <span class="c1">#             skip_postprocessing=skip_postprocessing,</span>
</span><span id="PredictionPipeline-274"><a href="#PredictionPipeline-274"><span class="linenos">274</span></a>    <span class="c1">#         )</span>
</span><span id="PredictionPipeline-275"><a href="#PredictionPipeline-275"><span class="linenos">275</span></a>    <span class="c1">#     elif isinstance(inputs, collections.abc.Iterable):</span>
</span><span id="PredictionPipeline-276"><a href="#PredictionPipeline-276"><span class="linenos">276</span></a>    <span class="c1">#         return (</span>
</span><span id="PredictionPipeline-277"><a href="#PredictionPipeline-277"><span class="linenos">277</span></a>    <span class="c1">#             self.predict(</span>
</span><span id="PredictionPipeline-278"><a href="#PredictionPipeline-278"><span class="linenos">278</span></a>    <span class="c1">#                 ipt,</span>
</span><span id="PredictionPipeline-279"><a href="#PredictionPipeline-279"><span class="linenos">279</span></a>    <span class="c1">#                 skip_preprocessing=skip_preprocessing,</span>
</span><span id="PredictionPipeline-280"><a href="#PredictionPipeline-280"><span class="linenos">280</span></a>    <span class="c1">#                 skip_postprocessing=skip_postprocessing,</span>
</span><span id="PredictionPipeline-281"><a href="#PredictionPipeline-281"><span class="linenos">281</span></a>    <span class="c1">#             )</span>
</span><span id="PredictionPipeline-282"><a href="#PredictionPipeline-282"><span class="linenos">282</span></a>    <span class="c1">#             for ipt in inputs</span>
</span><span id="PredictionPipeline-283"><a href="#PredictionPipeline-283"><span class="linenos">283</span></a>    <span class="c1">#         )</span>
</span><span id="PredictionPipeline-284"><a href="#PredictionPipeline-284"><span class="linenos">284</span></a>    <span class="c1">#     else:</span>
</span><span id="PredictionPipeline-285"><a href="#PredictionPipeline-285"><span class="linenos">285</span></a>    <span class="c1">#         assert_never(inputs)</span>
</span><span id="PredictionPipeline-286"><a href="#PredictionPipeline-286"><span class="linenos">286</span></a>
</span><span id="PredictionPipeline-287"><a href="#PredictionPipeline-287"><span class="linenos">287</span></a>    <span class="k">def</span> <span class="nf">apply_preprocessing</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sample</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Sample</span><span class="p">,</span> <span class="n">SampleBlockWithOrigin</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PredictionPipeline-288"><a href="#PredictionPipeline-288"><span class="linenos">288</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;apply preprocessing in-place, also updates sample stats&quot;&quot;&quot;</span>
</span><span id="PredictionPipeline-289"><a href="#PredictionPipeline-289"><span class="linenos">289</span></a>        <span class="k">for</span> <span class="n">op</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_preprocessing</span><span class="p">:</span>
</span><span id="PredictionPipeline-290"><a href="#PredictionPipeline-290"><span class="linenos">290</span></a>            <span class="n">op</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
</span><span id="PredictionPipeline-291"><a href="#PredictionPipeline-291"><span class="linenos">291</span></a>
</span><span id="PredictionPipeline-292"><a href="#PredictionPipeline-292"><span class="linenos">292</span></a>    <span class="k">def</span> <span class="nf">apply_postprocessing</span><span class="p">(</span>
</span><span id="PredictionPipeline-293"><a href="#PredictionPipeline-293"><span class="linenos">293</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">sample</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Sample</span><span class="p">,</span> <span class="n">SampleBlock</span><span class="p">,</span> <span class="n">SampleBlockWithOrigin</span><span class="p">]</span>
</span><span id="PredictionPipeline-294"><a href="#PredictionPipeline-294"><span class="linenos">294</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PredictionPipeline-295"><a href="#PredictionPipeline-295"><span class="linenos">295</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;apply postprocessing in-place, also updates samples stats&quot;&quot;&quot;</span>
</span><span id="PredictionPipeline-296"><a href="#PredictionPipeline-296"><span class="linenos">296</span></a>        <span class="k">for</span> <span class="n">op</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_postprocessing</span><span class="p">:</span>
</span><span id="PredictionPipeline-297"><a href="#PredictionPipeline-297"><span class="linenos">297</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="p">(</span><span class="n">Sample</span><span class="p">,</span> <span class="n">SampleBlockWithOrigin</span><span class="p">)):</span>
</span><span id="PredictionPipeline-298"><a href="#PredictionPipeline-298"><span class="linenos">298</span></a>                <span class="n">op</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
</span><span id="PredictionPipeline-299"><a href="#PredictionPipeline-299"><span class="linenos">299</span></a>            <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">op</span><span class="p">,</span> <span class="n">BlockedOperator</span><span class="p">):</span>
</span><span id="PredictionPipeline-300"><a href="#PredictionPipeline-300"><span class="linenos">300</span></a>                <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
</span><span id="PredictionPipeline-301"><a href="#PredictionPipeline-301"><span class="linenos">301</span></a>                    <span class="s2">&quot;block wise update of output statistics not yet implemented&quot;</span>
</span><span id="PredictionPipeline-302"><a href="#PredictionPipeline-302"><span class="linenos">302</span></a>                <span class="p">)</span>
</span><span id="PredictionPipeline-303"><a href="#PredictionPipeline-303"><span class="linenos">303</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="PredictionPipeline-304"><a href="#PredictionPipeline-304"><span class="linenos">304</span></a>                <span class="n">op</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
</span><span id="PredictionPipeline-305"><a href="#PredictionPipeline-305"><span class="linenos">305</span></a>
</span><span id="PredictionPipeline-306"><a href="#PredictionPipeline-306"><span class="linenos">306</span></a>    <span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="PredictionPipeline-307"><a href="#PredictionPipeline-307"><span class="linenos">307</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PredictionPipeline-308"><a href="#PredictionPipeline-308"><span class="linenos">308</span></a><span class="sd">        optional step: load model onto devices before calling forward if not using it as context manager</span>
</span><span id="PredictionPipeline-309"><a href="#PredictionPipeline-309"><span class="linenos">309</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PredictionPipeline-310"><a href="#PredictionPipeline-310"><span class="linenos">310</span></a>        <span class="k">pass</span>
</span><span id="PredictionPipeline-311"><a href="#PredictionPipeline-311"><span class="linenos">311</span></a>
</span><span id="PredictionPipeline-312"><a href="#PredictionPipeline-312"><span class="linenos">312</span></a>    <span class="k">def</span> <span class="nf">unload</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="PredictionPipeline-313"><a href="#PredictionPipeline-313"><span class="linenos">313</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PredictionPipeline-314"><a href="#PredictionPipeline-314"><span class="linenos">314</span></a><span class="sd">        free any device memory in use</span>
</span><span id="PredictionPipeline-315"><a href="#PredictionPipeline-315"><span class="linenos">315</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PredictionPipeline-316"><a href="#PredictionPipeline-316"><span class="linenos">316</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_adapter</span><span class="o">.</span><span class="n">unload</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Represents model computation including preprocessing and postprocessing
Note: Ideally use the PredictionPipeline as a context manager</p>
</div>


                            <div id="PredictionPipeline.__init__" class="classattr">
                                        <input id="PredictionPipeline.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">PredictionPipeline</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">name</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">model_description</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n"><a href="spec/model/v0_4.html#ModelDescr">bioimageio.spec.model.v0_4.ModelDescr</a></span><span class="p">,</span> <span class="n"><a href="spec.html#ModelDescr">bioimageio.spec.ModelDescr</a></span><span class="p">],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=</span><span class="s1">&#39;format_version&#39;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)]</span>,</span><span class="param">	<span class="n">preprocessing</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n"><a href="core/proc_ops.html#AddKnownDatasetStats">bioimageio.core.proc_ops.AddKnownDatasetStats</a></span><span class="p">,</span> <span class="n"><a href="core/proc_ops.html#Binarize">bioimageio.core.proc_ops.Binarize</a></span><span class="p">,</span> <span class="n"><a href="core/proc_ops.html#Clip">bioimageio.core.proc_ops.Clip</a></span><span class="p">,</span> <span class="n"><a href="core/proc_ops.html#EnsureDtype">bioimageio.core.proc_ops.EnsureDtype</a></span><span class="p">,</span> <span class="n"><a href="core/proc_ops.html#FixedZeroMeanUnitVariance">bioimageio.core.proc_ops.FixedZeroMeanUnitVariance</a></span><span class="p">,</span> <span class="n"><a href="core/proc_ops.html#ScaleLinear">bioimageio.core.proc_ops.ScaleLinear</a></span><span class="p">,</span> <span class="n"><a href="core/proc_ops.html#ScaleMeanVariance">bioimageio.core.proc_ops.ScaleMeanVariance</a></span><span class="p">,</span> <span class="n"><a href="core/proc_ops.html#ScaleRange">bioimageio.core.proc_ops.ScaleRange</a></span><span class="p">,</span> <span class="n"><a href="core/proc_ops.html#Sigmoid">bioimageio.core.proc_ops.Sigmoid</a></span><span class="p">,</span> <span class="n"><a href="core/proc_ops.html#UpdateStats">bioimageio.core.proc_ops.UpdateStats</a></span><span class="p">,</span> <span class="n"><a href="core/proc_ops.html#ZeroMeanUnitVariance">bioimageio.core.proc_ops.ZeroMeanUnitVariance</a></span><span class="p">]]</span>,</span><span class="param">	<span class="n">postprocessing</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n"><a href="core/proc_ops.html#AddKnownDatasetStats">bioimageio.core.proc_ops.AddKnownDatasetStats</a></span><span class="p">,</span> <span class="n"><a href="core/proc_ops.html#Binarize">bioimageio.core.proc_ops.Binarize</a></span><span class="p">,</span> <span class="n"><a href="core/proc_ops.html#Clip">bioimageio.core.proc_ops.Clip</a></span><span class="p">,</span> <span class="n"><a href="core/proc_ops.html#EnsureDtype">bioimageio.core.proc_ops.EnsureDtype</a></span><span class="p">,</span> <span class="n"><a href="core/proc_ops.html#FixedZeroMeanUnitVariance">bioimageio.core.proc_ops.FixedZeroMeanUnitVariance</a></span><span class="p">,</span> <span class="n"><a href="core/proc_ops.html#ScaleLinear">bioimageio.core.proc_ops.ScaleLinear</a></span><span class="p">,</span> <span class="n"><a href="core/proc_ops.html#ScaleMeanVariance">bioimageio.core.proc_ops.ScaleMeanVariance</a></span><span class="p">,</span> <span class="n"><a href="core/proc_ops.html#ScaleRange">bioimageio.core.proc_ops.ScaleRange</a></span><span class="p">,</span> <span class="n"><a href="core/proc_ops.html#Sigmoid">bioimageio.core.proc_ops.Sigmoid</a></span><span class="p">,</span> <span class="n"><a href="core/proc_ops.html#UpdateStats">bioimageio.core.proc_ops.UpdateStats</a></span><span class="p">,</span> <span class="n"><a href="core/proc_ops.html#ZeroMeanUnitVariance">bioimageio.core.proc_ops.ZeroMeanUnitVariance</a></span><span class="p">]]</span>,</span><span class="param">	<span class="n">model_adapter</span><span class="p">:</span> <span class="n"><a href="core/model_adapters.html#ModelAdapter">bioimageio.core.model_adapters.ModelAdapter</a></span>,</span><span class="param">	<span class="n">default_ns</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Mapping</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n"><a href="spec/model/v0_5.html#TensorId">bioimageio.spec.model.v0_5.TensorId</a></span><span class="p">,</span> <span class="n"><a href="#AxisId">AxisId</a></span><span class="p">],</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">10</span>,</span><span class="param">	<span class="n">default_batch_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span></span>)</span>

                <label class="view-source-button" for="PredictionPipeline.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PredictionPipeline.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PredictionPipeline.__init__-50"><a href="#PredictionPipeline.__init__-50"><span class="linenos">50</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="PredictionPipeline.__init__-51"><a href="#PredictionPipeline.__init__-51"><span class="linenos">51</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="PredictionPipeline.__init__-52"><a href="#PredictionPipeline.__init__-52"><span class="linenos">52</span></a>        <span class="o">*</span><span class="p">,</span>
</span><span id="PredictionPipeline.__init__-53"><a href="#PredictionPipeline.__init__-53"><span class="linenos">53</span></a>        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="PredictionPipeline.__init__-54"><a href="#PredictionPipeline.__init__-54"><span class="linenos">54</span></a>        <span class="n">model_description</span><span class="p">:</span> <span class="n">AnyModelDescr</span><span class="p">,</span>
</span><span id="PredictionPipeline.__init__-55"><a href="#PredictionPipeline.__init__-55"><span class="linenos">55</span></a>        <span class="n">preprocessing</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Processing</span><span class="p">],</span>
</span><span id="PredictionPipeline.__init__-56"><a href="#PredictionPipeline.__init__-56"><span class="linenos">56</span></a>        <span class="n">postprocessing</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Processing</span><span class="p">],</span>
</span><span id="PredictionPipeline.__init__-57"><a href="#PredictionPipeline.__init__-57"><span class="linenos">57</span></a>        <span class="n">model_adapter</span><span class="p">:</span> <span class="n">ModelAdapter</span><span class="p">,</span>
</span><span id="PredictionPipeline.__init__-58"><a href="#PredictionPipeline.__init__-58"><span class="linenos">58</span></a>        <span class="n">default_ns</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span>
</span><span id="PredictionPipeline.__init__-59"><a href="#PredictionPipeline.__init__-59"><span class="linenos">59</span></a>            <span class="n">v0_5</span><span class="o">.</span><span class="n">ParameterizedSize_N</span><span class="p">,</span>
</span><span id="PredictionPipeline.__init__-60"><a href="#PredictionPipeline.__init__-60"><span class="linenos">60</span></a>            <span class="n">Mapping</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">MemberId</span><span class="p">,</span> <span class="n">AxisId</span><span class="p">],</span> <span class="n">v0_5</span><span class="o">.</span><span class="n">ParameterizedSize_N</span><span class="p">],</span>
</span><span id="PredictionPipeline.__init__-61"><a href="#PredictionPipeline.__init__-61"><span class="linenos">61</span></a>        <span class="p">]</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
</span><span id="PredictionPipeline.__init__-62"><a href="#PredictionPipeline.__init__-62"><span class="linenos">62</span></a>        <span class="n">default_batch_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="PredictionPipeline.__init__-63"><a href="#PredictionPipeline.__init__-63"><span class="linenos">63</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PredictionPipeline.__init__-64"><a href="#PredictionPipeline.__init__-64"><span class="linenos">64</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
</span><span id="PredictionPipeline.__init__-65"><a href="#PredictionPipeline.__init__-65"><span class="linenos">65</span></a>        <span class="k">if</span> <span class="n">model_description</span><span class="o">.</span><span class="n">run_mode</span><span class="p">:</span>
</span><span id="PredictionPipeline.__init__-66"><a href="#PredictionPipeline.__init__-66"><span class="linenos">66</span></a>            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
</span><span id="PredictionPipeline.__init__-67"><a href="#PredictionPipeline.__init__-67"><span class="linenos">67</span></a>                <span class="sa">f</span><span class="s2">&quot;Not yet implemented inference for run mode &#39;</span><span class="si">{</span><span class="n">model_description</span><span class="o">.</span><span class="n">run_mode</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
</span><span id="PredictionPipeline.__init__-68"><a href="#PredictionPipeline.__init__-68"><span class="linenos">68</span></a>            <span class="p">)</span>
</span><span id="PredictionPipeline.__init__-69"><a href="#PredictionPipeline.__init__-69"><span class="linenos">69</span></a>
</span><span id="PredictionPipeline.__init__-70"><a href="#PredictionPipeline.__init__-70"><span class="linenos">70</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
</span><span id="PredictionPipeline.__init__-71"><a href="#PredictionPipeline.__init__-71"><span class="linenos">71</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_preprocessing</span> <span class="o">=</span> <span class="n">preprocessing</span>
</span><span id="PredictionPipeline.__init__-72"><a href="#PredictionPipeline.__init__-72"><span class="linenos">72</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_postprocessing</span> <span class="o">=</span> <span class="n">postprocessing</span>
</span><span id="PredictionPipeline.__init__-73"><a href="#PredictionPipeline.__init__-73"><span class="linenos">73</span></a>
</span><span id="PredictionPipeline.__init__-74"><a href="#PredictionPipeline.__init__-74"><span class="linenos">74</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model_description</span> <span class="o">=</span> <span class="n">model_description</span>
</span><span id="PredictionPipeline.__init__-75"><a href="#PredictionPipeline.__init__-75"><span class="linenos">75</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">model_description</span><span class="p">,</span> <span class="n">v0_4</span><span class="o">.</span><span class="n">ModelDescr</span><span class="p">):</span>
</span><span id="PredictionPipeline.__init__-76"><a href="#PredictionPipeline.__init__-76"><span class="linenos">76</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_default_input_halo</span><span class="p">:</span> <span class="n">PerMember</span><span class="p">[</span><span class="n">PerAxis</span><span class="p">[</span><span class="n">Halo</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="PredictionPipeline.__init__-77"><a href="#PredictionPipeline.__init__-77"><span class="linenos">77</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_block_transform</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="PredictionPipeline.__init__-78"><a href="#PredictionPipeline.__init__-78"><span class="linenos">78</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="PredictionPipeline.__init__-79"><a href="#PredictionPipeline.__init__-79"><span class="linenos">79</span></a>            <span class="n">default_output_halo</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="PredictionPipeline.__init__-80"><a href="#PredictionPipeline.__init__-80"><span class="linenos">80</span></a>                <span class="n">t</span><span class="o">.</span><span class="n">id</span><span class="p">:</span> <span class="p">{</span>
</span><span id="PredictionPipeline.__init__-81"><a href="#PredictionPipeline.__init__-81"><span class="linenos">81</span></a>                    <span class="n">a</span><span class="o">.</span><span class="n">id</span><span class="p">:</span> <span class="n">Halo</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">halo</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">halo</span><span class="p">)</span>
</span><span id="PredictionPipeline.__init__-82"><a href="#PredictionPipeline.__init__-82"><span class="linenos">82</span></a>                    <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">t</span><span class="o">.</span><span class="n">axes</span>
</span><span id="PredictionPipeline.__init__-83"><a href="#PredictionPipeline.__init__-83"><span class="linenos">83</span></a>                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">v0_5</span><span class="o">.</span><span class="n">WithHalo</span><span class="p">)</span>
</span><span id="PredictionPipeline.__init__-84"><a href="#PredictionPipeline.__init__-84"><span class="linenos">84</span></a>                <span class="p">}</span>
</span><span id="PredictionPipeline.__init__-85"><a href="#PredictionPipeline.__init__-85"><span class="linenos">85</span></a>                <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">model_description</span><span class="o">.</span><span class="n">outputs</span>
</span><span id="PredictionPipeline.__init__-86"><a href="#PredictionPipeline.__init__-86"><span class="linenos">86</span></a>            <span class="p">}</span>
</span><span id="PredictionPipeline.__init__-87"><a href="#PredictionPipeline.__init__-87"><span class="linenos">87</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_default_input_halo</span> <span class="o">=</span> <span class="n">get_input_halo</span><span class="p">(</span>
</span><span id="PredictionPipeline.__init__-88"><a href="#PredictionPipeline.__init__-88"><span class="linenos">88</span></a>                <span class="n">model_description</span><span class="p">,</span> <span class="n">default_output_halo</span>
</span><span id="PredictionPipeline.__init__-89"><a href="#PredictionPipeline.__init__-89"><span class="linenos">89</span></a>            <span class="p">)</span>
</span><span id="PredictionPipeline.__init__-90"><a href="#PredictionPipeline.__init__-90"><span class="linenos">90</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_block_transform</span> <span class="o">=</span> <span class="n">get_block_transform</span><span class="p">(</span><span class="n">model_description</span><span class="p">)</span>
</span><span id="PredictionPipeline.__init__-91"><a href="#PredictionPipeline.__init__-91"><span class="linenos">91</span></a>
</span><span id="PredictionPipeline.__init__-92"><a href="#PredictionPipeline.__init__-92"><span class="linenos">92</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_default_ns</span> <span class="o">=</span> <span class="n">default_ns</span>
</span><span id="PredictionPipeline.__init__-93"><a href="#PredictionPipeline.__init__-93"><span class="linenos">93</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_default_batch_size</span> <span class="o">=</span> <span class="n">default_batch_size</span>
</span><span id="PredictionPipeline.__init__-94"><a href="#PredictionPipeline.__init__-94"><span class="linenos">94</span></a>
</span><span id="PredictionPipeline.__init__-95"><a href="#PredictionPipeline.__init__-95"><span class="linenos">95</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_input_ids</span> <span class="o">=</span> <span class="n">get_member_ids</span><span class="p">(</span><span class="n">model_description</span><span class="o">.</span><span class="n">inputs</span><span class="p">)</span>
</span><span id="PredictionPipeline.__init__-96"><a href="#PredictionPipeline.__init__-96"><span class="linenos">96</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_output_ids</span> <span class="o">=</span> <span class="n">get_member_ids</span><span class="p">(</span><span class="n">model_description</span><span class="o">.</span><span class="n">outputs</span><span class="p">)</span>
</span><span id="PredictionPipeline.__init__-97"><a href="#PredictionPipeline.__init__-97"><span class="linenos">97</span></a>
</span><span id="PredictionPipeline.__init__-98"><a href="#PredictionPipeline.__init__-98"><span class="linenos">98</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_adapter</span><span class="p">:</span> <span class="n">ModelAdapter</span> <span class="o">=</span> <span class="n">model_adapter</span>
</span></pre></div>


    

                            </div>
                            <div id="PredictionPipeline.name" class="classattr">
                                <div class="attr variable">
            <span class="name">name</span>

        
    </div>
    <a class="headerlink" href="#PredictionPipeline.name"></a>
    
    

                            </div>
                            <div id="PredictionPipeline.model_description" class="classattr">
                                <div class="attr variable">
            <span class="name">model_description</span>

        
    </div>
    <a class="headerlink" href="#PredictionPipeline.model_description"></a>
    
    

                            </div>
                            <div id="PredictionPipeline.predict_sample_block" class="classattr">
                                        <input id="PredictionPipeline.predict_sample_block-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">predict_sample_block</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">sample_block</span><span class="p">:</span> <span class="n"><a href="core/sample.html#SampleBlockWithOrigin">bioimageio.core.sample.SampleBlockWithOrigin</a></span>,</span><span class="param">	<span class="n">skip_preprocessing</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">skip_postprocessing</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">) -> <span class="n"><a href="core/sample.html#SampleBlock">bioimageio.core.sample.SampleBlock</a></span>:</span></span>

                <label class="view-source-button" for="PredictionPipeline.predict_sample_block-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PredictionPipeline.predict_sample_block"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PredictionPipeline.predict_sample_block-108"><a href="#PredictionPipeline.predict_sample_block-108"><span class="linenos">108</span></a>    <span class="k">def</span> <span class="nf">predict_sample_block</span><span class="p">(</span>
</span><span id="PredictionPipeline.predict_sample_block-109"><a href="#PredictionPipeline.predict_sample_block-109"><span class="linenos">109</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="PredictionPipeline.predict_sample_block-110"><a href="#PredictionPipeline.predict_sample_block-110"><span class="linenos">110</span></a>        <span class="n">sample_block</span><span class="p">:</span> <span class="n">SampleBlockWithOrigin</span><span class="p">,</span>
</span><span id="PredictionPipeline.predict_sample_block-111"><a href="#PredictionPipeline.predict_sample_block-111"><span class="linenos">111</span></a>        <span class="n">skip_preprocessing</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="PredictionPipeline.predict_sample_block-112"><a href="#PredictionPipeline.predict_sample_block-112"><span class="linenos">112</span></a>        <span class="n">skip_postprocessing</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="PredictionPipeline.predict_sample_block-113"><a href="#PredictionPipeline.predict_sample_block-113"><span class="linenos">113</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SampleBlock</span><span class="p">:</span>
</span><span id="PredictionPipeline.predict_sample_block-114"><a href="#PredictionPipeline.predict_sample_block-114"><span class="linenos">114</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model_description</span><span class="p">,</span> <span class="n">v0_4</span><span class="o">.</span><span class="n">ModelDescr</span><span class="p">):</span>
</span><span id="PredictionPipeline.predict_sample_block-115"><a href="#PredictionPipeline.predict_sample_block-115"><span class="linenos">115</span></a>            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
</span><span id="PredictionPipeline.predict_sample_block-116"><a href="#PredictionPipeline.predict_sample_block-116"><span class="linenos">116</span></a>                <span class="sa">f</span><span class="s2">&quot;predict_sample_block not implemented for model </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">model_description</span><span class="o">.</span><span class="n">format_version</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="PredictionPipeline.predict_sample_block-117"><a href="#PredictionPipeline.predict_sample_block-117"><span class="linenos">117</span></a>            <span class="p">)</span>
</span><span id="PredictionPipeline.predict_sample_block-118"><a href="#PredictionPipeline.predict_sample_block-118"><span class="linenos">118</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="PredictionPipeline.predict_sample_block-119"><a href="#PredictionPipeline.predict_sample_block-119"><span class="linenos">119</span></a>            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">_block_transform</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="PredictionPipeline.predict_sample_block-120"><a href="#PredictionPipeline.predict_sample_block-120"><span class="linenos">120</span></a>
</span><span id="PredictionPipeline.predict_sample_block-121"><a href="#PredictionPipeline.predict_sample_block-121"><span class="linenos">121</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">skip_preprocessing</span><span class="p">:</span>
</span><span id="PredictionPipeline.predict_sample_block-122"><a href="#PredictionPipeline.predict_sample_block-122"><span class="linenos">122</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">apply_preprocessing</span><span class="p">(</span><span class="n">sample_block</span><span class="p">)</span>
</span><span id="PredictionPipeline.predict_sample_block-123"><a href="#PredictionPipeline.predict_sample_block-123"><span class="linenos">123</span></a>
</span><span id="PredictionPipeline.predict_sample_block-124"><a href="#PredictionPipeline.predict_sample_block-124"><span class="linenos">124</span></a>        <span class="n">output_meta</span> <span class="o">=</span> <span class="n">sample_block</span><span class="o">.</span><span class="n">get_transformed_meta</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_block_transform</span><span class="p">)</span>
</span><span id="PredictionPipeline.predict_sample_block-125"><a href="#PredictionPipeline.predict_sample_block-125"><span class="linenos">125</span></a>        <span class="n">output</span> <span class="o">=</span> <span class="n">output_meta</span><span class="o">.</span><span class="n">with_data</span><span class="p">(</span>
</span><span id="PredictionPipeline.predict_sample_block-126"><a href="#PredictionPipeline.predict_sample_block-126"><span class="linenos">126</span></a>            <span class="p">{</span>
</span><span id="PredictionPipeline.predict_sample_block-127"><a href="#PredictionPipeline.predict_sample_block-127"><span class="linenos">127</span></a>                <span class="n">tid</span><span class="p">:</span> <span class="n">out</span>
</span><span id="PredictionPipeline.predict_sample_block-128"><a href="#PredictionPipeline.predict_sample_block-128"><span class="linenos">128</span></a>                <span class="k">for</span> <span class="n">tid</span><span class="p">,</span> <span class="n">out</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
</span><span id="PredictionPipeline.predict_sample_block-129"><a href="#PredictionPipeline.predict_sample_block-129"><span class="linenos">129</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_output_ids</span><span class="p">,</span>
</span><span id="PredictionPipeline.predict_sample_block-130"><a href="#PredictionPipeline.predict_sample_block-130"><span class="linenos">130</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_adapter</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span>
</span><span id="PredictionPipeline.predict_sample_block-131"><a href="#PredictionPipeline.predict_sample_block-131"><span class="linenos">131</span></a>                        <span class="o">*</span><span class="p">(</span><span class="n">sample_block</span><span class="o">.</span><span class="n">members</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_input_ids</span><span class="p">)</span>
</span><span id="PredictionPipeline.predict_sample_block-132"><a href="#PredictionPipeline.predict_sample_block-132"><span class="linenos">132</span></a>                    <span class="p">),</span>
</span><span id="PredictionPipeline.predict_sample_block-133"><a href="#PredictionPipeline.predict_sample_block-133"><span class="linenos">133</span></a>                <span class="p">)</span>
</span><span id="PredictionPipeline.predict_sample_block-134"><a href="#PredictionPipeline.predict_sample_block-134"><span class="linenos">134</span></a>                <span class="k">if</span> <span class="n">out</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="PredictionPipeline.predict_sample_block-135"><a href="#PredictionPipeline.predict_sample_block-135"><span class="linenos">135</span></a>            <span class="p">},</span>
</span><span id="PredictionPipeline.predict_sample_block-136"><a href="#PredictionPipeline.predict_sample_block-136"><span class="linenos">136</span></a>            <span class="n">stat</span><span class="o">=</span><span class="n">sample_block</span><span class="o">.</span><span class="n">stat</span><span class="p">,</span>
</span><span id="PredictionPipeline.predict_sample_block-137"><a href="#PredictionPipeline.predict_sample_block-137"><span class="linenos">137</span></a>        <span class="p">)</span>
</span><span id="PredictionPipeline.predict_sample_block-138"><a href="#PredictionPipeline.predict_sample_block-138"><span class="linenos">138</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">skip_postprocessing</span><span class="p">:</span>
</span><span id="PredictionPipeline.predict_sample_block-139"><a href="#PredictionPipeline.predict_sample_block-139"><span class="linenos">139</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">apply_postprocessing</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
</span><span id="PredictionPipeline.predict_sample_block-140"><a href="#PredictionPipeline.predict_sample_block-140"><span class="linenos">140</span></a>
</span><span id="PredictionPipeline.predict_sample_block-141"><a href="#PredictionPipeline.predict_sample_block-141"><span class="linenos">141</span></a>        <span class="k">return</span> <span class="n">output</span>
</span></pre></div>


    

                            </div>
                            <div id="PredictionPipeline.predict_sample_without_blocking" class="classattr">
                                        <input id="PredictionPipeline.predict_sample_without_blocking-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">predict_sample_without_blocking</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">sample</span><span class="p">:</span> <span class="n"><a href="#Sample">Sample</a></span>,</span><span class="param">	<span class="n">skip_preprocessing</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">skip_postprocessing</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">) -> <span class="n"><a href="#Sample">Sample</a></span>:</span></span>

                <label class="view-source-button" for="PredictionPipeline.predict_sample_without_blocking-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PredictionPipeline.predict_sample_without_blocking"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PredictionPipeline.predict_sample_without_blocking-143"><a href="#PredictionPipeline.predict_sample_without_blocking-143"><span class="linenos">143</span></a>    <span class="k">def</span> <span class="nf">predict_sample_without_blocking</span><span class="p">(</span>
</span><span id="PredictionPipeline.predict_sample_without_blocking-144"><a href="#PredictionPipeline.predict_sample_without_blocking-144"><span class="linenos">144</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="PredictionPipeline.predict_sample_without_blocking-145"><a href="#PredictionPipeline.predict_sample_without_blocking-145"><span class="linenos">145</span></a>        <span class="n">sample</span><span class="p">:</span> <span class="n">Sample</span><span class="p">,</span>
</span><span id="PredictionPipeline.predict_sample_without_blocking-146"><a href="#PredictionPipeline.predict_sample_without_blocking-146"><span class="linenos">146</span></a>        <span class="n">skip_preprocessing</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="PredictionPipeline.predict_sample_without_blocking-147"><a href="#PredictionPipeline.predict_sample_without_blocking-147"><span class="linenos">147</span></a>        <span class="n">skip_postprocessing</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="PredictionPipeline.predict_sample_without_blocking-148"><a href="#PredictionPipeline.predict_sample_without_blocking-148"><span class="linenos">148</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sample</span><span class="p">:</span>
</span><span id="PredictionPipeline.predict_sample_without_blocking-149"><a href="#PredictionPipeline.predict_sample_without_blocking-149"><span class="linenos">149</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;predict a sample.</span>
</span><span id="PredictionPipeline.predict_sample_without_blocking-150"><a href="#PredictionPipeline.predict_sample_without_blocking-150"><span class="linenos">150</span></a><span class="sd">        The sample&#39;s tensor shapes have to match the model&#39;s input tensor description.</span>
</span><span id="PredictionPipeline.predict_sample_without_blocking-151"><a href="#PredictionPipeline.predict_sample_without_blocking-151"><span class="linenos">151</span></a><span class="sd">        If that is not the case, consider `predict_sample_with_blocking`&quot;&quot;&quot;</span>
</span><span id="PredictionPipeline.predict_sample_without_blocking-152"><a href="#PredictionPipeline.predict_sample_without_blocking-152"><span class="linenos">152</span></a>
</span><span id="PredictionPipeline.predict_sample_without_blocking-153"><a href="#PredictionPipeline.predict_sample_without_blocking-153"><span class="linenos">153</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">skip_preprocessing</span><span class="p">:</span>
</span><span id="PredictionPipeline.predict_sample_without_blocking-154"><a href="#PredictionPipeline.predict_sample_without_blocking-154"><span class="linenos">154</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">apply_preprocessing</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
</span><span id="PredictionPipeline.predict_sample_without_blocking-155"><a href="#PredictionPipeline.predict_sample_without_blocking-155"><span class="linenos">155</span></a>
</span><span id="PredictionPipeline.predict_sample_without_blocking-156"><a href="#PredictionPipeline.predict_sample_without_blocking-156"><span class="linenos">156</span></a>        <span class="n">output</span> <span class="o">=</span> <span class="n">Sample</span><span class="p">(</span>
</span><span id="PredictionPipeline.predict_sample_without_blocking-157"><a href="#PredictionPipeline.predict_sample_without_blocking-157"><span class="linenos">157</span></a>            <span class="n">members</span><span class="o">=</span><span class="p">{</span>
</span><span id="PredictionPipeline.predict_sample_without_blocking-158"><a href="#PredictionPipeline.predict_sample_without_blocking-158"><span class="linenos">158</span></a>                <span class="n">out_id</span><span class="p">:</span> <span class="n">out</span>
</span><span id="PredictionPipeline.predict_sample_without_blocking-159"><a href="#PredictionPipeline.predict_sample_without_blocking-159"><span class="linenos">159</span></a>                <span class="k">for</span> <span class="n">out_id</span><span class="p">,</span> <span class="n">out</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
</span><span id="PredictionPipeline.predict_sample_without_blocking-160"><a href="#PredictionPipeline.predict_sample_without_blocking-160"><span class="linenos">160</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_output_ids</span><span class="p">,</span>
</span><span id="PredictionPipeline.predict_sample_without_blocking-161"><a href="#PredictionPipeline.predict_sample_without_blocking-161"><span class="linenos">161</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_adapter</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span>
</span><span id="PredictionPipeline.predict_sample_without_blocking-162"><a href="#PredictionPipeline.predict_sample_without_blocking-162"><span class="linenos">162</span></a>                        <span class="o">*</span><span class="p">(</span><span class="n">sample</span><span class="o">.</span><span class="n">members</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">in_id</span><span class="p">)</span> <span class="k">for</span> <span class="n">in_id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_input_ids</span><span class="p">)</span>
</span><span id="PredictionPipeline.predict_sample_without_blocking-163"><a href="#PredictionPipeline.predict_sample_without_blocking-163"><span class="linenos">163</span></a>                    <span class="p">),</span>
</span><span id="PredictionPipeline.predict_sample_without_blocking-164"><a href="#PredictionPipeline.predict_sample_without_blocking-164"><span class="linenos">164</span></a>                <span class="p">)</span>
</span><span id="PredictionPipeline.predict_sample_without_blocking-165"><a href="#PredictionPipeline.predict_sample_without_blocking-165"><span class="linenos">165</span></a>                <span class="k">if</span> <span class="n">out</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="PredictionPipeline.predict_sample_without_blocking-166"><a href="#PredictionPipeline.predict_sample_without_blocking-166"><span class="linenos">166</span></a>            <span class="p">},</span>
</span><span id="PredictionPipeline.predict_sample_without_blocking-167"><a href="#PredictionPipeline.predict_sample_without_blocking-167"><span class="linenos">167</span></a>            <span class="n">stat</span><span class="o">=</span><span class="n">sample</span><span class="o">.</span><span class="n">stat</span><span class="p">,</span>
</span><span id="PredictionPipeline.predict_sample_without_blocking-168"><a href="#PredictionPipeline.predict_sample_without_blocking-168"><span class="linenos">168</span></a>            <span class="nb">id</span><span class="o">=</span><span class="n">sample</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
</span><span id="PredictionPipeline.predict_sample_without_blocking-169"><a href="#PredictionPipeline.predict_sample_without_blocking-169"><span class="linenos">169</span></a>        <span class="p">)</span>
</span><span id="PredictionPipeline.predict_sample_without_blocking-170"><a href="#PredictionPipeline.predict_sample_without_blocking-170"><span class="linenos">170</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">skip_postprocessing</span><span class="p">:</span>
</span><span id="PredictionPipeline.predict_sample_without_blocking-171"><a href="#PredictionPipeline.predict_sample_without_blocking-171"><span class="linenos">171</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">apply_postprocessing</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
</span><span id="PredictionPipeline.predict_sample_without_blocking-172"><a href="#PredictionPipeline.predict_sample_without_blocking-172"><span class="linenos">172</span></a>
</span><span id="PredictionPipeline.predict_sample_without_blocking-173"><a href="#PredictionPipeline.predict_sample_without_blocking-173"><span class="linenos">173</span></a>        <span class="k">return</span> <span class="n">output</span>
</span></pre></div>


            <div class="docstring"><p>predict a sample.
The sample's tensor shapes have to match the model's input tensor description.
If that is not the case, consider <code><a href="#PredictionPipeline.predict_sample_with_blocking">predict_sample_with_blocking</a></code></p>
</div>


                            </div>
                            <div id="PredictionPipeline.get_output_sample_id" class="classattr">
                                        <input id="PredictionPipeline.get_output_sample_id-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_output_sample_id</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">input_sample_id</span><span class="p">:</span> <span class="n">Hashable</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="PredictionPipeline.get_output_sample_id-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PredictionPipeline.get_output_sample_id"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PredictionPipeline.get_output_sample_id-175"><a href="#PredictionPipeline.get_output_sample_id-175"><span class="linenos">175</span></a>    <span class="k">def</span> <span class="nf">get_output_sample_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_sample_id</span><span class="p">:</span> <span class="n">SampleId</span><span class="p">):</span>
</span><span id="PredictionPipeline.get_output_sample_id-176"><a href="#PredictionPipeline.get_output_sample_id-176"><span class="linenos">176</span></a>        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
</span><span id="PredictionPipeline.get_output_sample_id-177"><a href="#PredictionPipeline.get_output_sample_id-177"><span class="linenos">177</span></a>            <span class="s2">&quot;`PredictionPipeline.get_output_sample_id()` is deprecated and will be&quot;</span>
</span><span id="PredictionPipeline.get_output_sample_id-178"><a href="#PredictionPipeline.get_output_sample_id-178"><span class="linenos">178</span></a>            <span class="o">+</span> <span class="s2">&quot; removed soon. Output sample id is equal to input sample id, hence this&quot;</span>
</span><span id="PredictionPipeline.get_output_sample_id-179"><a href="#PredictionPipeline.get_output_sample_id-179"><span class="linenos">179</span></a>            <span class="o">+</span> <span class="s2">&quot; function is not needed.&quot;</span>
</span><span id="PredictionPipeline.get_output_sample_id-180"><a href="#PredictionPipeline.get_output_sample_id-180"><span class="linenos">180</span></a>        <span class="p">)</span>
</span><span id="PredictionPipeline.get_output_sample_id-181"><a href="#PredictionPipeline.get_output_sample_id-181"><span class="linenos">181</span></a>        <span class="k">return</span> <span class="n">input_sample_id</span>
</span></pre></div>


    

                            </div>
                            <div id="PredictionPipeline.predict_sample_with_fixed_blocking" class="classattr">
                                        <input id="PredictionPipeline.predict_sample_with_fixed_blocking-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">predict_sample_with_fixed_blocking</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">sample</span><span class="p">:</span> <span class="n"><a href="#Sample">Sample</a></span>,</span><span class="param">	<span class="n">input_block_shape</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="n"><a href="spec/model/v0_5.html#TensorId">bioimageio.spec.model.v0_5.TensorId</a></span><span class="p">,</span> <span class="n">Mapping</span><span class="p">[</span><span class="n"><a href="#AxisId">AxisId</a></span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span>,</span><span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">skip_preprocessing</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">skip_postprocessing</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">) -> <span class="n"><a href="#Sample">Sample</a></span>:</span></span>

                <label class="view-source-button" for="PredictionPipeline.predict_sample_with_fixed_blocking-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PredictionPipeline.predict_sample_with_fixed_blocking"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PredictionPipeline.predict_sample_with_fixed_blocking-183"><a href="#PredictionPipeline.predict_sample_with_fixed_blocking-183"><span class="linenos">183</span></a>    <span class="k">def</span> <span class="nf">predict_sample_with_fixed_blocking</span><span class="p">(</span>
</span><span id="PredictionPipeline.predict_sample_with_fixed_blocking-184"><a href="#PredictionPipeline.predict_sample_with_fixed_blocking-184"><span class="linenos">184</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="PredictionPipeline.predict_sample_with_fixed_blocking-185"><a href="#PredictionPipeline.predict_sample_with_fixed_blocking-185"><span class="linenos">185</span></a>        <span class="n">sample</span><span class="p">:</span> <span class="n">Sample</span><span class="p">,</span>
</span><span id="PredictionPipeline.predict_sample_with_fixed_blocking-186"><a href="#PredictionPipeline.predict_sample_with_fixed_blocking-186"><span class="linenos">186</span></a>        <span class="n">input_block_shape</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="n">MemberId</span><span class="p">,</span> <span class="n">Mapping</span><span class="p">[</span><span class="n">AxisId</span><span class="p">,</span> <span class="nb">int</span><span class="p">]],</span>
</span><span id="PredictionPipeline.predict_sample_with_fixed_blocking-187"><a href="#PredictionPipeline.predict_sample_with_fixed_blocking-187"><span class="linenos">187</span></a>        <span class="o">*</span><span class="p">,</span>
</span><span id="PredictionPipeline.predict_sample_with_fixed_blocking-188"><a href="#PredictionPipeline.predict_sample_with_fixed_blocking-188"><span class="linenos">188</span></a>        <span class="n">skip_preprocessing</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="PredictionPipeline.predict_sample_with_fixed_blocking-189"><a href="#PredictionPipeline.predict_sample_with_fixed_blocking-189"><span class="linenos">189</span></a>        <span class="n">skip_postprocessing</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="PredictionPipeline.predict_sample_with_fixed_blocking-190"><a href="#PredictionPipeline.predict_sample_with_fixed_blocking-190"><span class="linenos">190</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sample</span><span class="p">:</span>
</span><span id="PredictionPipeline.predict_sample_with_fixed_blocking-191"><a href="#PredictionPipeline.predict_sample_with_fixed_blocking-191"><span class="linenos">191</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">skip_preprocessing</span><span class="p">:</span>
</span><span id="PredictionPipeline.predict_sample_with_fixed_blocking-192"><a href="#PredictionPipeline.predict_sample_with_fixed_blocking-192"><span class="linenos">192</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">apply_preprocessing</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
</span><span id="PredictionPipeline.predict_sample_with_fixed_blocking-193"><a href="#PredictionPipeline.predict_sample_with_fixed_blocking-193"><span class="linenos">193</span></a>
</span><span id="PredictionPipeline.predict_sample_with_fixed_blocking-194"><a href="#PredictionPipeline.predict_sample_with_fixed_blocking-194"><span class="linenos">194</span></a>        <span class="n">n_blocks</span><span class="p">,</span> <span class="n">input_blocks</span> <span class="o">=</span> <span class="n">sample</span><span class="o">.</span><span class="n">split_into_blocks</span><span class="p">(</span>
</span><span id="PredictionPipeline.predict_sample_with_fixed_blocking-195"><a href="#PredictionPipeline.predict_sample_with_fixed_blocking-195"><span class="linenos">195</span></a>            <span class="n">input_block_shape</span><span class="p">,</span>
</span><span id="PredictionPipeline.predict_sample_with_fixed_blocking-196"><a href="#PredictionPipeline.predict_sample_with_fixed_blocking-196"><span class="linenos">196</span></a>            <span class="n">halo</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_default_input_halo</span><span class="p">,</span>
</span><span id="PredictionPipeline.predict_sample_with_fixed_blocking-197"><a href="#PredictionPipeline.predict_sample_with_fixed_blocking-197"><span class="linenos">197</span></a>            <span class="n">pad_mode</span><span class="o">=</span><span class="s2">&quot;reflect&quot;</span><span class="p">,</span>
</span><span id="PredictionPipeline.predict_sample_with_fixed_blocking-198"><a href="#PredictionPipeline.predict_sample_with_fixed_blocking-198"><span class="linenos">198</span></a>        <span class="p">)</span>
</span><span id="PredictionPipeline.predict_sample_with_fixed_blocking-199"><a href="#PredictionPipeline.predict_sample_with_fixed_blocking-199"><span class="linenos">199</span></a>        <span class="n">input_blocks</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">input_blocks</span><span class="p">)</span>
</span><span id="PredictionPipeline.predict_sample_with_fixed_blocking-200"><a href="#PredictionPipeline.predict_sample_with_fixed_blocking-200"><span class="linenos">200</span></a>        <span class="n">predicted_blocks</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">SampleBlock</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="PredictionPipeline.predict_sample_with_fixed_blocking-201"><a href="#PredictionPipeline.predict_sample_with_fixed_blocking-201"><span class="linenos">201</span></a>        <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span>
</span><span id="PredictionPipeline.predict_sample_with_fixed_blocking-202"><a href="#PredictionPipeline.predict_sample_with_fixed_blocking-202"><span class="linenos">202</span></a>            <span class="n">input_blocks</span><span class="p">,</span>
</span><span id="PredictionPipeline.predict_sample_with_fixed_blocking-203"><a href="#PredictionPipeline.predict_sample_with_fixed_blocking-203"><span class="linenos">203</span></a>            <span class="n">desc</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;predict sample </span><span class="si">{</span><span class="n">sample</span><span class="o">.</span><span class="n">id</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}</span><span class="s2"> with </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">model_description</span><span class="o">.</span><span class="n">id</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">model_description</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="PredictionPipeline.predict_sample_with_fixed_blocking-204"><a href="#PredictionPipeline.predict_sample_with_fixed_blocking-204"><span class="linenos">204</span></a>            <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;block&quot;</span><span class="p">,</span>
</span><span id="PredictionPipeline.predict_sample_with_fixed_blocking-205"><a href="#PredictionPipeline.predict_sample_with_fixed_blocking-205"><span class="linenos">205</span></a>            <span class="n">unit_divisor</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="PredictionPipeline.predict_sample_with_fixed_blocking-206"><a href="#PredictionPipeline.predict_sample_with_fixed_blocking-206"><span class="linenos">206</span></a>            <span class="n">total</span><span class="o">=</span><span class="n">n_blocks</span><span class="p">,</span>
</span><span id="PredictionPipeline.predict_sample_with_fixed_blocking-207"><a href="#PredictionPipeline.predict_sample_with_fixed_blocking-207"><span class="linenos">207</span></a>        <span class="p">):</span>
</span><span id="PredictionPipeline.predict_sample_with_fixed_blocking-208"><a href="#PredictionPipeline.predict_sample_with_fixed_blocking-208"><span class="linenos">208</span></a>            <span class="n">predicted_blocks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="PredictionPipeline.predict_sample_with_fixed_blocking-209"><a href="#PredictionPipeline.predict_sample_with_fixed_blocking-209"><span class="linenos">209</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">predict_sample_block</span><span class="p">(</span>
</span><span id="PredictionPipeline.predict_sample_with_fixed_blocking-210"><a href="#PredictionPipeline.predict_sample_with_fixed_blocking-210"><span class="linenos">210</span></a>                    <span class="n">b</span><span class="p">,</span> <span class="n">skip_preprocessing</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">skip_postprocessing</span><span class="o">=</span><span class="kc">True</span>
</span><span id="PredictionPipeline.predict_sample_with_fixed_blocking-211"><a href="#PredictionPipeline.predict_sample_with_fixed_blocking-211"><span class="linenos">211</span></a>                <span class="p">)</span>
</span><span id="PredictionPipeline.predict_sample_with_fixed_blocking-212"><a href="#PredictionPipeline.predict_sample_with_fixed_blocking-212"><span class="linenos">212</span></a>            <span class="p">)</span>
</span><span id="PredictionPipeline.predict_sample_with_fixed_blocking-213"><a href="#PredictionPipeline.predict_sample_with_fixed_blocking-213"><span class="linenos">213</span></a>
</span><span id="PredictionPipeline.predict_sample_with_fixed_blocking-214"><a href="#PredictionPipeline.predict_sample_with_fixed_blocking-214"><span class="linenos">214</span></a>        <span class="n">predicted_sample</span> <span class="o">=</span> <span class="n">Sample</span><span class="o">.</span><span class="n">from_blocks</span><span class="p">(</span><span class="n">predicted_blocks</span><span class="p">)</span>
</span><span id="PredictionPipeline.predict_sample_with_fixed_blocking-215"><a href="#PredictionPipeline.predict_sample_with_fixed_blocking-215"><span class="linenos">215</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">skip_postprocessing</span><span class="p">:</span>
</span><span id="PredictionPipeline.predict_sample_with_fixed_blocking-216"><a href="#PredictionPipeline.predict_sample_with_fixed_blocking-216"><span class="linenos">216</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">apply_postprocessing</span><span class="p">(</span><span class="n">predicted_sample</span><span class="p">)</span>
</span><span id="PredictionPipeline.predict_sample_with_fixed_blocking-217"><a href="#PredictionPipeline.predict_sample_with_fixed_blocking-217"><span class="linenos">217</span></a>
</span><span id="PredictionPipeline.predict_sample_with_fixed_blocking-218"><a href="#PredictionPipeline.predict_sample_with_fixed_blocking-218"><span class="linenos">218</span></a>        <span class="k">return</span> <span class="n">predicted_sample</span>
</span></pre></div>


    

                            </div>
                            <div id="PredictionPipeline.predict_sample_with_blocking" class="classattr">
                                        <input id="PredictionPipeline.predict_sample_with_blocking-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">predict_sample_with_blocking</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">sample</span><span class="p">:</span> <span class="n"><a href="#Sample">Sample</a></span>,</span><span class="param">	<span class="n">skip_preprocessing</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">skip_postprocessing</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">ns</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Mapping</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n"><a href="spec/model/v0_5.html#TensorId">bioimageio.spec.model.v0_5.TensorId</a></span><span class="p">,</span> <span class="n"><a href="#AxisId">AxisId</a></span><span class="p">],</span> <span class="nb">int</span><span class="p">],</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">batch_size</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n"><a href="#Sample">Sample</a></span>:</span></span>

                <label class="view-source-button" for="PredictionPipeline.predict_sample_with_blocking-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PredictionPipeline.predict_sample_with_blocking"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PredictionPipeline.predict_sample_with_blocking-220"><a href="#PredictionPipeline.predict_sample_with_blocking-220"><span class="linenos">220</span></a>    <span class="k">def</span> <span class="nf">predict_sample_with_blocking</span><span class="p">(</span>
</span><span id="PredictionPipeline.predict_sample_with_blocking-221"><a href="#PredictionPipeline.predict_sample_with_blocking-221"><span class="linenos">221</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="PredictionPipeline.predict_sample_with_blocking-222"><a href="#PredictionPipeline.predict_sample_with_blocking-222"><span class="linenos">222</span></a>        <span class="n">sample</span><span class="p">:</span> <span class="n">Sample</span><span class="p">,</span>
</span><span id="PredictionPipeline.predict_sample_with_blocking-223"><a href="#PredictionPipeline.predict_sample_with_blocking-223"><span class="linenos">223</span></a>        <span class="n">skip_preprocessing</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="PredictionPipeline.predict_sample_with_blocking-224"><a href="#PredictionPipeline.predict_sample_with_blocking-224"><span class="linenos">224</span></a>        <span class="n">skip_postprocessing</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="PredictionPipeline.predict_sample_with_blocking-225"><a href="#PredictionPipeline.predict_sample_with_blocking-225"><span class="linenos">225</span></a>        <span class="n">ns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span>
</span><span id="PredictionPipeline.predict_sample_with_blocking-226"><a href="#PredictionPipeline.predict_sample_with_blocking-226"><span class="linenos">226</span></a>            <span class="n">Union</span><span class="p">[</span>
</span><span id="PredictionPipeline.predict_sample_with_blocking-227"><a href="#PredictionPipeline.predict_sample_with_blocking-227"><span class="linenos">227</span></a>                <span class="n">v0_5</span><span class="o">.</span><span class="n">ParameterizedSize_N</span><span class="p">,</span>
</span><span id="PredictionPipeline.predict_sample_with_blocking-228"><a href="#PredictionPipeline.predict_sample_with_blocking-228"><span class="linenos">228</span></a>                <span class="n">Mapping</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">MemberId</span><span class="p">,</span> <span class="n">AxisId</span><span class="p">],</span> <span class="n">v0_5</span><span class="o">.</span><span class="n">ParameterizedSize_N</span><span class="p">],</span>
</span><span id="PredictionPipeline.predict_sample_with_blocking-229"><a href="#PredictionPipeline.predict_sample_with_blocking-229"><span class="linenos">229</span></a>            <span class="p">]</span>
</span><span id="PredictionPipeline.predict_sample_with_blocking-230"><a href="#PredictionPipeline.predict_sample_with_blocking-230"><span class="linenos">230</span></a>        <span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PredictionPipeline.predict_sample_with_blocking-231"><a href="#PredictionPipeline.predict_sample_with_blocking-231"><span class="linenos">231</span></a>        <span class="n">batch_size</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PredictionPipeline.predict_sample_with_blocking-232"><a href="#PredictionPipeline.predict_sample_with_blocking-232"><span class="linenos">232</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sample</span><span class="p">:</span>
</span><span id="PredictionPipeline.predict_sample_with_blocking-233"><a href="#PredictionPipeline.predict_sample_with_blocking-233"><span class="linenos">233</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;predict a sample by splitting it into blocks according to the model and the `ns` parameter&quot;&quot;&quot;</span>
</span><span id="PredictionPipeline.predict_sample_with_blocking-234"><a href="#PredictionPipeline.predict_sample_with_blocking-234"><span class="linenos">234</span></a>
</span><span id="PredictionPipeline.predict_sample_with_blocking-235"><a href="#PredictionPipeline.predict_sample_with_blocking-235"><span class="linenos">235</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model_description</span><span class="p">,</span> <span class="n">v0_4</span><span class="o">.</span><span class="n">ModelDescr</span><span class="p">):</span>
</span><span id="PredictionPipeline.predict_sample_with_blocking-236"><a href="#PredictionPipeline.predict_sample_with_blocking-236"><span class="linenos">236</span></a>            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
</span><span id="PredictionPipeline.predict_sample_with_blocking-237"><a href="#PredictionPipeline.predict_sample_with_blocking-237"><span class="linenos">237</span></a>                <span class="s2">&quot;`predict_sample_with_blocking` not implemented for v0_4.ModelDescr&quot;</span>
</span><span id="PredictionPipeline.predict_sample_with_blocking-238"><a href="#PredictionPipeline.predict_sample_with_blocking-238"><span class="linenos">238</span></a>                <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">model_description</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">.&quot;</span>
</span><span id="PredictionPipeline.predict_sample_with_blocking-239"><a href="#PredictionPipeline.predict_sample_with_blocking-239"><span class="linenos">239</span></a>                <span class="o">+</span> <span class="s2">&quot; Consider using `predict_sample_with_fixed_blocking`&quot;</span>
</span><span id="PredictionPipeline.predict_sample_with_blocking-240"><a href="#PredictionPipeline.predict_sample_with_blocking-240"><span class="linenos">240</span></a>            <span class="p">)</span>
</span><span id="PredictionPipeline.predict_sample_with_blocking-241"><a href="#PredictionPipeline.predict_sample_with_blocking-241"><span class="linenos">241</span></a>
</span><span id="PredictionPipeline.predict_sample_with_blocking-242"><a href="#PredictionPipeline.predict_sample_with_blocking-242"><span class="linenos">242</span></a>        <span class="n">ns</span> <span class="o">=</span> <span class="n">ns</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_default_ns</span>
</span><span id="PredictionPipeline.predict_sample_with_blocking-243"><a href="#PredictionPipeline.predict_sample_with_blocking-243"><span class="linenos">243</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ns</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
</span><span id="PredictionPipeline.predict_sample_with_blocking-244"><a href="#PredictionPipeline.predict_sample_with_blocking-244"><span class="linenos">244</span></a>            <span class="n">ns</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="PredictionPipeline.predict_sample_with_blocking-245"><a href="#PredictionPipeline.predict_sample_with_blocking-245"><span class="linenos">245</span></a>                <span class="p">(</span><span class="n">ipt</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">id</span><span class="p">):</span> <span class="n">ns</span>
</span><span id="PredictionPipeline.predict_sample_with_blocking-246"><a href="#PredictionPipeline.predict_sample_with_blocking-246"><span class="linenos">246</span></a>                <span class="k">for</span> <span class="n">ipt</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_description</span><span class="o">.</span><span class="n">inputs</span>
</span><span id="PredictionPipeline.predict_sample_with_blocking-247"><a href="#PredictionPipeline.predict_sample_with_blocking-247"><span class="linenos">247</span></a>                <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">ipt</span><span class="o">.</span><span class="n">axes</span>
</span><span id="PredictionPipeline.predict_sample_with_blocking-248"><a href="#PredictionPipeline.predict_sample_with_blocking-248"><span class="linenos">248</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">v0_5</span><span class="o">.</span><span class="n">ParameterizedSize</span><span class="p">)</span>
</span><span id="PredictionPipeline.predict_sample_with_blocking-249"><a href="#PredictionPipeline.predict_sample_with_blocking-249"><span class="linenos">249</span></a>            <span class="p">}</span>
</span><span id="PredictionPipeline.predict_sample_with_blocking-250"><a href="#PredictionPipeline.predict_sample_with_blocking-250"><span class="linenos">250</span></a>        <span class="n">input_block_shape</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_description</span><span class="o">.</span><span class="n">get_tensor_sizes</span><span class="p">(</span>
</span><span id="PredictionPipeline.predict_sample_with_blocking-251"><a href="#PredictionPipeline.predict_sample_with_blocking-251"><span class="linenos">251</span></a>            <span class="n">ns</span><span class="p">,</span> <span class="n">batch_size</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_default_batch_size</span>
</span><span id="PredictionPipeline.predict_sample_with_blocking-252"><a href="#PredictionPipeline.predict_sample_with_blocking-252"><span class="linenos">252</span></a>        <span class="p">)</span><span class="o">.</span><span class="n">inputs</span>
</span><span id="PredictionPipeline.predict_sample_with_blocking-253"><a href="#PredictionPipeline.predict_sample_with_blocking-253"><span class="linenos">253</span></a>
</span><span id="PredictionPipeline.predict_sample_with_blocking-254"><a href="#PredictionPipeline.predict_sample_with_blocking-254"><span class="linenos">254</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict_sample_with_fixed_blocking</span><span class="p">(</span>
</span><span id="PredictionPipeline.predict_sample_with_blocking-255"><a href="#PredictionPipeline.predict_sample_with_blocking-255"><span class="linenos">255</span></a>            <span class="n">sample</span><span class="p">,</span>
</span><span id="PredictionPipeline.predict_sample_with_blocking-256"><a href="#PredictionPipeline.predict_sample_with_blocking-256"><span class="linenos">256</span></a>            <span class="n">input_block_shape</span><span class="o">=</span><span class="n">input_block_shape</span><span class="p">,</span>
</span><span id="PredictionPipeline.predict_sample_with_blocking-257"><a href="#PredictionPipeline.predict_sample_with_blocking-257"><span class="linenos">257</span></a>            <span class="n">skip_preprocessing</span><span class="o">=</span><span class="n">skip_preprocessing</span><span class="p">,</span>
</span><span id="PredictionPipeline.predict_sample_with_blocking-258"><a href="#PredictionPipeline.predict_sample_with_blocking-258"><span class="linenos">258</span></a>            <span class="n">skip_postprocessing</span><span class="o">=</span><span class="n">skip_postprocessing</span><span class="p">,</span>
</span><span id="PredictionPipeline.predict_sample_with_blocking-259"><a href="#PredictionPipeline.predict_sample_with_blocking-259"><span class="linenos">259</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>predict a sample by splitting it into blocks according to the model and the <code>ns</code> parameter</p>
</div>


                            </div>
                            <div id="PredictionPipeline.apply_preprocessing" class="classattr">
                                        <input id="PredictionPipeline.apply_preprocessing-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">apply_preprocessing</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">sample</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n"><a href="#Sample">Sample</a></span><span class="p">,</span> <span class="n"><a href="core/sample.html#SampleBlockWithOrigin">bioimageio.core.sample.SampleBlockWithOrigin</a></span><span class="p">]</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="PredictionPipeline.apply_preprocessing-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PredictionPipeline.apply_preprocessing"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PredictionPipeline.apply_preprocessing-287"><a href="#PredictionPipeline.apply_preprocessing-287"><span class="linenos">287</span></a>    <span class="k">def</span> <span class="nf">apply_preprocessing</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sample</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Sample</span><span class="p">,</span> <span class="n">SampleBlockWithOrigin</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PredictionPipeline.apply_preprocessing-288"><a href="#PredictionPipeline.apply_preprocessing-288"><span class="linenos">288</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;apply preprocessing in-place, also updates sample stats&quot;&quot;&quot;</span>
</span><span id="PredictionPipeline.apply_preprocessing-289"><a href="#PredictionPipeline.apply_preprocessing-289"><span class="linenos">289</span></a>        <span class="k">for</span> <span class="n">op</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_preprocessing</span><span class="p">:</span>
</span><span id="PredictionPipeline.apply_preprocessing-290"><a href="#PredictionPipeline.apply_preprocessing-290"><span class="linenos">290</span></a>            <span class="n">op</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>apply preprocessing in-place, also updates sample stats</p>
</div>


                            </div>
                            <div id="PredictionPipeline.apply_postprocessing" class="classattr">
                                        <input id="PredictionPipeline.apply_postprocessing-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">apply_postprocessing</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">sample</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n"><a href="#Sample">Sample</a></span><span class="p">,</span> <span class="n"><a href="core/sample.html#SampleBlock">bioimageio.core.sample.SampleBlock</a></span><span class="p">,</span> <span class="n"><a href="core/sample.html#SampleBlockWithOrigin">bioimageio.core.sample.SampleBlockWithOrigin</a></span><span class="p">]</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="PredictionPipeline.apply_postprocessing-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PredictionPipeline.apply_postprocessing"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PredictionPipeline.apply_postprocessing-292"><a href="#PredictionPipeline.apply_postprocessing-292"><span class="linenos">292</span></a>    <span class="k">def</span> <span class="nf">apply_postprocessing</span><span class="p">(</span>
</span><span id="PredictionPipeline.apply_postprocessing-293"><a href="#PredictionPipeline.apply_postprocessing-293"><span class="linenos">293</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">sample</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Sample</span><span class="p">,</span> <span class="n">SampleBlock</span><span class="p">,</span> <span class="n">SampleBlockWithOrigin</span><span class="p">]</span>
</span><span id="PredictionPipeline.apply_postprocessing-294"><a href="#PredictionPipeline.apply_postprocessing-294"><span class="linenos">294</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PredictionPipeline.apply_postprocessing-295"><a href="#PredictionPipeline.apply_postprocessing-295"><span class="linenos">295</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;apply postprocessing in-place, also updates samples stats&quot;&quot;&quot;</span>
</span><span id="PredictionPipeline.apply_postprocessing-296"><a href="#PredictionPipeline.apply_postprocessing-296"><span class="linenos">296</span></a>        <span class="k">for</span> <span class="n">op</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_postprocessing</span><span class="p">:</span>
</span><span id="PredictionPipeline.apply_postprocessing-297"><a href="#PredictionPipeline.apply_postprocessing-297"><span class="linenos">297</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="p">(</span><span class="n">Sample</span><span class="p">,</span> <span class="n">SampleBlockWithOrigin</span><span class="p">)):</span>
</span><span id="PredictionPipeline.apply_postprocessing-298"><a href="#PredictionPipeline.apply_postprocessing-298"><span class="linenos">298</span></a>                <span class="n">op</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
</span><span id="PredictionPipeline.apply_postprocessing-299"><a href="#PredictionPipeline.apply_postprocessing-299"><span class="linenos">299</span></a>            <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">op</span><span class="p">,</span> <span class="n">BlockedOperator</span><span class="p">):</span>
</span><span id="PredictionPipeline.apply_postprocessing-300"><a href="#PredictionPipeline.apply_postprocessing-300"><span class="linenos">300</span></a>                <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
</span><span id="PredictionPipeline.apply_postprocessing-301"><a href="#PredictionPipeline.apply_postprocessing-301"><span class="linenos">301</span></a>                    <span class="s2">&quot;block wise update of output statistics not yet implemented&quot;</span>
</span><span id="PredictionPipeline.apply_postprocessing-302"><a href="#PredictionPipeline.apply_postprocessing-302"><span class="linenos">302</span></a>                <span class="p">)</span>
</span><span id="PredictionPipeline.apply_postprocessing-303"><a href="#PredictionPipeline.apply_postprocessing-303"><span class="linenos">303</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="PredictionPipeline.apply_postprocessing-304"><a href="#PredictionPipeline.apply_postprocessing-304"><span class="linenos">304</span></a>                <span class="n">op</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>apply postprocessing in-place, also updates samples stats</p>
</div>


                            </div>
                            <div id="PredictionPipeline.load" class="classattr">
                                        <input id="PredictionPipeline.load-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">load</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="PredictionPipeline.load-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PredictionPipeline.load"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PredictionPipeline.load-306"><a href="#PredictionPipeline.load-306"><span class="linenos">306</span></a>    <span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="PredictionPipeline.load-307"><a href="#PredictionPipeline.load-307"><span class="linenos">307</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PredictionPipeline.load-308"><a href="#PredictionPipeline.load-308"><span class="linenos">308</span></a><span class="sd">        optional step: load model onto devices before calling forward if not using it as context manager</span>
</span><span id="PredictionPipeline.load-309"><a href="#PredictionPipeline.load-309"><span class="linenos">309</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PredictionPipeline.load-310"><a href="#PredictionPipeline.load-310"><span class="linenos">310</span></a>        <span class="k">pass</span>
</span></pre></div>


            <div class="docstring"><p>optional step: load model onto devices before calling forward if not using it as context manager</p>
</div>


                            </div>
                            <div id="PredictionPipeline.unload" class="classattr">
                                        <input id="PredictionPipeline.unload-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">unload</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="PredictionPipeline.unload-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PredictionPipeline.unload"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PredictionPipeline.unload-312"><a href="#PredictionPipeline.unload-312"><span class="linenos">312</span></a>    <span class="k">def</span> <span class="nf">unload</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="PredictionPipeline.unload-313"><a href="#PredictionPipeline.unload-313"><span class="linenos">313</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PredictionPipeline.unload-314"><a href="#PredictionPipeline.unload-314"><span class="linenos">314</span></a><span class="sd">        free any device memory in use</span>
</span><span id="PredictionPipeline.unload-315"><a href="#PredictionPipeline.unload-315"><span class="linenos">315</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PredictionPipeline.unload-316"><a href="#PredictionPipeline.unload-316"><span class="linenos">316</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_adapter</span><span class="o">.</span><span class="n">unload</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>free any device memory in use</p>
</div>


                            </div>
                </section>
                <section id="Sample">
                            <input id="Sample-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator decorator-dataclass">@dataclass</div>

    <span class="def">class</span>
    <span class="name">Sample</span>:

                <label class="view-source-button" for="Sample-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Sample"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Sample-44"><a href="#Sample-44"><span class="linenos"> 44</span></a><span class="nd">@dataclass</span>
</span><span id="Sample-45"><a href="#Sample-45"><span class="linenos"> 45</span></a><span class="k">class</span> <span class="nc">Sample</span><span class="p">:</span>
</span><span id="Sample-46"><a href="#Sample-46"><span class="linenos"> 46</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;A dataset sample&quot;&quot;&quot;</span>
</span><span id="Sample-47"><a href="#Sample-47"><span class="linenos"> 47</span></a>
</span><span id="Sample-48"><a href="#Sample-48"><span class="linenos"> 48</span></a>    <span class="n">members</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="n">MemberId</span><span class="p">,</span> <span class="n">Tensor</span><span class="p">]</span>
</span><span id="Sample-49"><a href="#Sample-49"><span class="linenos"> 49</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;the sample&#39;s tensors&quot;&quot;&quot;</span>
</span><span id="Sample-50"><a href="#Sample-50"><span class="linenos"> 50</span></a>
</span><span id="Sample-51"><a href="#Sample-51"><span class="linenos"> 51</span></a>    <span class="n">stat</span><span class="p">:</span> <span class="n">Stat</span>
</span><span id="Sample-52"><a href="#Sample-52"><span class="linenos"> 52</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;sample and dataset statistics&quot;&quot;&quot;</span>
</span><span id="Sample-53"><a href="#Sample-53"><span class="linenos"> 53</span></a>
</span><span id="Sample-54"><a href="#Sample-54"><span class="linenos"> 54</span></a>    <span class="nb">id</span><span class="p">:</span> <span class="n">SampleId</span>
</span><span id="Sample-55"><a href="#Sample-55"><span class="linenos"> 55</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;identifier within the sample&#39;s dataset&quot;&quot;&quot;</span>
</span><span id="Sample-56"><a href="#Sample-56"><span class="linenos"> 56</span></a>
</span><span id="Sample-57"><a href="#Sample-57"><span class="linenos"> 57</span></a>    <span class="nd">@property</span>
</span><span id="Sample-58"><a href="#Sample-58"><span class="linenos"> 58</span></a>    <span class="k">def</span> <span class="nf">shape</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PerMember</span><span class="p">[</span><span class="n">PerAxis</span><span class="p">[</span><span class="nb">int</span><span class="p">]]:</span>
</span><span id="Sample-59"><a href="#Sample-59"><span class="linenos"> 59</span></a>        <span class="k">return</span> <span class="p">{</span><span class="n">tid</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">sizes</span> <span class="k">for</span> <span class="n">tid</span><span class="p">,</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">members</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
</span><span id="Sample-60"><a href="#Sample-60"><span class="linenos"> 60</span></a>
</span><span id="Sample-61"><a href="#Sample-61"><span class="linenos"> 61</span></a>    <span class="k">def</span> <span class="nf">split_into_blocks</span><span class="p">(</span>
</span><span id="Sample-62"><a href="#Sample-62"><span class="linenos"> 62</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="Sample-63"><a href="#Sample-63"><span class="linenos"> 63</span></a>        <span class="n">block_shapes</span><span class="p">:</span> <span class="n">PerMember</span><span class="p">[</span><span class="n">PerAxis</span><span class="p">[</span><span class="nb">int</span><span class="p">]],</span>
</span><span id="Sample-64"><a href="#Sample-64"><span class="linenos"> 64</span></a>        <span class="n">halo</span><span class="p">:</span> <span class="n">PerMember</span><span class="p">[</span><span class="n">PerAxis</span><span class="p">[</span><span class="n">HaloLike</span><span class="p">]],</span>
</span><span id="Sample-65"><a href="#Sample-65"><span class="linenos"> 65</span></a>        <span class="n">pad_mode</span><span class="p">:</span> <span class="n">PadMode</span><span class="p">,</span>
</span><span id="Sample-66"><a href="#Sample-66"><span class="linenos"> 66</span></a>        <span class="n">broadcast</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="Sample-67"><a href="#Sample-67"><span class="linenos"> 67</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">TotalNumberOfBlocks</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">SampleBlockWithOrigin</span><span class="p">]]:</span>
</span><span id="Sample-68"><a href="#Sample-68"><span class="linenos"> 68</span></a>        <span class="k">assert</span> <span class="ow">not</span> <span class="p">(</span>
</span><span id="Sample-69"><a href="#Sample-69"><span class="linenos"> 69</span></a>            <span class="n">missing</span> <span class="o">:=</span> <span class="p">[</span><span class="n">m</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">block_shapes</span> <span class="k">if</span> <span class="n">m</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">members</span><span class="p">]</span>
</span><span id="Sample-70"><a href="#Sample-70"><span class="linenos"> 70</span></a>        <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;`block_shapes` specified for unknown members: </span><span class="si">{</span><span class="n">missing</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="Sample-71"><a href="#Sample-71"><span class="linenos"> 71</span></a>        <span class="k">assert</span> <span class="ow">not</span> <span class="p">(</span>
</span><span id="Sample-72"><a href="#Sample-72"><span class="linenos"> 72</span></a>            <span class="n">missing</span> <span class="o">:=</span> <span class="p">[</span><span class="n">m</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">halo</span> <span class="k">if</span> <span class="n">m</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">block_shapes</span><span class="p">]</span>
</span><span id="Sample-73"><a href="#Sample-73"><span class="linenos"> 73</span></a>        <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;`halo` specified for members without `block_shape`: </span><span class="si">{</span><span class="n">missing</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="Sample-74"><a href="#Sample-74"><span class="linenos"> 74</span></a>
</span><span id="Sample-75"><a href="#Sample-75"><span class="linenos"> 75</span></a>        <span class="n">n_blocks</span><span class="p">,</span> <span class="n">blocks</span> <span class="o">=</span> <span class="n">split_multiple_shapes_into_blocks</span><span class="p">(</span>
</span><span id="Sample-76"><a href="#Sample-76"><span class="linenos"> 76</span></a>            <span class="n">shapes</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
</span><span id="Sample-77"><a href="#Sample-77"><span class="linenos"> 77</span></a>            <span class="n">block_shapes</span><span class="o">=</span><span class="n">block_shapes</span><span class="p">,</span>
</span><span id="Sample-78"><a href="#Sample-78"><span class="linenos"> 78</span></a>            <span class="n">halo</span><span class="o">=</span><span class="n">halo</span><span class="p">,</span>
</span><span id="Sample-79"><a href="#Sample-79"><span class="linenos"> 79</span></a>            <span class="n">broadcast</span><span class="o">=</span><span class="n">broadcast</span><span class="p">,</span>
</span><span id="Sample-80"><a href="#Sample-80"><span class="linenos"> 80</span></a>        <span class="p">)</span>
</span><span id="Sample-81"><a href="#Sample-81"><span class="linenos"> 81</span></a>        <span class="k">return</span> <span class="n">n_blocks</span><span class="p">,</span> <span class="n">sample_block_generator</span><span class="p">(</span><span class="n">blocks</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">pad_mode</span><span class="o">=</span><span class="n">pad_mode</span><span class="p">)</span>
</span><span id="Sample-82"><a href="#Sample-82"><span class="linenos"> 82</span></a>
</span><span id="Sample-83"><a href="#Sample-83"><span class="linenos"> 83</span></a>    <span class="k">def</span> <span class="nf">as_single_block</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">halo</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">PerMember</span><span class="p">[</span><span class="n">PerAxis</span><span class="p">[</span><span class="n">Halo</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="Sample-84"><a href="#Sample-84"><span class="linenos"> 84</span></a>        <span class="k">if</span> <span class="n">halo</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Sample-85"><a href="#Sample-85"><span class="linenos"> 85</span></a>            <span class="n">halo</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Sample-86"><a href="#Sample-86"><span class="linenos"> 86</span></a>        <span class="k">return</span> <span class="n">SampleBlockWithOrigin</span><span class="p">(</span>
</span><span id="Sample-87"><a href="#Sample-87"><span class="linenos"> 87</span></a>            <span class="n">sample_shape</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
</span><span id="Sample-88"><a href="#Sample-88"><span class="linenos"> 88</span></a>            <span class="n">sample_id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
</span><span id="Sample-89"><a href="#Sample-89"><span class="linenos"> 89</span></a>            <span class="n">blocks</span><span class="o">=</span><span class="p">{</span>
</span><span id="Sample-90"><a href="#Sample-90"><span class="linenos"> 90</span></a>                <span class="n">m</span><span class="p">:</span> <span class="n">Block</span><span class="p">(</span>
</span><span id="Sample-91"><a href="#Sample-91"><span class="linenos"> 91</span></a>                    <span class="n">sample_shape</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">m</span><span class="p">],</span>
</span><span id="Sample-92"><a href="#Sample-92"><span class="linenos"> 92</span></a>                    <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
</span><span id="Sample-93"><a href="#Sample-93"><span class="linenos"> 93</span></a>                    <span class="n">inner_slice</span><span class="o">=</span><span class="p">{</span>
</span><span id="Sample-94"><a href="#Sample-94"><span class="linenos"> 94</span></a>                        <span class="n">a</span><span class="p">:</span> <span class="n">SliceInfo</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">tagged_shape</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
</span><span id="Sample-95"><a href="#Sample-95"><span class="linenos"> 95</span></a>                    <span class="p">},</span>
</span><span id="Sample-96"><a href="#Sample-96"><span class="linenos"> 96</span></a>                    <span class="n">halo</span><span class="o">=</span><span class="n">halo</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="p">{}),</span>
</span><span id="Sample-97"><a href="#Sample-97"><span class="linenos"> 97</span></a>                    <span class="n">block_index</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="Sample-98"><a href="#Sample-98"><span class="linenos"> 98</span></a>                    <span class="n">blocks_in_sample</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="Sample-99"><a href="#Sample-99"><span class="linenos"> 99</span></a>                <span class="p">)</span>
</span><span id="Sample-100"><a href="#Sample-100"><span class="linenos">100</span></a>                <span class="k">for</span> <span class="n">m</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">members</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
</span><span id="Sample-101"><a href="#Sample-101"><span class="linenos">101</span></a>            <span class="p">},</span>
</span><span id="Sample-102"><a href="#Sample-102"><span class="linenos">102</span></a>            <span class="n">stat</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stat</span><span class="p">,</span>
</span><span id="Sample-103"><a href="#Sample-103"><span class="linenos">103</span></a>            <span class="n">origin</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
</span><span id="Sample-104"><a href="#Sample-104"><span class="linenos">104</span></a>            <span class="n">block_index</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="Sample-105"><a href="#Sample-105"><span class="linenos">105</span></a>            <span class="n">blocks_in_sample</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="Sample-106"><a href="#Sample-106"><span class="linenos">106</span></a>        <span class="p">)</span>
</span><span id="Sample-107"><a href="#Sample-107"><span class="linenos">107</span></a>
</span><span id="Sample-108"><a href="#Sample-108"><span class="linenos">108</span></a>    <span class="nd">@classmethod</span>
</span><span id="Sample-109"><a href="#Sample-109"><span class="linenos">109</span></a>    <span class="k">def</span> <span class="nf">from_blocks</span><span class="p">(</span>
</span><span id="Sample-110"><a href="#Sample-110"><span class="linenos">110</span></a>        <span class="bp">cls</span><span class="p">,</span>
</span><span id="Sample-111"><a href="#Sample-111"><span class="linenos">111</span></a>        <span class="n">sample_blocks</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">SampleBlock</span><span class="p">],</span>
</span><span id="Sample-112"><a href="#Sample-112"><span class="linenos">112</span></a>        <span class="o">*</span><span class="p">,</span>
</span><span id="Sample-113"><a href="#Sample-113"><span class="linenos">113</span></a>        <span class="n">fill_value</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;nan&quot;</span><span class="p">),</span>
</span><span id="Sample-114"><a href="#Sample-114"><span class="linenos">114</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
</span><span id="Sample-115"><a href="#Sample-115"><span class="linenos">115</span></a>        <span class="n">members</span><span class="p">:</span> <span class="n">PerMember</span><span class="p">[</span><span class="n">Tensor</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Sample-116"><a href="#Sample-116"><span class="linenos">116</span></a>        <span class="n">stat</span><span class="p">:</span> <span class="n">Stat</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Sample-117"><a href="#Sample-117"><span class="linenos">117</span></a>        <span class="n">sample_id</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Sample-118"><a href="#Sample-118"><span class="linenos">118</span></a>        <span class="k">for</span> <span class="n">sample_block</span> <span class="ow">in</span> <span class="n">sample_blocks</span><span class="p">:</span>
</span><span id="Sample-119"><a href="#Sample-119"><span class="linenos">119</span></a>            <span class="k">assert</span> <span class="n">sample_id</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">sample_id</span> <span class="o">==</span> <span class="n">sample_block</span><span class="o">.</span><span class="n">sample_id</span>
</span><span id="Sample-120"><a href="#Sample-120"><span class="linenos">120</span></a>            <span class="n">sample_id</span> <span class="o">=</span> <span class="n">sample_block</span><span class="o">.</span><span class="n">sample_id</span>
</span><span id="Sample-121"><a href="#Sample-121"><span class="linenos">121</span></a>            <span class="n">stat</span> <span class="o">=</span> <span class="n">sample_block</span><span class="o">.</span><span class="n">stat</span>
</span><span id="Sample-122"><a href="#Sample-122"><span class="linenos">122</span></a>            <span class="k">for</span> <span class="n">m</span><span class="p">,</span> <span class="n">block</span> <span class="ow">in</span> <span class="n">sample_block</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="Sample-123"><a href="#Sample-123"><span class="linenos">123</span></a>                <span class="k">if</span> <span class="n">m</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">members</span><span class="p">:</span>
</span><span id="Sample-124"><a href="#Sample-124"><span class="linenos">124</span></a>                    <span class="k">if</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">in</span> <span class="n">block</span><span class="o">.</span><span class="n">sample_shape</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
</span><span id="Sample-125"><a href="#Sample-125"><span class="linenos">125</span></a>                        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
</span><span id="Sample-126"><a href="#Sample-126"><span class="linenos">126</span></a>                            <span class="s2">&quot;merging blocks with data dependent axis not yet implemented&quot;</span>
</span><span id="Sample-127"><a href="#Sample-127"><span class="linenos">127</span></a>                        <span class="p">)</span>
</span><span id="Sample-128"><a href="#Sample-128"><span class="linenos">128</span></a>
</span><span id="Sample-129"><a href="#Sample-129"><span class="linenos">129</span></a>                    <span class="n">members</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">(</span>
</span><span id="Sample-130"><a href="#Sample-130"><span class="linenos">130</span></a>                        <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span>
</span><span id="Sample-131"><a href="#Sample-131"><span class="linenos">131</span></a>                            <span class="nb">tuple</span><span class="p">(</span><span class="n">block</span><span class="o">.</span><span class="n">sample_shape</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">block</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dims</span><span class="p">),</span>
</span><span id="Sample-132"><a href="#Sample-132"><span class="linenos">132</span></a>                            <span class="n">fill_value</span><span class="p">,</span>
</span><span id="Sample-133"><a href="#Sample-133"><span class="linenos">133</span></a>                            <span class="n">dtype</span><span class="o">=</span><span class="n">block</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span>
</span><span id="Sample-134"><a href="#Sample-134"><span class="linenos">134</span></a>                        <span class="p">),</span>
</span><span id="Sample-135"><a href="#Sample-135"><span class="linenos">135</span></a>                        <span class="n">dims</span><span class="o">=</span><span class="n">block</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dims</span><span class="p">,</span>
</span><span id="Sample-136"><a href="#Sample-136"><span class="linenos">136</span></a>                    <span class="p">)</span>
</span><span id="Sample-137"><a href="#Sample-137"><span class="linenos">137</span></a>
</span><span id="Sample-138"><a href="#Sample-138"><span class="linenos">138</span></a>                <span class="n">members</span><span class="p">[</span><span class="n">m</span><span class="p">][</span><span class="n">block</span><span class="o">.</span><span class="n">inner_slice</span><span class="p">]</span> <span class="o">=</span> <span class="n">block</span><span class="o">.</span><span class="n">inner_data</span>
</span><span id="Sample-139"><a href="#Sample-139"><span class="linenos">139</span></a>
</span><span id="Sample-140"><a href="#Sample-140"><span class="linenos">140</span></a>        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">members</span><span class="o">=</span><span class="n">members</span><span class="p">,</span> <span class="n">stat</span><span class="o">=</span><span class="n">stat</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="n">sample_id</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>A dataset sample</p>
</div>


                            <div id="Sample.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">Sample</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">members</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="n"><a href="spec/model/v0_5.html#TensorId">bioimageio.spec.model.v0_5.TensorId</a></span><span class="p">,</span> <span class="n"><a href="#Tensor">Tensor</a></span><span class="p">]</span>,</span><span class="param">	<span class="n">stat</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n"><a href="core/stat_measures.html#SampleMean">bioimageio.core.stat_measures.SampleMean</a></span><span class="p">,</span> <span class="n"><a href="core/stat_measures.html#SampleStd">bioimageio.core.stat_measures.SampleStd</a></span><span class="p">,</span> <span class="n"><a href="core/stat_measures.html#SampleVar">bioimageio.core.stat_measures.SampleVar</a></span><span class="p">,</span> <span class="n"><a href="core/stat_measures.html#SampleQuantile">bioimageio.core.stat_measures.SampleQuantile</a></span><span class="p">],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)],</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n"><a href="core/stat_measures.html#DatasetMean">bioimageio.core.stat_measures.DatasetMean</a></span><span class="p">,</span> <span class="n"><a href="core/stat_measures.html#DatasetStd">bioimageio.core.stat_measures.DatasetStd</a></span><span class="p">,</span> <span class="n"><a href="core/stat_measures.html#DatasetVar">bioimageio.core.stat_measures.DatasetVar</a></span><span class="p">,</span> <span class="n"><a href="core/stat_measures.html#DatasetPercentile">bioimageio.core.stat_measures.DatasetPercentile</a></span><span class="p">],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)]],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=</span><span class="s1">&#39;scope&#39;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)],</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">Annotated</span><span class="p">[</span><span class="n"><a href="#Tensor">Tensor</a></span><span class="p">,</span> <span class="n">BeforeValidator</span><span class="p">(</span><span class="n">func</span><span class="o">=&lt;</span><span class="n">function</span> <span class="n">tensor_custom_before_validator</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">json_schema_input_type</span><span class="o">=</span><span class="n">PydanticUndefined</span><span class="p">),</span> <span class="n">PlainSerializer</span><span class="p">(</span><span class="n">func</span><span class="o">=&lt;</span><span class="n">function</span> <span class="n">tensor_custom_serializer</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">return_type</span><span class="o">=</span><span class="n">PydanticUndefined</span><span class="p">,</span> <span class="n">when_used</span><span class="o">=</span><span class="s1">&#39;always&#39;</span><span class="p">)]]]</span>,</span><span class="param">	<span class="nb">id</span><span class="p">:</span> <span class="n">Hashable</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#Sample.__init__"></a>
    
    

                            </div>
                            <div id="Sample.members" class="classattr">
                                <div class="attr variable">
            <span class="name">members</span><span class="annotation">: Dict[<a href="spec/model/v0_5.html#TensorId">bioimageio.spec.model.v0_5.TensorId</a>, <a href="#Tensor">Tensor</a>]</span>

        
    </div>
    <a class="headerlink" href="#Sample.members"></a>
    
            <div class="docstring"><p>the sample's tensors</p>
</div>


                            </div>
                            <div id="Sample.stat" class="classattr">
                                <div class="attr variable">
            <span class="name">stat</span><span class="annotation">: Dict[Annotated[Union[Annotated[Union[<a href="core/stat_measures.html#SampleMean">bioimageio.core.stat_measures.SampleMean</a>, <a href="core/stat_measures.html#SampleStd">bioimageio.core.stat_measures.SampleStd</a>, <a href="core/stat_measures.html#SampleVar">bioimageio.core.stat_measures.SampleVar</a>, <a href="core/stat_measures.html#SampleQuantile">bioimageio.core.stat_measures.SampleQuantile</a>], Discriminator(discriminator=&#39;name&#39;, custom_error_type=None, custom_error_message=None, custom_error_context=None)], Annotated[Union[<a href="core/stat_measures.html#DatasetMean">bioimageio.core.stat_measures.DatasetMean</a>, <a href="core/stat_measures.html#DatasetStd">bioimageio.core.stat_measures.DatasetStd</a>, <a href="core/stat_measures.html#DatasetVar">bioimageio.core.stat_measures.DatasetVar</a>, <a href="core/stat_measures.html#DatasetPercentile">bioimageio.core.stat_measures.DatasetPercentile</a>], Discriminator(discriminator=&#39;name&#39;, custom_error_type=None, custom_error_message=None, custom_error_context=None)]], Discriminator(discriminator=&#39;scope&#39;, custom_error_type=None, custom_error_message=None, custom_error_context=None)], Union[float, Annotated[<a href="#Tensor">Tensor</a>, BeforeValidator(func=&lt;function tensor_custom_before_validator at 0x7f7587fee840&gt;, json_schema_input_type=PydanticUndefined), PlainSerializer(func=&lt;function tensor_custom_serializer at 0x7f7587feea20&gt;, return_type=PydanticUndefined, when_used=&#39;always&#39;)]]]</span>

        
    </div>
    <a class="headerlink" href="#Sample.stat"></a>
    
            <div class="docstring"><p>sample and dataset statistics</p>
</div>


                            </div>
                            <div id="Sample.id" class="classattr">
                                <div class="attr variable">
            <span class="name">id</span><span class="annotation">: Hashable</span>

        
    </div>
    <a class="headerlink" href="#Sample.id"></a>
    
            <div class="docstring"><p>identifier within the sample's dataset</p>
</div>


                            </div>
                            <div id="Sample.shape" class="classattr">
                                        <input id="Sample.shape-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">shape</span><span class="annotation">: Mapping[<a href="spec/model/v0_5.html#TensorId">bioimageio.spec.model.v0_5.TensorId</a>, Mapping[<a href="#AxisId">AxisId</a>, int]]</span>

                <label class="view-source-button" for="Sample.shape-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Sample.shape"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Sample.shape-57"><a href="#Sample.shape-57"><span class="linenos">57</span></a>    <span class="nd">@property</span>
</span><span id="Sample.shape-58"><a href="#Sample.shape-58"><span class="linenos">58</span></a>    <span class="k">def</span> <span class="nf">shape</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PerMember</span><span class="p">[</span><span class="n">PerAxis</span><span class="p">[</span><span class="nb">int</span><span class="p">]]:</span>
</span><span id="Sample.shape-59"><a href="#Sample.shape-59"><span class="linenos">59</span></a>        <span class="k">return</span> <span class="p">{</span><span class="n">tid</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">sizes</span> <span class="k">for</span> <span class="n">tid</span><span class="p">,</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">members</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
</span></pre></div>


    

                            </div>
                            <div id="Sample.split_into_blocks" class="classattr">
                                        <input id="Sample.split_into_blocks-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">split_into_blocks</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">block_shapes</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="n"><a href="spec/model/v0_5.html#TensorId">bioimageio.spec.model.v0_5.TensorId</a></span><span class="p">,</span> <span class="n">Mapping</span><span class="p">[</span><span class="n"><a href="#AxisId">AxisId</a></span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span>,</span><span class="param">	<span class="n">halo</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="n"><a href="spec/model/v0_5.html#TensorId">bioimageio.spec.model.v0_5.TensorId</a></span><span class="p">,</span> <span class="n">Mapping</span><span class="p">[</span><span class="n"><a href="#AxisId">AxisId</a></span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="n"><a href="core/common.html#Halo">bioimageio.core.common.Halo</a></span><span class="p">]]]</span>,</span><span class="param">	<span class="n">pad_mode</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;edge&#39;</span><span class="p">,</span> <span class="s1">&#39;reflect&#39;</span><span class="p">,</span> <span class="s1">&#39;symmetric&#39;</span><span class="p">]</span>,</span><span class="param">	<span class="n">broadcast</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">) -> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">[</span><span class="n"><a href="core/sample.html#SampleBlockWithOrigin">bioimageio.core.sample.SampleBlockWithOrigin</a></span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="Sample.split_into_blocks-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Sample.split_into_blocks"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Sample.split_into_blocks-61"><a href="#Sample.split_into_blocks-61"><span class="linenos">61</span></a>    <span class="k">def</span> <span class="nf">split_into_blocks</span><span class="p">(</span>
</span><span id="Sample.split_into_blocks-62"><a href="#Sample.split_into_blocks-62"><span class="linenos">62</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="Sample.split_into_blocks-63"><a href="#Sample.split_into_blocks-63"><span class="linenos">63</span></a>        <span class="n">block_shapes</span><span class="p">:</span> <span class="n">PerMember</span><span class="p">[</span><span class="n">PerAxis</span><span class="p">[</span><span class="nb">int</span><span class="p">]],</span>
</span><span id="Sample.split_into_blocks-64"><a href="#Sample.split_into_blocks-64"><span class="linenos">64</span></a>        <span class="n">halo</span><span class="p">:</span> <span class="n">PerMember</span><span class="p">[</span><span class="n">PerAxis</span><span class="p">[</span><span class="n">HaloLike</span><span class="p">]],</span>
</span><span id="Sample.split_into_blocks-65"><a href="#Sample.split_into_blocks-65"><span class="linenos">65</span></a>        <span class="n">pad_mode</span><span class="p">:</span> <span class="n">PadMode</span><span class="p">,</span>
</span><span id="Sample.split_into_blocks-66"><a href="#Sample.split_into_blocks-66"><span class="linenos">66</span></a>        <span class="n">broadcast</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="Sample.split_into_blocks-67"><a href="#Sample.split_into_blocks-67"><span class="linenos">67</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">TotalNumberOfBlocks</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">SampleBlockWithOrigin</span><span class="p">]]:</span>
</span><span id="Sample.split_into_blocks-68"><a href="#Sample.split_into_blocks-68"><span class="linenos">68</span></a>        <span class="k">assert</span> <span class="ow">not</span> <span class="p">(</span>
</span><span id="Sample.split_into_blocks-69"><a href="#Sample.split_into_blocks-69"><span class="linenos">69</span></a>            <span class="n">missing</span> <span class="o">:=</span> <span class="p">[</span><span class="n">m</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">block_shapes</span> <span class="k">if</span> <span class="n">m</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">members</span><span class="p">]</span>
</span><span id="Sample.split_into_blocks-70"><a href="#Sample.split_into_blocks-70"><span class="linenos">70</span></a>        <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;`block_shapes` specified for unknown members: </span><span class="si">{</span><span class="n">missing</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="Sample.split_into_blocks-71"><a href="#Sample.split_into_blocks-71"><span class="linenos">71</span></a>        <span class="k">assert</span> <span class="ow">not</span> <span class="p">(</span>
</span><span id="Sample.split_into_blocks-72"><a href="#Sample.split_into_blocks-72"><span class="linenos">72</span></a>            <span class="n">missing</span> <span class="o">:=</span> <span class="p">[</span><span class="n">m</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">halo</span> <span class="k">if</span> <span class="n">m</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">block_shapes</span><span class="p">]</span>
</span><span id="Sample.split_into_blocks-73"><a href="#Sample.split_into_blocks-73"><span class="linenos">73</span></a>        <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;`halo` specified for members without `block_shape`: </span><span class="si">{</span><span class="n">missing</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="Sample.split_into_blocks-74"><a href="#Sample.split_into_blocks-74"><span class="linenos">74</span></a>
</span><span id="Sample.split_into_blocks-75"><a href="#Sample.split_into_blocks-75"><span class="linenos">75</span></a>        <span class="n">n_blocks</span><span class="p">,</span> <span class="n">blocks</span> <span class="o">=</span> <span class="n">split_multiple_shapes_into_blocks</span><span class="p">(</span>
</span><span id="Sample.split_into_blocks-76"><a href="#Sample.split_into_blocks-76"><span class="linenos">76</span></a>            <span class="n">shapes</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
</span><span id="Sample.split_into_blocks-77"><a href="#Sample.split_into_blocks-77"><span class="linenos">77</span></a>            <span class="n">block_shapes</span><span class="o">=</span><span class="n">block_shapes</span><span class="p">,</span>
</span><span id="Sample.split_into_blocks-78"><a href="#Sample.split_into_blocks-78"><span class="linenos">78</span></a>            <span class="n">halo</span><span class="o">=</span><span class="n">halo</span><span class="p">,</span>
</span><span id="Sample.split_into_blocks-79"><a href="#Sample.split_into_blocks-79"><span class="linenos">79</span></a>            <span class="n">broadcast</span><span class="o">=</span><span class="n">broadcast</span><span class="p">,</span>
</span><span id="Sample.split_into_blocks-80"><a href="#Sample.split_into_blocks-80"><span class="linenos">80</span></a>        <span class="p">)</span>
</span><span id="Sample.split_into_blocks-81"><a href="#Sample.split_into_blocks-81"><span class="linenos">81</span></a>        <span class="k">return</span> <span class="n">n_blocks</span><span class="p">,</span> <span class="n">sample_block_generator</span><span class="p">(</span><span class="n">blocks</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">pad_mode</span><span class="o">=</span><span class="n">pad_mode</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="Sample.as_single_block" class="classattr">
                                        <input id="Sample.as_single_block-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">as_single_block</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">halo</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Mapping</span><span class="p">[</span><span class="n"><a href="spec/model/v0_5.html#TensorId">bioimageio.spec.model.v0_5.TensorId</a></span><span class="p">,</span> <span class="n">Mapping</span><span class="p">[</span><span class="n"><a href="#AxisId">AxisId</a></span><span class="p">,</span> <span class="n"><a href="core/common.html#Halo">bioimageio.core.common.Halo</a></span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Sample.as_single_block-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Sample.as_single_block"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Sample.as_single_block-83"><a href="#Sample.as_single_block-83"><span class="linenos"> 83</span></a>    <span class="k">def</span> <span class="nf">as_single_block</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">halo</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">PerMember</span><span class="p">[</span><span class="n">PerAxis</span><span class="p">[</span><span class="n">Halo</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="Sample.as_single_block-84"><a href="#Sample.as_single_block-84"><span class="linenos"> 84</span></a>        <span class="k">if</span> <span class="n">halo</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Sample.as_single_block-85"><a href="#Sample.as_single_block-85"><span class="linenos"> 85</span></a>            <span class="n">halo</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Sample.as_single_block-86"><a href="#Sample.as_single_block-86"><span class="linenos"> 86</span></a>        <span class="k">return</span> <span class="n">SampleBlockWithOrigin</span><span class="p">(</span>
</span><span id="Sample.as_single_block-87"><a href="#Sample.as_single_block-87"><span class="linenos"> 87</span></a>            <span class="n">sample_shape</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
</span><span id="Sample.as_single_block-88"><a href="#Sample.as_single_block-88"><span class="linenos"> 88</span></a>            <span class="n">sample_id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
</span><span id="Sample.as_single_block-89"><a href="#Sample.as_single_block-89"><span class="linenos"> 89</span></a>            <span class="n">blocks</span><span class="o">=</span><span class="p">{</span>
</span><span id="Sample.as_single_block-90"><a href="#Sample.as_single_block-90"><span class="linenos"> 90</span></a>                <span class="n">m</span><span class="p">:</span> <span class="n">Block</span><span class="p">(</span>
</span><span id="Sample.as_single_block-91"><a href="#Sample.as_single_block-91"><span class="linenos"> 91</span></a>                    <span class="n">sample_shape</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">m</span><span class="p">],</span>
</span><span id="Sample.as_single_block-92"><a href="#Sample.as_single_block-92"><span class="linenos"> 92</span></a>                    <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
</span><span id="Sample.as_single_block-93"><a href="#Sample.as_single_block-93"><span class="linenos"> 93</span></a>                    <span class="n">inner_slice</span><span class="o">=</span><span class="p">{</span>
</span><span id="Sample.as_single_block-94"><a href="#Sample.as_single_block-94"><span class="linenos"> 94</span></a>                        <span class="n">a</span><span class="p">:</span> <span class="n">SliceInfo</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">tagged_shape</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
</span><span id="Sample.as_single_block-95"><a href="#Sample.as_single_block-95"><span class="linenos"> 95</span></a>                    <span class="p">},</span>
</span><span id="Sample.as_single_block-96"><a href="#Sample.as_single_block-96"><span class="linenos"> 96</span></a>                    <span class="n">halo</span><span class="o">=</span><span class="n">halo</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="p">{}),</span>
</span><span id="Sample.as_single_block-97"><a href="#Sample.as_single_block-97"><span class="linenos"> 97</span></a>                    <span class="n">block_index</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="Sample.as_single_block-98"><a href="#Sample.as_single_block-98"><span class="linenos"> 98</span></a>                    <span class="n">blocks_in_sample</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="Sample.as_single_block-99"><a href="#Sample.as_single_block-99"><span class="linenos"> 99</span></a>                <span class="p">)</span>
</span><span id="Sample.as_single_block-100"><a href="#Sample.as_single_block-100"><span class="linenos">100</span></a>                <span class="k">for</span> <span class="n">m</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">members</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
</span><span id="Sample.as_single_block-101"><a href="#Sample.as_single_block-101"><span class="linenos">101</span></a>            <span class="p">},</span>
</span><span id="Sample.as_single_block-102"><a href="#Sample.as_single_block-102"><span class="linenos">102</span></a>            <span class="n">stat</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stat</span><span class="p">,</span>
</span><span id="Sample.as_single_block-103"><a href="#Sample.as_single_block-103"><span class="linenos">103</span></a>            <span class="n">origin</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
</span><span id="Sample.as_single_block-104"><a href="#Sample.as_single_block-104"><span class="linenos">104</span></a>            <span class="n">block_index</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="Sample.as_single_block-105"><a href="#Sample.as_single_block-105"><span class="linenos">105</span></a>            <span class="n">blocks_in_sample</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="Sample.as_single_block-106"><a href="#Sample.as_single_block-106"><span class="linenos">106</span></a>        <span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="Sample.from_blocks" class="classattr">
                                        <input id="Sample.from_blocks-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-classmethod">@classmethod</div>

        <span class="def">def</span>
        <span class="name">from_blocks</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">cls</span>,</span><span class="param">	<span class="n">sample_blocks</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n"><a href="core/sample.html#SampleBlock">bioimageio.core.sample.SampleBlock</a></span><span class="p">]</span>,</span><span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">fill_value</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">nan</span></span><span class="return-annotation">) -> <span class="n">Self</span>:</span></span>

                <label class="view-source-button" for="Sample.from_blocks-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Sample.from_blocks"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Sample.from_blocks-108"><a href="#Sample.from_blocks-108"><span class="linenos">108</span></a>    <span class="nd">@classmethod</span>
</span><span id="Sample.from_blocks-109"><a href="#Sample.from_blocks-109"><span class="linenos">109</span></a>    <span class="k">def</span> <span class="nf">from_blocks</span><span class="p">(</span>
</span><span id="Sample.from_blocks-110"><a href="#Sample.from_blocks-110"><span class="linenos">110</span></a>        <span class="bp">cls</span><span class="p">,</span>
</span><span id="Sample.from_blocks-111"><a href="#Sample.from_blocks-111"><span class="linenos">111</span></a>        <span class="n">sample_blocks</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">SampleBlock</span><span class="p">],</span>
</span><span id="Sample.from_blocks-112"><a href="#Sample.from_blocks-112"><span class="linenos">112</span></a>        <span class="o">*</span><span class="p">,</span>
</span><span id="Sample.from_blocks-113"><a href="#Sample.from_blocks-113"><span class="linenos">113</span></a>        <span class="n">fill_value</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;nan&quot;</span><span class="p">),</span>
</span><span id="Sample.from_blocks-114"><a href="#Sample.from_blocks-114"><span class="linenos">114</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
</span><span id="Sample.from_blocks-115"><a href="#Sample.from_blocks-115"><span class="linenos">115</span></a>        <span class="n">members</span><span class="p">:</span> <span class="n">PerMember</span><span class="p">[</span><span class="n">Tensor</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Sample.from_blocks-116"><a href="#Sample.from_blocks-116"><span class="linenos">116</span></a>        <span class="n">stat</span><span class="p">:</span> <span class="n">Stat</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Sample.from_blocks-117"><a href="#Sample.from_blocks-117"><span class="linenos">117</span></a>        <span class="n">sample_id</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Sample.from_blocks-118"><a href="#Sample.from_blocks-118"><span class="linenos">118</span></a>        <span class="k">for</span> <span class="n">sample_block</span> <span class="ow">in</span> <span class="n">sample_blocks</span><span class="p">:</span>
</span><span id="Sample.from_blocks-119"><a href="#Sample.from_blocks-119"><span class="linenos">119</span></a>            <span class="k">assert</span> <span class="n">sample_id</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">sample_id</span> <span class="o">==</span> <span class="n">sample_block</span><span class="o">.</span><span class="n">sample_id</span>
</span><span id="Sample.from_blocks-120"><a href="#Sample.from_blocks-120"><span class="linenos">120</span></a>            <span class="n">sample_id</span> <span class="o">=</span> <span class="n">sample_block</span><span class="o">.</span><span class="n">sample_id</span>
</span><span id="Sample.from_blocks-121"><a href="#Sample.from_blocks-121"><span class="linenos">121</span></a>            <span class="n">stat</span> <span class="o">=</span> <span class="n">sample_block</span><span class="o">.</span><span class="n">stat</span>
</span><span id="Sample.from_blocks-122"><a href="#Sample.from_blocks-122"><span class="linenos">122</span></a>            <span class="k">for</span> <span class="n">m</span><span class="p">,</span> <span class="n">block</span> <span class="ow">in</span> <span class="n">sample_block</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="Sample.from_blocks-123"><a href="#Sample.from_blocks-123"><span class="linenos">123</span></a>                <span class="k">if</span> <span class="n">m</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">members</span><span class="p">:</span>
</span><span id="Sample.from_blocks-124"><a href="#Sample.from_blocks-124"><span class="linenos">124</span></a>                    <span class="k">if</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">in</span> <span class="n">block</span><span class="o">.</span><span class="n">sample_shape</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
</span><span id="Sample.from_blocks-125"><a href="#Sample.from_blocks-125"><span class="linenos">125</span></a>                        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
</span><span id="Sample.from_blocks-126"><a href="#Sample.from_blocks-126"><span class="linenos">126</span></a>                            <span class="s2">&quot;merging blocks with data dependent axis not yet implemented&quot;</span>
</span><span id="Sample.from_blocks-127"><a href="#Sample.from_blocks-127"><span class="linenos">127</span></a>                        <span class="p">)</span>
</span><span id="Sample.from_blocks-128"><a href="#Sample.from_blocks-128"><span class="linenos">128</span></a>
</span><span id="Sample.from_blocks-129"><a href="#Sample.from_blocks-129"><span class="linenos">129</span></a>                    <span class="n">members</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">(</span>
</span><span id="Sample.from_blocks-130"><a href="#Sample.from_blocks-130"><span class="linenos">130</span></a>                        <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span>
</span><span id="Sample.from_blocks-131"><a href="#Sample.from_blocks-131"><span class="linenos">131</span></a>                            <span class="nb">tuple</span><span class="p">(</span><span class="n">block</span><span class="o">.</span><span class="n">sample_shape</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">block</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dims</span><span class="p">),</span>
</span><span id="Sample.from_blocks-132"><a href="#Sample.from_blocks-132"><span class="linenos">132</span></a>                            <span class="n">fill_value</span><span class="p">,</span>
</span><span id="Sample.from_blocks-133"><a href="#Sample.from_blocks-133"><span class="linenos">133</span></a>                            <span class="n">dtype</span><span class="o">=</span><span class="n">block</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span>
</span><span id="Sample.from_blocks-134"><a href="#Sample.from_blocks-134"><span class="linenos">134</span></a>                        <span class="p">),</span>
</span><span id="Sample.from_blocks-135"><a href="#Sample.from_blocks-135"><span class="linenos">135</span></a>                        <span class="n">dims</span><span class="o">=</span><span class="n">block</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dims</span><span class="p">,</span>
</span><span id="Sample.from_blocks-136"><a href="#Sample.from_blocks-136"><span class="linenos">136</span></a>                    <span class="p">)</span>
</span><span id="Sample.from_blocks-137"><a href="#Sample.from_blocks-137"><span class="linenos">137</span></a>
</span><span id="Sample.from_blocks-138"><a href="#Sample.from_blocks-138"><span class="linenos">138</span></a>                <span class="n">members</span><span class="p">[</span><span class="n">m</span><span class="p">][</span><span class="n">block</span><span class="o">.</span><span class="n">inner_slice</span><span class="p">]</span> <span class="o">=</span> <span class="n">block</span><span class="o">.</span><span class="n">inner_data</span>
</span><span id="Sample.from_blocks-139"><a href="#Sample.from_blocks-139"><span class="linenos">139</span></a>
</span><span id="Sample.from_blocks-140"><a href="#Sample.from_blocks-140"><span class="linenos">140</span></a>        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">members</span><span class="o">=</span><span class="n">members</span><span class="p">,</span> <span class="n">stat</span><span class="o">=</span><span class="n">stat</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="n">sample_id</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                </section>
                <section id="save_bioimageio_package_as_folder">
                            <input id="save_bioimageio_package_as_folder-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">save_bioimageio_package_as_folder</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">source</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">bioimageio</span><span class="o">.</span><span class="n">spec</span><span class="o">.</span><span class="n">_internal</span><span class="o">.</span><span class="n">url</span><span class="o">.</span><span class="n">HttpUrl</span><span class="p">,</span> <span class="n">bioimageio</span><span class="o">.</span><span class="n">spec</span><span class="o">.</span><span class="n">_internal</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">RelativeFilePath</span><span class="p">,</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span> <span class="n">PathType</span><span class="p">(</span><span class="n">path_type</span><span class="o">=</span><span class="s1">&#39;file&#39;</span><span class="p">)]],</span> <span class="n">FieldInfo</span><span class="p">(</span><span class="n">annotation</span><span class="o">=</span><span class="n">NoneType</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="p">[</span><span class="n">_PydanticGeneralMetadata</span><span class="p">(</span><span class="n">union_mode</span><span class="o">=</span><span class="s1">&#39;left_to_right&#39;</span><span class="p">)])],</span> <span class="nb">str</span><span class="p">,</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">pydantic_core</span><span class="o">.</span><span class="n">_pydantic_core</span><span class="o">.</span><span class="n">Url</span><span class="p">,</span> <span class="n">UrlConstraints</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">2083</span><span class="p">,</span> <span class="n">allowed_schemes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;http&#39;</span><span class="p">,</span> <span class="s1">&#39;https&#39;</span><span class="p">],</span> <span class="n">host_required</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">default_host</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">default_port</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">default_path</span><span class="o">=</span><span class="kc">None</span><span class="p">)],</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">YamlValue</span><span class="p">],</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n"><a href="spec/application/v0_2.html#ApplicationDescr">bioimageio.spec.application.v0_2.ApplicationDescr</a></span><span class="p">,</span> <span class="n"><a href="spec.html#ApplicationDescr">bioimageio.spec.ApplicationDescr</a></span><span class="p">],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=</span><span class="s1">&#39;format_version&#39;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)],</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n"><a href="spec/dataset/v0_2.html#DatasetDescr">bioimageio.spec.dataset.v0_2.DatasetDescr</a></span><span class="p">,</span> <span class="n"><a href="spec.html#DatasetDescr">bioimageio.spec.DatasetDescr</a></span><span class="p">],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=</span><span class="s1">&#39;format_version&#39;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)],</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n"><a href="spec/model/v0_4.html#ModelDescr">bioimageio.spec.model.v0_4.ModelDescr</a></span><span class="p">,</span> <span class="n"><a href="spec.html#ModelDescr">bioimageio.spec.ModelDescr</a></span><span class="p">],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=</span><span class="s1">&#39;format_version&#39;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)],</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n"><a href="spec.html#NotebookDescr">bioimageio.spec.NotebookDescr</a></span><span class="p">,</span> <span class="n"><a href="spec.html#NotebookDescr">bioimageio.spec.NotebookDescr</a></span><span class="p">],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=</span><span class="s1">&#39;format_version&#39;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)]],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=</span><span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)],</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n"><a href="spec/generic/v0_2.html#GenericDescr">bioimageio.spec.generic.v0_2.GenericDescr</a></span><span class="p">,</span> <span class="n"><a href="spec.html#GenericDescr">bioimageio.spec.GenericDescr</a></span><span class="p">],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=</span><span class="s1">&#39;format_version&#39;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)]]</span>,</span><span class="param">	<span class="o">/</span>,</span><span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">output_path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Annotated</span><span class="p">[</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span> <span class="n">PathType</span><span class="p">(</span><span class="n">path_type</span><span class="o">=</span><span class="s1">&#39;new&#39;</span><span class="p">)],</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span> <span class="n">PathType</span><span class="p">(</span><span class="n">path_type</span><span class="o">=</span><span class="s1">&#39;dir&#39;</span><span class="p">)],</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">weights_priority_order</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;keras_hdf5&#39;</span><span class="p">,</span> <span class="s1">&#39;onnx&#39;</span><span class="p">,</span> <span class="s1">&#39;pytorch_state_dict&#39;</span><span class="p">,</span> <span class="s1">&#39;tensorflow_js&#39;</span><span class="p">,</span> <span class="s1">&#39;tensorflow_saved_model_bundle&#39;</span><span class="p">,</span> <span class="s1">&#39;torchscript&#39;</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n">Annotated</span><span class="p">[</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span> <span class="n">PathType</span><span class="p">(</span><span class="n">path_type</span><span class="o">=</span><span class="s1">&#39;dir&#39;</span><span class="p">)]</span>:</span></span>

                <label class="view-source-button" for="save_bioimageio_package_as_folder-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#save_bioimageio_package_as_folder"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="save_bioimageio_package_as_folder-121"><a href="#save_bioimageio_package_as_folder-121"><span class="linenos">121</span></a><span class="k">def</span> <span class="nf">save_bioimageio_package_as_folder</span><span class="p">(</span>
</span><span id="save_bioimageio_package_as_folder-122"><a href="#save_bioimageio_package_as_folder-122"><span class="linenos">122</span></a>    <span class="n">source</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">BioimageioYamlSource</span><span class="p">,</span> <span class="n">ResourceDescr</span><span class="p">],</span>
</span><span id="save_bioimageio_package_as_folder-123"><a href="#save_bioimageio_package_as_folder-123"><span class="linenos">123</span></a>    <span class="o">/</span><span class="p">,</span>
</span><span id="save_bioimageio_package_as_folder-124"><a href="#save_bioimageio_package_as_folder-124"><span class="linenos">124</span></a>    <span class="o">*</span><span class="p">,</span>
</span><span id="save_bioimageio_package_as_folder-125"><a href="#save_bioimageio_package_as_folder-125"><span class="linenos">125</span></a>    <span class="n">output_path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">NewPath</span><span class="p">,</span> <span class="n">DirectoryPath</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="save_bioimageio_package_as_folder-126"><a href="#save_bioimageio_package_as_folder-126"><span class="linenos">126</span></a>    <span class="n">weights_priority_order</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span>  <span class="c1"># model only</span>
</span><span id="save_bioimageio_package_as_folder-127"><a href="#save_bioimageio_package_as_folder-127"><span class="linenos">127</span></a>        <span class="n">Sequence</span><span class="p">[</span>
</span><span id="save_bioimageio_package_as_folder-128"><a href="#save_bioimageio_package_as_folder-128"><span class="linenos">128</span></a>            <span class="n">Literal</span><span class="p">[</span>
</span><span id="save_bioimageio_package_as_folder-129"><a href="#save_bioimageio_package_as_folder-129"><span class="linenos">129</span></a>                <span class="s2">&quot;keras_hdf5&quot;</span><span class="p">,</span>
</span><span id="save_bioimageio_package_as_folder-130"><a href="#save_bioimageio_package_as_folder-130"><span class="linenos">130</span></a>                <span class="s2">&quot;onnx&quot;</span><span class="p">,</span>
</span><span id="save_bioimageio_package_as_folder-131"><a href="#save_bioimageio_package_as_folder-131"><span class="linenos">131</span></a>                <span class="s2">&quot;pytorch_state_dict&quot;</span><span class="p">,</span>
</span><span id="save_bioimageio_package_as_folder-132"><a href="#save_bioimageio_package_as_folder-132"><span class="linenos">132</span></a>                <span class="s2">&quot;tensorflow_js&quot;</span><span class="p">,</span>
</span><span id="save_bioimageio_package_as_folder-133"><a href="#save_bioimageio_package_as_folder-133"><span class="linenos">133</span></a>                <span class="s2">&quot;tensorflow_saved_model_bundle&quot;</span><span class="p">,</span>
</span><span id="save_bioimageio_package_as_folder-134"><a href="#save_bioimageio_package_as_folder-134"><span class="linenos">134</span></a>                <span class="s2">&quot;torchscript&quot;</span><span class="p">,</span>
</span><span id="save_bioimageio_package_as_folder-135"><a href="#save_bioimageio_package_as_folder-135"><span class="linenos">135</span></a>            <span class="p">]</span>
</span><span id="save_bioimageio_package_as_folder-136"><a href="#save_bioimageio_package_as_folder-136"><span class="linenos">136</span></a>        <span class="p">]</span>
</span><span id="save_bioimageio_package_as_folder-137"><a href="#save_bioimageio_package_as_folder-137"><span class="linenos">137</span></a>    <span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="save_bioimageio_package_as_folder-138"><a href="#save_bioimageio_package_as_folder-138"><span class="linenos">138</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DirectoryPath</span><span class="p">:</span>
</span><span id="save_bioimageio_package_as_folder-139"><a href="#save_bioimageio_package_as_folder-139"><span class="linenos">139</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Write the content of a bioimage.io resource package to a folder.</span>
</span><span id="save_bioimageio_package_as_folder-140"><a href="#save_bioimageio_package_as_folder-140"><span class="linenos">140</span></a>
</span><span id="save_bioimageio_package_as_folder-141"><a href="#save_bioimageio_package_as_folder-141"><span class="linenos">141</span></a><span class="sd">    Args:</span>
</span><span id="save_bioimageio_package_as_folder-142"><a href="#save_bioimageio_package_as_folder-142"><span class="linenos">142</span></a><span class="sd">        source: bioimageio resource description</span>
</span><span id="save_bioimageio_package_as_folder-143"><a href="#save_bioimageio_package_as_folder-143"><span class="linenos">143</span></a><span class="sd">        output_path: file path to write package to</span>
</span><span id="save_bioimageio_package_as_folder-144"><a href="#save_bioimageio_package_as_folder-144"><span class="linenos">144</span></a><span class="sd">        weights_priority_order: If given only the first weights format present in the model is included.</span>
</span><span id="save_bioimageio_package_as_folder-145"><a href="#save_bioimageio_package_as_folder-145"><span class="linenos">145</span></a><span class="sd">                                If none of the prioritized weights formats is found all are included.</span>
</span><span id="save_bioimageio_package_as_folder-146"><a href="#save_bioimageio_package_as_folder-146"><span class="linenos">146</span></a>
</span><span id="save_bioimageio_package_as_folder-147"><a href="#save_bioimageio_package_as_folder-147"><span class="linenos">147</span></a><span class="sd">    Returns:</span>
</span><span id="save_bioimageio_package_as_folder-148"><a href="#save_bioimageio_package_as_folder-148"><span class="linenos">148</span></a><span class="sd">        directory path to bioimageio package folder</span>
</span><span id="save_bioimageio_package_as_folder-149"><a href="#save_bioimageio_package_as_folder-149"><span class="linenos">149</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="save_bioimageio_package_as_folder-150"><a href="#save_bioimageio_package_as_folder-150"><span class="linenos">150</span></a>    <span class="n">package_content</span> <span class="o">=</span> <span class="n">_prepare_resource_package</span><span class="p">(</span>
</span><span id="save_bioimageio_package_as_folder-151"><a href="#save_bioimageio_package_as_folder-151"><span class="linenos">151</span></a>        <span class="n">source</span><span class="p">,</span>
</span><span id="save_bioimageio_package_as_folder-152"><a href="#save_bioimageio_package_as_folder-152"><span class="linenos">152</span></a>        <span class="n">weights_priority_order</span><span class="o">=</span><span class="n">weights_priority_order</span><span class="p">,</span>
</span><span id="save_bioimageio_package_as_folder-153"><a href="#save_bioimageio_package_as_folder-153"><span class="linenos">153</span></a>    <span class="p">)</span>
</span><span id="save_bioimageio_package_as_folder-154"><a href="#save_bioimageio_package_as_folder-154"><span class="linenos">154</span></a>    <span class="k">if</span> <span class="n">output_path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="save_bioimageio_package_as_folder-155"><a href="#save_bioimageio_package_as_folder-155"><span class="linenos">155</span></a>        <span class="n">output_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">mkdtemp</span><span class="p">())</span>
</span><span id="save_bioimageio_package_as_folder-156"><a href="#save_bioimageio_package_as_folder-156"><span class="linenos">156</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="save_bioimageio_package_as_folder-157"><a href="#save_bioimageio_package_as_folder-157"><span class="linenos">157</span></a>        <span class="n">output_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">output_path</span><span class="p">)</span>
</span><span id="save_bioimageio_package_as_folder-158"><a href="#save_bioimageio_package_as_folder-158"><span class="linenos">158</span></a>
</span><span id="save_bioimageio_package_as_folder-159"><a href="#save_bioimageio_package_as_folder-159"><span class="linenos">159</span></a>    <span class="n">output_path</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="save_bioimageio_package_as_folder-160"><a href="#save_bioimageio_package_as_folder-160"><span class="linenos">160</span></a>    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">src</span> <span class="ow">in</span> <span class="n">package_content</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="save_bioimageio_package_as_folder-161"><a href="#save_bioimageio_package_as_folder-161"><span class="linenos">161</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">collections</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">Mapping</span><span class="p">):</span>
</span><span id="save_bioimageio_package_as_folder-162"><a href="#save_bioimageio_package_as_folder-162"><span class="linenos">162</span></a>            <span class="n">write_yaml</span><span class="p">(</span><span class="n">cast</span><span class="p">(</span><span class="n">YamlValue</span><span class="p">,</span> <span class="n">src</span><span class="p">),</span> <span class="n">output_path</span> <span class="o">/</span> <span class="n">name</span><span class="p">)</span>
</span><span id="save_bioimageio_package_as_folder-163"><a href="#save_bioimageio_package_as_folder-163"><span class="linenos">163</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">ZipPath</span><span class="p">):</span>
</span><span id="save_bioimageio_package_as_folder-164"><a href="#save_bioimageio_package_as_folder-164"><span class="linenos">164</span></a>            <span class="n">extracted</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">src</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="n">src</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">output_path</span><span class="p">))</span>
</span><span id="save_bioimageio_package_as_folder-165"><a href="#save_bioimageio_package_as_folder-165"><span class="linenos">165</span></a>            <span class="k">if</span> <span class="n">extracted</span><span class="o">.</span><span class="n">name</span> <span class="o">!=</span> <span class="n">src</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
</span><span id="save_bioimageio_package_as_folder-166"><a href="#save_bioimageio_package_as_folder-166"><span class="linenos">166</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="save_bioimageio_package_as_folder-167"><a href="#save_bioimageio_package_as_folder-167"><span class="linenos">167</span></a>                    <span class="n">shutil</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">extracted</span><span class="p">),</span> <span class="n">output_path</span> <span class="o">/</span> <span class="n">src</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="save_bioimageio_package_as_folder-168"><a href="#save_bioimageio_package_as_folder-168"><span class="linenos">168</span></a>                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="save_bioimageio_package_as_folder-169"><a href="#save_bioimageio_package_as_folder-169"><span class="linenos">169</span></a>                    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
</span><span id="save_bioimageio_package_as_folder-170"><a href="#save_bioimageio_package_as_folder-170"><span class="linenos">170</span></a>                        <span class="sa">f</span><span class="s2">&quot;Failed to rename extracted file &#39;</span><span class="si">{</span><span class="n">extracted</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
</span><span id="save_bioimageio_package_as_folder-171"><a href="#save_bioimageio_package_as_folder-171"><span class="linenos">171</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot; to &#39;</span><span class="si">{</span><span class="n">src</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39;.&quot;</span>
</span><span id="save_bioimageio_package_as_folder-172"><a href="#save_bioimageio_package_as_folder-172"><span class="linenos">172</span></a>                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot; (extracted from &#39;</span><span class="si">{</span><span class="n">src</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; in &#39;</span><span class="si">{</span><span class="n">src</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">filename</span><span class="si">}</span><span class="s2">&#39;)&quot;</span>
</span><span id="save_bioimageio_package_as_folder-173"><a href="#save_bioimageio_package_as_folder-173"><span class="linenos">173</span></a>                    <span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span>
</span><span id="save_bioimageio_package_as_folder-174"><a href="#save_bioimageio_package_as_folder-174"><span class="linenos">174</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="save_bioimageio_package_as_folder-175"><a href="#save_bioimageio_package_as_folder-175"><span class="linenos">175</span></a>            <span class="n">shutil</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">output_path</span> <span class="o">/</span> <span class="n">name</span><span class="p">)</span>
</span><span id="save_bioimageio_package_as_folder-176"><a href="#save_bioimageio_package_as_folder-176"><span class="linenos">176</span></a>
</span><span id="save_bioimageio_package_as_folder-177"><a href="#save_bioimageio_package_as_folder-177"><span class="linenos">177</span></a>    <span class="k">return</span> <span class="n">output_path</span>
</span></pre></div>


            <div class="docstring"><p>Write the content of a bioimage.io resource package to a folder.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>source:</strong>  bioimageio resource description</li>
<li><strong>output_path:</strong>  file path to write package to</li>
<li><strong>weights_priority_order:</strong>  If given only the first weights format present in the model is included.
If none of the prioritized weights formats is found all are included.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>directory path to bioimageio package folder</p>
</blockquote>
</div>


                </section>
                <section id="save_bioimageio_package">
                            <input id="save_bioimageio_package-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">save_bioimageio_package</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">source</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">bioimageio</span><span class="o">.</span><span class="n">spec</span><span class="o">.</span><span class="n">_internal</span><span class="o">.</span><span class="n">url</span><span class="o">.</span><span class="n">HttpUrl</span><span class="p">,</span> <span class="n">bioimageio</span><span class="o">.</span><span class="n">spec</span><span class="o">.</span><span class="n">_internal</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">RelativeFilePath</span><span class="p">,</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span> <span class="n">PathType</span><span class="p">(</span><span class="n">path_type</span><span class="o">=</span><span class="s1">&#39;file&#39;</span><span class="p">)]],</span> <span class="n">FieldInfo</span><span class="p">(</span><span class="n">annotation</span><span class="o">=</span><span class="n">NoneType</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="p">[</span><span class="n">_PydanticGeneralMetadata</span><span class="p">(</span><span class="n">union_mode</span><span class="o">=</span><span class="s1">&#39;left_to_right&#39;</span><span class="p">)])],</span> <span class="nb">str</span><span class="p">,</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">pydantic_core</span><span class="o">.</span><span class="n">_pydantic_core</span><span class="o">.</span><span class="n">Url</span><span class="p">,</span> <span class="n">UrlConstraints</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">2083</span><span class="p">,</span> <span class="n">allowed_schemes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;http&#39;</span><span class="p">,</span> <span class="s1">&#39;https&#39;</span><span class="p">],</span> <span class="n">host_required</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">default_host</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">default_port</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">default_path</span><span class="o">=</span><span class="kc">None</span><span class="p">)],</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">YamlValue</span><span class="p">],</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n"><a href="spec/application/v0_2.html#ApplicationDescr">bioimageio.spec.application.v0_2.ApplicationDescr</a></span><span class="p">,</span> <span class="n"><a href="spec.html#ApplicationDescr">bioimageio.spec.ApplicationDescr</a></span><span class="p">],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=</span><span class="s1">&#39;format_version&#39;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)],</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n"><a href="spec/dataset/v0_2.html#DatasetDescr">bioimageio.spec.dataset.v0_2.DatasetDescr</a></span><span class="p">,</span> <span class="n"><a href="spec.html#DatasetDescr">bioimageio.spec.DatasetDescr</a></span><span class="p">],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=</span><span class="s1">&#39;format_version&#39;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)],</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n"><a href="spec/model/v0_4.html#ModelDescr">bioimageio.spec.model.v0_4.ModelDescr</a></span><span class="p">,</span> <span class="n"><a href="spec.html#ModelDescr">bioimageio.spec.ModelDescr</a></span><span class="p">],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=</span><span class="s1">&#39;format_version&#39;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)],</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n"><a href="spec.html#NotebookDescr">bioimageio.spec.NotebookDescr</a></span><span class="p">,</span> <span class="n"><a href="spec.html#NotebookDescr">bioimageio.spec.NotebookDescr</a></span><span class="p">],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=</span><span class="s1">&#39;format_version&#39;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)]],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=</span><span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)],</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n"><a href="spec/generic/v0_2.html#GenericDescr">bioimageio.spec.generic.v0_2.GenericDescr</a></span><span class="p">,</span> <span class="n"><a href="spec.html#GenericDescr">bioimageio.spec.GenericDescr</a></span><span class="p">],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=</span><span class="s1">&#39;format_version&#39;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)]]</span>,</span><span class="param">	<span class="o">/</span>,</span><span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">compression</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">8</span>,</span><span class="param">	<span class="n">compression_level</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>,</span><span class="param">	<span class="n">output_path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Annotated</span><span class="p">[</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span> <span class="n">PathType</span><span class="p">(</span><span class="n">path_type</span><span class="o">=</span><span class="s1">&#39;new&#39;</span><span class="p">)],</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span> <span class="n">PathType</span><span class="p">(</span><span class="n">path_type</span><span class="o">=</span><span class="s1">&#39;file&#39;</span><span class="p">)],</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">weights_priority_order</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;keras_hdf5&#39;</span><span class="p">,</span> <span class="s1">&#39;onnx&#39;</span><span class="p">,</span> <span class="s1">&#39;pytorch_state_dict&#39;</span><span class="p">,</span> <span class="s1">&#39;tensorflow_js&#39;</span><span class="p">,</span> <span class="s1">&#39;tensorflow_saved_model_bundle&#39;</span><span class="p">,</span> <span class="s1">&#39;torchscript&#39;</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n">Annotated</span><span class="p">[</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span> <span class="n">PathType</span><span class="p">(</span><span class="n">path_type</span><span class="o">=</span><span class="s1">&#39;file&#39;</span><span class="p">)]</span>:</span></span>

                <label class="view-source-button" for="save_bioimageio_package-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#save_bioimageio_package"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="save_bioimageio_package-180"><a href="#save_bioimageio_package-180"><span class="linenos">180</span></a><span class="k">def</span> <span class="nf">save_bioimageio_package</span><span class="p">(</span>
</span><span id="save_bioimageio_package-181"><a href="#save_bioimageio_package-181"><span class="linenos">181</span></a>    <span class="n">source</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">BioimageioYamlSource</span><span class="p">,</span> <span class="n">ResourceDescr</span><span class="p">],</span>
</span><span id="save_bioimageio_package-182"><a href="#save_bioimageio_package-182"><span class="linenos">182</span></a>    <span class="o">/</span><span class="p">,</span>
</span><span id="save_bioimageio_package-183"><a href="#save_bioimageio_package-183"><span class="linenos">183</span></a>    <span class="o">*</span><span class="p">,</span>
</span><span id="save_bioimageio_package-184"><a href="#save_bioimageio_package-184"><span class="linenos">184</span></a>    <span class="n">compression</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">ZIP_DEFLATED</span><span class="p">,</span>
</span><span id="save_bioimageio_package-185"><a href="#save_bioimageio_package-185"><span class="linenos">185</span></a>    <span class="n">compression_level</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="save_bioimageio_package-186"><a href="#save_bioimageio_package-186"><span class="linenos">186</span></a>    <span class="n">output_path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">NewPath</span><span class="p">,</span> <span class="n">FilePath</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="save_bioimageio_package-187"><a href="#save_bioimageio_package-187"><span class="linenos">187</span></a>    <span class="n">weights_priority_order</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span>  <span class="c1"># model only</span>
</span><span id="save_bioimageio_package-188"><a href="#save_bioimageio_package-188"><span class="linenos">188</span></a>        <span class="n">Sequence</span><span class="p">[</span>
</span><span id="save_bioimageio_package-189"><a href="#save_bioimageio_package-189"><span class="linenos">189</span></a>            <span class="n">Literal</span><span class="p">[</span>
</span><span id="save_bioimageio_package-190"><a href="#save_bioimageio_package-190"><span class="linenos">190</span></a>                <span class="s2">&quot;keras_hdf5&quot;</span><span class="p">,</span>
</span><span id="save_bioimageio_package-191"><a href="#save_bioimageio_package-191"><span class="linenos">191</span></a>                <span class="s2">&quot;onnx&quot;</span><span class="p">,</span>
</span><span id="save_bioimageio_package-192"><a href="#save_bioimageio_package-192"><span class="linenos">192</span></a>                <span class="s2">&quot;pytorch_state_dict&quot;</span><span class="p">,</span>
</span><span id="save_bioimageio_package-193"><a href="#save_bioimageio_package-193"><span class="linenos">193</span></a>                <span class="s2">&quot;tensorflow_js&quot;</span><span class="p">,</span>
</span><span id="save_bioimageio_package-194"><a href="#save_bioimageio_package-194"><span class="linenos">194</span></a>                <span class="s2">&quot;tensorflow_saved_model_bundle&quot;</span><span class="p">,</span>
</span><span id="save_bioimageio_package-195"><a href="#save_bioimageio_package-195"><span class="linenos">195</span></a>                <span class="s2">&quot;torchscript&quot;</span><span class="p">,</span>
</span><span id="save_bioimageio_package-196"><a href="#save_bioimageio_package-196"><span class="linenos">196</span></a>            <span class="p">]</span>
</span><span id="save_bioimageio_package-197"><a href="#save_bioimageio_package-197"><span class="linenos">197</span></a>        <span class="p">]</span>
</span><span id="save_bioimageio_package-198"><a href="#save_bioimageio_package-198"><span class="linenos">198</span></a>    <span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="save_bioimageio_package-199"><a href="#save_bioimageio_package-199"><span class="linenos">199</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FilePath</span><span class="p">:</span>
</span><span id="save_bioimageio_package-200"><a href="#save_bioimageio_package-200"><span class="linenos">200</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Package a bioimageio resource as a zip file.</span>
</span><span id="save_bioimageio_package-201"><a href="#save_bioimageio_package-201"><span class="linenos">201</span></a>
</span><span id="save_bioimageio_package-202"><a href="#save_bioimageio_package-202"><span class="linenos">202</span></a><span class="sd">    Args:</span>
</span><span id="save_bioimageio_package-203"><a href="#save_bioimageio_package-203"><span class="linenos">203</span></a><span class="sd">        rd: bioimageio resource description</span>
</span><span id="save_bioimageio_package-204"><a href="#save_bioimageio_package-204"><span class="linenos">204</span></a><span class="sd">        compression: The numeric constant of compression method.</span>
</span><span id="save_bioimageio_package-205"><a href="#save_bioimageio_package-205"><span class="linenos">205</span></a><span class="sd">        compression_level: Compression level to use when writing files to the archive.</span>
</span><span id="save_bioimageio_package-206"><a href="#save_bioimageio_package-206"><span class="linenos">206</span></a><span class="sd">                           See https://docs.python.org/3/library/zipfile.html#zipfile.ZipFile</span>
</span><span id="save_bioimageio_package-207"><a href="#save_bioimageio_package-207"><span class="linenos">207</span></a><span class="sd">        output_path: file path to write package to</span>
</span><span id="save_bioimageio_package-208"><a href="#save_bioimageio_package-208"><span class="linenos">208</span></a><span class="sd">        weights_priority_order: If given only the first weights format present in the model is included.</span>
</span><span id="save_bioimageio_package-209"><a href="#save_bioimageio_package-209"><span class="linenos">209</span></a><span class="sd">                                If none of the prioritized weights formats is found all are included.</span>
</span><span id="save_bioimageio_package-210"><a href="#save_bioimageio_package-210"><span class="linenos">210</span></a>
</span><span id="save_bioimageio_package-211"><a href="#save_bioimageio_package-211"><span class="linenos">211</span></a><span class="sd">    Returns:</span>
</span><span id="save_bioimageio_package-212"><a href="#save_bioimageio_package-212"><span class="linenos">212</span></a><span class="sd">        path to zipped bioimageio package</span>
</span><span id="save_bioimageio_package-213"><a href="#save_bioimageio_package-213"><span class="linenos">213</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="save_bioimageio_package-214"><a href="#save_bioimageio_package-214"><span class="linenos">214</span></a>    <span class="n">package_content</span> <span class="o">=</span> <span class="n">_prepare_resource_package</span><span class="p">(</span>
</span><span id="save_bioimageio_package-215"><a href="#save_bioimageio_package-215"><span class="linenos">215</span></a>        <span class="n">source</span><span class="p">,</span>
</span><span id="save_bioimageio_package-216"><a href="#save_bioimageio_package-216"><span class="linenos">216</span></a>        <span class="n">weights_priority_order</span><span class="o">=</span><span class="n">weights_priority_order</span><span class="p">,</span>
</span><span id="save_bioimageio_package-217"><a href="#save_bioimageio_package-217"><span class="linenos">217</span></a>    <span class="p">)</span>
</span><span id="save_bioimageio_package-218"><a href="#save_bioimageio_package-218"><span class="linenos">218</span></a>    <span class="k">if</span> <span class="n">output_path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="save_bioimageio_package-219"><a href="#save_bioimageio_package-219"><span class="linenos">219</span></a>        <span class="n">output_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span>
</span><span id="save_bioimageio_package-220"><a href="#save_bioimageio_package-220"><span class="linenos">220</span></a>            <span class="n">NamedTemporaryFile</span><span class="p">(</span><span class="n">suffix</span><span class="o">=</span><span class="s2">&quot;.bioimageio.zip&quot;</span><span class="p">,</span> <span class="n">delete</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">name</span>
</span><span id="save_bioimageio_package-221"><a href="#save_bioimageio_package-221"><span class="linenos">221</span></a>        <span class="p">)</span>
</span><span id="save_bioimageio_package-222"><a href="#save_bioimageio_package-222"><span class="linenos">222</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="save_bioimageio_package-223"><a href="#save_bioimageio_package-223"><span class="linenos">223</span></a>        <span class="n">output_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">output_path</span><span class="p">)</span>
</span><span id="save_bioimageio_package-224"><a href="#save_bioimageio_package-224"><span class="linenos">224</span></a>
</span><span id="save_bioimageio_package-225"><a href="#save_bioimageio_package-225"><span class="linenos">225</span></a>    <span class="n">write_zip</span><span class="p">(</span>
</span><span id="save_bioimageio_package-226"><a href="#save_bioimageio_package-226"><span class="linenos">226</span></a>        <span class="n">output_path</span><span class="p">,</span>
</span><span id="save_bioimageio_package-227"><a href="#save_bioimageio_package-227"><span class="linenos">227</span></a>        <span class="n">package_content</span><span class="p">,</span>
</span><span id="save_bioimageio_package-228"><a href="#save_bioimageio_package-228"><span class="linenos">228</span></a>        <span class="n">compression</span><span class="o">=</span><span class="n">compression</span><span class="p">,</span>
</span><span id="save_bioimageio_package-229"><a href="#save_bioimageio_package-229"><span class="linenos">229</span></a>        <span class="n">compression_level</span><span class="o">=</span><span class="n">compression_level</span><span class="p">,</span>
</span><span id="save_bioimageio_package-230"><a href="#save_bioimageio_package-230"><span class="linenos">230</span></a>    <span class="p">)</span>
</span><span id="save_bioimageio_package-231"><a href="#save_bioimageio_package-231"><span class="linenos">231</span></a>    <span class="k">with</span> <span class="n">validation_context_var</span><span class="o">.</span><span class="n">get</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">warning_level</span><span class="o">=</span><span class="n">ERROR</span><span class="p">):</span>
</span><span id="save_bioimageio_package-232"><a href="#save_bioimageio_package-232"><span class="linenos">232</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">((</span><span class="n">exported</span> <span class="o">:=</span> <span class="n">load_description</span><span class="p">(</span><span class="n">output_path</span><span class="p">)),</span> <span class="n">InvalidDescr</span><span class="p">):</span>
</span><span id="save_bioimageio_package-233"><a href="#save_bioimageio_package-233"><span class="linenos">233</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="save_bioimageio_package-234"><a href="#save_bioimageio_package-234"><span class="linenos">234</span></a>                <span class="sa">f</span><span class="s2">&quot;Exported package &#39;</span><span class="si">{</span><span class="n">output_path</span><span class="si">}</span><span class="s2">&#39; is invalid:&quot;</span>
</span><span id="save_bioimageio_package-235"><a href="#save_bioimageio_package-235"><span class="linenos">235</span></a>                <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="n">exported</span><span class="o">.</span><span class="n">validation_summary</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="save_bioimageio_package-236"><a href="#save_bioimageio_package-236"><span class="linenos">236</span></a>            <span class="p">)</span>
</span><span id="save_bioimageio_package-237"><a href="#save_bioimageio_package-237"><span class="linenos">237</span></a>
</span><span id="save_bioimageio_package-238"><a href="#save_bioimageio_package-238"><span class="linenos">238</span></a>    <span class="k">return</span> <span class="n">output_path</span>
</span></pre></div>


            <div class="docstring"><p>Package a bioimageio resource as a zip file.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>rd:</strong>  bioimageio resource description</li>
<li><strong>compression:</strong>  The numeric constant of compression method.</li>
<li><strong>compression_level:</strong>  Compression level to use when writing files to the archive.
See <a href="https://docs.python.org/3/library/zipfile.html#zipfile.ZipFile">https://docs.python.org/3/library/zipfile.html#zipfile.ZipFile</a></li>
<li><strong>output_path:</strong>  file path to write package to</li>
<li><strong>weights_priority_order:</strong>  If given only the first weights format present in the model is included.
If none of the prioritized weights formats is found all are included.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>path to zipped bioimageio package</p>
</blockquote>
</div>


                </section>
                <section id="save_bioimageio_yaml_only">
                            <input id="save_bioimageio_yaml_only-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">save_bioimageio_yaml_only</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">rd</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n"><a href="spec/application/v0_2.html#ApplicationDescr">bioimageio.spec.application.v0_2.ApplicationDescr</a></span><span class="p">,</span> <span class="n"><a href="spec.html#ApplicationDescr">bioimageio.spec.ApplicationDescr</a></span><span class="p">],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=</span><span class="s1">&#39;format_version&#39;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)],</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n"><a href="spec/dataset/v0_2.html#DatasetDescr">bioimageio.spec.dataset.v0_2.DatasetDescr</a></span><span class="p">,</span> <span class="n"><a href="spec.html#DatasetDescr">bioimageio.spec.DatasetDescr</a></span><span class="p">],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=</span><span class="s1">&#39;format_version&#39;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)],</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n"><a href="spec/model/v0_4.html#ModelDescr">bioimageio.spec.model.v0_4.ModelDescr</a></span><span class="p">,</span> <span class="n"><a href="spec.html#ModelDescr">bioimageio.spec.ModelDescr</a></span><span class="p">],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=</span><span class="s1">&#39;format_version&#39;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)],</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n"><a href="spec.html#NotebookDescr">bioimageio.spec.NotebookDescr</a></span><span class="p">,</span> <span class="n"><a href="spec.html#NotebookDescr">bioimageio.spec.NotebookDescr</a></span><span class="p">],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=</span><span class="s1">&#39;format_version&#39;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)]],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=</span><span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)],</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n"><a href="spec/generic/v0_2.html#GenericDescr">bioimageio.spec.generic.v0_2.GenericDescr</a></span><span class="p">,</span> <span class="n"><a href="spec.html#GenericDescr">bioimageio.spec.GenericDescr</a></span><span class="p">],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=</span><span class="s1">&#39;format_version&#39;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)],</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">YamlValue</span><span class="p">],</span> <span class="n"><a href="spec.html#InvalidDescr">bioimageio.spec.InvalidDescr</a></span><span class="p">]</span>,</span><span class="param">	<span class="o">/</span>,</span><span class="param">	<span class="n">file</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Annotated</span><span class="p">[</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span> <span class="n">PathType</span><span class="p">(</span><span class="n">path_type</span><span class="o">=</span><span class="s1">&#39;new&#39;</span><span class="p">)],</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span> <span class="n">PathType</span><span class="p">(</span><span class="n">path_type</span><span class="o">=</span><span class="s1">&#39;file&#39;</span><span class="p">)],</span> <span class="n">TextIO</span><span class="p">]</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="save_bioimageio_yaml_only-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#save_bioimageio_yaml_only"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="save_bioimageio_yaml_only-118"><a href="#save_bioimageio_yaml_only-118"><span class="linenos">118</span></a><span class="k">def</span> <span class="nf">save_bioimageio_yaml_only</span><span class="p">(</span>
</span><span id="save_bioimageio_yaml_only-119"><a href="#save_bioimageio_yaml_only-119"><span class="linenos">119</span></a>    <span class="n">rd</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ResourceDescr</span><span class="p">,</span> <span class="n">BioimageioYamlContent</span><span class="p">,</span> <span class="n">InvalidDescr</span><span class="p">],</span>
</span><span id="save_bioimageio_yaml_only-120"><a href="#save_bioimageio_yaml_only-120"><span class="linenos">120</span></a>    <span class="o">/</span><span class="p">,</span>
</span><span id="save_bioimageio_yaml_only-121"><a href="#save_bioimageio_yaml_only-121"><span class="linenos">121</span></a>    <span class="n">file</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">NewPath</span><span class="p">,</span> <span class="n">FilePath</span><span class="p">,</span> <span class="n">TextIO</span><span class="p">],</span>
</span><span id="save_bioimageio_yaml_only-122"><a href="#save_bioimageio_yaml_only-122"><span class="linenos">122</span></a><span class="p">):</span>
</span><span id="save_bioimageio_yaml_only-123"><a href="#save_bioimageio_yaml_only-123"><span class="linenos">123</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;write the metadata of a resource description (`rd`) to `file`</span>
</span><span id="save_bioimageio_yaml_only-124"><a href="#save_bioimageio_yaml_only-124"><span class="linenos">124</span></a><span class="sd">    without writing any of the referenced files in it.</span>
</span><span id="save_bioimageio_yaml_only-125"><a href="#save_bioimageio_yaml_only-125"><span class="linenos">125</span></a>
</span><span id="save_bioimageio_yaml_only-126"><a href="#save_bioimageio_yaml_only-126"><span class="linenos">126</span></a><span class="sd">    Note: To save a resource description with its associated files as a package,</span>
</span><span id="save_bioimageio_yaml_only-127"><a href="#save_bioimageio_yaml_only-127"><span class="linenos">127</span></a><span class="sd">    use `save_bioimageio_package` or `save_bioimageio_package_as_folder`.</span>
</span><span id="save_bioimageio_yaml_only-128"><a href="#save_bioimageio_yaml_only-128"><span class="linenos">128</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="save_bioimageio_yaml_only-129"><a href="#save_bioimageio_yaml_only-129"><span class="linenos">129</span></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rd</span><span class="p">,</span> <span class="n">ResourceDescrBase</span><span class="p">):</span>
</span><span id="save_bioimageio_yaml_only-130"><a href="#save_bioimageio_yaml_only-130"><span class="linenos">130</span></a>        <span class="n">content</span> <span class="o">=</span> <span class="n">dump_description</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span>
</span><span id="save_bioimageio_yaml_only-131"><a href="#save_bioimageio_yaml_only-131"><span class="linenos">131</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="save_bioimageio_yaml_only-132"><a href="#save_bioimageio_yaml_only-132"><span class="linenos">132</span></a>        <span class="n">content</span> <span class="o">=</span> <span class="n">rd</span>
</span><span id="save_bioimageio_yaml_only-133"><a href="#save_bioimageio_yaml_only-133"><span class="linenos">133</span></a>
</span><span id="save_bioimageio_yaml_only-134"><a href="#save_bioimageio_yaml_only-134"><span class="linenos">134</span></a>    <span class="n">write_yaml</span><span class="p">(</span><span class="n">cast</span><span class="p">(</span><span class="n">YamlValue</span><span class="p">,</span> <span class="n">content</span><span class="p">),</span> <span class="n">file</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>write the metadata of a resource description (<code>rd</code>) to <code>file</code>
without writing any of the referenced files in it.</p>

<p>Note: To save a resource description with its associated files as a package,
use <code><a href="#save_bioimageio_package">save_bioimageio_package</a></code> or <code><a href="#save_bioimageio_package_as_folder">save_bioimageio_package_as_folder</a></code>.</p>
</div>


                </section>
                <section id="settings">
                    <div class="attr variable">
            <span class="name">settings</span>        =
<input id="settings-view-value" class="view-value-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
            <label class="view-value-button pdoc-button" for="settings-view-value"></label><span class="default_value">Settings(cache_path=PosixPath(&#39;/home/runner/.cache/bioimageio&#39;), id_map=&#39;https://uk1s3.embassy.ebi.ac.uk/public-datasets/bioimage.io/id_map.json&#39;, id_map_draft=&#39;https://uk1s3.embassy.ebi.ac.uk/public-datasets/bioimage.io/id_map_draft.json&#39;, resolve_draft=True, perform_io_checks=True, log_warnings=True, github_username=None, github_token=None, CI=&#39;true&#39;, user_agent=None, keras_backend=&#39;torch&#39;)</span>

        
    </div>
    <a class="headerlink" href="#settings"></a>
    
    

                </section>
                <section id="Stat">
                    <div class="attr variable">
            <span class="name">Stat</span>        =
<input id="Stat-view-value" class="view-value-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
            <label class="view-value-button pdoc-button" for="Stat-view-value"></label><span class="default_value">typing.Dict[typing.Annotated[typing.Union[typing.Annotated[typing.Union[<a href="core/stat_measures.html#SampleMean">bioimageio.core.stat_measures.SampleMean</a>, <a href="core/stat_measures.html#SampleStd">bioimageio.core.stat_measures.SampleStd</a>, <a href="core/stat_measures.html#SampleVar">bioimageio.core.stat_measures.SampleVar</a>, <a href="core/stat_measures.html#SampleQuantile">bioimageio.core.stat_measures.SampleQuantile</a>], Discriminator(discriminator=&#39;name&#39;, custom_error_type=None, custom_error_message=None, custom_error_context=None)], typing.Annotated[typing.Union[<a href="core/stat_measures.html#DatasetMean">bioimageio.core.stat_measures.DatasetMean</a>, <a href="core/stat_measures.html#DatasetStd">bioimageio.core.stat_measures.DatasetStd</a>, <a href="core/stat_measures.html#DatasetVar">bioimageio.core.stat_measures.DatasetVar</a>, <a href="core/stat_measures.html#DatasetPercentile">bioimageio.core.stat_measures.DatasetPercentile</a>], Discriminator(discriminator=&#39;name&#39;, custom_error_type=None, custom_error_message=None, custom_error_context=None)]], Discriminator(discriminator=&#39;scope&#39;, custom_error_type=None, custom_error_message=None, custom_error_context=None)], typing.Union[float, typing.Annotated[<a href="#Tensor">Tensor</a>, BeforeValidator(func=&lt;function tensor_custom_before_validator&gt;, json_schema_input_type=PydanticUndefined), PlainSerializer(func=&lt;function tensor_custom_serializer&gt;, return_type=PydanticUndefined, when_used=&#39;always&#39;)]]]</span>

        
    </div>
    <a class="headerlink" href="#Stat"></a>
    
    

                </section>
                <section id="Tensor">
                            <input id="Tensor-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Tensor</span><wbr>(<span class="base">bioimageio.core._magic_tensor_ops.MagicTensorOpsMixin</span>):

                <label class="view-source-button" for="Tensor-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Tensor"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Tensor-49"><a href="#Tensor-49"><span class="linenos"> 49</span></a><span class="k">class</span> <span class="nc">Tensor</span><span class="p">(</span><span class="n">MagicTensorOpsMixin</span><span class="p">):</span>
</span><span id="Tensor-50"><a href="#Tensor-50"><span class="linenos"> 50</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;A wrapper around an xr.DataArray for better integration with bioimageio.spec</span>
</span><span id="Tensor-51"><a href="#Tensor-51"><span class="linenos"> 51</span></a><span class="sd">    and improved type annotations.&quot;&quot;&quot;</span>
</span><span id="Tensor-52"><a href="#Tensor-52"><span class="linenos"> 52</span></a>
</span><span id="Tensor-53"><a href="#Tensor-53"><span class="linenos"> 53</span></a>    <span class="n">_Compatible</span> <span class="o">=</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Tensor&quot;</span><span class="p">,</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">,</span> <span class="n">_ScalarOrArray</span><span class="p">]</span>
</span><span id="Tensor-54"><a href="#Tensor-54"><span class="linenos"> 54</span></a>
</span><span id="Tensor-55"><a href="#Tensor-55"><span class="linenos"> 55</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="Tensor-56"><a href="#Tensor-56"><span class="linenos"> 56</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="Tensor-57"><a href="#Tensor-57"><span class="linenos"> 57</span></a>        <span class="n">array</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">Any</span><span class="p">],</span>
</span><span id="Tensor-58"><a href="#Tensor-58"><span class="linenos"> 58</span></a>        <span class="n">dims</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">AxisId</span><span class="p">,</span> <span class="n">AxisLike</span><span class="p">]],</span>
</span><span id="Tensor-59"><a href="#Tensor-59"><span class="linenos"> 59</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Tensor-60"><a href="#Tensor-60"><span class="linenos"> 60</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
</span><span id="Tensor-61"><a href="#Tensor-61"><span class="linenos"> 61</span></a>        <span class="n">axes</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span>
</span><span id="Tensor-62"><a href="#Tensor-62"><span class="linenos"> 62</span></a>            <span class="n">a</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">AxisId</span><span class="p">)</span> <span class="k">else</span> <span class="n">AxisInfo</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">id</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">dims</span>
</span><span id="Tensor-63"><a href="#Tensor-63"><span class="linenos"> 63</span></a>        <span class="p">)</span>
</span><span id="Tensor-64"><a href="#Tensor-64"><span class="linenos"> 64</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="n">axes</span><span class="p">)</span>
</span><span id="Tensor-65"><a href="#Tensor-65"><span class="linenos"> 65</span></a>
</span><span id="Tensor-66"><a href="#Tensor-66"><span class="linenos"> 66</span></a>    <span class="k">def</span> <span class="nf">__array__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">DTypeLike</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="Tensor-67"><a href="#Tensor-67"><span class="linenos"> 67</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
</span><span id="Tensor-68"><a href="#Tensor-68"><span class="linenos"> 68</span></a>
</span><span id="Tensor-69"><a href="#Tensor-69"><span class="linenos"> 69</span></a>    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span>
</span><span id="Tensor-70"><a href="#Tensor-70"><span class="linenos"> 70</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">SliceInfo</span><span class="p">,</span> <span class="nb">slice</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="n">PerAxis</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">SliceInfo</span><span class="p">,</span> <span class="nb">slice</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]]</span>
</span><span id="Tensor-71"><a href="#Tensor-71"><span class="linenos"> 71</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
</span><span id="Tensor-72"><a href="#Tensor-72"><span class="linenos"> 72</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">SliceInfo</span><span class="p">):</span>
</span><span id="Tensor-73"><a href="#Tensor-73"><span class="linenos"> 73</span></a>            <span class="n">key</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="o">*</span><span class="n">key</span><span class="p">)</span>
</span><span id="Tensor-74"><a href="#Tensor-74"><span class="linenos"> 74</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">collections</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">Mapping</span><span class="p">):</span>
</span><span id="Tensor-75"><a href="#Tensor-75"><span class="linenos"> 75</span></a>            <span class="n">key</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="Tensor-76"><a href="#Tensor-76"><span class="linenos"> 76</span></a>                <span class="n">a</span><span class="p">:</span> <span class="n">s</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="k">else</span> <span class="n">s</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="nb">slice</span><span class="p">)</span> <span class="k">else</span> <span class="nb">slice</span><span class="p">(</span><span class="o">*</span><span class="n">s</span><span class="p">)</span>
</span><span id="Tensor-77"><a href="#Tensor-77"><span class="linenos"> 77</span></a>                <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">key</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
</span><span id="Tensor-78"><a href="#Tensor-78"><span class="linenos"> 78</span></a>            <span class="p">}</span>
</span><span id="Tensor-79"><a href="#Tensor-79"><span class="linenos"> 79</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="n">from_xarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
</span><span id="Tensor-80"><a href="#Tensor-80"><span class="linenos"> 80</span></a>
</span><span id="Tensor-81"><a href="#Tensor-81"><span class="linenos"> 81</span></a>    <span class="k">def</span> <span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">PerAxis</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">SliceInfo</span><span class="p">,</span> <span class="nb">slice</span><span class="p">]],</span> <span class="n">value</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Tensor-82"><a href="#Tensor-82"><span class="linenos"> 82</span></a>        <span class="n">key</span> <span class="o">=</span> <span class="p">{</span><span class="n">a</span><span class="p">:</span> <span class="n">s</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="nb">slice</span><span class="p">)</span> <span class="k">else</span> <span class="nb">slice</span><span class="p">(</span><span class="o">*</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">key</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
</span><span id="Tensor-83"><a href="#Tensor-83"><span class="linenos"> 83</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">_data</span>
</span><span id="Tensor-84"><a href="#Tensor-84"><span class="linenos"> 84</span></a>
</span><span id="Tensor-85"><a href="#Tensor-85"><span class="linenos"> 85</span></a>    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="Tensor-86"><a href="#Tensor-86"><span class="linenos"> 86</span></a>        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
</span><span id="Tensor-87"><a href="#Tensor-87"><span class="linenos"> 87</span></a>
</span><span id="Tensor-88"><a href="#Tensor-88"><span class="linenos"> 88</span></a>    <span class="k">def</span> <span class="nf">_iter</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Any</span><span class="p">]:</span>
</span><span id="Tensor-89"><a href="#Tensor-89"><span class="linenos"> 89</span></a>        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)):</span>
</span><span id="Tensor-90"><a href="#Tensor-90"><span class="linenos"> 90</span></a>            <span class="k">yield</span> <span class="bp">self</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>
</span><span id="Tensor-91"><a href="#Tensor-91"><span class="linenos"> 91</span></a>
</span><span id="Tensor-92"><a href="#Tensor-92"><span class="linenos"> 92</span></a>    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Any</span><span class="p">]:</span>
</span><span id="Tensor-93"><a href="#Tensor-93"><span class="linenos"> 93</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Tensor-94"><a href="#Tensor-94"><span class="linenos"> 94</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;iteration over a 0-d array&quot;</span><span class="p">)</span>
</span><span id="Tensor-95"><a href="#Tensor-95"><span class="linenos"> 95</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_iter</span><span class="p">()</span>
</span><span id="Tensor-96"><a href="#Tensor-96"><span class="linenos"> 96</span></a>
</span><span id="Tensor-97"><a href="#Tensor-97"><span class="linenos"> 97</span></a>    <span class="k">def</span> <span class="nf">_binary_op</span><span class="p">(</span>
</span><span id="Tensor-98"><a href="#Tensor-98"><span class="linenos"> 98</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="Tensor-99"><a href="#Tensor-99"><span class="linenos"> 99</span></a>        <span class="n">other</span><span class="p">:</span> <span class="n">_Compatible</span><span class="p">,</span>
</span><span id="Tensor-100"><a href="#Tensor-100"><span class="linenos">100</span></a>        <span class="n">f</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">Any</span><span class="p">],</span>
</span><span id="Tensor-101"><a href="#Tensor-101"><span class="linenos">101</span></a>        <span class="n">reflexive</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="Tensor-102"><a href="#Tensor-102"><span class="linenos">102</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
</span><span id="Tensor-103"><a href="#Tensor-103"><span class="linenos">103</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">_binary_op</span><span class="p">(</span>  <span class="c1"># pyright: ignore[reportPrivateUsage]</span>
</span><span id="Tensor-104"><a href="#Tensor-104"><span class="linenos">104</span></a>            <span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">_data</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Tensor</span><span class="p">)</span> <span class="k">else</span> <span class="n">other</span><span class="p">),</span>
</span><span id="Tensor-105"><a href="#Tensor-105"><span class="linenos">105</span></a>            <span class="n">f</span><span class="p">,</span>
</span><span id="Tensor-106"><a href="#Tensor-106"><span class="linenos">106</span></a>            <span class="n">reflexive</span><span class="p">,</span>
</span><span id="Tensor-107"><a href="#Tensor-107"><span class="linenos">107</span></a>        <span class="p">)</span>
</span><span id="Tensor-108"><a href="#Tensor-108"><span class="linenos">108</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="n">from_xarray</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="Tensor-109"><a href="#Tensor-109"><span class="linenos">109</span></a>
</span><span id="Tensor-110"><a href="#Tensor-110"><span class="linenos">110</span></a>    <span class="k">def</span> <span class="nf">_inplace_binary_op</span><span class="p">(</span>
</span><span id="Tensor-111"><a href="#Tensor-111"><span class="linenos">111</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="Tensor-112"><a href="#Tensor-112"><span class="linenos">112</span></a>        <span class="n">other</span><span class="p">:</span> <span class="n">_Compatible</span><span class="p">,</span>
</span><span id="Tensor-113"><a href="#Tensor-113"><span class="linenos">113</span></a>        <span class="n">f</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">Any</span><span class="p">],</span>
</span><span id="Tensor-114"><a href="#Tensor-114"><span class="linenos">114</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
</span><span id="Tensor-115"><a href="#Tensor-115"><span class="linenos">115</span></a>        <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">_inplace_binary_op</span><span class="p">(</span>  <span class="c1"># pyright: ignore[reportPrivateUsage]</span>
</span><span id="Tensor-116"><a href="#Tensor-116"><span class="linenos">116</span></a>            <span class="p">(</span>
</span><span id="Tensor-117"><a href="#Tensor-117"><span class="linenos">117</span></a>                <span class="n">other_d</span>
</span><span id="Tensor-118"><a href="#Tensor-118"><span class="linenos">118</span></a>                <span class="k">if</span> <span class="p">(</span><span class="n">other_d</span> <span class="o">:=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">))</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="Tensor-119"><a href="#Tensor-119"><span class="linenos">119</span></a>                <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="Tensor-120"><a href="#Tensor-120"><span class="linenos">120</span></a>                    <span class="n">other_d</span><span class="p">,</span>
</span><span id="Tensor-121"><a href="#Tensor-121"><span class="linenos">121</span></a>                    <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">,</span>
</span><span id="Tensor-122"><a href="#Tensor-122"><span class="linenos">122</span></a>                <span class="p">)</span>
</span><span id="Tensor-123"><a href="#Tensor-123"><span class="linenos">123</span></a>                <span class="k">else</span> <span class="n">other</span>
</span><span id="Tensor-124"><a href="#Tensor-124"><span class="linenos">124</span></a>            <span class="p">),</span>
</span><span id="Tensor-125"><a href="#Tensor-125"><span class="linenos">125</span></a>            <span class="n">f</span><span class="p">,</span>
</span><span id="Tensor-126"><a href="#Tensor-126"><span class="linenos">126</span></a>        <span class="p">)</span>
</span><span id="Tensor-127"><a href="#Tensor-127"><span class="linenos">127</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="Tensor-128"><a href="#Tensor-128"><span class="linenos">128</span></a>
</span><span id="Tensor-129"><a href="#Tensor-129"><span class="linenos">129</span></a>    <span class="k">def</span> <span class="nf">_unary_op</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">],</span> <span class="n">Any</span><span class="p">],</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
</span><span id="Tensor-130"><a href="#Tensor-130"><span class="linenos">130</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">_unary_op</span><span class="p">(</span>  <span class="c1"># pyright: ignore[reportPrivateUsage]</span>
</span><span id="Tensor-131"><a href="#Tensor-131"><span class="linenos">131</span></a>            <span class="n">f</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
</span><span id="Tensor-132"><a href="#Tensor-132"><span class="linenos">132</span></a>        <span class="p">)</span>
</span><span id="Tensor-133"><a href="#Tensor-133"><span class="linenos">133</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="n">from_xarray</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="Tensor-134"><a href="#Tensor-134"><span class="linenos">134</span></a>
</span><span id="Tensor-135"><a href="#Tensor-135"><span class="linenos">135</span></a>    <span class="nd">@classmethod</span>
</span><span id="Tensor-136"><a href="#Tensor-136"><span class="linenos">136</span></a>    <span class="k">def</span> <span class="nf">from_xarray</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data_array</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
</span><span id="Tensor-137"><a href="#Tensor-137"><span class="linenos">137</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;create a `Tensor` from an xarray data array</span>
</span><span id="Tensor-138"><a href="#Tensor-138"><span class="linenos">138</span></a>
</span><span id="Tensor-139"><a href="#Tensor-139"><span class="linenos">139</span></a><span class="sd">        note for internal use: this factory method is round-trip save</span>
</span><span id="Tensor-140"><a href="#Tensor-140"><span class="linenos">140</span></a><span class="sd">            for any `Tensor`&#39;s  `data` property (an xarray.DataArray).</span>
</span><span id="Tensor-141"><a href="#Tensor-141"><span class="linenos">141</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Tensor-142"><a href="#Tensor-142"><span class="linenos">142</span></a>        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span>
</span><span id="Tensor-143"><a href="#Tensor-143"><span class="linenos">143</span></a>            <span class="n">array</span><span class="o">=</span><span class="n">data_array</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="n">AxisId</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">data_array</span><span class="o">.</span><span class="n">dims</span><span class="p">)</span>
</span><span id="Tensor-144"><a href="#Tensor-144"><span class="linenos">144</span></a>        <span class="p">)</span>
</span><span id="Tensor-145"><a href="#Tensor-145"><span class="linenos">145</span></a>
</span><span id="Tensor-146"><a href="#Tensor-146"><span class="linenos">146</span></a>    <span class="nd">@classmethod</span>
</span><span id="Tensor-147"><a href="#Tensor-147"><span class="linenos">147</span></a>    <span class="k">def</span> <span class="nf">from_numpy</span><span class="p">(</span>
</span><span id="Tensor-148"><a href="#Tensor-148"><span class="linenos">148</span></a>        <span class="bp">cls</span><span class="p">,</span>
</span><span id="Tensor-149"><a href="#Tensor-149"><span class="linenos">149</span></a>        <span class="n">array</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">Any</span><span class="p">],</span>
</span><span id="Tensor-150"><a href="#Tensor-150"><span class="linenos">150</span></a>        <span class="o">*</span><span class="p">,</span>
</span><span id="Tensor-151"><a href="#Tensor-151"><span class="linenos">151</span></a>        <span class="n">dims</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">AxisLike</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">AxisLike</span><span class="p">]]],</span>
</span><span id="Tensor-152"><a href="#Tensor-152"><span class="linenos">152</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tensor</span><span class="p">:</span>
</span><span id="Tensor-153"><a href="#Tensor-153"><span class="linenos">153</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;create a `Tensor` from a numpy array</span>
</span><span id="Tensor-154"><a href="#Tensor-154"><span class="linenos">154</span></a>
</span><span id="Tensor-155"><a href="#Tensor-155"><span class="linenos">155</span></a><span class="sd">        Args:</span>
</span><span id="Tensor-156"><a href="#Tensor-156"><span class="linenos">156</span></a><span class="sd">            array: the nd numpy array</span>
</span><span id="Tensor-157"><a href="#Tensor-157"><span class="linenos">157</span></a><span class="sd">            axes: A description of the array&#39;s axes,</span>
</span><span id="Tensor-158"><a href="#Tensor-158"><span class="linenos">158</span></a><span class="sd">                if None axes are guessed (which might fail and raise a ValueError.)</span>
</span><span id="Tensor-159"><a href="#Tensor-159"><span class="linenos">159</span></a>
</span><span id="Tensor-160"><a href="#Tensor-160"><span class="linenos">160</span></a><span class="sd">        Raises:</span>
</span><span id="Tensor-161"><a href="#Tensor-161"><span class="linenos">161</span></a><span class="sd">            ValueError: if `axes` is None and axes guessing fails.</span>
</span><span id="Tensor-162"><a href="#Tensor-162"><span class="linenos">162</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Tensor-163"><a href="#Tensor-163"><span class="linenos">163</span></a>
</span><span id="Tensor-164"><a href="#Tensor-164"><span class="linenos">164</span></a>        <span class="k">if</span> <span class="n">dims</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Tensor-165"><a href="#Tensor-165"><span class="linenos">165</span></a>            <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_interprete_array_wo_known_axes</span><span class="p">(</span><span class="n">array</span><span class="p">)</span>
</span><span id="Tensor-166"><a href="#Tensor-166"><span class="linenos">166</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dims</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">Axis</span><span class="p">,</span> <span class="n">v0_5</span><span class="o">.</span><span class="n">AxisBase</span><span class="p">)):</span>
</span><span id="Tensor-167"><a href="#Tensor-167"><span class="linenos">167</span></a>            <span class="n">dims</span> <span class="o">=</span> <span class="p">[</span><span class="n">dims</span><span class="p">]</span>
</span><span id="Tensor-168"><a href="#Tensor-168"><span class="linenos">168</span></a>
</span><span id="Tensor-169"><a href="#Tensor-169"><span class="linenos">169</span></a>        <span class="n">axis_infos</span> <span class="o">=</span> <span class="p">[</span><span class="n">AxisInfo</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">dims</span><span class="p">]</span>
</span><span id="Tensor-170"><a href="#Tensor-170"><span class="linenos">170</span></a>        <span class="n">original_shape</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</span><span id="Tensor-171"><a href="#Tensor-171"><span class="linenos">171</span></a>
</span><span id="Tensor-172"><a href="#Tensor-172"><span class="linenos">172</span></a>        <span class="n">successful_view</span> <span class="o">=</span> <span class="n">_get_array_view</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">axis_infos</span><span class="p">)</span>
</span><span id="Tensor-173"><a href="#Tensor-173"><span class="linenos">173</span></a>        <span class="k">if</span> <span class="n">successful_view</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Tensor-174"><a href="#Tensor-174"><span class="linenos">174</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="Tensor-175"><a href="#Tensor-175"><span class="linenos">175</span></a>                <span class="sa">f</span><span class="s2">&quot;Array shape </span><span class="si">{</span><span class="n">original_shape</span><span class="si">}</span><span class="s2"> does not map to axes </span><span class="si">{</span><span class="n">dims</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="Tensor-176"><a href="#Tensor-176"><span class="linenos">176</span></a>            <span class="p">)</span>
</span><span id="Tensor-177"><a href="#Tensor-177"><span class="linenos">177</span></a>
</span><span id="Tensor-178"><a href="#Tensor-178"><span class="linenos">178</span></a>        <span class="k">return</span> <span class="n">Tensor</span><span class="p">(</span><span class="n">successful_view</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">id</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">axis_infos</span><span class="p">))</span>
</span><span id="Tensor-179"><a href="#Tensor-179"><span class="linenos">179</span></a>
</span><span id="Tensor-180"><a href="#Tensor-180"><span class="linenos">180</span></a>    <span class="nd">@property</span>
</span><span id="Tensor-181"><a href="#Tensor-181"><span class="linenos">181</span></a>    <span class="k">def</span> <span class="nf">data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Tensor-182"><a href="#Tensor-182"><span class="linenos">182</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span>
</span><span id="Tensor-183"><a href="#Tensor-183"><span class="linenos">183</span></a>
</span><span id="Tensor-184"><a href="#Tensor-184"><span class="linenos">184</span></a>    <span class="nd">@property</span>
</span><span id="Tensor-185"><a href="#Tensor-185"><span class="linenos">185</span></a>    <span class="k">def</span> <span class="nf">dims</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># TODO: rename to `axes`?</span>
</span><span id="Tensor-186"><a href="#Tensor-186"><span class="linenos">186</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Tuple of dimension names associated with this tensor.&quot;&quot;&quot;</span>
</span><span id="Tensor-187"><a href="#Tensor-187"><span class="linenos">187</span></a>        <span class="k">return</span> <span class="n">cast</span><span class="p">(</span><span class="n">Tuple</span><span class="p">[</span><span class="n">AxisId</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">dims</span><span class="p">)</span>
</span><span id="Tensor-188"><a href="#Tensor-188"><span class="linenos">188</span></a>
</span><span id="Tensor-189"><a href="#Tensor-189"><span class="linenos">189</span></a>    <span class="nd">@property</span>
</span><span id="Tensor-190"><a href="#Tensor-190"><span class="linenos">190</span></a>    <span class="k">def</span> <span class="nf">tagged_shape</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Tensor-191"><a href="#Tensor-191"><span class="linenos">191</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;(alias for `sizes`) Ordered, immutable mapping from axis ids to lengths.&quot;&quot;&quot;</span>
</span><span id="Tensor-192"><a href="#Tensor-192"><span class="linenos">192</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sizes</span>
</span><span id="Tensor-193"><a href="#Tensor-193"><span class="linenos">193</span></a>
</span><span id="Tensor-194"><a href="#Tensor-194"><span class="linenos">194</span></a>    <span class="nd">@property</span>
</span><span id="Tensor-195"><a href="#Tensor-195"><span class="linenos">195</span></a>    <span class="k">def</span> <span class="nf">shape_tuple</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Tensor-196"><a href="#Tensor-196"><span class="linenos">196</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Tuple of tensor axes lengths&quot;&quot;&quot;</span>
</span><span id="Tensor-197"><a href="#Tensor-197"><span class="linenos">197</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">shape</span>
</span><span id="Tensor-198"><a href="#Tensor-198"><span class="linenos">198</span></a>
</span><span id="Tensor-199"><a href="#Tensor-199"><span class="linenos">199</span></a>    <span class="nd">@property</span>
</span><span id="Tensor-200"><a href="#Tensor-200"><span class="linenos">200</span></a>    <span class="k">def</span> <span class="nf">size</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Tensor-201"><a href="#Tensor-201"><span class="linenos">201</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Number of elements in the tensor.</span>
</span><span id="Tensor-202"><a href="#Tensor-202"><span class="linenos">202</span></a>
</span><span id="Tensor-203"><a href="#Tensor-203"><span class="linenos">203</span></a><span class="sd">        Equal to math.prod(tensor.shape), i.e., the product of the tensors’ dimensions.</span>
</span><span id="Tensor-204"><a href="#Tensor-204"><span class="linenos">204</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Tensor-205"><a href="#Tensor-205"><span class="linenos">205</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">size</span>
</span><span id="Tensor-206"><a href="#Tensor-206"><span class="linenos">206</span></a>
</span><span id="Tensor-207"><a href="#Tensor-207"><span class="linenos">207</span></a>    <span class="k">def</span> <span class="nf">sum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dim</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">AxisId</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">AxisId</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
</span><span id="Tensor-208"><a href="#Tensor-208"><span class="linenos">208</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Reduce this Tensor&#39;s data by applying sum along some dimension(s).&quot;&quot;&quot;</span>
</span><span id="Tensor-209"><a href="#Tensor-209"><span class="linenos">209</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="n">from_xarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="n">dim</span><span class="p">))</span>
</span><span id="Tensor-210"><a href="#Tensor-210"><span class="linenos">210</span></a>
</span><span id="Tensor-211"><a href="#Tensor-211"><span class="linenos">211</span></a>    <span class="nd">@property</span>
</span><span id="Tensor-212"><a href="#Tensor-212"><span class="linenos">212</span></a>    <span class="k">def</span> <span class="nf">ndim</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Tensor-213"><a href="#Tensor-213"><span class="linenos">213</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Number of tensor dimensions.&quot;&quot;&quot;</span>
</span><span id="Tensor-214"><a href="#Tensor-214"><span class="linenos">214</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">ndim</span>
</span><span id="Tensor-215"><a href="#Tensor-215"><span class="linenos">215</span></a>
</span><span id="Tensor-216"><a href="#Tensor-216"><span class="linenos">216</span></a>    <span class="nd">@property</span>
</span><span id="Tensor-217"><a href="#Tensor-217"><span class="linenos">217</span></a>    <span class="k">def</span> <span class="nf">dtype</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DTypeStr</span><span class="p">:</span>
</span><span id="Tensor-218"><a href="#Tensor-218"><span class="linenos">218</span></a>        <span class="n">dt</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>  <span class="c1"># pyright: ignore[reportUnknownArgumentType]</span>
</span><span id="Tensor-219"><a href="#Tensor-219"><span class="linenos">219</span></a>        <span class="k">assert</span> <span class="n">dt</span> <span class="ow">in</span> <span class="n">get_args</span><span class="p">(</span><span class="n">DTypeStr</span><span class="p">)</span>
</span><span id="Tensor-220"><a href="#Tensor-220"><span class="linenos">220</span></a>        <span class="k">return</span> <span class="n">dt</span>  <span class="c1"># pyright: ignore[reportReturnType]</span>
</span><span id="Tensor-221"><a href="#Tensor-221"><span class="linenos">221</span></a>
</span><span id="Tensor-222"><a href="#Tensor-222"><span class="linenos">222</span></a>    <span class="nd">@property</span>
</span><span id="Tensor-223"><a href="#Tensor-223"><span class="linenos">223</span></a>    <span class="k">def</span> <span class="nf">sizes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Tensor-224"><a href="#Tensor-224"><span class="linenos">224</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Ordered, immutable mapping from axis ids to axis lengths.&quot;&quot;&quot;</span>
</span><span id="Tensor-225"><a href="#Tensor-225"><span class="linenos">225</span></a>        <span class="k">return</span> <span class="n">cast</span><span class="p">(</span><span class="n">Mapping</span><span class="p">[</span><span class="n">AxisId</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">sizes</span><span class="p">)</span>
</span><span id="Tensor-226"><a href="#Tensor-226"><span class="linenos">226</span></a>
</span><span id="Tensor-227"><a href="#Tensor-227"><span class="linenos">227</span></a>    <span class="k">def</span> <span class="nf">astype</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">DTypeStr</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">copy</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
</span><span id="Tensor-228"><a href="#Tensor-228"><span class="linenos">228</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return tensor cast to `dtype`</span>
</span><span id="Tensor-229"><a href="#Tensor-229"><span class="linenos">229</span></a>
</span><span id="Tensor-230"><a href="#Tensor-230"><span class="linenos">230</span></a><span class="sd">        note: if dtype is already satisfied copy if `copy`&quot;&quot;&quot;</span>
</span><span id="Tensor-231"><a href="#Tensor-231"><span class="linenos">231</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="n">from_xarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">dtype</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="n">copy</span><span class="p">))</span>
</span><span id="Tensor-232"><a href="#Tensor-232"><span class="linenos">232</span></a>
</span><span id="Tensor-233"><a href="#Tensor-233"><span class="linenos">233</span></a>    <span class="k">def</span> <span class="nf">clip</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">min</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="nb">max</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="Tensor-234"><a href="#Tensor-234"><span class="linenos">234</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a tensor whose values are limited to [min, max].</span>
</span><span id="Tensor-235"><a href="#Tensor-235"><span class="linenos">235</span></a><span class="sd">        At least one of max or min must be given.&quot;&quot;&quot;</span>
</span><span id="Tensor-236"><a href="#Tensor-236"><span class="linenos">236</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="n">from_xarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="nb">min</span><span class="p">,</span> <span class="nb">max</span><span class="p">))</span>
</span><span id="Tensor-237"><a href="#Tensor-237"><span class="linenos">237</span></a>
</span><span id="Tensor-238"><a href="#Tensor-238"><span class="linenos">238</span></a>    <span class="k">def</span> <span class="nf">crop_to</span><span class="p">(</span>
</span><span id="Tensor-239"><a href="#Tensor-239"><span class="linenos">239</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="Tensor-240"><a href="#Tensor-240"><span class="linenos">240</span></a>        <span class="n">sizes</span><span class="p">:</span> <span class="n">PerAxis</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span>
</span><span id="Tensor-241"><a href="#Tensor-241"><span class="linenos">241</span></a>        <span class="n">crop_where</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span>
</span><span id="Tensor-242"><a href="#Tensor-242"><span class="linenos">242</span></a>            <span class="n">CropWhere</span><span class="p">,</span>
</span><span id="Tensor-243"><a href="#Tensor-243"><span class="linenos">243</span></a>            <span class="n">PerAxis</span><span class="p">[</span><span class="n">CropWhere</span><span class="p">],</span>
</span><span id="Tensor-244"><a href="#Tensor-244"><span class="linenos">244</span></a>        <span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;left_and_right&quot;</span><span class="p">,</span>
</span><span id="Tensor-245"><a href="#Tensor-245"><span class="linenos">245</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
</span><span id="Tensor-246"><a href="#Tensor-246"><span class="linenos">246</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;crop to match `sizes`&quot;&quot;&quot;</span>
</span><span id="Tensor-247"><a href="#Tensor-247"><span class="linenos">247</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">crop_where</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="Tensor-248"><a href="#Tensor-248"><span class="linenos">248</span></a>            <span class="n">crop_axis_where</span><span class="p">:</span> <span class="n">PerAxis</span><span class="p">[</span><span class="n">CropWhere</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="n">a</span><span class="p">:</span> <span class="n">crop_where</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dims</span><span class="p">}</span>
</span><span id="Tensor-249"><a href="#Tensor-249"><span class="linenos">249</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Tensor-250"><a href="#Tensor-250"><span class="linenos">250</span></a>            <span class="n">crop_axis_where</span> <span class="o">=</span> <span class="n">crop_where</span>
</span><span id="Tensor-251"><a href="#Tensor-251"><span class="linenos">251</span></a>
</span><span id="Tensor-252"><a href="#Tensor-252"><span class="linenos">252</span></a>        <span class="n">slices</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="n">AxisId</span><span class="p">,</span> <span class="n">SliceInfo</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Tensor-253"><a href="#Tensor-253"><span class="linenos">253</span></a>
</span><span id="Tensor-254"><a href="#Tensor-254"><span class="linenos">254</span></a>        <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">s_is</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sizes</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="Tensor-255"><a href="#Tensor-255"><span class="linenos">255</span></a>            <span class="k">if</span> <span class="n">a</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sizes</span> <span class="ow">or</span> <span class="n">sizes</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">==</span> <span class="n">s_is</span><span class="p">:</span>
</span><span id="Tensor-256"><a href="#Tensor-256"><span class="linenos">256</span></a>                <span class="k">pass</span>
</span><span id="Tensor-257"><a href="#Tensor-257"><span class="linenos">257</span></a>            <span class="k">elif</span> <span class="n">sizes</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">s_is</span><span class="p">:</span>
</span><span id="Tensor-258"><a href="#Tensor-258"><span class="linenos">258</span></a>                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
</span><span id="Tensor-259"><a href="#Tensor-259"><span class="linenos">259</span></a>                    <span class="s2">&quot;Cannot crop axis </span><span class="si">{}</span><span class="s2"> of size </span><span class="si">{}</span><span class="s2"> to larger size </span><span class="si">{}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="Tensor-260"><a href="#Tensor-260"><span class="linenos">260</span></a>                    <span class="n">a</span><span class="p">,</span>
</span><span id="Tensor-261"><a href="#Tensor-261"><span class="linenos">261</span></a>                    <span class="n">s_is</span><span class="p">,</span>
</span><span id="Tensor-262"><a href="#Tensor-262"><span class="linenos">262</span></a>                    <span class="n">sizes</span><span class="p">[</span><span class="n">a</span><span class="p">],</span>
</span><span id="Tensor-263"><a href="#Tensor-263"><span class="linenos">263</span></a>                <span class="p">)</span>
</span><span id="Tensor-264"><a href="#Tensor-264"><span class="linenos">264</span></a>            <span class="k">elif</span> <span class="n">a</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">crop_axis_where</span><span class="p">:</span>
</span><span id="Tensor-265"><a href="#Tensor-265"><span class="linenos">265</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="Tensor-266"><a href="#Tensor-266"><span class="linenos">266</span></a>                    <span class="sa">f</span><span class="s2">&quot;Don&#39;t know where to crop axis </span><span class="si">{</span><span class="n">a</span><span class="si">}</span><span class="s2">, `crop_where`=</span><span class="si">{</span><span class="n">crop_where</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="Tensor-267"><a href="#Tensor-267"><span class="linenos">267</span></a>                <span class="p">)</span>
</span><span id="Tensor-268"><a href="#Tensor-268"><span class="linenos">268</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Tensor-269"><a href="#Tensor-269"><span class="linenos">269</span></a>                <span class="n">crop_this_axis_where</span> <span class="o">=</span> <span class="n">crop_axis_where</span><span class="p">[</span><span class="n">a</span><span class="p">]</span>
</span><span id="Tensor-270"><a href="#Tensor-270"><span class="linenos">270</span></a>                <span class="k">if</span> <span class="n">crop_this_axis_where</span> <span class="o">==</span> <span class="s2">&quot;left&quot;</span><span class="p">:</span>
</span><span id="Tensor-271"><a href="#Tensor-271"><span class="linenos">271</span></a>                    <span class="n">slices</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="n">SliceInfo</span><span class="p">(</span><span class="n">s_is</span> <span class="o">-</span> <span class="n">sizes</span><span class="p">[</span><span class="n">a</span><span class="p">],</span> <span class="n">s_is</span><span class="p">)</span>
</span><span id="Tensor-272"><a href="#Tensor-272"><span class="linenos">272</span></a>                <span class="k">elif</span> <span class="n">crop_this_axis_where</span> <span class="o">==</span> <span class="s2">&quot;right&quot;</span><span class="p">:</span>
</span><span id="Tensor-273"><a href="#Tensor-273"><span class="linenos">273</span></a>                    <span class="n">slices</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="n">SliceInfo</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">sizes</span><span class="p">[</span><span class="n">a</span><span class="p">])</span>
</span><span id="Tensor-274"><a href="#Tensor-274"><span class="linenos">274</span></a>                <span class="k">elif</span> <span class="n">crop_this_axis_where</span> <span class="o">==</span> <span class="s2">&quot;left_and_right&quot;</span><span class="p">:</span>
</span><span id="Tensor-275"><a href="#Tensor-275"><span class="linenos">275</span></a>                    <span class="n">slices</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="n">SliceInfo</span><span class="p">(</span>
</span><span id="Tensor-276"><a href="#Tensor-276"><span class="linenos">276</span></a>                        <span class="n">start</span> <span class="o">:=</span> <span class="p">(</span><span class="n">s_is</span> <span class="o">-</span> <span class="n">sizes</span><span class="p">[</span><span class="n">a</span><span class="p">])</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="n">sizes</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">+</span> <span class="n">start</span>
</span><span id="Tensor-277"><a href="#Tensor-277"><span class="linenos">277</span></a>                    <span class="p">)</span>
</span><span id="Tensor-278"><a href="#Tensor-278"><span class="linenos">278</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="Tensor-279"><a href="#Tensor-279"><span class="linenos">279</span></a>                    <span class="n">assert_never</span><span class="p">(</span><span class="n">crop_this_axis_where</span><span class="p">)</span>
</span><span id="Tensor-280"><a href="#Tensor-280"><span class="linenos">280</span></a>
</span><span id="Tensor-281"><a href="#Tensor-281"><span class="linenos">281</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="n">slices</span><span class="p">]</span>
</span><span id="Tensor-282"><a href="#Tensor-282"><span class="linenos">282</span></a>
</span><span id="Tensor-283"><a href="#Tensor-283"><span class="linenos">283</span></a>    <span class="k">def</span> <span class="nf">expand_dims</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dims</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="n">AxisId</span><span class="p">],</span> <span class="n">PerAxis</span><span class="p">[</span><span class="nb">int</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
</span><span id="Tensor-284"><a href="#Tensor-284"><span class="linenos">284</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="n">from_xarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">dims</span><span class="o">=</span><span class="n">dims</span><span class="p">))</span>
</span><span id="Tensor-285"><a href="#Tensor-285"><span class="linenos">285</span></a>
</span><span id="Tensor-286"><a href="#Tensor-286"><span class="linenos">286</span></a>    <span class="k">def</span> <span class="nf">mean</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dim</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">AxisId</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">AxisId</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
</span><span id="Tensor-287"><a href="#Tensor-287"><span class="linenos">287</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="n">from_xarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="n">dim</span><span class="p">))</span>
</span><span id="Tensor-288"><a href="#Tensor-288"><span class="linenos">288</span></a>
</span><span id="Tensor-289"><a href="#Tensor-289"><span class="linenos">289</span></a>    <span class="k">def</span> <span class="nf">std</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dim</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">AxisId</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">AxisId</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
</span><span id="Tensor-290"><a href="#Tensor-290"><span class="linenos">290</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="n">from_xarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="n">dim</span><span class="p">))</span>
</span><span id="Tensor-291"><a href="#Tensor-291"><span class="linenos">291</span></a>
</span><span id="Tensor-292"><a href="#Tensor-292"><span class="linenos">292</span></a>    <span class="k">def</span> <span class="nf">var</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dim</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">AxisId</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">AxisId</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
</span><span id="Tensor-293"><a href="#Tensor-293"><span class="linenos">293</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="n">from_xarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="n">dim</span><span class="p">))</span>
</span><span id="Tensor-294"><a href="#Tensor-294"><span class="linenos">294</span></a>
</span><span id="Tensor-295"><a href="#Tensor-295"><span class="linenos">295</span></a>    <span class="k">def</span> <span class="nf">pad</span><span class="p">(</span>
</span><span id="Tensor-296"><a href="#Tensor-296"><span class="linenos">296</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="Tensor-297"><a href="#Tensor-297"><span class="linenos">297</span></a>        <span class="n">pad_width</span><span class="p">:</span> <span class="n">PerAxis</span><span class="p">[</span><span class="n">PadWidthLike</span><span class="p">],</span>
</span><span id="Tensor-298"><a href="#Tensor-298"><span class="linenos">298</span></a>        <span class="n">mode</span><span class="p">:</span> <span class="n">PadMode</span> <span class="o">=</span> <span class="s2">&quot;symmetric&quot;</span><span class="p">,</span>
</span><span id="Tensor-299"><a href="#Tensor-299"><span class="linenos">299</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
</span><span id="Tensor-300"><a href="#Tensor-300"><span class="linenos">300</span></a>        <span class="n">pad_width</span> <span class="o">=</span> <span class="p">{</span><span class="n">a</span><span class="p">:</span> <span class="n">PadWidth</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">pad_width</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
</span><span id="Tensor-301"><a href="#Tensor-301"><span class="linenos">301</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="n">from_xarray</span><span class="p">(</span>
</span><span id="Tensor-302"><a href="#Tensor-302"><span class="linenos">302</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span><span class="n">pad_width</span><span class="o">=</span><span class="n">pad_width</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">)</span>
</span><span id="Tensor-303"><a href="#Tensor-303"><span class="linenos">303</span></a>        <span class="p">)</span>
</span><span id="Tensor-304"><a href="#Tensor-304"><span class="linenos">304</span></a>
</span><span id="Tensor-305"><a href="#Tensor-305"><span class="linenos">305</span></a>    <span class="k">def</span> <span class="nf">pad_to</span><span class="p">(</span>
</span><span id="Tensor-306"><a href="#Tensor-306"><span class="linenos">306</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="Tensor-307"><a href="#Tensor-307"><span class="linenos">307</span></a>        <span class="n">sizes</span><span class="p">:</span> <span class="n">PerAxis</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span>
</span><span id="Tensor-308"><a href="#Tensor-308"><span class="linenos">308</span></a>        <span class="n">pad_where</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">PadWhere</span><span class="p">,</span> <span class="n">PerAxis</span><span class="p">[</span><span class="n">PadWhere</span><span class="p">]]</span> <span class="o">=</span> <span class="s2">&quot;left_and_right&quot;</span><span class="p">,</span>
</span><span id="Tensor-309"><a href="#Tensor-309"><span class="linenos">309</span></a>        <span class="n">mode</span><span class="p">:</span> <span class="n">PadMode</span> <span class="o">=</span> <span class="s2">&quot;symmetric&quot;</span><span class="p">,</span>
</span><span id="Tensor-310"><a href="#Tensor-310"><span class="linenos">310</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
</span><span id="Tensor-311"><a href="#Tensor-311"><span class="linenos">311</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;pad `tensor` to match `sizes`&quot;&quot;&quot;</span>
</span><span id="Tensor-312"><a href="#Tensor-312"><span class="linenos">312</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pad_where</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="Tensor-313"><a href="#Tensor-313"><span class="linenos">313</span></a>            <span class="n">pad_axis_where</span><span class="p">:</span> <span class="n">PerAxis</span><span class="p">[</span><span class="n">PadWhere</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="n">a</span><span class="p">:</span> <span class="n">pad_where</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dims</span><span class="p">}</span>
</span><span id="Tensor-314"><a href="#Tensor-314"><span class="linenos">314</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Tensor-315"><a href="#Tensor-315"><span class="linenos">315</span></a>            <span class="n">pad_axis_where</span> <span class="o">=</span> <span class="n">pad_where</span>
</span><span id="Tensor-316"><a href="#Tensor-316"><span class="linenos">316</span></a>
</span><span id="Tensor-317"><a href="#Tensor-317"><span class="linenos">317</span></a>        <span class="n">pad_width</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="n">AxisId</span><span class="p">,</span> <span class="n">PadWidth</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Tensor-318"><a href="#Tensor-318"><span class="linenos">318</span></a>        <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">s_is</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sizes</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="Tensor-319"><a href="#Tensor-319"><span class="linenos">319</span></a>            <span class="k">if</span> <span class="n">a</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sizes</span> <span class="ow">or</span> <span class="n">sizes</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">==</span> <span class="n">s_is</span><span class="p">:</span>
</span><span id="Tensor-320"><a href="#Tensor-320"><span class="linenos">320</span></a>                <span class="n">pad_width</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="n">PadWidth</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="Tensor-321"><a href="#Tensor-321"><span class="linenos">321</span></a>            <span class="k">elif</span> <span class="n">s_is</span> <span class="o">&gt;</span> <span class="n">sizes</span><span class="p">[</span><span class="n">a</span><span class="p">]:</span>
</span><span id="Tensor-322"><a href="#Tensor-322"><span class="linenos">322</span></a>                <span class="n">pad_width</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="n">PadWidth</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="Tensor-323"><a href="#Tensor-323"><span class="linenos">323</span></a>                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
</span><span id="Tensor-324"><a href="#Tensor-324"><span class="linenos">324</span></a>                    <span class="s2">&quot;Cannot pad axis </span><span class="si">{}</span><span class="s2"> of size </span><span class="si">{}</span><span class="s2"> to smaller size </span><span class="si">{}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="Tensor-325"><a href="#Tensor-325"><span class="linenos">325</span></a>                    <span class="n">a</span><span class="p">,</span>
</span><span id="Tensor-326"><a href="#Tensor-326"><span class="linenos">326</span></a>                    <span class="n">s_is</span><span class="p">,</span>
</span><span id="Tensor-327"><a href="#Tensor-327"><span class="linenos">327</span></a>                    <span class="n">sizes</span><span class="p">[</span><span class="n">a</span><span class="p">],</span>
</span><span id="Tensor-328"><a href="#Tensor-328"><span class="linenos">328</span></a>                <span class="p">)</span>
</span><span id="Tensor-329"><a href="#Tensor-329"><span class="linenos">329</span></a>            <span class="k">elif</span> <span class="n">a</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">pad_axis_where</span><span class="p">:</span>
</span><span id="Tensor-330"><a href="#Tensor-330"><span class="linenos">330</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="Tensor-331"><a href="#Tensor-331"><span class="linenos">331</span></a>                    <span class="sa">f</span><span class="s2">&quot;Don&#39;t know where to pad axis </span><span class="si">{</span><span class="n">a</span><span class="si">}</span><span class="s2">, `pad_where`=</span><span class="si">{</span><span class="n">pad_where</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="Tensor-332"><a href="#Tensor-332"><span class="linenos">332</span></a>                <span class="p">)</span>
</span><span id="Tensor-333"><a href="#Tensor-333"><span class="linenos">333</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Tensor-334"><a href="#Tensor-334"><span class="linenos">334</span></a>                <span class="n">pad_this_axis_where</span> <span class="o">=</span> <span class="n">pad_axis_where</span><span class="p">[</span><span class="n">a</span><span class="p">]</span>
</span><span id="Tensor-335"><a href="#Tensor-335"><span class="linenos">335</span></a>                <span class="n">d</span> <span class="o">=</span> <span class="n">sizes</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">-</span> <span class="n">s_is</span>
</span><span id="Tensor-336"><a href="#Tensor-336"><span class="linenos">336</span></a>                <span class="k">if</span> <span class="n">pad_this_axis_where</span> <span class="o">==</span> <span class="s2">&quot;left&quot;</span><span class="p">:</span>
</span><span id="Tensor-337"><a href="#Tensor-337"><span class="linenos">337</span></a>                    <span class="n">pad_width</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="n">PadWidth</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="Tensor-338"><a href="#Tensor-338"><span class="linenos">338</span></a>                <span class="k">elif</span> <span class="n">pad_this_axis_where</span> <span class="o">==</span> <span class="s2">&quot;right&quot;</span><span class="p">:</span>
</span><span id="Tensor-339"><a href="#Tensor-339"><span class="linenos">339</span></a>                    <span class="n">pad_width</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="n">PadWidth</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
</span><span id="Tensor-340"><a href="#Tensor-340"><span class="linenos">340</span></a>                <span class="k">elif</span> <span class="n">pad_this_axis_where</span> <span class="o">==</span> <span class="s2">&quot;left_and_right&quot;</span><span class="p">:</span>
</span><span id="Tensor-341"><a href="#Tensor-341"><span class="linenos">341</span></a>                    <span class="n">pad_width</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="n">PadWidth</span><span class="p">(</span><span class="n">left</span> <span class="o">:=</span> <span class="n">d</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="n">d</span> <span class="o">-</span> <span class="n">left</span><span class="p">)</span>
</span><span id="Tensor-342"><a href="#Tensor-342"><span class="linenos">342</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="Tensor-343"><a href="#Tensor-343"><span class="linenos">343</span></a>                    <span class="n">assert_never</span><span class="p">(</span><span class="n">pad_this_axis_where</span><span class="p">)</span>
</span><span id="Tensor-344"><a href="#Tensor-344"><span class="linenos">344</span></a>
</span><span id="Tensor-345"><a href="#Tensor-345"><span class="linenos">345</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span><span class="n">pad_width</span><span class="p">,</span> <span class="n">mode</span><span class="p">)</span>
</span><span id="Tensor-346"><a href="#Tensor-346"><span class="linenos">346</span></a>
</span><span id="Tensor-347"><a href="#Tensor-347"><span class="linenos">347</span></a>    <span class="k">def</span> <span class="nf">quantile</span><span class="p">(</span>
</span><span id="Tensor-348"><a href="#Tensor-348"><span class="linenos">348</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="Tensor-349"><a href="#Tensor-349"><span class="linenos">349</span></a>        <span class="n">q</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]],</span>
</span><span id="Tensor-350"><a href="#Tensor-350"><span class="linenos">350</span></a>        <span class="n">dim</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">AxisId</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">AxisId</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Tensor-351"><a href="#Tensor-351"><span class="linenos">351</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
</span><span id="Tensor-352"><a href="#Tensor-352"><span class="linenos">352</span></a>        <span class="k">assert</span> <span class="p">(</span>
</span><span id="Tensor-353"><a href="#Tensor-353"><span class="linenos">353</span></a>            <span class="nb">isinstance</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">))</span>
</span><span id="Tensor-354"><a href="#Tensor-354"><span class="linenos">354</span></a>            <span class="ow">and</span> <span class="n">q</span> <span class="o">&gt;=</span> <span class="mf">0.0</span>
</span><span id="Tensor-355"><a href="#Tensor-355"><span class="linenos">355</span></a>            <span class="ow">or</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">))</span>
</span><span id="Tensor-356"><a href="#Tensor-356"><span class="linenos">356</span></a>            <span class="ow">and</span> <span class="nb">all</span><span class="p">(</span><span class="n">qq</span> <span class="o">&gt;=</span> <span class="mf">0.0</span> <span class="k">for</span> <span class="n">qq</span> <span class="ow">in</span> <span class="n">q</span><span class="p">)</span>
</span><span id="Tensor-357"><a href="#Tensor-357"><span class="linenos">357</span></a>        <span class="p">)</span>
</span><span id="Tensor-358"><a href="#Tensor-358"><span class="linenos">358</span></a>        <span class="k">assert</span> <span class="p">(</span>
</span><span id="Tensor-359"><a href="#Tensor-359"><span class="linenos">359</span></a>            <span class="nb">isinstance</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">))</span>
</span><span id="Tensor-360"><a href="#Tensor-360"><span class="linenos">360</span></a>            <span class="ow">and</span> <span class="n">q</span> <span class="o">&lt;=</span> <span class="mf">1.0</span>
</span><span id="Tensor-361"><a href="#Tensor-361"><span class="linenos">361</span></a>            <span class="ow">or</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">))</span>
</span><span id="Tensor-362"><a href="#Tensor-362"><span class="linenos">362</span></a>            <span class="ow">and</span> <span class="nb">all</span><span class="p">(</span><span class="n">qq</span> <span class="o">&lt;=</span> <span class="mf">1.0</span> <span class="k">for</span> <span class="n">qq</span> <span class="ow">in</span> <span class="n">q</span><span class="p">)</span>
</span><span id="Tensor-363"><a href="#Tensor-363"><span class="linenos">363</span></a>        <span class="p">)</span>
</span><span id="Tensor-364"><a href="#Tensor-364"><span class="linenos">364</span></a>        <span class="k">assert</span> <span class="n">dim</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="p">(</span>
</span><span id="Tensor-365"><a href="#Tensor-365"><span class="linenos">365</span></a>            <span class="p">(</span><span class="n">quantile_dim</span> <span class="o">:=</span> <span class="n">AxisId</span><span class="p">(</span><span class="s2">&quot;quantile&quot;</span><span class="p">))</span> <span class="o">!=</span> <span class="n">dim</span> <span class="ow">and</span> <span class="n">quantile_dim</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">(</span><span class="n">dim</span><span class="p">)</span>
</span><span id="Tensor-366"><a href="#Tensor-366"><span class="linenos">366</span></a>        <span class="p">)</span>
</span><span id="Tensor-367"><a href="#Tensor-367"><span class="linenos">367</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="n">from_xarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="n">dim</span><span class="p">))</span>
</span><span id="Tensor-368"><a href="#Tensor-368"><span class="linenos">368</span></a>
</span><span id="Tensor-369"><a href="#Tensor-369"><span class="linenos">369</span></a>    <span class="k">def</span> <span class="nf">resize_to</span><span class="p">(</span>
</span><span id="Tensor-370"><a href="#Tensor-370"><span class="linenos">370</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="Tensor-371"><a href="#Tensor-371"><span class="linenos">371</span></a>        <span class="n">sizes</span><span class="p">:</span> <span class="n">PerAxis</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span>
</span><span id="Tensor-372"><a href="#Tensor-372"><span class="linenos">372</span></a>        <span class="o">*</span><span class="p">,</span>
</span><span id="Tensor-373"><a href="#Tensor-373"><span class="linenos">373</span></a>        <span class="n">pad_where</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span>
</span><span id="Tensor-374"><a href="#Tensor-374"><span class="linenos">374</span></a>            <span class="n">PadWhere</span><span class="p">,</span>
</span><span id="Tensor-375"><a href="#Tensor-375"><span class="linenos">375</span></a>            <span class="n">PerAxis</span><span class="p">[</span><span class="n">PadWhere</span><span class="p">],</span>
</span><span id="Tensor-376"><a href="#Tensor-376"><span class="linenos">376</span></a>        <span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;left_and_right&quot;</span><span class="p">,</span>
</span><span id="Tensor-377"><a href="#Tensor-377"><span class="linenos">377</span></a>        <span class="n">crop_where</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span>
</span><span id="Tensor-378"><a href="#Tensor-378"><span class="linenos">378</span></a>            <span class="n">CropWhere</span><span class="p">,</span>
</span><span id="Tensor-379"><a href="#Tensor-379"><span class="linenos">379</span></a>            <span class="n">PerAxis</span><span class="p">[</span><span class="n">CropWhere</span><span class="p">],</span>
</span><span id="Tensor-380"><a href="#Tensor-380"><span class="linenos">380</span></a>        <span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;left_and_right&quot;</span><span class="p">,</span>
</span><span id="Tensor-381"><a href="#Tensor-381"><span class="linenos">381</span></a>        <span class="n">pad_mode</span><span class="p">:</span> <span class="n">PadMode</span> <span class="o">=</span> <span class="s2">&quot;symmetric&quot;</span><span class="p">,</span>
</span><span id="Tensor-382"><a href="#Tensor-382"><span class="linenos">382</span></a>    <span class="p">):</span>
</span><span id="Tensor-383"><a href="#Tensor-383"><span class="linenos">383</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;return cropped/padded tensor with `sizes`&quot;&quot;&quot;</span>
</span><span id="Tensor-384"><a href="#Tensor-384"><span class="linenos">384</span></a>        <span class="n">crop_to_sizes</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="n">AxisId</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Tensor-385"><a href="#Tensor-385"><span class="linenos">385</span></a>        <span class="n">pad_to_sizes</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="n">AxisId</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Tensor-386"><a href="#Tensor-386"><span class="linenos">386</span></a>        <span class="n">new_axes</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">sizes</span><span class="p">)</span>
</span><span id="Tensor-387"><a href="#Tensor-387"><span class="linenos">387</span></a>        <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">s_is</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sizes</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="Tensor-388"><a href="#Tensor-388"><span class="linenos">388</span></a>            <span class="n">a</span> <span class="o">=</span> <span class="n">AxisId</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
</span><span id="Tensor-389"><a href="#Tensor-389"><span class="linenos">389</span></a>            <span class="n">_</span> <span class="o">=</span> <span class="n">new_axes</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="Tensor-390"><a href="#Tensor-390"><span class="linenos">390</span></a>            <span class="k">if</span> <span class="n">a</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sizes</span> <span class="ow">or</span> <span class="n">sizes</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">==</span> <span class="n">s_is</span><span class="p">:</span>
</span><span id="Tensor-391"><a href="#Tensor-391"><span class="linenos">391</span></a>                <span class="k">pass</span>
</span><span id="Tensor-392"><a href="#Tensor-392"><span class="linenos">392</span></a>            <span class="k">elif</span> <span class="n">s_is</span> <span class="o">&gt;</span> <span class="n">sizes</span><span class="p">[</span><span class="n">a</span><span class="p">]:</span>
</span><span id="Tensor-393"><a href="#Tensor-393"><span class="linenos">393</span></a>                <span class="n">crop_to_sizes</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="n">sizes</span><span class="p">[</span><span class="n">a</span><span class="p">]</span>
</span><span id="Tensor-394"><a href="#Tensor-394"><span class="linenos">394</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Tensor-395"><a href="#Tensor-395"><span class="linenos">395</span></a>                <span class="n">pad_to_sizes</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="n">sizes</span><span class="p">[</span><span class="n">a</span><span class="p">]</span>
</span><span id="Tensor-396"><a href="#Tensor-396"><span class="linenos">396</span></a>
</span><span id="Tensor-397"><a href="#Tensor-397"><span class="linenos">397</span></a>        <span class="n">tensor</span> <span class="o">=</span> <span class="bp">self</span>
</span><span id="Tensor-398"><a href="#Tensor-398"><span class="linenos">398</span></a>        <span class="k">if</span> <span class="n">crop_to_sizes</span><span class="p">:</span>
</span><span id="Tensor-399"><a href="#Tensor-399"><span class="linenos">399</span></a>            <span class="n">tensor</span> <span class="o">=</span> <span class="n">tensor</span><span class="o">.</span><span class="n">crop_to</span><span class="p">(</span><span class="n">crop_to_sizes</span><span class="p">,</span> <span class="n">crop_where</span><span class="o">=</span><span class="n">crop_where</span><span class="p">)</span>
</span><span id="Tensor-400"><a href="#Tensor-400"><span class="linenos">400</span></a>
</span><span id="Tensor-401"><a href="#Tensor-401"><span class="linenos">401</span></a>        <span class="k">if</span> <span class="n">pad_to_sizes</span><span class="p">:</span>
</span><span id="Tensor-402"><a href="#Tensor-402"><span class="linenos">402</span></a>            <span class="n">tensor</span> <span class="o">=</span> <span class="n">tensor</span><span class="o">.</span><span class="n">pad_to</span><span class="p">(</span><span class="n">pad_to_sizes</span><span class="p">,</span> <span class="n">pad_where</span><span class="o">=</span><span class="n">pad_where</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">pad_mode</span><span class="p">)</span>
</span><span id="Tensor-403"><a href="#Tensor-403"><span class="linenos">403</span></a>
</span><span id="Tensor-404"><a href="#Tensor-404"><span class="linenos">404</span></a>        <span class="k">if</span> <span class="n">new_axes</span><span class="p">:</span>
</span><span id="Tensor-405"><a href="#Tensor-405"><span class="linenos">405</span></a>            <span class="n">tensor</span> <span class="o">=</span> <span class="n">tensor</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">new_axes</span><span class="p">)</span>
</span><span id="Tensor-406"><a href="#Tensor-406"><span class="linenos">406</span></a>
</span><span id="Tensor-407"><a href="#Tensor-407"><span class="linenos">407</span></a>        <span class="k">return</span> <span class="n">tensor</span>
</span><span id="Tensor-408"><a href="#Tensor-408"><span class="linenos">408</span></a>
</span><span id="Tensor-409"><a href="#Tensor-409"><span class="linenos">409</span></a>    <span class="k">def</span> <span class="nf">transpose</span><span class="p">(</span>
</span><span id="Tensor-410"><a href="#Tensor-410"><span class="linenos">410</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="Tensor-411"><a href="#Tensor-411"><span class="linenos">411</span></a>        <span class="n">axes</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">AxisId</span><span class="p">],</span>
</span><span id="Tensor-412"><a href="#Tensor-412"><span class="linenos">412</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
</span><span id="Tensor-413"><a href="#Tensor-413"><span class="linenos">413</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;return a transposed tensor</span>
</span><span id="Tensor-414"><a href="#Tensor-414"><span class="linenos">414</span></a>
</span><span id="Tensor-415"><a href="#Tensor-415"><span class="linenos">415</span></a><span class="sd">        Args:</span>
</span><span id="Tensor-416"><a href="#Tensor-416"><span class="linenos">416</span></a><span class="sd">            axes: the desired tensor axes</span>
</span><span id="Tensor-417"><a href="#Tensor-417"><span class="linenos">417</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Tensor-418"><a href="#Tensor-418"><span class="linenos">418</span></a>        <span class="c1"># expand missing tensor axes</span>
</span><span id="Tensor-419"><a href="#Tensor-419"><span class="linenos">419</span></a>        <span class="n">missing_axes</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">axes</span> <span class="k">if</span> <span class="n">a</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dims</span><span class="p">)</span>
</span><span id="Tensor-420"><a href="#Tensor-420"><span class="linenos">420</span></a>        <span class="n">array</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span>
</span><span id="Tensor-421"><a href="#Tensor-421"><span class="linenos">421</span></a>        <span class="k">if</span> <span class="n">missing_axes</span><span class="p">:</span>
</span><span id="Tensor-422"><a href="#Tensor-422"><span class="linenos">422</span></a>            <span class="n">array</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">missing_axes</span><span class="p">)</span>
</span><span id="Tensor-423"><a href="#Tensor-423"><span class="linenos">423</span></a>
</span><span id="Tensor-424"><a href="#Tensor-424"><span class="linenos">424</span></a>        <span class="c1"># transpose to the correct axis order</span>
</span><span id="Tensor-425"><a href="#Tensor-425"><span class="linenos">425</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="n">from_xarray</span><span class="p">(</span><span class="n">array</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="o">*</span><span class="n">axes</span><span class="p">))</span>
</span><span id="Tensor-426"><a href="#Tensor-426"><span class="linenos">426</span></a>
</span><span id="Tensor-427"><a href="#Tensor-427"><span class="linenos">427</span></a>    <span class="nd">@classmethod</span>
</span><span id="Tensor-428"><a href="#Tensor-428"><span class="linenos">428</span></a>    <span class="k">def</span> <span class="nf">_interprete_array_wo_known_axes</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">array</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">Any</span><span class="p">]):</span>
</span><span id="Tensor-429"><a href="#Tensor-429"><span class="linenos">429</span></a>        <span class="n">ndim</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">ndim</span>
</span><span id="Tensor-430"><a href="#Tensor-430"><span class="linenos">430</span></a>        <span class="k">if</span> <span class="n">ndim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="Tensor-431"><a href="#Tensor-431"><span class="linenos">431</span></a>            <span class="n">current_axes</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="Tensor-432"><a href="#Tensor-432"><span class="linenos">432</span></a>                <span class="n">v0_5</span><span class="o">.</span><span class="n">SpaceInputAxis</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">AxisId</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="n">array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
</span><span id="Tensor-433"><a href="#Tensor-433"><span class="linenos">433</span></a>                <span class="n">v0_5</span><span class="o">.</span><span class="n">SpaceInputAxis</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">AxisId</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="n">array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
</span><span id="Tensor-434"><a href="#Tensor-434"><span class="linenos">434</span></a>            <span class="p">)</span>
</span><span id="Tensor-435"><a href="#Tensor-435"><span class="linenos">435</span></a>        <span class="k">elif</span> <span class="n">ndim</span> <span class="o">==</span> <span class="mi">3</span> <span class="ow">and</span> <span class="nb">any</span><span class="p">(</span><span class="n">s</span> <span class="o">&lt;=</span> <span class="mi">3</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">array</span><span class="o">.</span><span class="n">shape</span><span class="p">):</span>
</span><span id="Tensor-436"><a href="#Tensor-436"><span class="linenos">436</span></a>            <span class="n">current_axes</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="Tensor-437"><a href="#Tensor-437"><span class="linenos">437</span></a>                <span class="n">v0_5</span><span class="o">.</span><span class="n">ChannelAxis</span><span class="p">(</span>
</span><span id="Tensor-438"><a href="#Tensor-438"><span class="linenos">438</span></a>                    <span class="n">channel_names</span><span class="o">=</span><span class="p">[</span>
</span><span id="Tensor-439"><a href="#Tensor-439"><span class="linenos">439</span></a>                        <span class="n">v0_5</span><span class="o">.</span><span class="n">Identifier</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;channel</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="Tensor-440"><a href="#Tensor-440"><span class="linenos">440</span></a>                    <span class="p">]</span>
</span><span id="Tensor-441"><a href="#Tensor-441"><span class="linenos">441</span></a>                <span class="p">),</span>
</span><span id="Tensor-442"><a href="#Tensor-442"><span class="linenos">442</span></a>                <span class="n">v0_5</span><span class="o">.</span><span class="n">SpaceInputAxis</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">AxisId</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="n">array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
</span><span id="Tensor-443"><a href="#Tensor-443"><span class="linenos">443</span></a>                <span class="n">v0_5</span><span class="o">.</span><span class="n">SpaceInputAxis</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">AxisId</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="n">array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span>
</span><span id="Tensor-444"><a href="#Tensor-444"><span class="linenos">444</span></a>            <span class="p">)</span>
</span><span id="Tensor-445"><a href="#Tensor-445"><span class="linenos">445</span></a>        <span class="k">elif</span> <span class="n">ndim</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
</span><span id="Tensor-446"><a href="#Tensor-446"><span class="linenos">446</span></a>            <span class="n">current_axes</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="Tensor-447"><a href="#Tensor-447"><span class="linenos">447</span></a>                <span class="n">v0_5</span><span class="o">.</span><span class="n">SpaceInputAxis</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">AxisId</span><span class="p">(</span><span class="s2">&quot;z&quot;</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="n">array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
</span><span id="Tensor-448"><a href="#Tensor-448"><span class="linenos">448</span></a>                <span class="n">v0_5</span><span class="o">.</span><span class="n">SpaceInputAxis</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">AxisId</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="n">array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
</span><span id="Tensor-449"><a href="#Tensor-449"><span class="linenos">449</span></a>                <span class="n">v0_5</span><span class="o">.</span><span class="n">SpaceInputAxis</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">AxisId</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="n">array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span>
</span><span id="Tensor-450"><a href="#Tensor-450"><span class="linenos">450</span></a>            <span class="p">)</span>
</span><span id="Tensor-451"><a href="#Tensor-451"><span class="linenos">451</span></a>        <span class="k">elif</span> <span class="n">ndim</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
</span><span id="Tensor-452"><a href="#Tensor-452"><span class="linenos">452</span></a>            <span class="n">current_axes</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="Tensor-453"><a href="#Tensor-453"><span class="linenos">453</span></a>                <span class="n">v0_5</span><span class="o">.</span><span class="n">ChannelAxis</span><span class="p">(</span>
</span><span id="Tensor-454"><a href="#Tensor-454"><span class="linenos">454</span></a>                    <span class="n">channel_names</span><span class="o">=</span><span class="p">[</span>
</span><span id="Tensor-455"><a href="#Tensor-455"><span class="linenos">455</span></a>                        <span class="n">v0_5</span><span class="o">.</span><span class="n">Identifier</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;channel</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="Tensor-456"><a href="#Tensor-456"><span class="linenos">456</span></a>                    <span class="p">]</span>
</span><span id="Tensor-457"><a href="#Tensor-457"><span class="linenos">457</span></a>                <span class="p">),</span>
</span><span id="Tensor-458"><a href="#Tensor-458"><span class="linenos">458</span></a>                <span class="n">v0_5</span><span class="o">.</span><span class="n">SpaceInputAxis</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">AxisId</span><span class="p">(</span><span class="s2">&quot;z&quot;</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="n">array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
</span><span id="Tensor-459"><a href="#Tensor-459"><span class="linenos">459</span></a>                <span class="n">v0_5</span><span class="o">.</span><span class="n">SpaceInputAxis</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">AxisId</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="n">array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span>
</span><span id="Tensor-460"><a href="#Tensor-460"><span class="linenos">460</span></a>                <span class="n">v0_5</span><span class="o">.</span><span class="n">SpaceInputAxis</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">AxisId</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="n">array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">3</span><span class="p">]),</span>
</span><span id="Tensor-461"><a href="#Tensor-461"><span class="linenos">461</span></a>            <span class="p">)</span>
</span><span id="Tensor-462"><a href="#Tensor-462"><span class="linenos">462</span></a>        <span class="k">elif</span> <span class="n">ndim</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
</span><span id="Tensor-463"><a href="#Tensor-463"><span class="linenos">463</span></a>            <span class="n">current_axes</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="Tensor-464"><a href="#Tensor-464"><span class="linenos">464</span></a>                <span class="n">v0_5</span><span class="o">.</span><span class="n">BatchAxis</span><span class="p">(),</span>
</span><span id="Tensor-465"><a href="#Tensor-465"><span class="linenos">465</span></a>                <span class="n">v0_5</span><span class="o">.</span><span class="n">ChannelAxis</span><span class="p">(</span>
</span><span id="Tensor-466"><a href="#Tensor-466"><span class="linenos">466</span></a>                    <span class="n">channel_names</span><span class="o">=</span><span class="p">[</span>
</span><span id="Tensor-467"><a href="#Tensor-467"><span class="linenos">467</span></a>                        <span class="n">v0_5</span><span class="o">.</span><span class="n">Identifier</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;channel</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="Tensor-468"><a href="#Tensor-468"><span class="linenos">468</span></a>                    <span class="p">]</span>
</span><span id="Tensor-469"><a href="#Tensor-469"><span class="linenos">469</span></a>                <span class="p">),</span>
</span><span id="Tensor-470"><a href="#Tensor-470"><span class="linenos">470</span></a>                <span class="n">v0_5</span><span class="o">.</span><span class="n">SpaceInputAxis</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">AxisId</span><span class="p">(</span><span class="s2">&quot;z&quot;</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="n">array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span>
</span><span id="Tensor-471"><a href="#Tensor-471"><span class="linenos">471</span></a>                <span class="n">v0_5</span><span class="o">.</span><span class="n">SpaceInputAxis</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">AxisId</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="n">array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">3</span><span class="p">]),</span>
</span><span id="Tensor-472"><a href="#Tensor-472"><span class="linenos">472</span></a>                <span class="n">v0_5</span><span class="o">.</span><span class="n">SpaceInputAxis</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">AxisId</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="n">array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">4</span><span class="p">]),</span>
</span><span id="Tensor-473"><a href="#Tensor-473"><span class="linenos">473</span></a>            <span class="p">)</span>
</span><span id="Tensor-474"><a href="#Tensor-474"><span class="linenos">474</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Tensor-475"><a href="#Tensor-475"><span class="linenos">475</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Could not guess an axis mapping for </span><span class="si">{</span><span class="n">array</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="Tensor-476"><a href="#Tensor-476"><span class="linenos">476</span></a>
</span><span id="Tensor-477"><a href="#Tensor-477"><span class="linenos">477</span></a>        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">id</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">current_axes</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>A wrapper around an xr.DataArray for better integration with <a href="spec.html">bioimageio.spec</a>
and improved type annotations.</p>
</div>


                            <div id="Tensor.__init__" class="classattr">
                                        <input id="Tensor.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Tensor</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">array</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]]</span>,</span><span class="param">	<span class="n">dims</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n"><a href="#AxisId">AxisId</a></span><span class="p">,</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">],</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n"><a href="spec/model/v0_5.html#BatchAxis">bioimageio.spec.model.v0_5.BatchAxis</a></span><span class="p">,</span> <span class="n"><a href="spec/model/v0_5.html#ChannelAxis">bioimageio.spec.model.v0_5.ChannelAxis</a></span><span class="p">,</span> <span class="n"><a href="spec/model/v0_5.html#IndexInputAxis">bioimageio.spec.model.v0_5.IndexInputAxis</a></span><span class="p">,</span> <span class="n"><a href="spec/model/v0_5.html#TimeInputAxis">bioimageio.spec.model.v0_5.TimeInputAxis</a></span><span class="p">,</span> <span class="n"><a href="spec/model/v0_5.html#SpaceInputAxis">bioimageio.spec.model.v0_5.SpaceInputAxis</a></span><span class="p">],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=</span><span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)],</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n"><a href="spec/model/v0_5.html#BatchAxis">bioimageio.spec.model.v0_5.BatchAxis</a></span><span class="p">,</span> <span class="n"><a href="spec/model/v0_5.html#ChannelAxis">bioimageio.spec.model.v0_5.ChannelAxis</a></span><span class="p">,</span> <span class="n"><a href="spec/model/v0_5.html#IndexOutputAxis">bioimageio.spec.model.v0_5.IndexOutputAxis</a></span><span class="p">,</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Annotated</span><span class="p">[</span><span class="n"><a href="spec/model/v0_5.html#TimeOutputAxis">bioimageio.spec.model.v0_5.TimeOutputAxis</a></span><span class="p">,</span> <span class="n">Tag</span><span class="p">(</span><span class="n">tag</span><span class="o">=</span><span class="s1">&#39;wo_halo&#39;</span><span class="p">)],</span> <span class="n">Annotated</span><span class="p">[</span><span class="n"><a href="spec/model/v0_5.html#TimeOutputAxisWithHalo">bioimageio.spec.model.v0_5.TimeOutputAxisWithHalo</a></span><span class="p">,</span> <span class="n">Tag</span><span class="p">(</span><span class="n">tag</span><span class="o">=</span><span class="s1">&#39;with_halo&#39;</span><span class="p">)]],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=&lt;</span><span class="n">function</span> <span class="n">_get_halo_axis_discriminator_value</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)],</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Annotated</span><span class="p">[</span><span class="n"><a href="spec/model/v0_5.html#SpaceOutputAxis">bioimageio.spec.model.v0_5.SpaceOutputAxis</a></span><span class="p">,</span> <span class="n">Tag</span><span class="p">(</span><span class="n">tag</span><span class="o">=</span><span class="s1">&#39;wo_halo&#39;</span><span class="p">)],</span> <span class="n">Annotated</span><span class="p">[</span><span class="n"><a href="spec/model/v0_5.html#SpaceOutputAxisWithHalo">bioimageio.spec.model.v0_5.SpaceOutputAxisWithHalo</a></span><span class="p">,</span> <span class="n">Tag</span><span class="p">(</span><span class="n">tag</span><span class="o">=</span><span class="s1">&#39;with_halo&#39;</span><span class="p">)]],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=&lt;</span><span class="n">function</span> <span class="n">_get_halo_axis_discriminator_value</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)]],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=</span><span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)],</span> <span class="n"><a href="#Axis">Axis</a></span><span class="p">]]</span></span>)</span>

                <label class="view-source-button" for="Tensor.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Tensor.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Tensor.__init__-55"><a href="#Tensor.__init__-55"><span class="linenos">55</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="Tensor.__init__-56"><a href="#Tensor.__init__-56"><span class="linenos">56</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="Tensor.__init__-57"><a href="#Tensor.__init__-57"><span class="linenos">57</span></a>        <span class="n">array</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">Any</span><span class="p">],</span>
</span><span id="Tensor.__init__-58"><a href="#Tensor.__init__-58"><span class="linenos">58</span></a>        <span class="n">dims</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">AxisId</span><span class="p">,</span> <span class="n">AxisLike</span><span class="p">]],</span>
</span><span id="Tensor.__init__-59"><a href="#Tensor.__init__-59"><span class="linenos">59</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Tensor.__init__-60"><a href="#Tensor.__init__-60"><span class="linenos">60</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
</span><span id="Tensor.__init__-61"><a href="#Tensor.__init__-61"><span class="linenos">61</span></a>        <span class="n">axes</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span>
</span><span id="Tensor.__init__-62"><a href="#Tensor.__init__-62"><span class="linenos">62</span></a>            <span class="n">a</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">AxisId</span><span class="p">)</span> <span class="k">else</span> <span class="n">AxisInfo</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">id</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">dims</span>
</span><span id="Tensor.__init__-63"><a href="#Tensor.__init__-63"><span class="linenos">63</span></a>        <span class="p">)</span>
</span><span id="Tensor.__init__-64"><a href="#Tensor.__init__-64"><span class="linenos">64</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="n">axes</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="Tensor.from_xarray" class="classattr">
                                        <input id="Tensor.from_xarray-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-classmethod">@classmethod</div>

        <span class="def">def</span>
        <span class="name">from_xarray</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">cls</span>, </span><span class="param"><span class="n">data_array</span><span class="p">:</span> <span class="n">xarray</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">dataarray</span><span class="o">.</span><span class="n">DataArray</span></span><span class="return-annotation">) -> <span class="n">Self</span>:</span></span>

                <label class="view-source-button" for="Tensor.from_xarray-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Tensor.from_xarray"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Tensor.from_xarray-135"><a href="#Tensor.from_xarray-135"><span class="linenos">135</span></a>    <span class="nd">@classmethod</span>
</span><span id="Tensor.from_xarray-136"><a href="#Tensor.from_xarray-136"><span class="linenos">136</span></a>    <span class="k">def</span> <span class="nf">from_xarray</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data_array</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
</span><span id="Tensor.from_xarray-137"><a href="#Tensor.from_xarray-137"><span class="linenos">137</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;create a `Tensor` from an xarray data array</span>
</span><span id="Tensor.from_xarray-138"><a href="#Tensor.from_xarray-138"><span class="linenos">138</span></a>
</span><span id="Tensor.from_xarray-139"><a href="#Tensor.from_xarray-139"><span class="linenos">139</span></a><span class="sd">        note for internal use: this factory method is round-trip save</span>
</span><span id="Tensor.from_xarray-140"><a href="#Tensor.from_xarray-140"><span class="linenos">140</span></a><span class="sd">            for any `Tensor`&#39;s  `data` property (an xarray.DataArray).</span>
</span><span id="Tensor.from_xarray-141"><a href="#Tensor.from_xarray-141"><span class="linenos">141</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Tensor.from_xarray-142"><a href="#Tensor.from_xarray-142"><span class="linenos">142</span></a>        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span>
</span><span id="Tensor.from_xarray-143"><a href="#Tensor.from_xarray-143"><span class="linenos">143</span></a>            <span class="n">array</span><span class="o">=</span><span class="n">data_array</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="n">AxisId</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">data_array</span><span class="o">.</span><span class="n">dims</span><span class="p">)</span>
</span><span id="Tensor.from_xarray-144"><a href="#Tensor.from_xarray-144"><span class="linenos">144</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>create a <code><a href="#Tensor">Tensor</a></code> from an xarray data array</p>

<p>note for internal use: this factory method is round-trip save
    for any <code><a href="#Tensor">Tensor</a></code>'s  <code><a href="#Tensor.data">data</a></code> property (an xarray.DataArray).</p>
</div>


                            </div>
                            <div id="Tensor.from_numpy" class="classattr">
                                        <input id="Tensor.from_numpy-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-classmethod">@classmethod</div>

        <span class="def">def</span>
        <span class="name">from_numpy</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">cls</span>,</span><span class="param">	<span class="n">array</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]]</span>,</span><span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">dims</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n"><a href="#AxisId">AxisId</a></span><span class="p">,</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">],</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n"><a href="spec/model/v0_5.html#BatchAxis">bioimageio.spec.model.v0_5.BatchAxis</a></span><span class="p">,</span> <span class="n"><a href="spec/model/v0_5.html#ChannelAxis">bioimageio.spec.model.v0_5.ChannelAxis</a></span><span class="p">,</span> <span class="n"><a href="spec/model/v0_5.html#IndexInputAxis">bioimageio.spec.model.v0_5.IndexInputAxis</a></span><span class="p">,</span> <span class="n"><a href="spec/model/v0_5.html#TimeInputAxis">bioimageio.spec.model.v0_5.TimeInputAxis</a></span><span class="p">,</span> <span class="n"><a href="spec/model/v0_5.html#SpaceInputAxis">bioimageio.spec.model.v0_5.SpaceInputAxis</a></span><span class="p">],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=</span><span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)],</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n"><a href="spec/model/v0_5.html#BatchAxis">bioimageio.spec.model.v0_5.BatchAxis</a></span><span class="p">,</span> <span class="n"><a href="spec/model/v0_5.html#ChannelAxis">bioimageio.spec.model.v0_5.ChannelAxis</a></span><span class="p">,</span> <span class="n"><a href="spec/model/v0_5.html#IndexOutputAxis">bioimageio.spec.model.v0_5.IndexOutputAxis</a></span><span class="p">,</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Annotated</span><span class="p">[</span><span class="n"><a href="spec/model/v0_5.html#TimeOutputAxis">bioimageio.spec.model.v0_5.TimeOutputAxis</a></span><span class="p">,</span> <span class="n">Tag</span><span class="p">(</span><span class="n">tag</span><span class="o">=</span><span class="s1">&#39;wo_halo&#39;</span><span class="p">)],</span> <span class="n">Annotated</span><span class="p">[</span><span class="n"><a href="spec/model/v0_5.html#TimeOutputAxisWithHalo">bioimageio.spec.model.v0_5.TimeOutputAxisWithHalo</a></span><span class="p">,</span> <span class="n">Tag</span><span class="p">(</span><span class="n">tag</span><span class="o">=</span><span class="s1">&#39;with_halo&#39;</span><span class="p">)]],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=&lt;</span><span class="n">function</span> <span class="n">_get_halo_axis_discriminator_value</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)],</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Annotated</span><span class="p">[</span><span class="n"><a href="spec/model/v0_5.html#SpaceOutputAxis">bioimageio.spec.model.v0_5.SpaceOutputAxis</a></span><span class="p">,</span> <span class="n">Tag</span><span class="p">(</span><span class="n">tag</span><span class="o">=</span><span class="s1">&#39;wo_halo&#39;</span><span class="p">)],</span> <span class="n">Annotated</span><span class="p">[</span><span class="n"><a href="spec/model/v0_5.html#SpaceOutputAxisWithHalo">bioimageio.spec.model.v0_5.SpaceOutputAxisWithHalo</a></span><span class="p">,</span> <span class="n">Tag</span><span class="p">(</span><span class="n">tag</span><span class="o">=</span><span class="s1">&#39;with_halo&#39;</span><span class="p">)]],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=&lt;</span><span class="n">function</span> <span class="n">_get_halo_axis_discriminator_value</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)]],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=</span><span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)],</span> <span class="n"><a href="#Axis">Axis</a></span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n"><a href="#AxisId">AxisId</a></span><span class="p">,</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">],</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n"><a href="spec/model/v0_5.html#BatchAxis">bioimageio.spec.model.v0_5.BatchAxis</a></span><span class="p">,</span> <span class="n"><a href="spec/model/v0_5.html#ChannelAxis">bioimageio.spec.model.v0_5.ChannelAxis</a></span><span class="p">,</span> <span class="n"><a href="spec/model/v0_5.html#IndexInputAxis">bioimageio.spec.model.v0_5.IndexInputAxis</a></span><span class="p">,</span> <span class="n"><a href="spec/model/v0_5.html#TimeInputAxis">bioimageio.spec.model.v0_5.TimeInputAxis</a></span><span class="p">,</span> <span class="n"><a href="spec/model/v0_5.html#SpaceInputAxis">bioimageio.spec.model.v0_5.SpaceInputAxis</a></span><span class="p">],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=</span><span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)],</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n"><a href="spec/model/v0_5.html#BatchAxis">bioimageio.spec.model.v0_5.BatchAxis</a></span><span class="p">,</span> <span class="n"><a href="spec/model/v0_5.html#ChannelAxis">bioimageio.spec.model.v0_5.ChannelAxis</a></span><span class="p">,</span> <span class="n"><a href="spec/model/v0_5.html#IndexOutputAxis">bioimageio.spec.model.v0_5.IndexOutputAxis</a></span><span class="p">,</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Annotated</span><span class="p">[</span><span class="n"><a href="spec/model/v0_5.html#TimeOutputAxis">bioimageio.spec.model.v0_5.TimeOutputAxis</a></span><span class="p">,</span> <span class="n">Tag</span><span class="p">(</span><span class="n">tag</span><span class="o">=</span><span class="s1">&#39;wo_halo&#39;</span><span class="p">)],</span> <span class="n">Annotated</span><span class="p">[</span><span class="n"><a href="spec/model/v0_5.html#TimeOutputAxisWithHalo">bioimageio.spec.model.v0_5.TimeOutputAxisWithHalo</a></span><span class="p">,</span> <span class="n">Tag</span><span class="p">(</span><span class="n">tag</span><span class="o">=</span><span class="s1">&#39;with_halo&#39;</span><span class="p">)]],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=&lt;</span><span class="n">function</span> <span class="n">_get_halo_axis_discriminator_value</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)],</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Annotated</span><span class="p">[</span><span class="n"><a href="spec/model/v0_5.html#SpaceOutputAxis">bioimageio.spec.model.v0_5.SpaceOutputAxis</a></span><span class="p">,</span> <span class="n">Tag</span><span class="p">(</span><span class="n">tag</span><span class="o">=</span><span class="s1">&#39;wo_halo&#39;</span><span class="p">)],</span> <span class="n">Annotated</span><span class="p">[</span><span class="n"><a href="spec/model/v0_5.html#SpaceOutputAxisWithHalo">bioimageio.spec.model.v0_5.SpaceOutputAxisWithHalo</a></span><span class="p">,</span> <span class="n">Tag</span><span class="p">(</span><span class="n">tag</span><span class="o">=</span><span class="s1">&#39;with_halo&#39;</span><span class="p">)]],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=&lt;</span><span class="n">function</span> <span class="n">_get_halo_axis_discriminator_value</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)]],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=</span><span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)],</span> <span class="n"><a href="#Axis">Axis</a></span><span class="p">]],</span> <span class="n">NoneType</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="n"><a href="#Tensor">Tensor</a></span>:</span></span>

                <label class="view-source-button" for="Tensor.from_numpy-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Tensor.from_numpy"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Tensor.from_numpy-146"><a href="#Tensor.from_numpy-146"><span class="linenos">146</span></a>    <span class="nd">@classmethod</span>
</span><span id="Tensor.from_numpy-147"><a href="#Tensor.from_numpy-147"><span class="linenos">147</span></a>    <span class="k">def</span> <span class="nf">from_numpy</span><span class="p">(</span>
</span><span id="Tensor.from_numpy-148"><a href="#Tensor.from_numpy-148"><span class="linenos">148</span></a>        <span class="bp">cls</span><span class="p">,</span>
</span><span id="Tensor.from_numpy-149"><a href="#Tensor.from_numpy-149"><span class="linenos">149</span></a>        <span class="n">array</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">Any</span><span class="p">],</span>
</span><span id="Tensor.from_numpy-150"><a href="#Tensor.from_numpy-150"><span class="linenos">150</span></a>        <span class="o">*</span><span class="p">,</span>
</span><span id="Tensor.from_numpy-151"><a href="#Tensor.from_numpy-151"><span class="linenos">151</span></a>        <span class="n">dims</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">AxisLike</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">AxisLike</span><span class="p">]]],</span>
</span><span id="Tensor.from_numpy-152"><a href="#Tensor.from_numpy-152"><span class="linenos">152</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tensor</span><span class="p">:</span>
</span><span id="Tensor.from_numpy-153"><a href="#Tensor.from_numpy-153"><span class="linenos">153</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;create a `Tensor` from a numpy array</span>
</span><span id="Tensor.from_numpy-154"><a href="#Tensor.from_numpy-154"><span class="linenos">154</span></a>
</span><span id="Tensor.from_numpy-155"><a href="#Tensor.from_numpy-155"><span class="linenos">155</span></a><span class="sd">        Args:</span>
</span><span id="Tensor.from_numpy-156"><a href="#Tensor.from_numpy-156"><span class="linenos">156</span></a><span class="sd">            array: the nd numpy array</span>
</span><span id="Tensor.from_numpy-157"><a href="#Tensor.from_numpy-157"><span class="linenos">157</span></a><span class="sd">            axes: A description of the array&#39;s axes,</span>
</span><span id="Tensor.from_numpy-158"><a href="#Tensor.from_numpy-158"><span class="linenos">158</span></a><span class="sd">                if None axes are guessed (which might fail and raise a ValueError.)</span>
</span><span id="Tensor.from_numpy-159"><a href="#Tensor.from_numpy-159"><span class="linenos">159</span></a>
</span><span id="Tensor.from_numpy-160"><a href="#Tensor.from_numpy-160"><span class="linenos">160</span></a><span class="sd">        Raises:</span>
</span><span id="Tensor.from_numpy-161"><a href="#Tensor.from_numpy-161"><span class="linenos">161</span></a><span class="sd">            ValueError: if `axes` is None and axes guessing fails.</span>
</span><span id="Tensor.from_numpy-162"><a href="#Tensor.from_numpy-162"><span class="linenos">162</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Tensor.from_numpy-163"><a href="#Tensor.from_numpy-163"><span class="linenos">163</span></a>
</span><span id="Tensor.from_numpy-164"><a href="#Tensor.from_numpy-164"><span class="linenos">164</span></a>        <span class="k">if</span> <span class="n">dims</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Tensor.from_numpy-165"><a href="#Tensor.from_numpy-165"><span class="linenos">165</span></a>            <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_interprete_array_wo_known_axes</span><span class="p">(</span><span class="n">array</span><span class="p">)</span>
</span><span id="Tensor.from_numpy-166"><a href="#Tensor.from_numpy-166"><span class="linenos">166</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dims</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">Axis</span><span class="p">,</span> <span class="n">v0_5</span><span class="o">.</span><span class="n">AxisBase</span><span class="p">)):</span>
</span><span id="Tensor.from_numpy-167"><a href="#Tensor.from_numpy-167"><span class="linenos">167</span></a>            <span class="n">dims</span> <span class="o">=</span> <span class="p">[</span><span class="n">dims</span><span class="p">]</span>
</span><span id="Tensor.from_numpy-168"><a href="#Tensor.from_numpy-168"><span class="linenos">168</span></a>
</span><span id="Tensor.from_numpy-169"><a href="#Tensor.from_numpy-169"><span class="linenos">169</span></a>        <span class="n">axis_infos</span> <span class="o">=</span> <span class="p">[</span><span class="n">AxisInfo</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">dims</span><span class="p">]</span>
</span><span id="Tensor.from_numpy-170"><a href="#Tensor.from_numpy-170"><span class="linenos">170</span></a>        <span class="n">original_shape</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</span><span id="Tensor.from_numpy-171"><a href="#Tensor.from_numpy-171"><span class="linenos">171</span></a>
</span><span id="Tensor.from_numpy-172"><a href="#Tensor.from_numpy-172"><span class="linenos">172</span></a>        <span class="n">successful_view</span> <span class="o">=</span> <span class="n">_get_array_view</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">axis_infos</span><span class="p">)</span>
</span><span id="Tensor.from_numpy-173"><a href="#Tensor.from_numpy-173"><span class="linenos">173</span></a>        <span class="k">if</span> <span class="n">successful_view</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Tensor.from_numpy-174"><a href="#Tensor.from_numpy-174"><span class="linenos">174</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="Tensor.from_numpy-175"><a href="#Tensor.from_numpy-175"><span class="linenos">175</span></a>                <span class="sa">f</span><span class="s2">&quot;Array shape </span><span class="si">{</span><span class="n">original_shape</span><span class="si">}</span><span class="s2"> does not map to axes </span><span class="si">{</span><span class="n">dims</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="Tensor.from_numpy-176"><a href="#Tensor.from_numpy-176"><span class="linenos">176</span></a>            <span class="p">)</span>
</span><span id="Tensor.from_numpy-177"><a href="#Tensor.from_numpy-177"><span class="linenos">177</span></a>
</span><span id="Tensor.from_numpy-178"><a href="#Tensor.from_numpy-178"><span class="linenos">178</span></a>        <span class="k">return</span> <span class="n">Tensor</span><span class="p">(</span><span class="n">successful_view</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">id</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">axis_infos</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>create a <code><a href="#Tensor">Tensor</a></code> from a numpy array</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>array:</strong>  the nd numpy array</li>
<li><strong>axes:</strong>  A description of the array's axes,
if None axes are guessed (which might fail and raise a ValueError.)</li>
</ul>

<h6 id="raises">Raises:</h6>

<ul>
<li><strong>ValueError:</strong>  if <code>axes</code> is None and axes guessing fails.</li>
</ul>
</div>


                            </div>
                            <div id="Tensor.data" class="classattr">
                                        <input id="Tensor.data-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">data</span>

                <label class="view-source-button" for="Tensor.data-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Tensor.data"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Tensor.data-180"><a href="#Tensor.data-180"><span class="linenos">180</span></a>    <span class="nd">@property</span>
</span><span id="Tensor.data-181"><a href="#Tensor.data-181"><span class="linenos">181</span></a>    <span class="k">def</span> <span class="nf">data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Tensor.data-182"><a href="#Tensor.data-182"><span class="linenos">182</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span>
</span></pre></div>


    

                            </div>
                            <div id="Tensor.dims" class="classattr">
                                        <input id="Tensor.dims-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">dims</span>

                <label class="view-source-button" for="Tensor.dims-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Tensor.dims"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Tensor.dims-184"><a href="#Tensor.dims-184"><span class="linenos">184</span></a>    <span class="nd">@property</span>
</span><span id="Tensor.dims-185"><a href="#Tensor.dims-185"><span class="linenos">185</span></a>    <span class="k">def</span> <span class="nf">dims</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># TODO: rename to `axes`?</span>
</span><span id="Tensor.dims-186"><a href="#Tensor.dims-186"><span class="linenos">186</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Tuple of dimension names associated with this tensor.&quot;&quot;&quot;</span>
</span><span id="Tensor.dims-187"><a href="#Tensor.dims-187"><span class="linenos">187</span></a>        <span class="k">return</span> <span class="n">cast</span><span class="p">(</span><span class="n">Tuple</span><span class="p">[</span><span class="n">AxisId</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">dims</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Tuple of dimension names associated with this tensor.</p>
</div>


                            </div>
                            <div id="Tensor.tagged_shape" class="classattr">
                                        <input id="Tensor.tagged_shape-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">tagged_shape</span>

                <label class="view-source-button" for="Tensor.tagged_shape-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Tensor.tagged_shape"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Tensor.tagged_shape-189"><a href="#Tensor.tagged_shape-189"><span class="linenos">189</span></a>    <span class="nd">@property</span>
</span><span id="Tensor.tagged_shape-190"><a href="#Tensor.tagged_shape-190"><span class="linenos">190</span></a>    <span class="k">def</span> <span class="nf">tagged_shape</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Tensor.tagged_shape-191"><a href="#Tensor.tagged_shape-191"><span class="linenos">191</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;(alias for `sizes`) Ordered, immutable mapping from axis ids to lengths.&quot;&quot;&quot;</span>
</span><span id="Tensor.tagged_shape-192"><a href="#Tensor.tagged_shape-192"><span class="linenos">192</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sizes</span>
</span></pre></div>


            <div class="docstring"><p>(alias for <code><a href="#Tensor.sizes">sizes</a></code>) Ordered, immutable mapping from axis ids to lengths.</p>
</div>


                            </div>
                            <div id="Tensor.shape_tuple" class="classattr">
                                        <input id="Tensor.shape_tuple-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">shape_tuple</span>

                <label class="view-source-button" for="Tensor.shape_tuple-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Tensor.shape_tuple"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Tensor.shape_tuple-194"><a href="#Tensor.shape_tuple-194"><span class="linenos">194</span></a>    <span class="nd">@property</span>
</span><span id="Tensor.shape_tuple-195"><a href="#Tensor.shape_tuple-195"><span class="linenos">195</span></a>    <span class="k">def</span> <span class="nf">shape_tuple</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Tensor.shape_tuple-196"><a href="#Tensor.shape_tuple-196"><span class="linenos">196</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Tuple of tensor axes lengths&quot;&quot;&quot;</span>
</span><span id="Tensor.shape_tuple-197"><a href="#Tensor.shape_tuple-197"><span class="linenos">197</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">shape</span>
</span></pre></div>


            <div class="docstring"><p>Tuple of tensor axes lengths</p>
</div>


                            </div>
                            <div id="Tensor.size" class="classattr">
                                        <input id="Tensor.size-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">size</span>

                <label class="view-source-button" for="Tensor.size-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Tensor.size"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Tensor.size-199"><a href="#Tensor.size-199"><span class="linenos">199</span></a>    <span class="nd">@property</span>
</span><span id="Tensor.size-200"><a href="#Tensor.size-200"><span class="linenos">200</span></a>    <span class="k">def</span> <span class="nf">size</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Tensor.size-201"><a href="#Tensor.size-201"><span class="linenos">201</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Number of elements in the tensor.</span>
</span><span id="Tensor.size-202"><a href="#Tensor.size-202"><span class="linenos">202</span></a>
</span><span id="Tensor.size-203"><a href="#Tensor.size-203"><span class="linenos">203</span></a><span class="sd">        Equal to math.prod(tensor.shape), i.e., the product of the tensors’ dimensions.</span>
</span><span id="Tensor.size-204"><a href="#Tensor.size-204"><span class="linenos">204</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Tensor.size-205"><a href="#Tensor.size-205"><span class="linenos">205</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">size</span>
</span></pre></div>


            <div class="docstring"><p>Number of elements in the tensor.</p>

<p>Equal to math.prod(tensor.shape), i.e., the product of the tensors’ dimensions.</p>
</div>


                            </div>
                            <div id="Tensor.sum" class="classattr">
                                        <input id="Tensor.sum-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">sum</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">dim</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n"><a href="#AxisId">AxisId</a></span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="n"><a href="#AxisId">AxisId</a></span><span class="p">],</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n">Self</span>:</span></span>

                <label class="view-source-button" for="Tensor.sum-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Tensor.sum"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Tensor.sum-207"><a href="#Tensor.sum-207"><span class="linenos">207</span></a>    <span class="k">def</span> <span class="nf">sum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dim</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">AxisId</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">AxisId</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
</span><span id="Tensor.sum-208"><a href="#Tensor.sum-208"><span class="linenos">208</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Reduce this Tensor&#39;s data by applying sum along some dimension(s).&quot;&quot;&quot;</span>
</span><span id="Tensor.sum-209"><a href="#Tensor.sum-209"><span class="linenos">209</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="n">from_xarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="n">dim</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>Reduce this Tensor's data by applying sum along some dimension(s).</p>
</div>


                            </div>
                            <div id="Tensor.ndim" class="classattr">
                                        <input id="Tensor.ndim-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">ndim</span>

                <label class="view-source-button" for="Tensor.ndim-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Tensor.ndim"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Tensor.ndim-211"><a href="#Tensor.ndim-211"><span class="linenos">211</span></a>    <span class="nd">@property</span>
</span><span id="Tensor.ndim-212"><a href="#Tensor.ndim-212"><span class="linenos">212</span></a>    <span class="k">def</span> <span class="nf">ndim</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Tensor.ndim-213"><a href="#Tensor.ndim-213"><span class="linenos">213</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Number of tensor dimensions.&quot;&quot;&quot;</span>
</span><span id="Tensor.ndim-214"><a href="#Tensor.ndim-214"><span class="linenos">214</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">ndim</span>
</span></pre></div>


            <div class="docstring"><p>Number of tensor dimensions.</p>
</div>


                            </div>
                            <div id="Tensor.dtype" class="classattr">
                                        <input id="Tensor.dtype-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">dtype</span><span class="annotation">: Literal[&#39;bool&#39;, &#39;float32&#39;, &#39;float64&#39;, &#39;int8&#39;, &#39;int16&#39;, &#39;int32&#39;, &#39;int64&#39;, &#39;uint8&#39;, &#39;uint16&#39;, &#39;uint32&#39;, &#39;uint64&#39;]</span>

                <label class="view-source-button" for="Tensor.dtype-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Tensor.dtype"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Tensor.dtype-216"><a href="#Tensor.dtype-216"><span class="linenos">216</span></a>    <span class="nd">@property</span>
</span><span id="Tensor.dtype-217"><a href="#Tensor.dtype-217"><span class="linenos">217</span></a>    <span class="k">def</span> <span class="nf">dtype</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DTypeStr</span><span class="p">:</span>
</span><span id="Tensor.dtype-218"><a href="#Tensor.dtype-218"><span class="linenos">218</span></a>        <span class="n">dt</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>  <span class="c1"># pyright: ignore[reportUnknownArgumentType]</span>
</span><span id="Tensor.dtype-219"><a href="#Tensor.dtype-219"><span class="linenos">219</span></a>        <span class="k">assert</span> <span class="n">dt</span> <span class="ow">in</span> <span class="n">get_args</span><span class="p">(</span><span class="n">DTypeStr</span><span class="p">)</span>
</span><span id="Tensor.dtype-220"><a href="#Tensor.dtype-220"><span class="linenos">220</span></a>        <span class="k">return</span> <span class="n">dt</span>  <span class="c1"># pyright: ignore[reportReturnType]</span>
</span></pre></div>


    

                            </div>
                            <div id="Tensor.sizes" class="classattr">
                                        <input id="Tensor.sizes-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">sizes</span>

                <label class="view-source-button" for="Tensor.sizes-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Tensor.sizes"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Tensor.sizes-222"><a href="#Tensor.sizes-222"><span class="linenos">222</span></a>    <span class="nd">@property</span>
</span><span id="Tensor.sizes-223"><a href="#Tensor.sizes-223"><span class="linenos">223</span></a>    <span class="k">def</span> <span class="nf">sizes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Tensor.sizes-224"><a href="#Tensor.sizes-224"><span class="linenos">224</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Ordered, immutable mapping from axis ids to axis lengths.&quot;&quot;&quot;</span>
</span><span id="Tensor.sizes-225"><a href="#Tensor.sizes-225"><span class="linenos">225</span></a>        <span class="k">return</span> <span class="n">cast</span><span class="p">(</span><span class="n">Mapping</span><span class="p">[</span><span class="n">AxisId</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">sizes</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Ordered, immutable mapping from axis ids to axis lengths.</p>
</div>


                            </div>
                            <div id="Tensor.astype" class="classattr">
                                        <input id="Tensor.astype-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">astype</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">dtype</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;bool&#39;</span><span class="p">,</span> <span class="s1">&#39;float32&#39;</span><span class="p">,</span> <span class="s1">&#39;float64&#39;</span><span class="p">,</span> <span class="s1">&#39;int8&#39;</span><span class="p">,</span> <span class="s1">&#39;int16&#39;</span><span class="p">,</span> <span class="s1">&#39;int32&#39;</span><span class="p">,</span> <span class="s1">&#39;int64&#39;</span><span class="p">,</span> <span class="s1">&#39;uint8&#39;</span><span class="p">,</span> <span class="s1">&#39;uint16&#39;</span><span class="p">,</span> <span class="s1">&#39;uint32&#39;</span><span class="p">,</span> <span class="s1">&#39;uint64&#39;</span><span class="p">]</span>,</span><span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">copy</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Tensor.astype-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Tensor.astype"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Tensor.astype-227"><a href="#Tensor.astype-227"><span class="linenos">227</span></a>    <span class="k">def</span> <span class="nf">astype</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">DTypeStr</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">copy</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
</span><span id="Tensor.astype-228"><a href="#Tensor.astype-228"><span class="linenos">228</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return tensor cast to `dtype`</span>
</span><span id="Tensor.astype-229"><a href="#Tensor.astype-229"><span class="linenos">229</span></a>
</span><span id="Tensor.astype-230"><a href="#Tensor.astype-230"><span class="linenos">230</span></a><span class="sd">        note: if dtype is already satisfied copy if `copy`&quot;&quot;&quot;</span>
</span><span id="Tensor.astype-231"><a href="#Tensor.astype-231"><span class="linenos">231</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="n">from_xarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">dtype</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="n">copy</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>Return tensor cast to <code><a href="#Tensor.dtype">dtype</a></code></p>

<p>note: if dtype is already satisfied copy if <code>copy</code></p>
</div>


                            </div>
                            <div id="Tensor.clip" class="classattr">
                                        <input id="Tensor.clip-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">clip</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="nb">min</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>, </span><span class="param"><span class="nb">max</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Tensor.clip-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Tensor.clip"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Tensor.clip-233"><a href="#Tensor.clip-233"><span class="linenos">233</span></a>    <span class="k">def</span> <span class="nf">clip</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">min</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="nb">max</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="Tensor.clip-234"><a href="#Tensor.clip-234"><span class="linenos">234</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a tensor whose values are limited to [min, max].</span>
</span><span id="Tensor.clip-235"><a href="#Tensor.clip-235"><span class="linenos">235</span></a><span class="sd">        At least one of max or min must be given.&quot;&quot;&quot;</span>
</span><span id="Tensor.clip-236"><a href="#Tensor.clip-236"><span class="linenos">236</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="n">from_xarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="nb">min</span><span class="p">,</span> <span class="nb">max</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>Return a tensor whose values are limited to [min, max].
At least one of max or min must be given.</p>
</div>


                            </div>
                            <div id="Tensor.crop_to" class="classattr">
                                        <input id="Tensor.crop_to-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">crop_to</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">sizes</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="n"><a href="#AxisId">AxisId</a></span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span>,</span><span class="param">	<span class="n">crop_where</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="s1">&#39;left_and_right&#39;</span><span class="p">],</span> <span class="n">Mapping</span><span class="p">[</span><span class="n"><a href="#AxisId">AxisId</a></span><span class="p">,</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="s1">&#39;left_and_right&#39;</span><span class="p">]]]</span> <span class="o">=</span> <span class="s1">&#39;left_and_right&#39;</span></span><span class="return-annotation">) -> <span class="n">Self</span>:</span></span>

                <label class="view-source-button" for="Tensor.crop_to-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Tensor.crop_to"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Tensor.crop_to-238"><a href="#Tensor.crop_to-238"><span class="linenos">238</span></a>    <span class="k">def</span> <span class="nf">crop_to</span><span class="p">(</span>
</span><span id="Tensor.crop_to-239"><a href="#Tensor.crop_to-239"><span class="linenos">239</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="Tensor.crop_to-240"><a href="#Tensor.crop_to-240"><span class="linenos">240</span></a>        <span class="n">sizes</span><span class="p">:</span> <span class="n">PerAxis</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span>
</span><span id="Tensor.crop_to-241"><a href="#Tensor.crop_to-241"><span class="linenos">241</span></a>        <span class="n">crop_where</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span>
</span><span id="Tensor.crop_to-242"><a href="#Tensor.crop_to-242"><span class="linenos">242</span></a>            <span class="n">CropWhere</span><span class="p">,</span>
</span><span id="Tensor.crop_to-243"><a href="#Tensor.crop_to-243"><span class="linenos">243</span></a>            <span class="n">PerAxis</span><span class="p">[</span><span class="n">CropWhere</span><span class="p">],</span>
</span><span id="Tensor.crop_to-244"><a href="#Tensor.crop_to-244"><span class="linenos">244</span></a>        <span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;left_and_right&quot;</span><span class="p">,</span>
</span><span id="Tensor.crop_to-245"><a href="#Tensor.crop_to-245"><span class="linenos">245</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
</span><span id="Tensor.crop_to-246"><a href="#Tensor.crop_to-246"><span class="linenos">246</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;crop to match `sizes`&quot;&quot;&quot;</span>
</span><span id="Tensor.crop_to-247"><a href="#Tensor.crop_to-247"><span class="linenos">247</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">crop_where</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="Tensor.crop_to-248"><a href="#Tensor.crop_to-248"><span class="linenos">248</span></a>            <span class="n">crop_axis_where</span><span class="p">:</span> <span class="n">PerAxis</span><span class="p">[</span><span class="n">CropWhere</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="n">a</span><span class="p">:</span> <span class="n">crop_where</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dims</span><span class="p">}</span>
</span><span id="Tensor.crop_to-249"><a href="#Tensor.crop_to-249"><span class="linenos">249</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Tensor.crop_to-250"><a href="#Tensor.crop_to-250"><span class="linenos">250</span></a>            <span class="n">crop_axis_where</span> <span class="o">=</span> <span class="n">crop_where</span>
</span><span id="Tensor.crop_to-251"><a href="#Tensor.crop_to-251"><span class="linenos">251</span></a>
</span><span id="Tensor.crop_to-252"><a href="#Tensor.crop_to-252"><span class="linenos">252</span></a>        <span class="n">slices</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="n">AxisId</span><span class="p">,</span> <span class="n">SliceInfo</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Tensor.crop_to-253"><a href="#Tensor.crop_to-253"><span class="linenos">253</span></a>
</span><span id="Tensor.crop_to-254"><a href="#Tensor.crop_to-254"><span class="linenos">254</span></a>        <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">s_is</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sizes</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="Tensor.crop_to-255"><a href="#Tensor.crop_to-255"><span class="linenos">255</span></a>            <span class="k">if</span> <span class="n">a</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sizes</span> <span class="ow">or</span> <span class="n">sizes</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">==</span> <span class="n">s_is</span><span class="p">:</span>
</span><span id="Tensor.crop_to-256"><a href="#Tensor.crop_to-256"><span class="linenos">256</span></a>                <span class="k">pass</span>
</span><span id="Tensor.crop_to-257"><a href="#Tensor.crop_to-257"><span class="linenos">257</span></a>            <span class="k">elif</span> <span class="n">sizes</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">s_is</span><span class="p">:</span>
</span><span id="Tensor.crop_to-258"><a href="#Tensor.crop_to-258"><span class="linenos">258</span></a>                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
</span><span id="Tensor.crop_to-259"><a href="#Tensor.crop_to-259"><span class="linenos">259</span></a>                    <span class="s2">&quot;Cannot crop axis </span><span class="si">{}</span><span class="s2"> of size </span><span class="si">{}</span><span class="s2"> to larger size </span><span class="si">{}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="Tensor.crop_to-260"><a href="#Tensor.crop_to-260"><span class="linenos">260</span></a>                    <span class="n">a</span><span class="p">,</span>
</span><span id="Tensor.crop_to-261"><a href="#Tensor.crop_to-261"><span class="linenos">261</span></a>                    <span class="n">s_is</span><span class="p">,</span>
</span><span id="Tensor.crop_to-262"><a href="#Tensor.crop_to-262"><span class="linenos">262</span></a>                    <span class="n">sizes</span><span class="p">[</span><span class="n">a</span><span class="p">],</span>
</span><span id="Tensor.crop_to-263"><a href="#Tensor.crop_to-263"><span class="linenos">263</span></a>                <span class="p">)</span>
</span><span id="Tensor.crop_to-264"><a href="#Tensor.crop_to-264"><span class="linenos">264</span></a>            <span class="k">elif</span> <span class="n">a</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">crop_axis_where</span><span class="p">:</span>
</span><span id="Tensor.crop_to-265"><a href="#Tensor.crop_to-265"><span class="linenos">265</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="Tensor.crop_to-266"><a href="#Tensor.crop_to-266"><span class="linenos">266</span></a>                    <span class="sa">f</span><span class="s2">&quot;Don&#39;t know where to crop axis </span><span class="si">{</span><span class="n">a</span><span class="si">}</span><span class="s2">, `crop_where`=</span><span class="si">{</span><span class="n">crop_where</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="Tensor.crop_to-267"><a href="#Tensor.crop_to-267"><span class="linenos">267</span></a>                <span class="p">)</span>
</span><span id="Tensor.crop_to-268"><a href="#Tensor.crop_to-268"><span class="linenos">268</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Tensor.crop_to-269"><a href="#Tensor.crop_to-269"><span class="linenos">269</span></a>                <span class="n">crop_this_axis_where</span> <span class="o">=</span> <span class="n">crop_axis_where</span><span class="p">[</span><span class="n">a</span><span class="p">]</span>
</span><span id="Tensor.crop_to-270"><a href="#Tensor.crop_to-270"><span class="linenos">270</span></a>                <span class="k">if</span> <span class="n">crop_this_axis_where</span> <span class="o">==</span> <span class="s2">&quot;left&quot;</span><span class="p">:</span>
</span><span id="Tensor.crop_to-271"><a href="#Tensor.crop_to-271"><span class="linenos">271</span></a>                    <span class="n">slices</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="n">SliceInfo</span><span class="p">(</span><span class="n">s_is</span> <span class="o">-</span> <span class="n">sizes</span><span class="p">[</span><span class="n">a</span><span class="p">],</span> <span class="n">s_is</span><span class="p">)</span>
</span><span id="Tensor.crop_to-272"><a href="#Tensor.crop_to-272"><span class="linenos">272</span></a>                <span class="k">elif</span> <span class="n">crop_this_axis_where</span> <span class="o">==</span> <span class="s2">&quot;right&quot;</span><span class="p">:</span>
</span><span id="Tensor.crop_to-273"><a href="#Tensor.crop_to-273"><span class="linenos">273</span></a>                    <span class="n">slices</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="n">SliceInfo</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">sizes</span><span class="p">[</span><span class="n">a</span><span class="p">])</span>
</span><span id="Tensor.crop_to-274"><a href="#Tensor.crop_to-274"><span class="linenos">274</span></a>                <span class="k">elif</span> <span class="n">crop_this_axis_where</span> <span class="o">==</span> <span class="s2">&quot;left_and_right&quot;</span><span class="p">:</span>
</span><span id="Tensor.crop_to-275"><a href="#Tensor.crop_to-275"><span class="linenos">275</span></a>                    <span class="n">slices</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="n">SliceInfo</span><span class="p">(</span>
</span><span id="Tensor.crop_to-276"><a href="#Tensor.crop_to-276"><span class="linenos">276</span></a>                        <span class="n">start</span> <span class="o">:=</span> <span class="p">(</span><span class="n">s_is</span> <span class="o">-</span> <span class="n">sizes</span><span class="p">[</span><span class="n">a</span><span class="p">])</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="n">sizes</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">+</span> <span class="n">start</span>
</span><span id="Tensor.crop_to-277"><a href="#Tensor.crop_to-277"><span class="linenos">277</span></a>                    <span class="p">)</span>
</span><span id="Tensor.crop_to-278"><a href="#Tensor.crop_to-278"><span class="linenos">278</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="Tensor.crop_to-279"><a href="#Tensor.crop_to-279"><span class="linenos">279</span></a>                    <span class="n">assert_never</span><span class="p">(</span><span class="n">crop_this_axis_where</span><span class="p">)</span>
</span><span id="Tensor.crop_to-280"><a href="#Tensor.crop_to-280"><span class="linenos">280</span></a>
</span><span id="Tensor.crop_to-281"><a href="#Tensor.crop_to-281"><span class="linenos">281</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="n">slices</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>crop to match <code><a href="#Tensor.sizes">sizes</a></code></p>
</div>


                            </div>
                            <div id="Tensor.expand_dims" class="classattr">
                                        <input id="Tensor.expand_dims-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">expand_dims</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">dims</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="n"><a href="#AxisId">AxisId</a></span><span class="p">],</span> <span class="n">Mapping</span><span class="p">[</span><span class="n"><a href="#AxisId">AxisId</a></span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span></span><span class="return-annotation">) -> <span class="n">Self</span>:</span></span>

                <label class="view-source-button" for="Tensor.expand_dims-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Tensor.expand_dims"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Tensor.expand_dims-283"><a href="#Tensor.expand_dims-283"><span class="linenos">283</span></a>    <span class="k">def</span> <span class="nf">expand_dims</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dims</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="n">AxisId</span><span class="p">],</span> <span class="n">PerAxis</span><span class="p">[</span><span class="nb">int</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
</span><span id="Tensor.expand_dims-284"><a href="#Tensor.expand_dims-284"><span class="linenos">284</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="n">from_xarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">dims</span><span class="o">=</span><span class="n">dims</span><span class="p">))</span>
</span></pre></div>


    

                            </div>
                            <div id="Tensor.mean" class="classattr">
                                        <input id="Tensor.mean-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">mean</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">dim</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n"><a href="#AxisId">AxisId</a></span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="n"><a href="#AxisId">AxisId</a></span><span class="p">],</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n">Self</span>:</span></span>

                <label class="view-source-button" for="Tensor.mean-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Tensor.mean"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Tensor.mean-286"><a href="#Tensor.mean-286"><span class="linenos">286</span></a>    <span class="k">def</span> <span class="nf">mean</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dim</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">AxisId</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">AxisId</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
</span><span id="Tensor.mean-287"><a href="#Tensor.mean-287"><span class="linenos">287</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="n">from_xarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="n">dim</span><span class="p">))</span>
</span></pre></div>


    

                            </div>
                            <div id="Tensor.std" class="classattr">
                                        <input id="Tensor.std-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">std</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">dim</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n"><a href="#AxisId">AxisId</a></span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="n"><a href="#AxisId">AxisId</a></span><span class="p">],</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n">Self</span>:</span></span>

                <label class="view-source-button" for="Tensor.std-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Tensor.std"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Tensor.std-289"><a href="#Tensor.std-289"><span class="linenos">289</span></a>    <span class="k">def</span> <span class="nf">std</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dim</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">AxisId</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">AxisId</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
</span><span id="Tensor.std-290"><a href="#Tensor.std-290"><span class="linenos">290</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="n">from_xarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="n">dim</span><span class="p">))</span>
</span></pre></div>


    

                            </div>
                            <div id="Tensor.var" class="classattr">
                                        <input id="Tensor.var-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">var</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">dim</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n"><a href="#AxisId">AxisId</a></span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="n"><a href="#AxisId">AxisId</a></span><span class="p">],</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n">Self</span>:</span></span>

                <label class="view-source-button" for="Tensor.var-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Tensor.var"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Tensor.var-292"><a href="#Tensor.var-292"><span class="linenos">292</span></a>    <span class="k">def</span> <span class="nf">var</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dim</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">AxisId</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">AxisId</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
</span><span id="Tensor.var-293"><a href="#Tensor.var-293"><span class="linenos">293</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="n">from_xarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="n">dim</span><span class="p">))</span>
</span></pre></div>


    

                            </div>
                            <div id="Tensor.pad" class="classattr">
                                        <input id="Tensor.pad-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">pad</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">pad_width</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="n"><a href="#AxisId">AxisId</a></span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="n"><a href="core/common.html#PadWidth">bioimageio.core.common.PadWidth</a></span><span class="p">]]</span>,</span><span class="param">	<span class="n">mode</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;edge&#39;</span><span class="p">,</span> <span class="s1">&#39;reflect&#39;</span><span class="p">,</span> <span class="s1">&#39;symmetric&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;symmetric&#39;</span></span><span class="return-annotation">) -> <span class="n">Self</span>:</span></span>

                <label class="view-source-button" for="Tensor.pad-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Tensor.pad"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Tensor.pad-295"><a href="#Tensor.pad-295"><span class="linenos">295</span></a>    <span class="k">def</span> <span class="nf">pad</span><span class="p">(</span>
</span><span id="Tensor.pad-296"><a href="#Tensor.pad-296"><span class="linenos">296</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="Tensor.pad-297"><a href="#Tensor.pad-297"><span class="linenos">297</span></a>        <span class="n">pad_width</span><span class="p">:</span> <span class="n">PerAxis</span><span class="p">[</span><span class="n">PadWidthLike</span><span class="p">],</span>
</span><span id="Tensor.pad-298"><a href="#Tensor.pad-298"><span class="linenos">298</span></a>        <span class="n">mode</span><span class="p">:</span> <span class="n">PadMode</span> <span class="o">=</span> <span class="s2">&quot;symmetric&quot;</span><span class="p">,</span>
</span><span id="Tensor.pad-299"><a href="#Tensor.pad-299"><span class="linenos">299</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
</span><span id="Tensor.pad-300"><a href="#Tensor.pad-300"><span class="linenos">300</span></a>        <span class="n">pad_width</span> <span class="o">=</span> <span class="p">{</span><span class="n">a</span><span class="p">:</span> <span class="n">PadWidth</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">pad_width</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
</span><span id="Tensor.pad-301"><a href="#Tensor.pad-301"><span class="linenos">301</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="n">from_xarray</span><span class="p">(</span>
</span><span id="Tensor.pad-302"><a href="#Tensor.pad-302"><span class="linenos">302</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span><span class="n">pad_width</span><span class="o">=</span><span class="n">pad_width</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">)</span>
</span><span id="Tensor.pad-303"><a href="#Tensor.pad-303"><span class="linenos">303</span></a>        <span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="Tensor.pad_to" class="classattr">
                                        <input id="Tensor.pad_to-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">pad_to</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">sizes</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="n"><a href="#AxisId">AxisId</a></span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span>,</span><span class="param">	<span class="n">pad_where</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="s1">&#39;left_and_right&#39;</span><span class="p">],</span> <span class="n">Mapping</span><span class="p">[</span><span class="n"><a href="#AxisId">AxisId</a></span><span class="p">,</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="s1">&#39;left_and_right&#39;</span><span class="p">]]]</span> <span class="o">=</span> <span class="s1">&#39;left_and_right&#39;</span>,</span><span class="param">	<span class="n">mode</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;edge&#39;</span><span class="p">,</span> <span class="s1">&#39;reflect&#39;</span><span class="p">,</span> <span class="s1">&#39;symmetric&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;symmetric&#39;</span></span><span class="return-annotation">) -> <span class="n">Self</span>:</span></span>

                <label class="view-source-button" for="Tensor.pad_to-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Tensor.pad_to"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Tensor.pad_to-305"><a href="#Tensor.pad_to-305"><span class="linenos">305</span></a>    <span class="k">def</span> <span class="nf">pad_to</span><span class="p">(</span>
</span><span id="Tensor.pad_to-306"><a href="#Tensor.pad_to-306"><span class="linenos">306</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="Tensor.pad_to-307"><a href="#Tensor.pad_to-307"><span class="linenos">307</span></a>        <span class="n">sizes</span><span class="p">:</span> <span class="n">PerAxis</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span>
</span><span id="Tensor.pad_to-308"><a href="#Tensor.pad_to-308"><span class="linenos">308</span></a>        <span class="n">pad_where</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">PadWhere</span><span class="p">,</span> <span class="n">PerAxis</span><span class="p">[</span><span class="n">PadWhere</span><span class="p">]]</span> <span class="o">=</span> <span class="s2">&quot;left_and_right&quot;</span><span class="p">,</span>
</span><span id="Tensor.pad_to-309"><a href="#Tensor.pad_to-309"><span class="linenos">309</span></a>        <span class="n">mode</span><span class="p">:</span> <span class="n">PadMode</span> <span class="o">=</span> <span class="s2">&quot;symmetric&quot;</span><span class="p">,</span>
</span><span id="Tensor.pad_to-310"><a href="#Tensor.pad_to-310"><span class="linenos">310</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
</span><span id="Tensor.pad_to-311"><a href="#Tensor.pad_to-311"><span class="linenos">311</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;pad `tensor` to match `sizes`&quot;&quot;&quot;</span>
</span><span id="Tensor.pad_to-312"><a href="#Tensor.pad_to-312"><span class="linenos">312</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pad_where</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="Tensor.pad_to-313"><a href="#Tensor.pad_to-313"><span class="linenos">313</span></a>            <span class="n">pad_axis_where</span><span class="p">:</span> <span class="n">PerAxis</span><span class="p">[</span><span class="n">PadWhere</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="n">a</span><span class="p">:</span> <span class="n">pad_where</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dims</span><span class="p">}</span>
</span><span id="Tensor.pad_to-314"><a href="#Tensor.pad_to-314"><span class="linenos">314</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Tensor.pad_to-315"><a href="#Tensor.pad_to-315"><span class="linenos">315</span></a>            <span class="n">pad_axis_where</span> <span class="o">=</span> <span class="n">pad_where</span>
</span><span id="Tensor.pad_to-316"><a href="#Tensor.pad_to-316"><span class="linenos">316</span></a>
</span><span id="Tensor.pad_to-317"><a href="#Tensor.pad_to-317"><span class="linenos">317</span></a>        <span class="n">pad_width</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="n">AxisId</span><span class="p">,</span> <span class="n">PadWidth</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Tensor.pad_to-318"><a href="#Tensor.pad_to-318"><span class="linenos">318</span></a>        <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">s_is</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sizes</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="Tensor.pad_to-319"><a href="#Tensor.pad_to-319"><span class="linenos">319</span></a>            <span class="k">if</span> <span class="n">a</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sizes</span> <span class="ow">or</span> <span class="n">sizes</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">==</span> <span class="n">s_is</span><span class="p">:</span>
</span><span id="Tensor.pad_to-320"><a href="#Tensor.pad_to-320"><span class="linenos">320</span></a>                <span class="n">pad_width</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="n">PadWidth</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="Tensor.pad_to-321"><a href="#Tensor.pad_to-321"><span class="linenos">321</span></a>            <span class="k">elif</span> <span class="n">s_is</span> <span class="o">&gt;</span> <span class="n">sizes</span><span class="p">[</span><span class="n">a</span><span class="p">]:</span>
</span><span id="Tensor.pad_to-322"><a href="#Tensor.pad_to-322"><span class="linenos">322</span></a>                <span class="n">pad_width</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="n">PadWidth</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="Tensor.pad_to-323"><a href="#Tensor.pad_to-323"><span class="linenos">323</span></a>                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
</span><span id="Tensor.pad_to-324"><a href="#Tensor.pad_to-324"><span class="linenos">324</span></a>                    <span class="s2">&quot;Cannot pad axis </span><span class="si">{}</span><span class="s2"> of size </span><span class="si">{}</span><span class="s2"> to smaller size </span><span class="si">{}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="Tensor.pad_to-325"><a href="#Tensor.pad_to-325"><span class="linenos">325</span></a>                    <span class="n">a</span><span class="p">,</span>
</span><span id="Tensor.pad_to-326"><a href="#Tensor.pad_to-326"><span class="linenos">326</span></a>                    <span class="n">s_is</span><span class="p">,</span>
</span><span id="Tensor.pad_to-327"><a href="#Tensor.pad_to-327"><span class="linenos">327</span></a>                    <span class="n">sizes</span><span class="p">[</span><span class="n">a</span><span class="p">],</span>
</span><span id="Tensor.pad_to-328"><a href="#Tensor.pad_to-328"><span class="linenos">328</span></a>                <span class="p">)</span>
</span><span id="Tensor.pad_to-329"><a href="#Tensor.pad_to-329"><span class="linenos">329</span></a>            <span class="k">elif</span> <span class="n">a</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">pad_axis_where</span><span class="p">:</span>
</span><span id="Tensor.pad_to-330"><a href="#Tensor.pad_to-330"><span class="linenos">330</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="Tensor.pad_to-331"><a href="#Tensor.pad_to-331"><span class="linenos">331</span></a>                    <span class="sa">f</span><span class="s2">&quot;Don&#39;t know where to pad axis </span><span class="si">{</span><span class="n">a</span><span class="si">}</span><span class="s2">, `pad_where`=</span><span class="si">{</span><span class="n">pad_where</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="Tensor.pad_to-332"><a href="#Tensor.pad_to-332"><span class="linenos">332</span></a>                <span class="p">)</span>
</span><span id="Tensor.pad_to-333"><a href="#Tensor.pad_to-333"><span class="linenos">333</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Tensor.pad_to-334"><a href="#Tensor.pad_to-334"><span class="linenos">334</span></a>                <span class="n">pad_this_axis_where</span> <span class="o">=</span> <span class="n">pad_axis_where</span><span class="p">[</span><span class="n">a</span><span class="p">]</span>
</span><span id="Tensor.pad_to-335"><a href="#Tensor.pad_to-335"><span class="linenos">335</span></a>                <span class="n">d</span> <span class="o">=</span> <span class="n">sizes</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">-</span> <span class="n">s_is</span>
</span><span id="Tensor.pad_to-336"><a href="#Tensor.pad_to-336"><span class="linenos">336</span></a>                <span class="k">if</span> <span class="n">pad_this_axis_where</span> <span class="o">==</span> <span class="s2">&quot;left&quot;</span><span class="p">:</span>
</span><span id="Tensor.pad_to-337"><a href="#Tensor.pad_to-337"><span class="linenos">337</span></a>                    <span class="n">pad_width</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="n">PadWidth</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="Tensor.pad_to-338"><a href="#Tensor.pad_to-338"><span class="linenos">338</span></a>                <span class="k">elif</span> <span class="n">pad_this_axis_where</span> <span class="o">==</span> <span class="s2">&quot;right&quot;</span><span class="p">:</span>
</span><span id="Tensor.pad_to-339"><a href="#Tensor.pad_to-339"><span class="linenos">339</span></a>                    <span class="n">pad_width</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="n">PadWidth</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
</span><span id="Tensor.pad_to-340"><a href="#Tensor.pad_to-340"><span class="linenos">340</span></a>                <span class="k">elif</span> <span class="n">pad_this_axis_where</span> <span class="o">==</span> <span class="s2">&quot;left_and_right&quot;</span><span class="p">:</span>
</span><span id="Tensor.pad_to-341"><a href="#Tensor.pad_to-341"><span class="linenos">341</span></a>                    <span class="n">pad_width</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="n">PadWidth</span><span class="p">(</span><span class="n">left</span> <span class="o">:=</span> <span class="n">d</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="n">d</span> <span class="o">-</span> <span class="n">left</span><span class="p">)</span>
</span><span id="Tensor.pad_to-342"><a href="#Tensor.pad_to-342"><span class="linenos">342</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="Tensor.pad_to-343"><a href="#Tensor.pad_to-343"><span class="linenos">343</span></a>                    <span class="n">assert_never</span><span class="p">(</span><span class="n">pad_this_axis_where</span><span class="p">)</span>
</span><span id="Tensor.pad_to-344"><a href="#Tensor.pad_to-344"><span class="linenos">344</span></a>
</span><span id="Tensor.pad_to-345"><a href="#Tensor.pad_to-345"><span class="linenos">345</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span><span class="n">pad_width</span><span class="p">,</span> <span class="n">mode</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>pad <code>tensor</code> to match <code><a href="#Tensor.sizes">sizes</a></code></p>
</div>


                            </div>
                            <div id="Tensor.quantile" class="classattr">
                                        <input id="Tensor.quantile-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">quantile</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">q</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span>,</span><span class="param">	<span class="n">dim</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n"><a href="#AxisId">AxisId</a></span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="n"><a href="#AxisId">AxisId</a></span><span class="p">],</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n">Self</span>:</span></span>

                <label class="view-source-button" for="Tensor.quantile-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Tensor.quantile"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Tensor.quantile-347"><a href="#Tensor.quantile-347"><span class="linenos">347</span></a>    <span class="k">def</span> <span class="nf">quantile</span><span class="p">(</span>
</span><span id="Tensor.quantile-348"><a href="#Tensor.quantile-348"><span class="linenos">348</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="Tensor.quantile-349"><a href="#Tensor.quantile-349"><span class="linenos">349</span></a>        <span class="n">q</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]],</span>
</span><span id="Tensor.quantile-350"><a href="#Tensor.quantile-350"><span class="linenos">350</span></a>        <span class="n">dim</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">AxisId</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">AxisId</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Tensor.quantile-351"><a href="#Tensor.quantile-351"><span class="linenos">351</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
</span><span id="Tensor.quantile-352"><a href="#Tensor.quantile-352"><span class="linenos">352</span></a>        <span class="k">assert</span> <span class="p">(</span>
</span><span id="Tensor.quantile-353"><a href="#Tensor.quantile-353"><span class="linenos">353</span></a>            <span class="nb">isinstance</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">))</span>
</span><span id="Tensor.quantile-354"><a href="#Tensor.quantile-354"><span class="linenos">354</span></a>            <span class="ow">and</span> <span class="n">q</span> <span class="o">&gt;=</span> <span class="mf">0.0</span>
</span><span id="Tensor.quantile-355"><a href="#Tensor.quantile-355"><span class="linenos">355</span></a>            <span class="ow">or</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">))</span>
</span><span id="Tensor.quantile-356"><a href="#Tensor.quantile-356"><span class="linenos">356</span></a>            <span class="ow">and</span> <span class="nb">all</span><span class="p">(</span><span class="n">qq</span> <span class="o">&gt;=</span> <span class="mf">0.0</span> <span class="k">for</span> <span class="n">qq</span> <span class="ow">in</span> <span class="n">q</span><span class="p">)</span>
</span><span id="Tensor.quantile-357"><a href="#Tensor.quantile-357"><span class="linenos">357</span></a>        <span class="p">)</span>
</span><span id="Tensor.quantile-358"><a href="#Tensor.quantile-358"><span class="linenos">358</span></a>        <span class="k">assert</span> <span class="p">(</span>
</span><span id="Tensor.quantile-359"><a href="#Tensor.quantile-359"><span class="linenos">359</span></a>            <span class="nb">isinstance</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">))</span>
</span><span id="Tensor.quantile-360"><a href="#Tensor.quantile-360"><span class="linenos">360</span></a>            <span class="ow">and</span> <span class="n">q</span> <span class="o">&lt;=</span> <span class="mf">1.0</span>
</span><span id="Tensor.quantile-361"><a href="#Tensor.quantile-361"><span class="linenos">361</span></a>            <span class="ow">or</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">))</span>
</span><span id="Tensor.quantile-362"><a href="#Tensor.quantile-362"><span class="linenos">362</span></a>            <span class="ow">and</span> <span class="nb">all</span><span class="p">(</span><span class="n">qq</span> <span class="o">&lt;=</span> <span class="mf">1.0</span> <span class="k">for</span> <span class="n">qq</span> <span class="ow">in</span> <span class="n">q</span><span class="p">)</span>
</span><span id="Tensor.quantile-363"><a href="#Tensor.quantile-363"><span class="linenos">363</span></a>        <span class="p">)</span>
</span><span id="Tensor.quantile-364"><a href="#Tensor.quantile-364"><span class="linenos">364</span></a>        <span class="k">assert</span> <span class="n">dim</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="p">(</span>
</span><span id="Tensor.quantile-365"><a href="#Tensor.quantile-365"><span class="linenos">365</span></a>            <span class="p">(</span><span class="n">quantile_dim</span> <span class="o">:=</span> <span class="n">AxisId</span><span class="p">(</span><span class="s2">&quot;quantile&quot;</span><span class="p">))</span> <span class="o">!=</span> <span class="n">dim</span> <span class="ow">and</span> <span class="n">quantile_dim</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">(</span><span class="n">dim</span><span class="p">)</span>
</span><span id="Tensor.quantile-366"><a href="#Tensor.quantile-366"><span class="linenos">366</span></a>        <span class="p">)</span>
</span><span id="Tensor.quantile-367"><a href="#Tensor.quantile-367"><span class="linenos">367</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="n">from_xarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="n">dim</span><span class="p">))</span>
</span></pre></div>


    

                            </div>
                            <div id="Tensor.resize_to" class="classattr">
                                        <input id="Tensor.resize_to-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">resize_to</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">sizes</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="n"><a href="#AxisId">AxisId</a></span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span>,</span><span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">pad_where</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="s1">&#39;left_and_right&#39;</span><span class="p">],</span> <span class="n">Mapping</span><span class="p">[</span><span class="n"><a href="#AxisId">AxisId</a></span><span class="p">,</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="s1">&#39;left_and_right&#39;</span><span class="p">]]]</span> <span class="o">=</span> <span class="s1">&#39;left_and_right&#39;</span>,</span><span class="param">	<span class="n">crop_where</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="s1">&#39;left_and_right&#39;</span><span class="p">],</span> <span class="n">Mapping</span><span class="p">[</span><span class="n"><a href="#AxisId">AxisId</a></span><span class="p">,</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="s1">&#39;left_and_right&#39;</span><span class="p">]]]</span> <span class="o">=</span> <span class="s1">&#39;left_and_right&#39;</span>,</span><span class="param">	<span class="n">pad_mode</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;edge&#39;</span><span class="p">,</span> <span class="s1">&#39;reflect&#39;</span><span class="p">,</span> <span class="s1">&#39;symmetric&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;symmetric&#39;</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Tensor.resize_to-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Tensor.resize_to"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Tensor.resize_to-369"><a href="#Tensor.resize_to-369"><span class="linenos">369</span></a>    <span class="k">def</span> <span class="nf">resize_to</span><span class="p">(</span>
</span><span id="Tensor.resize_to-370"><a href="#Tensor.resize_to-370"><span class="linenos">370</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="Tensor.resize_to-371"><a href="#Tensor.resize_to-371"><span class="linenos">371</span></a>        <span class="n">sizes</span><span class="p">:</span> <span class="n">PerAxis</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span>
</span><span id="Tensor.resize_to-372"><a href="#Tensor.resize_to-372"><span class="linenos">372</span></a>        <span class="o">*</span><span class="p">,</span>
</span><span id="Tensor.resize_to-373"><a href="#Tensor.resize_to-373"><span class="linenos">373</span></a>        <span class="n">pad_where</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span>
</span><span id="Tensor.resize_to-374"><a href="#Tensor.resize_to-374"><span class="linenos">374</span></a>            <span class="n">PadWhere</span><span class="p">,</span>
</span><span id="Tensor.resize_to-375"><a href="#Tensor.resize_to-375"><span class="linenos">375</span></a>            <span class="n">PerAxis</span><span class="p">[</span><span class="n">PadWhere</span><span class="p">],</span>
</span><span id="Tensor.resize_to-376"><a href="#Tensor.resize_to-376"><span class="linenos">376</span></a>        <span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;left_and_right&quot;</span><span class="p">,</span>
</span><span id="Tensor.resize_to-377"><a href="#Tensor.resize_to-377"><span class="linenos">377</span></a>        <span class="n">crop_where</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span>
</span><span id="Tensor.resize_to-378"><a href="#Tensor.resize_to-378"><span class="linenos">378</span></a>            <span class="n">CropWhere</span><span class="p">,</span>
</span><span id="Tensor.resize_to-379"><a href="#Tensor.resize_to-379"><span class="linenos">379</span></a>            <span class="n">PerAxis</span><span class="p">[</span><span class="n">CropWhere</span><span class="p">],</span>
</span><span id="Tensor.resize_to-380"><a href="#Tensor.resize_to-380"><span class="linenos">380</span></a>        <span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;left_and_right&quot;</span><span class="p">,</span>
</span><span id="Tensor.resize_to-381"><a href="#Tensor.resize_to-381"><span class="linenos">381</span></a>        <span class="n">pad_mode</span><span class="p">:</span> <span class="n">PadMode</span> <span class="o">=</span> <span class="s2">&quot;symmetric&quot;</span><span class="p">,</span>
</span><span id="Tensor.resize_to-382"><a href="#Tensor.resize_to-382"><span class="linenos">382</span></a>    <span class="p">):</span>
</span><span id="Tensor.resize_to-383"><a href="#Tensor.resize_to-383"><span class="linenos">383</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;return cropped/padded tensor with `sizes`&quot;&quot;&quot;</span>
</span><span id="Tensor.resize_to-384"><a href="#Tensor.resize_to-384"><span class="linenos">384</span></a>        <span class="n">crop_to_sizes</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="n">AxisId</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Tensor.resize_to-385"><a href="#Tensor.resize_to-385"><span class="linenos">385</span></a>        <span class="n">pad_to_sizes</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="n">AxisId</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Tensor.resize_to-386"><a href="#Tensor.resize_to-386"><span class="linenos">386</span></a>        <span class="n">new_axes</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">sizes</span><span class="p">)</span>
</span><span id="Tensor.resize_to-387"><a href="#Tensor.resize_to-387"><span class="linenos">387</span></a>        <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">s_is</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sizes</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="Tensor.resize_to-388"><a href="#Tensor.resize_to-388"><span class="linenos">388</span></a>            <span class="n">a</span> <span class="o">=</span> <span class="n">AxisId</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
</span><span id="Tensor.resize_to-389"><a href="#Tensor.resize_to-389"><span class="linenos">389</span></a>            <span class="n">_</span> <span class="o">=</span> <span class="n">new_axes</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="Tensor.resize_to-390"><a href="#Tensor.resize_to-390"><span class="linenos">390</span></a>            <span class="k">if</span> <span class="n">a</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sizes</span> <span class="ow">or</span> <span class="n">sizes</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">==</span> <span class="n">s_is</span><span class="p">:</span>
</span><span id="Tensor.resize_to-391"><a href="#Tensor.resize_to-391"><span class="linenos">391</span></a>                <span class="k">pass</span>
</span><span id="Tensor.resize_to-392"><a href="#Tensor.resize_to-392"><span class="linenos">392</span></a>            <span class="k">elif</span> <span class="n">s_is</span> <span class="o">&gt;</span> <span class="n">sizes</span><span class="p">[</span><span class="n">a</span><span class="p">]:</span>
</span><span id="Tensor.resize_to-393"><a href="#Tensor.resize_to-393"><span class="linenos">393</span></a>                <span class="n">crop_to_sizes</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="n">sizes</span><span class="p">[</span><span class="n">a</span><span class="p">]</span>
</span><span id="Tensor.resize_to-394"><a href="#Tensor.resize_to-394"><span class="linenos">394</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Tensor.resize_to-395"><a href="#Tensor.resize_to-395"><span class="linenos">395</span></a>                <span class="n">pad_to_sizes</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="n">sizes</span><span class="p">[</span><span class="n">a</span><span class="p">]</span>
</span><span id="Tensor.resize_to-396"><a href="#Tensor.resize_to-396"><span class="linenos">396</span></a>
</span><span id="Tensor.resize_to-397"><a href="#Tensor.resize_to-397"><span class="linenos">397</span></a>        <span class="n">tensor</span> <span class="o">=</span> <span class="bp">self</span>
</span><span id="Tensor.resize_to-398"><a href="#Tensor.resize_to-398"><span class="linenos">398</span></a>        <span class="k">if</span> <span class="n">crop_to_sizes</span><span class="p">:</span>
</span><span id="Tensor.resize_to-399"><a href="#Tensor.resize_to-399"><span class="linenos">399</span></a>            <span class="n">tensor</span> <span class="o">=</span> <span class="n">tensor</span><span class="o">.</span><span class="n">crop_to</span><span class="p">(</span><span class="n">crop_to_sizes</span><span class="p">,</span> <span class="n">crop_where</span><span class="o">=</span><span class="n">crop_where</span><span class="p">)</span>
</span><span id="Tensor.resize_to-400"><a href="#Tensor.resize_to-400"><span class="linenos">400</span></a>
</span><span id="Tensor.resize_to-401"><a href="#Tensor.resize_to-401"><span class="linenos">401</span></a>        <span class="k">if</span> <span class="n">pad_to_sizes</span><span class="p">:</span>
</span><span id="Tensor.resize_to-402"><a href="#Tensor.resize_to-402"><span class="linenos">402</span></a>            <span class="n">tensor</span> <span class="o">=</span> <span class="n">tensor</span><span class="o">.</span><span class="n">pad_to</span><span class="p">(</span><span class="n">pad_to_sizes</span><span class="p">,</span> <span class="n">pad_where</span><span class="o">=</span><span class="n">pad_where</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">pad_mode</span><span class="p">)</span>
</span><span id="Tensor.resize_to-403"><a href="#Tensor.resize_to-403"><span class="linenos">403</span></a>
</span><span id="Tensor.resize_to-404"><a href="#Tensor.resize_to-404"><span class="linenos">404</span></a>        <span class="k">if</span> <span class="n">new_axes</span><span class="p">:</span>
</span><span id="Tensor.resize_to-405"><a href="#Tensor.resize_to-405"><span class="linenos">405</span></a>            <span class="n">tensor</span> <span class="o">=</span> <span class="n">tensor</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">new_axes</span><span class="p">)</span>
</span><span id="Tensor.resize_to-406"><a href="#Tensor.resize_to-406"><span class="linenos">406</span></a>
</span><span id="Tensor.resize_to-407"><a href="#Tensor.resize_to-407"><span class="linenos">407</span></a>        <span class="k">return</span> <span class="n">tensor</span>
</span></pre></div>


            <div class="docstring"><p>return cropped/padded tensor with <code><a href="#Tensor.sizes">sizes</a></code></p>
</div>


                            </div>
                            <div id="Tensor.transpose" class="classattr">
                                        <input id="Tensor.transpose-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">transpose</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">axes</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n"><a href="#AxisId">AxisId</a></span><span class="p">]</span></span><span class="return-annotation">) -> <span class="n">Self</span>:</span></span>

                <label class="view-source-button" for="Tensor.transpose-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Tensor.transpose"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Tensor.transpose-409"><a href="#Tensor.transpose-409"><span class="linenos">409</span></a>    <span class="k">def</span> <span class="nf">transpose</span><span class="p">(</span>
</span><span id="Tensor.transpose-410"><a href="#Tensor.transpose-410"><span class="linenos">410</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="Tensor.transpose-411"><a href="#Tensor.transpose-411"><span class="linenos">411</span></a>        <span class="n">axes</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">AxisId</span><span class="p">],</span>
</span><span id="Tensor.transpose-412"><a href="#Tensor.transpose-412"><span class="linenos">412</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
</span><span id="Tensor.transpose-413"><a href="#Tensor.transpose-413"><span class="linenos">413</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;return a transposed tensor</span>
</span><span id="Tensor.transpose-414"><a href="#Tensor.transpose-414"><span class="linenos">414</span></a>
</span><span id="Tensor.transpose-415"><a href="#Tensor.transpose-415"><span class="linenos">415</span></a><span class="sd">        Args:</span>
</span><span id="Tensor.transpose-416"><a href="#Tensor.transpose-416"><span class="linenos">416</span></a><span class="sd">            axes: the desired tensor axes</span>
</span><span id="Tensor.transpose-417"><a href="#Tensor.transpose-417"><span class="linenos">417</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Tensor.transpose-418"><a href="#Tensor.transpose-418"><span class="linenos">418</span></a>        <span class="c1"># expand missing tensor axes</span>
</span><span id="Tensor.transpose-419"><a href="#Tensor.transpose-419"><span class="linenos">419</span></a>        <span class="n">missing_axes</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">axes</span> <span class="k">if</span> <span class="n">a</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dims</span><span class="p">)</span>
</span><span id="Tensor.transpose-420"><a href="#Tensor.transpose-420"><span class="linenos">420</span></a>        <span class="n">array</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span>
</span><span id="Tensor.transpose-421"><a href="#Tensor.transpose-421"><span class="linenos">421</span></a>        <span class="k">if</span> <span class="n">missing_axes</span><span class="p">:</span>
</span><span id="Tensor.transpose-422"><a href="#Tensor.transpose-422"><span class="linenos">422</span></a>            <span class="n">array</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">missing_axes</span><span class="p">)</span>
</span><span id="Tensor.transpose-423"><a href="#Tensor.transpose-423"><span class="linenos">423</span></a>
</span><span id="Tensor.transpose-424"><a href="#Tensor.transpose-424"><span class="linenos">424</span></a>        <span class="c1"># transpose to the correct axis order</span>
</span><span id="Tensor.transpose-425"><a href="#Tensor.transpose-425"><span class="linenos">425</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="n">from_xarray</span><span class="p">(</span><span class="n">array</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="o">*</span><span class="n">axes</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>return a transposed tensor</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>axes:</strong>  the desired tensor axes</li>
</ul>
</div>


                            </div>
                </section>
                <section id="test_description">
                            <input id="test_description-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">test_description</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">source</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n"><a href="spec/application/v0_2.html#ApplicationDescr">bioimageio.spec.application.v0_2.ApplicationDescr</a></span><span class="p">,</span> <span class="n"><a href="spec.html#ApplicationDescr">bioimageio.spec.ApplicationDescr</a></span><span class="p">],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=</span><span class="s1">&#39;format_version&#39;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)],</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n"><a href="spec/dataset/v0_2.html#DatasetDescr">bioimageio.spec.dataset.v0_2.DatasetDescr</a></span><span class="p">,</span> <span class="n"><a href="spec.html#DatasetDescr">bioimageio.spec.DatasetDescr</a></span><span class="p">],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=</span><span class="s1">&#39;format_version&#39;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)],</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n"><a href="spec/model/v0_4.html#ModelDescr">bioimageio.spec.model.v0_4.ModelDescr</a></span><span class="p">,</span> <span class="n"><a href="spec.html#ModelDescr">bioimageio.spec.ModelDescr</a></span><span class="p">],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=</span><span class="s1">&#39;format_version&#39;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)],</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n"><a href="spec.html#NotebookDescr">bioimageio.spec.NotebookDescr</a></span><span class="p">,</span> <span class="n"><a href="spec.html#NotebookDescr">bioimageio.spec.NotebookDescr</a></span><span class="p">],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=</span><span class="s1">&#39;format_version&#39;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)]],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=</span><span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)],</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n"><a href="spec/generic/v0_2.html#GenericDescr">bioimageio.spec.generic.v0_2.GenericDescr</a></span><span class="p">,</span> <span class="n"><a href="spec.html#GenericDescr">bioimageio.spec.GenericDescr</a></span><span class="p">],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=</span><span class="s1">&#39;format_version&#39;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)],</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">bioimageio</span><span class="o">.</span><span class="n">spec</span><span class="o">.</span><span class="n">_internal</span><span class="o">.</span><span class="n">url</span><span class="o">.</span><span class="n">HttpUrl</span><span class="p">,</span> <span class="n">bioimageio</span><span class="o">.</span><span class="n">spec</span><span class="o">.</span><span class="n">_internal</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">RelativeFilePath</span><span class="p">,</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span> <span class="n">PathType</span><span class="p">(</span><span class="n">path_type</span><span class="o">=</span><span class="s1">&#39;file&#39;</span><span class="p">)]],</span> <span class="n">FieldInfo</span><span class="p">(</span><span class="n">annotation</span><span class="o">=</span><span class="n">NoneType</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="p">[</span><span class="n">_PydanticGeneralMetadata</span><span class="p">(</span><span class="n">union_mode</span><span class="o">=</span><span class="s1">&#39;left_to_right&#39;</span><span class="p">)])],</span> <span class="nb">str</span><span class="p">,</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">pydantic_core</span><span class="o">.</span><span class="n">_pydantic_core</span><span class="o">.</span><span class="n">Url</span><span class="p">,</span> <span class="n">UrlConstraints</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">2083</span><span class="p">,</span> <span class="n">allowed_schemes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;http&#39;</span><span class="p">,</span> <span class="s1">&#39;https&#39;</span><span class="p">],</span> <span class="n">host_required</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">default_host</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">default_port</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">default_path</span><span class="o">=</span><span class="kc">None</span><span class="p">)],</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">YamlValue</span><span class="p">]]</span>,</span><span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">format_version</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;discover&#39;</span><span class="p">,</span> <span class="s1">&#39;latest&#39;</span><span class="p">],</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;discover&#39;</span>,</span><span class="param">	<span class="n">weight_format</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;keras_hdf5&#39;</span><span class="p">,</span> <span class="s1">&#39;onnx&#39;</span><span class="p">,</span> <span class="s1">&#39;pytorch_state_dict&#39;</span><span class="p">,</span> <span class="s1">&#39;tensorflow_js&#39;</span><span class="p">,</span> <span class="s1">&#39;tensorflow_saved_model_bundle&#39;</span><span class="p">,</span> <span class="s1">&#39;torchscript&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">devices</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">absolute_tolerance</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.00015</span>,</span><span class="param">	<span class="n">relative_tolerance</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0001</span>,</span><span class="param">	<span class="n">decimal</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">determinism</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;seed_only&#39;</span><span class="p">,</span> <span class="s1">&#39;full&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;seed_only&#39;</span>,</span><span class="param">	<span class="n">expected_type</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n"><a href="spec.html#ValidationSummary">bioimageio.spec.ValidationSummary</a></span>:</span></span>

                <label class="view-source-button" for="test_description-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#test_description"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="test_description-120"><a href="#test_description-120"><span class="linenos">120</span></a><span class="k">def</span> <span class="nf">test_description</span><span class="p">(</span>
</span><span id="test_description-121"><a href="#test_description-121"><span class="linenos">121</span></a>    <span class="n">source</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ResourceDescr</span><span class="p">,</span> <span class="n">PermissiveFileSource</span><span class="p">,</span> <span class="n">BioimageioYamlContent</span><span class="p">],</span>
</span><span id="test_description-122"><a href="#test_description-122"><span class="linenos">122</span></a>    <span class="o">*</span><span class="p">,</span>
</span><span id="test_description-123"><a href="#test_description-123"><span class="linenos">123</span></a>    <span class="n">format_version</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;discover&quot;</span><span class="p">,</span> <span class="s2">&quot;latest&quot;</span><span class="p">],</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;discover&quot;</span><span class="p">,</span>
</span><span id="test_description-124"><a href="#test_description-124"><span class="linenos">124</span></a>    <span class="n">weight_format</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">WeightsFormat</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="test_description-125"><a href="#test_description-125"><span class="linenos">125</span></a>    <span class="n">devices</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="test_description-126"><a href="#test_description-126"><span class="linenos">126</span></a>    <span class="n">absolute_tolerance</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.5e-4</span><span class="p">,</span>
</span><span id="test_description-127"><a href="#test_description-127"><span class="linenos">127</span></a>    <span class="n">relative_tolerance</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-4</span><span class="p">,</span>
</span><span id="test_description-128"><a href="#test_description-128"><span class="linenos">128</span></a>    <span class="n">decimal</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="test_description-129"><a href="#test_description-129"><span class="linenos">129</span></a>    <span class="n">determinism</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;seed_only&quot;</span><span class="p">,</span> <span class="s2">&quot;full&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;seed_only&quot;</span><span class="p">,</span>
</span><span id="test_description-130"><a href="#test_description-130"><span class="linenos">130</span></a>    <span class="n">expected_type</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="test_description-131"><a href="#test_description-131"><span class="linenos">131</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ValidationSummary</span><span class="p">:</span>
</span><span id="test_description-132"><a href="#test_description-132"><span class="linenos">132</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Test a bioimage.io resource dynamically, e.g. prediction of test tensors for models&quot;&quot;&quot;</span>
</span><span id="test_description-133"><a href="#test_description-133"><span class="linenos">133</span></a>    <span class="n">rd</span> <span class="o">=</span> <span class="n">load_description_and_test</span><span class="p">(</span>
</span><span id="test_description-134"><a href="#test_description-134"><span class="linenos">134</span></a>        <span class="n">source</span><span class="p">,</span>
</span><span id="test_description-135"><a href="#test_description-135"><span class="linenos">135</span></a>        <span class="n">format_version</span><span class="o">=</span><span class="n">format_version</span><span class="p">,</span>
</span><span id="test_description-136"><a href="#test_description-136"><span class="linenos">136</span></a>        <span class="n">weight_format</span><span class="o">=</span><span class="n">weight_format</span><span class="p">,</span>
</span><span id="test_description-137"><a href="#test_description-137"><span class="linenos">137</span></a>        <span class="n">devices</span><span class="o">=</span><span class="n">devices</span><span class="p">,</span>
</span><span id="test_description-138"><a href="#test_description-138"><span class="linenos">138</span></a>        <span class="n">absolute_tolerance</span><span class="o">=</span><span class="n">absolute_tolerance</span><span class="p">,</span>
</span><span id="test_description-139"><a href="#test_description-139"><span class="linenos">139</span></a>        <span class="n">relative_tolerance</span><span class="o">=</span><span class="n">relative_tolerance</span><span class="p">,</span>
</span><span id="test_description-140"><a href="#test_description-140"><span class="linenos">140</span></a>        <span class="n">decimal</span><span class="o">=</span><span class="n">decimal</span><span class="p">,</span>
</span><span id="test_description-141"><a href="#test_description-141"><span class="linenos">141</span></a>        <span class="n">determinism</span><span class="o">=</span><span class="n">determinism</span><span class="p">,</span>
</span><span id="test_description-142"><a href="#test_description-142"><span class="linenos">142</span></a>        <span class="n">expected_type</span><span class="o">=</span><span class="n">expected_type</span><span class="p">,</span>
</span><span id="test_description-143"><a href="#test_description-143"><span class="linenos">143</span></a>    <span class="p">)</span>
</span><span id="test_description-144"><a href="#test_description-144"><span class="linenos">144</span></a>    <span class="k">return</span> <span class="n">rd</span><span class="o">.</span><span class="n">validation_summary</span>
</span></pre></div>


            <div class="docstring"><p>Test a bioimage.io resource dynamically, e.g. prediction of test tensors for models</p>
</div>


                </section>
                <section id="test_model">
                            <input id="test_model-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">test_model</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">source</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n"><a href="spec.html#ModelDescr">bioimageio.spec.ModelDescr</a></span><span class="p">,</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">bioimageio</span><span class="o">.</span><span class="n">spec</span><span class="o">.</span><span class="n">_internal</span><span class="o">.</span><span class="n">url</span><span class="o">.</span><span class="n">HttpUrl</span><span class="p">,</span> <span class="n">bioimageio</span><span class="o">.</span><span class="n">spec</span><span class="o">.</span><span class="n">_internal</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">RelativeFilePath</span><span class="p">,</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span> <span class="n">PathType</span><span class="p">(</span><span class="n">path_type</span><span class="o">=</span><span class="s1">&#39;file&#39;</span><span class="p">)]],</span> <span class="n">FieldInfo</span><span class="p">(</span><span class="n">annotation</span><span class="o">=</span><span class="n">NoneType</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="p">[</span><span class="n">_PydanticGeneralMetadata</span><span class="p">(</span><span class="n">union_mode</span><span class="o">=</span><span class="s1">&#39;left_to_right&#39;</span><span class="p">)])],</span> <span class="nb">str</span><span class="p">,</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">pydantic_core</span><span class="o">.</span><span class="n">_pydantic_core</span><span class="o">.</span><span class="n">Url</span><span class="p">,</span> <span class="n">UrlConstraints</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">2083</span><span class="p">,</span> <span class="n">allowed_schemes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;http&#39;</span><span class="p">,</span> <span class="s1">&#39;https&#39;</span><span class="p">],</span> <span class="n">host_required</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">default_host</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">default_port</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">default_path</span><span class="o">=</span><span class="kc">None</span><span class="p">)]]</span>,</span><span class="param">	<span class="n">weight_format</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;keras_hdf5&#39;</span><span class="p">,</span> <span class="s1">&#39;onnx&#39;</span><span class="p">,</span> <span class="s1">&#39;pytorch_state_dict&#39;</span><span class="p">,</span> <span class="s1">&#39;tensorflow_js&#39;</span><span class="p">,</span> <span class="s1">&#39;tensorflow_saved_model_bundle&#39;</span><span class="p">,</span> <span class="s1">&#39;torchscript&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">devices</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">absolute_tolerance</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.00015</span>,</span><span class="param">	<span class="n">relative_tolerance</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0001</span>,</span><span class="param">	<span class="n">decimal</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">determinism</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;seed_only&#39;</span><span class="p">,</span> <span class="s1">&#39;full&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;seed_only&#39;</span></span><span class="return-annotation">) -> <span class="n"><a href="spec.html#ValidationSummary">bioimageio.spec.ValidationSummary</a></span>:</span></span>

                <label class="view-source-button" for="test_model-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#test_model"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="test_model-97"><a href="#test_model-97"><span class="linenos"> 97</span></a><span class="k">def</span> <span class="nf">test_model</span><span class="p">(</span>
</span><span id="test_model-98"><a href="#test_model-98"><span class="linenos"> 98</span></a>    <span class="n">source</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">v0_5</span><span class="o">.</span><span class="n">ModelDescr</span><span class="p">,</span> <span class="n">PermissiveFileSource</span><span class="p">],</span>
</span><span id="test_model-99"><a href="#test_model-99"><span class="linenos"> 99</span></a>    <span class="n">weight_format</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">WeightsFormat</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="test_model-100"><a href="#test_model-100"><span class="linenos">100</span></a>    <span class="n">devices</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="test_model-101"><a href="#test_model-101"><span class="linenos">101</span></a>    <span class="n">absolute_tolerance</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.5e-4</span><span class="p">,</span>
</span><span id="test_model-102"><a href="#test_model-102"><span class="linenos">102</span></a>    <span class="n">relative_tolerance</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-4</span><span class="p">,</span>
</span><span id="test_model-103"><a href="#test_model-103"><span class="linenos">103</span></a>    <span class="n">decimal</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="test_model-104"><a href="#test_model-104"><span class="linenos">104</span></a>    <span class="o">*</span><span class="p">,</span>
</span><span id="test_model-105"><a href="#test_model-105"><span class="linenos">105</span></a>    <span class="n">determinism</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;seed_only&quot;</span><span class="p">,</span> <span class="s2">&quot;full&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;seed_only&quot;</span><span class="p">,</span>
</span><span id="test_model-106"><a href="#test_model-106"><span class="linenos">106</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ValidationSummary</span><span class="p">:</span>
</span><span id="test_model-107"><a href="#test_model-107"><span class="linenos">107</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Test model inference&quot;&quot;&quot;</span>
</span><span id="test_model-108"><a href="#test_model-108"><span class="linenos">108</span></a>    <span class="k">return</span> <span class="n">test_description</span><span class="p">(</span>
</span><span id="test_model-109"><a href="#test_model-109"><span class="linenos">109</span></a>        <span class="n">source</span><span class="p">,</span>
</span><span id="test_model-110"><a href="#test_model-110"><span class="linenos">110</span></a>        <span class="n">weight_format</span><span class="o">=</span><span class="n">weight_format</span><span class="p">,</span>
</span><span id="test_model-111"><a href="#test_model-111"><span class="linenos">111</span></a>        <span class="n">devices</span><span class="o">=</span><span class="n">devices</span><span class="p">,</span>
</span><span id="test_model-112"><a href="#test_model-112"><span class="linenos">112</span></a>        <span class="n">absolute_tolerance</span><span class="o">=</span><span class="n">absolute_tolerance</span><span class="p">,</span>
</span><span id="test_model-113"><a href="#test_model-113"><span class="linenos">113</span></a>        <span class="n">relative_tolerance</span><span class="o">=</span><span class="n">relative_tolerance</span><span class="p">,</span>
</span><span id="test_model-114"><a href="#test_model-114"><span class="linenos">114</span></a>        <span class="n">decimal</span><span class="o">=</span><span class="n">decimal</span><span class="p">,</span>
</span><span id="test_model-115"><a href="#test_model-115"><span class="linenos">115</span></a>        <span class="n">determinism</span><span class="o">=</span><span class="n">determinism</span><span class="p">,</span>
</span><span id="test_model-116"><a href="#test_model-116"><span class="linenos">116</span></a>        <span class="n">expected_type</span><span class="o">=</span><span class="s2">&quot;model&quot;</span><span class="p">,</span>
</span><span id="test_model-117"><a href="#test_model-117"><span class="linenos">117</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Test model inference</p>
</div>


                </section>
                <section id="test_resource">
                            <input id="test_resource-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">test_resource</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">source</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n"><a href="spec/application/v0_2.html#ApplicationDescr">bioimageio.spec.application.v0_2.ApplicationDescr</a></span><span class="p">,</span> <span class="n"><a href="spec.html#ApplicationDescr">bioimageio.spec.ApplicationDescr</a></span><span class="p">],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=</span><span class="s1">&#39;format_version&#39;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)],</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n"><a href="spec/dataset/v0_2.html#DatasetDescr">bioimageio.spec.dataset.v0_2.DatasetDescr</a></span><span class="p">,</span> <span class="n"><a href="spec.html#DatasetDescr">bioimageio.spec.DatasetDescr</a></span><span class="p">],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=</span><span class="s1">&#39;format_version&#39;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)],</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n"><a href="spec/model/v0_4.html#ModelDescr">bioimageio.spec.model.v0_4.ModelDescr</a></span><span class="p">,</span> <span class="n"><a href="spec.html#ModelDescr">bioimageio.spec.ModelDescr</a></span><span class="p">],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=</span><span class="s1">&#39;format_version&#39;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)],</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n"><a href="spec.html#NotebookDescr">bioimageio.spec.NotebookDescr</a></span><span class="p">,</span> <span class="n"><a href="spec.html#NotebookDescr">bioimageio.spec.NotebookDescr</a></span><span class="p">],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=</span><span class="s1">&#39;format_version&#39;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)]],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=</span><span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)],</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n"><a href="spec/generic/v0_2.html#GenericDescr">bioimageio.spec.generic.v0_2.GenericDescr</a></span><span class="p">,</span> <span class="n"><a href="spec.html#GenericDescr">bioimageio.spec.GenericDescr</a></span><span class="p">],</span> <span class="n">Discriminator</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=</span><span class="s1">&#39;format_version&#39;</span><span class="p">,</span> <span class="n">custom_error_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">custom_error_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)],</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">bioimageio</span><span class="o">.</span><span class="n">spec</span><span class="o">.</span><span class="n">_internal</span><span class="o">.</span><span class="n">url</span><span class="o">.</span><span class="n">HttpUrl</span><span class="p">,</span> <span class="n">bioimageio</span><span class="o">.</span><span class="n">spec</span><span class="o">.</span><span class="n">_internal</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">RelativeFilePath</span><span class="p">,</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span> <span class="n">PathType</span><span class="p">(</span><span class="n">path_type</span><span class="o">=</span><span class="s1">&#39;file&#39;</span><span class="p">)]],</span> <span class="n">FieldInfo</span><span class="p">(</span><span class="n">annotation</span><span class="o">=</span><span class="n">NoneType</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="p">[</span><span class="n">_PydanticGeneralMetadata</span><span class="p">(</span><span class="n">union_mode</span><span class="o">=</span><span class="s1">&#39;left_to_right&#39;</span><span class="p">)])],</span> <span class="nb">str</span><span class="p">,</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">pydantic_core</span><span class="o">.</span><span class="n">_pydantic_core</span><span class="o">.</span><span class="n">Url</span><span class="p">,</span> <span class="n">UrlConstraints</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">2083</span><span class="p">,</span> <span class="n">allowed_schemes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;http&#39;</span><span class="p">,</span> <span class="s1">&#39;https&#39;</span><span class="p">],</span> <span class="n">host_required</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">default_host</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">default_port</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">default_path</span><span class="o">=</span><span class="kc">None</span><span class="p">)],</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">YamlValue</span><span class="p">]]</span>,</span><span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">format_version</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;discover&#39;</span><span class="p">,</span> <span class="s1">&#39;latest&#39;</span><span class="p">],</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;discover&#39;</span>,</span><span class="param">	<span class="n">weight_format</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;keras_hdf5&#39;</span><span class="p">,</span> <span class="s1">&#39;onnx&#39;</span><span class="p">,</span> <span class="s1">&#39;pytorch_state_dict&#39;</span><span class="p">,</span> <span class="s1">&#39;tensorflow_js&#39;</span><span class="p">,</span> <span class="s1">&#39;tensorflow_saved_model_bundle&#39;</span><span class="p">,</span> <span class="s1">&#39;torchscript&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">devices</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">absolute_tolerance</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.00015</span>,</span><span class="param">	<span class="n">relative_tolerance</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0001</span>,</span><span class="param">	<span class="n">decimal</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">determinism</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;seed_only&#39;</span><span class="p">,</span> <span class="s1">&#39;full&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;seed_only&#39;</span>,</span><span class="param">	<span class="n">expected_type</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n"><a href="spec.html#ValidationSummary">bioimageio.spec.ValidationSummary</a></span>:</span></span>

                <label class="view-source-button" for="test_resource-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#test_resource"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="test_resource-120"><a href="#test_resource-120"><span class="linenos">120</span></a><span class="k">def</span> <span class="nf">test_description</span><span class="p">(</span>
</span><span id="test_resource-121"><a href="#test_resource-121"><span class="linenos">121</span></a>    <span class="n">source</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ResourceDescr</span><span class="p">,</span> <span class="n">PermissiveFileSource</span><span class="p">,</span> <span class="n">BioimageioYamlContent</span><span class="p">],</span>
</span><span id="test_resource-122"><a href="#test_resource-122"><span class="linenos">122</span></a>    <span class="o">*</span><span class="p">,</span>
</span><span id="test_resource-123"><a href="#test_resource-123"><span class="linenos">123</span></a>    <span class="n">format_version</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;discover&quot;</span><span class="p">,</span> <span class="s2">&quot;latest&quot;</span><span class="p">],</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;discover&quot;</span><span class="p">,</span>
</span><span id="test_resource-124"><a href="#test_resource-124"><span class="linenos">124</span></a>    <span class="n">weight_format</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">WeightsFormat</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="test_resource-125"><a href="#test_resource-125"><span class="linenos">125</span></a>    <span class="n">devices</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="test_resource-126"><a href="#test_resource-126"><span class="linenos">126</span></a>    <span class="n">absolute_tolerance</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.5e-4</span><span class="p">,</span>
</span><span id="test_resource-127"><a href="#test_resource-127"><span class="linenos">127</span></a>    <span class="n">relative_tolerance</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-4</span><span class="p">,</span>
</span><span id="test_resource-128"><a href="#test_resource-128"><span class="linenos">128</span></a>    <span class="n">decimal</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="test_resource-129"><a href="#test_resource-129"><span class="linenos">129</span></a>    <span class="n">determinism</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;seed_only&quot;</span><span class="p">,</span> <span class="s2">&quot;full&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;seed_only&quot;</span><span class="p">,</span>
</span><span id="test_resource-130"><a href="#test_resource-130"><span class="linenos">130</span></a>    <span class="n">expected_type</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="test_resource-131"><a href="#test_resource-131"><span class="linenos">131</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ValidationSummary</span><span class="p">:</span>
</span><span id="test_resource-132"><a href="#test_resource-132"><span class="linenos">132</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Test a bioimage.io resource dynamically, e.g. prediction of test tensors for models&quot;&quot;&quot;</span>
</span><span id="test_resource-133"><a href="#test_resource-133"><span class="linenos">133</span></a>    <span class="n">rd</span> <span class="o">=</span> <span class="n">load_description_and_test</span><span class="p">(</span>
</span><span id="test_resource-134"><a href="#test_resource-134"><span class="linenos">134</span></a>        <span class="n">source</span><span class="p">,</span>
</span><span id="test_resource-135"><a href="#test_resource-135"><span class="linenos">135</span></a>        <span class="n">format_version</span><span class="o">=</span><span class="n">format_version</span><span class="p">,</span>
</span><span id="test_resource-136"><a href="#test_resource-136"><span class="linenos">136</span></a>        <span class="n">weight_format</span><span class="o">=</span><span class="n">weight_format</span><span class="p">,</span>
</span><span id="test_resource-137"><a href="#test_resource-137"><span class="linenos">137</span></a>        <span class="n">devices</span><span class="o">=</span><span class="n">devices</span><span class="p">,</span>
</span><span id="test_resource-138"><a href="#test_resource-138"><span class="linenos">138</span></a>        <span class="n">absolute_tolerance</span><span class="o">=</span><span class="n">absolute_tolerance</span><span class="p">,</span>
</span><span id="test_resource-139"><a href="#test_resource-139"><span class="linenos">139</span></a>        <span class="n">relative_tolerance</span><span class="o">=</span><span class="n">relative_tolerance</span><span class="p">,</span>
</span><span id="test_resource-140"><a href="#test_resource-140"><span class="linenos">140</span></a>        <span class="n">decimal</span><span class="o">=</span><span class="n">decimal</span><span class="p">,</span>
</span><span id="test_resource-141"><a href="#test_resource-141"><span class="linenos">141</span></a>        <span class="n">determinism</span><span class="o">=</span><span class="n">determinism</span><span class="p">,</span>
</span><span id="test_resource-142"><a href="#test_resource-142"><span class="linenos">142</span></a>        <span class="n">expected_type</span><span class="o">=</span><span class="n">expected_type</span><span class="p">,</span>
</span><span id="test_resource-143"><a href="#test_resource-143"><span class="linenos">143</span></a>    <span class="p">)</span>
</span><span id="test_resource-144"><a href="#test_resource-144"><span class="linenos">144</span></a>    <span class="k">return</span> <span class="n">rd</span><span class="o">.</span><span class="n">validation_summary</span>
</span></pre></div>


            <div class="docstring"><p>alias of <code><a href="#test_description">test_description</a></code></p>
</div>


                </section>
                <section id="validate_format">
                            <input id="validate_format-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">validate_format</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">data</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">YamlValue</span><span class="p">]</span>,</span><span class="param">	<span class="o">/</span>,</span><span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">format_version</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;latest&#39;</span><span class="p">,</span> <span class="s1">&#39;discover&#39;</span><span class="p">],</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;discover&#39;</span>,</span><span class="param">	<span class="n">context</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n"><a href="spec.html#ValidationContext">bioimageio.spec.ValidationContext</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n"><a href="spec.html#ValidationSummary">bioimageio.spec.ValidationSummary</a></span>:</span></span>

                <label class="view-source-button" for="validate_format-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#validate_format"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="validate_format-161"><a href="#validate_format-161"><span class="linenos">161</span></a><span class="k">def</span> <span class="nf">validate_format</span><span class="p">(</span>
</span><span id="validate_format-162"><a href="#validate_format-162"><span class="linenos">162</span></a>    <span class="n">data</span><span class="p">:</span> <span class="n">BioimageioYamlContent</span><span class="p">,</span>
</span><span id="validate_format-163"><a href="#validate_format-163"><span class="linenos">163</span></a>    <span class="o">/</span><span class="p">,</span>
</span><span id="validate_format-164"><a href="#validate_format-164"><span class="linenos">164</span></a>    <span class="o">*</span><span class="p">,</span>
</span><span id="validate_format-165"><a href="#validate_format-165"><span class="linenos">165</span></a>    <span class="n">format_version</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;discover&quot;</span><span class="p">,</span> <span class="s2">&quot;latest&quot;</span><span class="p">],</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">DISCOVER</span><span class="p">,</span>
</span><span id="validate_format-166"><a href="#validate_format-166"><span class="linenos">166</span></a>    <span class="n">context</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ValidationContext</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="validate_format-167"><a href="#validate_format-167"><span class="linenos">167</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ValidationSummary</span><span class="p">:</span>
</span><span id="validate_format-168"><a href="#validate_format-168"><span class="linenos">168</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;validate a bioimageio.yaml file (RDF)&quot;&quot;&quot;</span>
</span><span id="validate_format-169"><a href="#validate_format-169"><span class="linenos">169</span></a>    <span class="k">with</span> <span class="n">context</span> <span class="ow">or</span> <span class="n">validation_context_var</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
</span><span id="validate_format-170"><a href="#validate_format-170"><span class="linenos">170</span></a>        <span class="n">rd</span> <span class="o">=</span> <span class="n">build_description</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">format_version</span><span class="o">=</span><span class="n">format_version</span><span class="p">)</span>
</span><span id="validate_format-171"><a href="#validate_format-171"><span class="linenos">171</span></a>
</span><span id="validate_format-172"><a href="#validate_format-172"><span class="linenos">172</span></a>    <span class="k">assert</span> <span class="n">rd</span><span class="o">.</span><span class="n">validation_summary</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="validate_format-173"><a href="#validate_format-173"><span class="linenos">173</span></a>    <span class="k">return</span> <span class="n">rd</span><span class="o">.</span><span class="n">validation_summary</span>
</span></pre></div>


            <div class="docstring"><p>validate a bioimageio.yaml file (RDF)</p>
</div>


                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>